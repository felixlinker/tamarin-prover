theory TAK1 begin

// Function signature and definition of the equational theory E

builtins: diffie-hellman, bilinear-pairing, multiset
functions: fst/1, h/1, kdf/1, pair/2, snd/1, tag/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2





section{* The TAK1 Protocol. *}





rule (modulo E) Register_pk:
   [ Fr( ~ea ) ]
  -->
   [ !Ltk( $A, ~ea ), !Pk( $A, pmult(~ea, 'P') ), Out( pmult(~ea, 'P') ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_ltk:
   [ !Ltk( $A, ~ea ) ] --[ LtkRev( $A ) ]-> [ Out( ~ea ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_ephk:
   [ !EphKey( ~ek ) ] --[ EphkRev( ~ek ) ]-> [ Out( ~ek ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_sessk:
   [ !SessKey( ~sid, kdf(sessKey) ) ]
  --[ SesskRev( ~sid ) ]->
   [ Out( kdf(sessKey) ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Proto1:
   [ Fr( ~ex ) ]
  --[ Origin( ~ex, pmult(~ex, 'P') ), Participants( ($A++$B++$C) ) ]->
   [ PState1( ~ex, $A, $B, $C ), Out( pmult(~ex, 'P') ), !EphKey( ~ex ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Proto2:
   [ PState1( ~ex, $A, $B, $C ), In( XB ), In( XC ) ]
  -->
   [ PState2( ~ex, $A, $B, $C, tag(XB), tag(XC), em(XB, XC) ) ]

  /*
  rule (modulo AC) Proto2:
     [ PState1( ~ex, $A, $B, $C ), In( XB ), In( XC ) ]
    -->
     [ PState2( ~ex, $A, $B, $C, tag(XB), tag(XC), z ) ]
    variants (modulo AC)
     1. XB    = XB.2
        XC    = pmult(x, x.1)
        z     = em(x.1, XB.2)^x
    
     2. XB    = pmult(x, x.1)
        XC    = XC.2
        z     = em(x.1, XC.2)^x
    
     3. XB    = pmult(x, x.1)
        XC    = pmult((x.2*inv(x)), x.3)
        z     = em(x.1, x.3)^x.2
    
     4. XB    = pmult(inv(x), x.1)
        XC    = pmult((x*x.2), x.3)
        z     = em(x.1, x.3)^x.2
    
     5. XB    = pmult(x, x.1)
        XC    = pmult(inv((x*x.2)), x.3)
        z     = em(x.1, x.3)^inv(x.2)
    
     6. XB    = pmult(inv(x), x.1)
        XC    = pmult(inv(x.2), x.3)
        z     = em(x.1, x.3)^inv((x*x.2))
    
     7. XB    = pmult(x, x.1)
        XC    = pmult(x.2, x.3)
        z     = em(x.1, x.3)^(x*x.2)
    
     8. XB    = pmult(x, x.1)
        XC    = pmult((x.2*inv((x*x.3))), x.4)
        z     = em(x.1, x.4)^(x.2*inv(x.3))
    
     9. XB    = pmult(inv(x), x.1)
        XC    = pmult((x.2*inv(x.3)), x.4)
        z     = em(x.1, x.4)^(x.2*inv((x*x.3)))
    
    10. XB    = pmult((x*inv(x.1)), x.2)
        XC    = pmult(x.1, x.3)
        z     = em(x.2, x.3)^x
    
    11. XB    = pmult((x*x.1), x.2)
        XC    = pmult(inv(x), x.3)
        z     = em(x.2, x.3)^x.1
    
    12. XB    = pmult(inv((x*x.1)), x.2)
        XC    = pmult(x.1, x.3)
        z     = em(x.2, x.3)^inv(x)
    
    13. XB    = pmult((x*inv(x.1)), x.2)
        XC    = pmult((x.1*x.3*inv(x)), x.4)
        z     = em(x.2, x.4)^x.3
    
    14. XB    = pmult((x*inv(x.1)), x.2)
        XC    = pmult((x.1*inv((x*x.3))), x.4)
        z     = em(x.2, x.4)^inv(x.3)
    
    15. XB    = pmult(inv((x*x.1)), x.2)
        XC    = pmult((x*inv(x.3)), x.4)
        z     = em(x.2, x.4)^inv((x.1*x.3))
    
    16. XB    = pmult((x*inv(x.1)), x.2)
        XC    = pmult(inv((x*x.3)), x.4)
        z     = em(x.2, x.4)^inv((x.1*x.3))
    
    17. XB    = pmult((x*inv(x.1)), x.2)
        XC    = pmult((x.1*x.3), x.4)
        z     = em(x.2, x.4)^(x*x.3)
    
    18. XB    = pmult((x*inv(x.1)), x.2)
        XC    = pmult(inv(x.3), x.4)
        z     = em(x.2, x.4)^(x*inv((x.1*x.3)))
    
    19. XB    = pmult((x*x.1), x.2)
        XC    = pmult((x.3*inv(x)), x.4)
        z     = em(x.2, x.4)^(x.1*x.3)
    
    20. XB    = pmult((x*x.1), x.2)
        XC    = pmult(inv((x*x.3)), x.4)
        z     = em(x.2, x.4)^(x.1*inv(x.3))
    
    21. XB    = pmult(inv((x*x.1)), x.2)
        XC    = pmult((x*x.3), x.4)
        z     = em(x.2, x.4)^(x.3*inv(x.1))
    
    22. XB    = pmult((x*inv(x.1)), x.2)
        XC    = pmult((x.3*inv(x.4)), x.5)
        z     = em(x.2, x.5)^(x*x.3*inv((x.1*x.4)))
    
    23. XB    = pmult((x*x.1), x.2)
        XC    = pmult((x.3*inv((x*x.4))), x.5)
        z     = em(x.2, x.5)^(x.1*x.3*inv(x.4))
    
    24. XB    = pmult((x*inv(x.1)), x.2)
        XC    = pmult((x.1*x.3*inv((x*x.4))), x.5)
        z     = em(x.2, x.5)^(x.3*inv(x.4))
    
    25. XB    = pmult(inv((x*x.1)), x.2)
        XC    = pmult((x*x.3*inv(x.4)), x.5)
        z     = em(x.2, x.5)^(x.3*inv((x.1*x.4)))
    
    26. XB    = pmult((x*inv(x.1)), x.2)
        XC    = pmult((x.3*inv((x*x.4))), x.5)
        z     = em(x.2, x.5)^(x.3*inv((x.1*x.4)))
    
    27. XB    = pmult((x*x.1*inv(x.2)), x.3)
        XC    = pmult((x.2*inv(x.1)), x.4)
        z     = em(x.3, x.4)^x
    
    28. XB    = pmult((x*inv((x.1*x.2))), x.3)
        XC    = pmult((x.2*inv(x)), x.4)
        z     = em(x.3, x.4)^inv(x.1)
    
    29. XB    = pmult((x*inv((x.1*x.2))), x.3)
        XC    = pmult(x.2, x.4)
        z     = em(x.3, x.4)^(x*inv(x.1))
    
    30. XB    = pmult((x*inv((x.1*x.2))), x.3)
        XC    = pmult((x.1*inv((x*x.4))), x.5)
        z     = em(x.3, x.5)^inv((x.2*x.4))
    
    31. XB    = pmult((x*inv((x.1*x.2))), x.3)
        XC    = pmult((x.1*x.4), x.5)
        z     = em(x.3, x.5)^(x*x.4*inv(x.2))
    
    32. XB    = pmult((x*x.1*inv(x.2)), x.3)
        XC    = pmult(inv((x.1*x.4)), x.5)
        z     = em(x.3, x.5)^(x*inv((x.2*x.4)))
    
    33. XB    = pmult((x*inv((x.1*x.2))), x.3)
        XC    = pmult((x.1*inv(x.4)), x.5)
        z     = em(x.3, x.5)^(x*inv((x.2*x.4)))
    
    34. XB    = pmult((x*x.1*inv(x.2)), x.3)
        XC    = pmult((x.2*x.4*inv(x)), x.5)
        z     = em(x.3, x.5)^(x.1*x.4)
    
    35. XB    = pmult((x*x.1*inv(x.2)), x.3)
        XC    = pmult((x.2*inv((x*x.4))), x.5)
        z     = em(x.3, x.5)^(x.1*inv(x.4))
    
    36. XB    = pmult((x*inv((x.1*x.2))), x.3)
        XC    = pmult((x.1*x.4*inv(x)), x.5)
        z     = em(x.3, x.5)^(x.4*inv(x.2))
    
    37. XB    = pmult((x*inv((x.1*x.2))), x.3)
        XC    = pmult((x.1*x.4*inv(x.5)), x.6)
        z     = em(x.3, x.6)^(x*x.4*inv((x.2*x.5)))
    
    38. XB    = pmult((x*x.1*inv(x.2)), x.3)
        XC    = pmult((x.2*x.4*inv((x*x.5))), x.6)
        z     = em(x.3, x.6)^(x.1*x.4*inv(x.5))
    
    39. XB    = pmult((x*x.1*inv(x.2)), x.3)
        XC    = pmult((x.4*inv((x*x.5))), x.6)
        z     = em(x.3, x.6)^(x.1*x.4*inv((x.2*x.5)))
    
    40. XB    = pmult((x*inv((x.1*x.2))), x.3)
        XC    = pmult((x.1*x.4*inv((x*x.5))), x.6)
        z     = em(x.3, x.6)^(x.4*inv((x.2*x.5)))
    
    41. XB    = pmult((x*x.1*inv((x.2*x.3))), x.4)
        XC    = pmult((x.3*inv(x.1)), x.5)
        z     = em(x.4, x.5)^(x*inv(x.2))
    
    42. XB    = pmult((x*x.1*inv((x.2*x.3))), x.4)
        XC    = pmult((x.2*x.5*inv(x)), x.6)
        z     = em(x.4, x.6)^(x.1*x.5*inv(x.3))
    
    43. XB    = pmult((x*x.1*inv((x.2*x.3))), x.4)
        XC    = pmult((x.2*inv((x*x.5))), x.6)
        z     = em(x.4, x.6)^(x.1*inv((x.3*x.5)))
    
    44. XB    = pmult((x*x.1*inv((x.2*x.3))), x.4)
        XC    = pmult((x.2*x.5*inv((x*x.6))), x.7)
        z     = em(x.4, x.7)^(x.1*x.5*inv((x.3*x.6)))
    
    45. XB    = pmult(x, x.1)
        XC    = pmult(inv(x), x.2)
        z     = em(x.1, x.2)
    
    46. XB    = pmult(inv(x), x.1)
        XC    = pmult(x, x.2)
        z     = em(x.1, x.2)
    
    47. XB    = XB.2
        XC    = XC.2
        z     = em(XB.2, XC.2)
    
    48. XB    = pmult((x*inv(x.1)), x.2)
        XC    = pmult((x.1*inv(x)), x.3)
        z     = em(x.2, x.3)
  */

rule (modulo E) Proto3:
   [
   PState2( ~ex, $A, $B, $C, tag(XB), tag(XC), emXBXC ), !Ltk( $A, ~ea ),
   !Pk( $B, pmult(~eb, 'P') ), !Pk( $C, pmult(~ec, 'P') )
   ]
  --[
  Accept( ~ex, $A, $B, $C, pmult(~ex, 'P'), tag(XB), tag(XC),
          kdf(<emXBXC^~ex, em(pmult(~eb, 'P'), pmult(~ec, 'P'))^~ea, ($A++$B++$C), 
               (tag(XB)++tag(XC)++tag(pmult(~ex, 'P')))>)
  ),
  Match( ~ex, <(tag(XB)++tag(XC)++tag(pmult(~ex, 'P'))), ($A++$B++$C)> ),
  Sid( ~ex, <(tag(XB)++tag(XC)++tag(pmult(~ex, 'P'))), ($A++$B++$C)> )
  ]->
   [
   !SessKey( ~ex,
             kdf(<emXBXC^~ex, em(pmult(~eb, 'P'), pmult(~ec, 'P'))^~ea, ($A++$B++$C), 
                  (tag(XB)++tag(XC)++tag(pmult(~ex, 'P')))>)
   )
   ]

  /*
  rule (modulo AC) Proto3:
     [
     PState2( ~ex, $A, $B, $C, tag(XB), tag(XC), emXBXC ), !Ltk( $A, ~ea ),
     !Pk( $B, pmult(~x, 'P') ), !Pk( $C, pmult(~x.1, 'P') )
     ]
    --[
    Accept( ~ex, $A, $B, $C, pmult(~ex, 'P'), tag(XB), tag(XC),
            kdf(<z, em('P', 'P')^(~ea*~x*~x.1), ($A++$B++$C), 
                 (tag(XB)++tag(XC)++tag(pmult(~ex, 'P')))>)
    ),
    Match( ~ex, <(tag(XB)++tag(XC)++tag(pmult(~ex, 'P'))), ($A++$B++$C)> ),
    Sid( ~ex, <(tag(XB)++tag(XC)++tag(pmult(~ex, 'P'))), ($A++$B++$C)> )
    ]->
     [
     !SessKey( ~ex,
               kdf(<z, em('P', 'P')^(~ea*~x*~x.1), ($A++$B++$C), 
                    (tag(XB)++tag(XC)++tag(pmult(~ex, 'P')))>)
     )
     ]
    variants (modulo AC)
    1. ~ex   = ~ex.3
       emXBXC
             = emXBXC.3
       z     = emXBXC.3^~ex.3
    
    2. ~ex   = ~ex.3
       emXBXC
             = x.20^x.21
       z     = x.20^(~ex.3*x.21)
    
    3. ~ex   = ~x.22
       emXBXC
             = x.25^inv(~x.22)
       z     = x.25
    
    4. ~ex   = ~x.23
       emXBXC
             = x.26^inv((~x.23*x.27))
       z     = x.26^inv(x.27)
    
    5. ~ex   = ~x.23
       emXBXC
             = x.26^(x.27*inv(~x.23))
       z     = x.26^x.27
    
    6. ~ex   = ~x.24
       emXBXC
             = x.27^(x.28*inv((~x.24*x.29)))
       z     = x.27^(x.28*inv(x.29))
    
    7. emXBXC
             = DH_neutral
       z     = DH_neutral
  */

lemma session_key_establish:
  exists-trace
  "∃ A B C XA XB XC sa sb sc #ia #ib #ic k.
    ((((((((Accept( sa, A, B, C, XA, tag(XB), tag(XC), k ) @ #ia) ∧
           (Accept( sb, B, A, C, XB, tag(XA), tag(XC), k ) @ #ib)) ∧
          (Accept( sc, C, A, B, XC, tag(XA), tag(XB), k ) @ #ic)) ∧
         (¬(A = B))) ∧
        (¬(B = C))) ∧
       (¬(A = C))) ∧
      (¬(∃ #j. LtkRev( A ) @ #j))) ∧
     (¬(∃ #j. LtkRev( B ) @ #j))) ∧
    (¬(∃ #j. LtkRev( C ) @ #j))"
/*
guarded formula characterizing all satisfying traces:
"∃ A B C XA XB XC sa sb sc #ia #ib #ic k.
  (Accept( sa, A, B, C, XA, tag(XB), tag(XC), k ) @ #ia) ∧
  (Accept( sb, B, A, C, XB, tag(XA), tag(XC), k ) @ #ib) ∧
  (Accept( sc, C, A, B, XC, tag(XA), tag(XB), k ) @ #ic)
 ∧
  (¬(A = B)) ∧
  (¬(B = C)) ∧
  (¬(A = C)) ∧
  (∀ #j. (LtkRev( A ) @ #j) ⇒ ⊥) ∧
  (∀ #j. (LtkRev( B ) @ #j) ⇒ ⊥) ∧
  (∀ #j. (LtkRev( C ) @ #j) ⇒ ⊥)"
*/
simplify
  case 17
  solve( PState2( ~ex, $B.3, $C.3, $A.3, tag(pmult(~ex.1, 'P')),
                  tag(pmult(~ex.2, 'P')), emXBXC
         ) ▶₀ #ia )
    case Proto2
    solve( !Ltk( $B.3, ~ea.4 ) ▶₁ #ia )
      case Register_pk
      solve( !Pk( $C.3, pmult(~x.8, 'P') ) ▶₂ #ia )
        case Register_pk
        solve( !Pk( $A.3, pmult(~ea.5, 'P') ) ▶₃ #ia )
          case Register_pk
          solve( PState2( ~ex.9, $C.3, $B.3, $A.3, tag(pmult(~ex.11, 'P')),
                          tag(pmult(~ex.10, 'P')), em('P', 'P')^(~ex.10*~ex.11)
                 ) ▶₀ #ib )
            case Proto2
            solve( !Ltk( $C.3, ~x.8 ) ▶₁ #ib )
              case Register_pk
              solve( !Pk( $B.3, pmult(~ea.4, 'P') ) ▶₂ #ib )
                case Register_pk
                solve( !Pk( $A.3, pmult(~ea.5, 'P') ) ▶₃ #ib )
                  case Register_pk
                  solve( PState2( ~ex.10, $A.3, $B.3, $C.3, tag(pmult(~ex.11, 'P')),
                                  tag(pmult(~ex.9, 'P')), em('P', 'P')^(~ex.9*~ex.11)
                         ) ▶₀ #ic )
                    case Proto2
                    solve( !Ltk( $A.3, ~ea.5 ) ▶₁ #ic )
                      case Register_pk
                      solve( !Pk( $B.3, pmult(~ea.4, 'P') ) ▶₂ #ic )
                        case Register_pk
                        solve( !Pk( $C.3, pmult(~x.8, 'P') ) ▶₃ #ic )
                          case Register_pk
                          solve( !KU( pmult(~ex.9, 'P') ) @ #vk.5 )
                            case Proto1
                            solve( !KU( pmult(~ex.10, 'P') ) @ #vk.3 )
                              case Proto1
                              solve( !KU( pmult(~ex.11, 'P') ) @ #vk.4 )
                                case Proto1
                                SOLVED // trace found
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma Session_Key_Secrecy:
  all-traces
  "∀ stest A B C XA XB XC sessKey sessString #i #j.
    (((Accept( stest, A, B, C, XA, tag(XB), tag(XC), sessKey ) @ #i) ∧
      (K( sessKey ) @ #j)) ∧
     (Match( stest, sessString ) @ #i)) ⇒
    (((∃ #m #n smatch.
        (Sid( smatch, sessString ) @ #m) ∧ (SesskRev( smatch ) @ #n)) ∨
      (((¬(∃ #k spartner. Origin( spartner, XC ) @ #k)) ∨
        (¬(∃ #k spartner. Origin( spartner, XB ) @ #k))) ∧
       (((∃ #m. LtkRev( A ) @ #m) ∨ (∃ #m. LtkRev( B ) @ #m)) ∨
        (∃ #m. LtkRev( C ) @ #m)))) ∨
     (∃ #k #l spartner1 spartner2.
       ((Origin( spartner1, XB ) @ #k) ∧ (Origin( spartner2, XC ) @ #l)) ∧
       ((((∃ #v1. LtkRev( A ) @ #v1) ∨ (∃ #v1. LtkRev( B ) @ #v1)) ∨
         (∃ #v1. LtkRev( C ) @ #v1)) ∧
        (((∃ #v2. EphkRev( stest ) @ #v2) ∨
          (∃ #v2. EphkRev( spartner1 ) @ #v2)) ∨
         (∃ #v2. EphkRev( spartner2 ) @ #v2)))))"
/*
guarded formula characterizing all counter-examples:
"∃ stest A B C XA XB XC sessKey sessString #i #j.
  (Accept( stest, A, B, C, XA, tag(XB), tag(XC), sessKey ) @ #i) ∧
  (K( sessKey ) @ #j) ∧
  (Match( stest, sessString ) @ #i)
 ∧
  (∀ #m #n smatch.
    (Sid( smatch, sessString ) @ #m) ∧ (SesskRev( smatch ) @ #n) ⇒ ⊥) ∧
  ((((∃ #k spartner. (Origin( spartner, XC ) @ #k)) ∧
     (∃ #k spartner. (Origin( spartner, XB ) @ #k))) ∨
    ((∀ #m. (LtkRev( A ) @ #m) ⇒ ⊥) ∧
     (∀ #m. (LtkRev( B ) @ #m) ⇒ ⊥) ∧
     (∀ #m. (LtkRev( C ) @ #m) ⇒ ⊥)))) ∧
  (∀ #k #l spartner1 spartner2.
    (Origin( spartner1, XB ) @ #k) ∧ (Origin( spartner2, XC ) @ #l)
   ⇒
    (((∀ #v1. (LtkRev( A ) @ #v1) ⇒ ⊥) ∧
      (∀ #v1. (LtkRev( B ) @ #v1) ⇒ ⊥) ∧
      (∀ #v1. (LtkRev( C ) @ #v1) ⇒ ⊥)) ∨
     ((∀ #v2. (EphkRev( stest ) @ #v2) ⇒ ⊥) ∧
      (∀ #v2. (EphkRev( spartner1 ) @ #v2) ⇒ ⊥) ∧
      (∀ #v2. (EphkRev( spartner2 ) @ #v2) ⇒ ⊥))))"
*/
simplify
solve( ((∃ #k spartner. (Origin( spartner, XC.1 ) @ #k)) ∧
        (∃ #k spartner. (Origin( spartner, XB.1 ) @ #k)))  ∥
       ((∀ #m. (LtkRev( $A.1 ) @ #m) ⇒ ⊥) ∧
        (∀ #m. (LtkRev( $B.1 ) @ #m) ⇒ ⊥) ∧
        (∀ #m. (LtkRev( $C.1 ) @ #m) ⇒ ⊥)) )
  case case_1
  solve( ((∀ #v1. (LtkRev( $A.1 ) @ #v1) ⇒ ⊥) ∧
          (∀ #v1. (LtkRev( $B.1 ) @ #v1) ⇒ ⊥) ∧
          (∀ #v1. (LtkRev( $C.1 ) @ #v1) ⇒ ⊥))  ∥
         ((∀ #v2. (EphkRev( ~ex ) @ #v2) ⇒ ⊥) ∧
          (∀ #v2. (EphkRev( ~ex.2 ) @ #v2) ⇒ ⊥) ∧
          (∀ #v2. (EphkRev( ~ex.1 ) @ #v2) ⇒ ⊥)) )
    case case_1
    solve( PState2( ~ex, $A.1, $B.1, $C.1, tag(pmult(~ex.2, 'P')),
                    tag(pmult(~ex.1, 'P')), emXBXC
           ) ▶₀ #i )
      case Proto2
      solve( !Ltk( $A.1, ~ea ) ▶₁ #i )
        case Register_pk
        solve( !Pk( $B.1, pmult(~x, 'P') ) ▶₂ #i )
          case Register_pk
          solve( !Pk( $C.1, pmult(~x.1, 'P') ) ▶₃ #i )
            case Register_pk
            solve( !KU( kdf(<em('P', 'P')^(~ex.5*~ex.6*~ex.7), 
                             em('P', 'P')^(~ea*~x*~x.1), ($A.1++$B.1++$C.1), 
                             (tag(pmult(~ex.5, 'P'))++tag(pmult(~ex.6, 'P'))++tag(pmult(~ex.7, 'P')))
                            >)
                   ) @ #vk )
              case Reveal_sessk_case_001
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_002
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_003
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_004
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_005
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_006
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_007
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_008
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_009
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_010
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_011
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_012
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_013
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_014
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_015
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_016
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_017
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_018
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_019
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_020
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_021
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_022
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_023
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_024
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_025
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_026
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_027
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_028
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_029
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_030
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_031
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_032
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_033
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_034
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_035
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_036
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_037
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_038
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_039
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_040
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_041
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_042
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_043
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_044
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_045
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_046
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_047
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_048
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_049
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_050
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_051
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_052
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_053
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_054
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_055
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_056
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_057
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_058
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_059
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_060
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_061
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_062
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_063
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_064
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_065
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_066
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_067
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_068
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_069
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_070
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_071
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_072
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_073
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_074
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_075
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_076
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_077
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_078
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_079
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_080
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_081
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_082
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_083
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_084
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_085
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_086
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_087
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_088
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_089
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_090
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_091
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_092
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_093
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_094
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_095
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_096
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_097
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_098
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_099
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_100
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_101
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_102
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_103
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_104
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_105
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_106
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_107
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_108
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_109
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_110
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_111
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_112
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_113
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_114
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_115
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_116
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_117
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_118
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_119
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_120
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_121
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_122
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_123
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_124
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_125
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_126
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_127
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_128
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_129
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_130
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_131
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_132
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_133
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_134
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_135
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_136
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_137
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_138
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_139
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_140
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_141
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_142
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_143
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_144
              by contradiction /* from formulas */
            next
              case c_kdf
              solve( !KU( tag(pmult(~ex.5, 'P')) ) @ #vk.13 )
                case c_tag
                solve( !KU( tag(pmult(~ex.6, 'P')) ) @ #vk.14 )
                  case c_tag
                  solve( !KU( tag(pmult(~ex.7, 'P')) ) @ #vk.15 )
                    case c_tag
                    solve( !KU( em('P', 'P')^(~ex.5*~ex.6*~ex.7) ) @ #vk.4 )
                      case Proto1_case_1
                      solve( !KU( ~ex.9 ) @ #vk.21 )
                        case Reveal_ephk
                        solve( !KU( ~ex.10 ) @ #vk.22 )
                          case Reveal_ephk
                          solve( !KU( em('P', 'P')^(~ea*~x*~x.1) ) @ #vk.6 )
                            case Register_pk_case_1
                            solve( !KU( ~ea.2 ) @ #vk.31 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_2
                            solve( !KU( ~ea.1 ) @ #vk.31 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_3
                            solve( !KU( ~x.3 ) @ #vk.31 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_4
                            solve( !KU( ~ea.1 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_5
                            solve( !KU( ~ea.2 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_6
                            solve( !KU( ~x.4 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_7
                            solve( !KU( ~x.4 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_8
                            solve( !KU( ~x.3 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_9
                            solve( !KU( ~x.4 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case c_exp
                            solve( !KU( ~ea ) @ #vk.31 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    next
                      case Proto1_case_2
                      solve( !KU( ~ex.9 ) @ #vk.21 )
                        case Reveal_ephk
                        solve( !KU( ~ex.10 ) @ #vk.22 )
                          case Reveal_ephk
                          solve( !KU( em('P', 'P')^(~ea*~x*~x.1) ) @ #vk.6 )
                            case Register_pk_case_1
                            solve( !KU( ~ea.2 ) @ #vk.31 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_2
                            solve( !KU( ~ea.1 ) @ #vk.31 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_3
                            solve( !KU( ~x.3 ) @ #vk.31 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_4
                            solve( !KU( ~ea.1 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_5
                            solve( !KU( ~ea.2 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_6
                            solve( !KU( ~x.4 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_7
                            solve( !KU( ~x.4 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_8
                            solve( !KU( ~x.3 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_9
                            solve( !KU( ~x.4 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case c_exp
                            solve( !KU( ~ea ) @ #vk.31 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    next
                      case Proto1_case_3
                      solve( !KU( ~ex.9 ) @ #vk.21 )
                        case Reveal_ephk
                        solve( !KU( ~ex.10 ) @ #vk.22 )
                          case Reveal_ephk
                          solve( !KU( em('P', 'P')^(~ea*~x*~x.1) ) @ #vk.6 )
                            case Register_pk_case_1
                            solve( !KU( ~ea.2 ) @ #vk.31 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_2
                            solve( !KU( ~ea.1 ) @ #vk.31 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_3
                            solve( !KU( ~x.3 ) @ #vk.31 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_4
                            solve( !KU( ~ea.1 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_5
                            solve( !KU( ~ea.2 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_6
                            solve( !KU( ~x.4 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_7
                            solve( !KU( ~x.4 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_8
                            solve( !KU( ~x.3 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_pk_case_9
                            solve( !KU( ~x.4 ) @ #vk.29 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          next
                            case c_exp
                            solve( !KU( ~ea ) @ #vk.31 )
                              case Reveal_ltk
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    next
                      case Proto1_case_4
                      solve( !KU( ~ex.10 ) @ #vk.19 )
                        case Reveal_ephk
                        solve( !KU( em('P', 'P')^(~ea*~x*~x.1) ) @ #vk.6 )
                          case Register_pk_case_1
                          solve( !KU( ~ea.2 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_2
                          solve( !KU( ~ea.1 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_3
                          solve( !KU( ~x.3 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_4
                          solve( !KU( ~ea.1 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_5
                          solve( !KU( ~ea.2 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_6
                          solve( !KU( ~x.4 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_7
                          solve( !KU( ~x.4 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_8
                          solve( !KU( ~x.3 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_9
                          solve( !KU( ~x.4 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case c_exp
                          solve( !KU( ~ea ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    next
                      case Proto1_case_5
                      solve( !KU( ~ex.10 ) @ #vk.19 )
                        case Reveal_ephk
                        solve( !KU( em('P', 'P')^(~ea*~x*~x.1) ) @ #vk.6 )
                          case Register_pk_case_1
                          solve( !KU( ~ea.2 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_2
                          solve( !KU( ~ea.1 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_3
                          solve( !KU( ~x.3 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_4
                          solve( !KU( ~ea.1 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_5
                          solve( !KU( ~ea.2 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_6
                          solve( !KU( ~x.4 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_7
                          solve( !KU( ~x.4 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_8
                          solve( !KU( ~x.3 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_9
                          solve( !KU( ~x.4 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case c_exp
                          solve( !KU( ~ea ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    next
                      case Proto1_case_6
                      solve( !KU( ~ex.10 ) @ #vk.19 )
                        case Reveal_ephk
                        solve( !KU( em('P', 'P')^(~ea*~x*~x.1) ) @ #vk.6 )
                          case Register_pk_case_1
                          solve( !KU( ~ea.2 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_2
                          solve( !KU( ~ea.1 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_3
                          solve( !KU( ~x.3 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_4
                          solve( !KU( ~ea.1 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_5
                          solve( !KU( ~ea.2 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_6
                          solve( !KU( ~x.4 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_7
                          solve( !KU( ~x.4 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_8
                          solve( !KU( ~x.3 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_9
                          solve( !KU( ~x.4 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case c_exp
                          solve( !KU( ~ea ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    next
                      case Proto1_case_7
                      solve( !KU( ~x.3 ) @ #vk.19 )
                        case Reveal_ephk
                        solve( !KU( em('P', 'P')^(~ea*~x*~x.1) ) @ #vk.6 )
                          case Register_pk_case_1
                          solve( !KU( ~ea.2 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_2
                          solve( !KU( ~ea.1 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_3
                          solve( !KU( ~x.4 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_4
                          solve( !KU( ~ea.1 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_5
                          solve( !KU( ~ea.2 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_6
                          solve( !KU( ~x.5 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_7
                          solve( !KU( ~x.5 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_8
                          solve( !KU( ~x.4 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_9
                          solve( !KU( ~x.5 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case c_exp
                          solve( !KU( ~ea ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    next
                      case Proto1_case_8
                      solve( !KU( ~ex.10 ) @ #vk.19 )
                        case Reveal_ephk
                        solve( !KU( em('P', 'P')^(~ea*~x*~x.1) ) @ #vk.6 )
                          case Register_pk_case_1
                          solve( !KU( ~ea.2 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_2
                          solve( !KU( ~ea.1 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_3
                          solve( !KU( ~x.3 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_4
                          solve( !KU( ~ea.1 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_5
                          solve( !KU( ~ea.2 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_6
                          solve( !KU( ~x.4 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_7
                          solve( !KU( ~x.4 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_8
                          solve( !KU( ~x.3 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_9
                          solve( !KU( ~x.4 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case c_exp
                          solve( !KU( ~ea ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    next
                      case Proto1_case_9
                      solve( !KU( ~x.3 ) @ #vk.19 )
                        case Reveal_ephk
                        solve( !KU( em('P', 'P')^(~ea*~x*~x.1) ) @ #vk.6 )
                          case Register_pk_case_1
                          solve( !KU( ~ea.2 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_2
                          solve( !KU( ~ea.1 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_3
                          solve( !KU( ~x.4 ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_4
                          solve( !KU( ~ea.1 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_5
                          solve( !KU( ~ea.2 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_6
                          solve( !KU( ~x.5 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_7
                          solve( !KU( ~x.5 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_8
                          solve( !KU( ~x.4 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case Register_pk_case_9
                          solve( !KU( ~x.5 ) @ #vk.26 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        next
                          case c_exp
                          solve( !KU( ~ea ) @ #vk.28 )
                            case Reveal_ltk
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    next
                      case c_exp
                      solve( !KU( ~ex.5 ) @ #vk.21 )
                        case Reveal_ephk
                        solve( !KU( ~ex.6 ) @ #vk.22 )
                          case Reveal_ephk
                          solve( !KU( ~ex.7 ) @ #vk.23 )
                            case Reveal_ephk
                            solve( !KU( em('P', 'P')^(~ea*~x*~x.1) ) @ #vk.6 )
                              case Register_pk_case_1
                              solve( !KU( ~ea.2 ) @ #vk.29 )
                                case Reveal_ltk
                                by contradiction /* from formulas */
                              qed
                            next
                              case Register_pk_case_2
                              solve( !KU( ~ea.1 ) @ #vk.29 )
                                case Reveal_ltk
                                by contradiction /* from formulas */
                              qed
                            next
                              case Register_pk_case_3
                              solve( !KU( ~x.3 ) @ #vk.29 )
                                case Reveal_ltk
                                by contradiction /* from formulas */
                              qed
                            next
                              case Register_pk_case_4
                              solve( !KU( ~ea.1 ) @ #vk.27 )
                                case Reveal_ltk
                                by contradiction /* from formulas */
                              qed
                            next
                              case Register_pk_case_5
                              solve( !KU( ~ea.2 ) @ #vk.27 )
                                case Reveal_ltk
                                by contradiction /* from formulas */
                              qed
                            next
                              case Register_pk_case_6
                              solve( !KU( ~x.4 ) @ #vk.27 )
                                case Reveal_ltk
                                by contradiction /* from formulas */
                              qed
                            next
                              case Register_pk_case_7
                              solve( !KU( ~x.4 ) @ #vk.27 )
                                case Reveal_ltk
                                by contradiction /* from formulas */
                              qed
                            next
                              case Register_pk_case_8
                              solve( !KU( ~x.3 ) @ #vk.27 )
                                case Reveal_ltk
                                by contradiction /* from formulas */
                              qed
                            next
                              case Register_pk_case_9
                              solve( !KU( ~x.4 ) @ #vk.27 )
                                case Reveal_ltk
                                by contradiction /* from formulas */
                              qed
                            next
                              case c_exp
                              solve( !KU( ~ea ) @ #vk.29 )
                                case Reveal_ltk
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case case_2
    solve( PState2( ~ex, $A.1, $B.1, $C.1, tag(pmult(~ex.2, 'P')),
                    tag(pmult(~ex.1, 'P')), emXBXC
           ) ▶₀ #i )
      case Proto2
      solve( !Ltk( $A.1, ~ea ) ▶₁ #i )
        case Register_pk
        solve( !Pk( $B.1, pmult(~x, 'P') ) ▶₂ #i )
          case Register_pk
          solve( !Pk( $C.1, pmult(~x.1, 'P') ) ▶₃ #i )
            case Register_pk
            solve( !KU( kdf(<em('P', 'P')^(~ex.5*~ex.6*~ex.7), 
                             em('P', 'P')^(~ea*~x*~x.1), ($A.1++$B.1++$C.1), 
                             (tag(pmult(~ex.5, 'P'))++tag(pmult(~ex.6, 'P'))++tag(pmult(~ex.7, 'P')))
                            >)
                   ) @ #vk )
              case Reveal_sessk_case_001
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_002
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_003
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_004
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_005
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_006
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_007
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_008
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_009
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_010
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_011
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_012
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_013
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_014
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_015
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_016
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_017
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_018
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_019
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_020
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_021
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_022
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_023
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_024
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_025
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_026
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_027
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_028
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_029
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_030
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_031
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_032
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_033
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_034
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_035
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_036
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_037
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_038
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_039
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_040
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_041
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_042
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_043
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_044
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_045
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_046
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_047
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_048
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_049
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_050
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_051
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_052
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_053
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_054
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_055
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_056
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_057
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_058
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_059
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_060
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_061
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_062
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_063
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_064
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_065
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_066
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_067
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_068
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_069
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_070
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_071
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_072
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_073
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_074
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_075
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_076
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_077
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_078
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_079
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_080
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_081
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_082
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_083
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_084
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_085
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_086
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_087
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_088
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_089
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_090
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_091
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_092
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_093
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_094
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_095
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_096
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_097
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_098
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_099
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_100
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_101
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_102
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_103
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_104
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_105
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_106
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_107
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_108
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_109
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_110
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_111
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_112
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_113
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_114
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_115
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_116
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_117
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_118
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_119
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_120
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_121
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_122
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_123
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_124
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_125
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_126
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_127
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_128
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_129
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_130
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_131
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_132
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_133
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_134
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_135
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_136
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_137
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_138
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_139
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_140
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_141
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_142
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_143
              by contradiction /* from formulas */
            next
              case Reveal_sessk_case_144
              by contradiction /* from formulas */
            next
              case c_kdf
              solve( !KU( tag(pmult(~ex.5, 'P')) ) @ #vk.13 )
                case c_tag
                solve( !KU( tag(pmult(~ex.6, 'P')) ) @ #vk.14 )
                  case c_tag
                  solve( !KU( tag(pmult(~ex.7, 'P')) ) @ #vk.15 )
                    case c_tag
                    solve( !KU( em('P', 'P')^(~ex.5*~ex.6*~ex.7) ) @ #vk.4 )
                      case Proto1_case_1
                      solve( !KU( ~ex.9 ) @ #vk.21 )
                        case Reveal_ephk
                        by contradiction /* from formulas */
                      qed
                    next
                      case Proto1_case_2
                      solve( !KU( ~ex.9 ) @ #vk.21 )
                        case Reveal_ephk
                        by contradiction /* from formulas */
                      qed
                    next
                      case Proto1_case_3
                      solve( !KU( ~ex.9 ) @ #vk.21 )
                        case Reveal_ephk
                        by contradiction /* from formulas */
                      qed
                    next
                      case Proto1_case_4
                      solve( !KU( ~ex.10 ) @ #vk.19 )
                        case Reveal_ephk
                        by contradiction /* from formulas */
                      qed
                    next
                      case Proto1_case_5
                      solve( !KU( ~ex.10 ) @ #vk.19 )
                        case Reveal_ephk
                        by contradiction /* from formulas */
                      qed
                    next
                      case Proto1_case_6
                      solve( !KU( ~ex.10 ) @ #vk.19 )
                        case Reveal_ephk
                        by contradiction /* from formulas */
                      qed
                    next
                      case Proto1_case_7
                      solve( !KU( ~x.3 ) @ #vk.19 )
                        case Reveal_ephk
                        by contradiction /* from formulas */
                      qed
                    next
                      case Proto1_case_8
                      solve( !KU( ~ex.10 ) @ #vk.19 )
                        case Reveal_ephk
                        by contradiction /* from formulas */
                      qed
                    next
                      case Proto1_case_9
                      solve( !KU( ~x.3 ) @ #vk.19 )
                        case Reveal_ephk
                        by contradiction /* from formulas */
                      qed
                    next
                      case c_exp
                      solve( !KU( ~ex.5 ) @ #vk.21 )
                        case Reveal_ephk
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
next
  case case_2
  solve( PState2( ~ex, $A.1, $B.1, $C.1, tag(XB.1), tag(XC.1), emXBXC
         ) ▶₀ #i )
    case Proto2
    solve( !Ltk( $A.1, ~ea ) ▶₁ #i )
      case Register_pk
      solve( !Pk( $B.1, pmult(~x, 'P') ) ▶₂ #i )
        case Register_pk
        solve( !Pk( $C.1, pmult(~x.1, 'P') ) ▶₃ #i )
          case Register_pk
          solve( !KU( kdf(<z, em('P', 'P')^(~ea*~x*~x.1), ($A.1++$B.1++$C.1), 
                           (tag(XB.1)++tag(XC.1)++tag(pmult(~ex, 'P')))>)
                 ) @ #vk )
            case Reveal_sessk_case_001
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_002
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_003
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_004
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_005
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_006
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_007
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_008
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_009
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_010
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_011
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_012
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_013
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_014
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_015
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_016
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_017
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_018
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_019
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_020
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_021
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_022
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_023
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_024
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_025
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_026
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_027
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_028
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_029
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_030
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_031
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_032
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_033
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_034
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_035
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_036
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_037
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_038
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_039
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_040
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_041
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_042
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_043
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_044
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_045
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_046
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_047
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_048
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_049
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_050
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_051
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_052
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_053
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_054
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_055
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_056
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_057
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_058
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_059
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_060
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_061
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_062
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_063
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_064
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_065
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_066
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_067
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_068
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_069
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_070
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_071
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_072
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_073
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_074
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_075
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_076
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_077
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_078
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_079
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_080
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_081
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_082
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_083
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_084
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_085
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_086
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_087
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_088
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_089
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_090
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_091
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_092
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_093
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_094
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_095
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_096
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_097
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_098
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_099
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_100
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_101
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_102
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_103
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_104
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_105
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_106
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_107
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_108
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_109
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_110
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_111
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_112
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_113
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_114
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_115
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_116
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_117
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_118
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_119
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_120
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_121
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_122
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_123
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_124
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_125
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_126
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_127
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_128
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_129
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_130
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_131
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_132
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_133
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_134
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_135
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_136
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_137
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_138
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_139
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_140
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_141
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_142
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_143
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_144
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_145
            by contradiction /* from formulas */
          next
            case Reveal_sessk_case_146
            by contradiction /* from formulas */
          next
            case c_kdf
            solve( !KU( tag(pmult(~ex, 'P')) ) @ #vk.15 )
              case c_tag
              solve( !KU( em('P', 'P')^(~ea*~x*~x.1) ) @ #vk.6 )
                case Register_pk_case_1
                solve( !KU( ~ea.2 ) @ #vk.19 )
                  case Reveal_ltk
                  by contradiction /* from formulas */
                qed
              next
                case Register_pk_case_2
                solve( !KU( ~ea.1 ) @ #vk.19 )
                  case Reveal_ltk
                  by contradiction /* from formulas */
                qed
              next
                case Register_pk_case_3
                solve( !KU( ~x.3 ) @ #vk.19 )
                  case Reveal_ltk
                  by contradiction /* from formulas */
                qed
              next
                case Register_pk_case_4
                solve( !KU( ~ea.1 ) @ #vk.17 )
                  case Reveal_ltk
                  by contradiction /* from formulas */
                qed
              next
                case Register_pk_case_5
                solve( !KU( ~ea.2 ) @ #vk.17 )
                  case Reveal_ltk
                  by contradiction /* from formulas */
                qed
              next
                case Register_pk_case_6
                solve( !KU( ~x.4 ) @ #vk.17 )
                  case Reveal_ltk
                  by contradiction /* from formulas */
                qed
              next
                case Register_pk_case_7
                solve( !KU( ~x.4 ) @ #vk.17 )
                  case Reveal_ltk
                  by contradiction /* from formulas */
                qed
              next
                case Register_pk_case_8
                solve( !KU( ~x.3 ) @ #vk.17 )
                  case Reveal_ltk
                  by contradiction /* from formulas */
                qed
              next
                case Register_pk_case_9
                solve( !KU( ~x.4 ) @ #vk.17 )
                  case Reveal_ltk
                  by contradiction /* from formulas */
                qed
              next
                case c_exp
                solve( !KU( ~ea ) @ #vk.19 )
                  case Reveal_ltk
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed













/*
WARNING: the following wellformedness checks failed!

Message Derivation Checks
=========================

  The variables of the following rule(s) are not derivable from their premises, you may be performing unintended pattern matching.

Rule Reveal_sessk: 
Failed to derive Variable(s): sessKey

Rule Proto3: 
Failed to derive Variable(s): ~eb, ~ec, XB, XC
*/

/*
Generated from:
Tamarin version 1.11.0
Maude version 3.2.1
Git revision: d8e8266fc8aa702ff3c4d08608a7fbbe124eea65, branch: cyclic-squashed
Compiled at: 2024-11-27 09:37:37.786154 UTC
*/

end
/* Output

==============================================================================
summary of summaries:

analyzed: examples/ake/bilinear/TAK1.spthy

  output:          examples/ake/bilinear/TAK1.spthy.tmp
  processing time: 17.09s
  
  WARNING: 1 wellformedness check failed!
           The analysis results might be wrong!
  
  session_key_establish (exists-trace): verified (17 steps)
  Session_Key_Secrecy (all-traces): verified (727 steps)

==============================================================================
*/
