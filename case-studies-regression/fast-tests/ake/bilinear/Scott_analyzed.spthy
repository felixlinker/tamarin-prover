theory Scott begin

// Function signature and definition of the equational theory E

builtins: diffie-hellman, bilinear-pairing
functions: fst/1, hp/1, kdf/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2







section{* Scott: MTI-C0 like identity based key exchange protocol *}

rule (modulo E) KGC_Setup:
   [ Fr( ~msk ) ] --[ KGCSetup( ) ]-> [ !MSK( ~msk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KGC_request:
   [ !MSK( ~msk ) ] --> [ !LTK( $ID, pmult(~msk, hp($ID)) ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_ltk:
   [ !LTK( $ID, skID ) ] --[ LtkRev( $ID ) ]-> [ Out( skID ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_master_key:
   [ !MSK( ~msk ) ] --[ MskRev( ) ]-> [ Out( ~msk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_session_key:
   [ !Sessk( ~ey, sek ) ] --[ SesskRev( ~ey ) ]-> [ Out( sek ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Init_1:
   [ Fr( ~ex ), !LTK( $A, pmult(~s, hp($A)) ) ]
  -->
   [
   Init( ~ex, $A, $B, em(hp($B), pmult(~s, hp($A)))^~ex ),
   Out( em(hp($B), pmult(~s, hp($A)))^~ex )
   ]

  /*
  rule (modulo AC) Init_1:
     [ Fr( ~ex ), !LTK( $A, pmult(~s, hp($A)) ) ]
    -->
     [
     Init( ~ex, $A, $B, em(hp($A), hp($B))^(~ex*~s) ),
     Out( em(hp($A), hp($B))^(~ex*~s) )
     ]
  */

rule (modulo E) Init_2:
   [ Init( ~ex, $A, $B, X ), In( Y ) ]
  --[
  Accept( ~ex, $A, $B, kdf(<Y^~ex, $A, $B, X, Y>) ),
  Sid( ~ex, <'Init', $A, $B, X, Y> ), Match( ~ex, <'Resp', $B, $A, X, Y> ),
  NotNeutral( Y )
  ]->
   [ !Sessk( ~ex, kdf(<Y^~ex, $A, $B, X, Y>) ) ]

  /*
  rule (modulo AC) Init_2:
     [ Init( ~ex, $A, $B, X ), In( Y ) ]
    --[
    Accept( ~ex, $A, $B, kdf(<z, $A, $B, X, Y>) ),
    Sid( ~ex, <'Init', $A, $B, X, Y> ), Match( ~ex, <'Resp', $B, $A, X, Y> ),
    NotNeutral( Y )
    ]->
     [ !Sessk( ~ex, kdf(<z, $A, $B, X, Y>) ) ]
    variants (modulo AC)
    1. ~ex   = ~x.3
       Y     = x.5^inv(~x.3)
       z     = x.5
    
    2. Y     = DH_neutral
       z     = DH_neutral
    
    3. ~ex   = ~ex.3
       Y     = x.2^x.3
       z     = x.2^(~ex.3*x.3)
    
    4. ~ex   = ~ex.3
       Y     = Y.3
       z     = Y.3^~ex.3
    
    5. ~ex   = ~x.4
       Y     = x.6^(x.7*inv(~x.4))
       z     = x.6^x.7
    
    6. ~ex   = ~x.4
       Y     = x.6^inv((~x.4*x.7))
       z     = x.6^inv(x.7)
    
    7. ~ex   = ~x.5
       Y     = x.7^(x.8*inv((~x.5*x.9)))
       z     = x.7^(x.8*inv(x.9))
  */

rule (modulo E) Resp_1:
   [ Fr( ~ey ), !LTK( $B, pmult(~s, hp($B)) ), In( X ) ]
  --[
  Accept( ~ey, $B, $A,
          kdf(<X^~ey, $A, $B, X, em(hp($A), pmult(~s, hp($B)))^~ey>)
  ),
  Sid( ~ey, <'Resp', $B, $A, X, em(hp($A), pmult(~s, hp($B)))^~ey> ),
  Match( ~ey, <'Init', $A, $B, X, em(hp($A), pmult(~s, hp($B)))^~ey> ),
  NotNeutral( X )
  ]->
   [
   Out( em(hp($A), pmult(~s, hp($B)))^~ey ),
   !Sessk( ~ey, kdf(<X^~ey, $A, $B, X, em(hp($A), pmult(~s, hp($B)))^~ey>) )
   ]

  /*
  rule (modulo AC) Resp_1:
     [ Fr( ~ey ), !LTK( $B, pmult(~x, hp($B)) ), In( X ) ]
    --[
    Accept( ~ey, $B, $A, kdf(<z, $A, $B, X, em(hp($A), hp($B))^(~ey*~x)>) ),
    Sid( ~ey, <'Resp', $B, $A, X, em(hp($A), hp($B))^(~ey*~x)> ),
    Match( ~ey, <'Init', $A, $B, X, em(hp($A), hp($B))^(~ey*~x)> ),
    NotNeutral( X )
    ]->
     [
     Out( em(hp($A), hp($B))^(~ey*~x) ),
     !Sessk( ~ey, kdf(<z, $A, $B, X, em(hp($A), hp($B))^(~ey*~x)>) )
     ]
    variants (modulo AC)
    1. ~ey   = ~ey.3
       X     = X.3
       z     = X.3^~ey.3
    
    2. ~ey   = ~ey.3
       X     = x.14^x.15
       z     = x.14^(~ey.3*x.15)
    
    3. ~ey   = ~x.15
       X     = x.17^inv(~x.15)
       z     = x.17
    
    4. ~ey   = ~x.16
       X     = x.18^inv((~x.16*x.19))
       z     = x.18^inv(x.19)
    
    5. ~ey   = ~x.16
       X     = x.18^(x.19*inv(~x.16))
       z     = x.18^x.19
    
    6. ~ey   = ~x.17
       X     = x.19^(x.20*inv((~x.17*x.21)))
       z     = x.19^(x.20*inv(x.21))
    
    7. X     = DH_neutral
       z     = DH_neutral
  */

restriction notneutral:
  "∀ x #i. (NotNeutral( x ) @ #i) ⇒ (¬(x = DH_neutral))"
  // safety formula

lemma key_agreement_reachable:
  exists-trace
  "∃ #i #j A B SID t1 t2 k.
    (((Accept( t1, A, B, k ) @ #i) ∧ (Match( t1, SID ) @ #i)) ∧
     (Accept( t2, B, A, k ) @ #j)) ∧
    (Sid( t2, SID ) @ #j)"
/*
guarded formula characterizing all satisfying traces:
"∃ #i #j A B SID t1 t2 k.
  (Accept( t1, A, B, k ) @ #i) ∧
  (Match( t1, SID ) @ #i) ∧
  (Accept( t2, B, A, k ) @ #j) ∧
  (Sid( t2, SID ) @ #j)"
*/
simplify
solve( Accept( t1, A, B, k ) @ #i )
  case Init_2
  solve( Init( ~ex, $A.1, $B.1, X ) ▶₀ #i )
    case Init_1
    solve( Match( ~ex, SID ) @ #i )
      case Init_2
      solve( Accept( t2, $B.1, $A.1,
                     kdf(<z, $A.1, $B.1, em(hp($A.1), hp($B.1))^(~ex*~s), Y>)
             ) @ #j )
        case Resp_1
        solve( !LTK( $B.3, pmult(~x, hp($B.3)) ) ▶₁ #j )
          case KGC_request
          solve( Sid( ~ey.1,
                      <'Resp', $B.3, $A.3, em(hp($A.3), hp($B.3))^(~x*~ex.1), 
                       em(hp($A.3), hp($B.3))^(~x*~ey.1)>
                 ) @ #j )
            case Resp_1
            solve( !KU( em(hp($A.3), hp($B.3))^(~x*~ey.1) ) @ #vk )
              case Resp_1_case_1
              solve( !KU( em(hp($A.4), hp($B.4))^(~ex.1*~x.1) ) @ #vk.2 )
                case Init_1_case_1
                SOLVED // trace found
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma key_secrecy:
  all-traces
  "∀ #i1 #i2 test A B k.
    ((Accept( test, A, B, k ) @ #i1) ∧ (K( k ) @ #i2)) ⇒
    ((((∃ #i3. SesskRev( test ) @ #i3) ∨
       (∃ #i3 #i4.
         ((KGCSetup( ) @ #i3) ∧ (KGCSetup( ) @ #i4)) ∧ (¬(#i3 = #i4)))) ∨
      (∃ matching #i3 #i4 sid.
        ((Sid( matching, sid ) @ #i3) ∧ (Match( test, sid ) @ #i4)) ∧
        (∃ #i5. SesskRev( matching ) @ #i5))) ∨
     ((¬(∃ matching #i3 #i4 sid.
          (Sid( matching, sid ) @ #i3) ∧ (Match( test, sid ) @ #i4))) ∧
      (((∃ #i5. LtkRev( B ) @ #i5) ∨ (∃ #i3. LtkRev( A ) @ #i3)) ∨
       (∃ #i3. MskRev( ) @ #i3))))"
/*
guarded formula characterizing all counter-examples:
"∃ #i1 #i2 test A B k.
  (Accept( test, A, B, k ) @ #i1) ∧ (K( k ) @ #i2)
 ∧
  (∀ #i3. (SesskRev( test ) @ #i3) ⇒ ⊥) ∧
  (∀ #i3 #i4. (KGCSetup( ) @ #i3) ∧ (KGCSetup( ) @ #i4) ⇒ #i3 = #i4) ∧
  (∀ matching #i3 #i4 sid.
    (Sid( matching, sid ) @ #i3) ∧ (Match( test, sid ) @ #i4)
   ⇒
    ∀ #i5. (SesskRev( matching ) @ #i5) ⇒ ⊥) ∧
  (((∃ matching #i3 #i4 sid.
      (Sid( matching, sid ) @ #i3) ∧ (Match( test, sid ) @ #i4)) ∨
    ((∀ #i5. (LtkRev( B ) @ #i5) ⇒ ⊥) ∧
     (∀ #i3. (LtkRev( A ) @ #i3) ⇒ ⊥) ∧
     (∀ #i3. (MskRev( ) @ #i3) ⇒ ⊥))))"
*/
simplify
solve( (∃ matching #i3 #i4 sid.
         (Sid( matching, sid ) @ #i3) ∧ (Match( test, sid ) @ #i4))  ∥
       ((∀ #i5. (LtkRev( B ) @ #i5) ⇒ ⊥) ∧
        (∀ #i3. (LtkRev( A ) @ #i3) ⇒ ⊥) ∧
        (∀ #i3. (MskRev( ) @ #i3) ⇒ ⊥)) )
  case case_1
  solve( Accept( test, A, B, x ) @ #i1 )
    case Init_2
    solve( Init( ~ex, $A.1, $B.1, X ) ▶₀ #i1 )
      case Init_1
      solve( Sid( matching, sid ) @ #i3 )
        case Init_2
        solve( Init( ~ex.1, $A.2, $B.2, X.1 ) ▶₀ #i3 )
          case Init_1
          by solve( Match( ~ex,
                           <'Init', $A.2, $B.2, em(hp($A.2), hp($B.2))^(~ex.1*~s.1), Y.1>
                    ) @ #i4 )
        qed
      next
        case Resp_1
        solve( !LTK( $B.2, pmult(~x.1, hp($B.2)) ) ▶₁ #i3 )
          case KGC_request
          solve( Match( ~ex,
                        <'Resp', $B.2, $A.2, X.1, em(hp($A.2), hp($B.2))^(~ey*~x.1)>
                 ) @ #i4 )
            case Init_2
            solve( Init( ~ex.2, $A.4, $B.4, X.2 ) ▶₀ #i4 )
              case Init_1
              solve( !KU( kdf(<em(hp($A.5), hp($B.5))^(~ey.2*~s.2*~ex.3), $A.5, $B.5, 
                               em(hp($A.5), hp($B.5))^(~s.2*~ex.3), em(hp($A.5), hp($B.5))^(~ey.2*~s.2)
                              >)
                     ) @ #vk )
                case Reveal_session_key_case_1
                by contradiction /* from formulas */
              next
                case Reveal_session_key_case_2
                by contradiction /* from formulas */
              next
                case c_kdf
                solve( !KU( em(hp($A.5), hp($B.5))^(~ey.2*~s.2*~ex.3) ) @ #vk.5 )
                  case Init_1_case_1
                  by solve( !KU( ~ey.3 ) @ #vk.13 )
                next
                  case Init_1_case_2
                  by solve( !KU( ~ey.3 ) @ #vk.13 )
                next
                  case Init_1_case_3
                  by solve( !KU( ~ex.4 ) @ #vk.20 )
                next
                  case Init_1_case_4
                  by solve( !KU( ~ex.4 ) @ #vk.20 )
                next
                  case Init_1_case_5
                  solve( !KU( ~s.3 ) @ #vk.28 )
                    case Reveal_master_key
                    by solve( !KU( ~ey.3 ) @ #vk.27 )
                  qed
                next
                  case Init_1_case_6
                  solve( !KU( ~s.3 ) @ #vk.28 )
                    case Reveal_master_key
                    by solve( !KU( ~ey.3 ) @ #vk.27 )
                  qed
                next
                  case Resp_1_case_1
                  by solve( !KU( ~ex.4 ) @ #vk.14 )
                next
                  case Resp_1_case_2
                  by solve( !KU( ~ex.4 ) @ #vk.14 )
                next
                  case Resp_1_case_3
                  by solve( !KU( ~ey.3 ) @ #vk.21 )
                next
                  case Resp_1_case_4
                  by solve( !KU( ~ey.3 ) @ #vk.21 )
                next
                  case Resp_1_case_5
                  solve( !KU( ~x.3 ) @ #vk.28 )
                    case Reveal_master_key
                    by solve( !KU( ~ex.4 ) @ #vk.29 )
                  qed
                next
                  case Resp_1_case_6
                  solve( !KU( ~x.3 ) @ #vk.28 )
                    case Reveal_master_key
                    by solve( !KU( ~ex.4 ) @ #vk.29 )
                  qed
                next
                  case Reveal_ltk_case_1
                  by solve( !KU( ~ey.3 ) @ #vk.15 )
                next
                  case Reveal_ltk_case_2
                  by solve( !KU( ~ey.3 ) @ #vk.15 )
                next
                  case c_exp
                  by solve( !KU( ~ey.2 ) @ #vk.15 )
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case Resp_1
    solve( !LTK( $B.1, pmult(~x.1, hp($B.1)) ) ▶₁ #i1 )
      case KGC_request
      solve( Sid( matching, sid ) @ #i3 )
        case Init_2
        solve( Init( ~ex, $A.2, $B.2, X.1 ) ▶₀ #i3 )
          case Init_1
          solve( Match( ~ey,
                        <'Init', $A.2, $B.2, em(hp($A.2), hp($B.2))^(~ex*~s), Y>
                 ) @ #i4 )
            case Resp_1
            solve( !KU( kdf(<em(hp($A.5), hp($B.5))^(~ex.2*~ey.3*~x.5), $A.5, $B.5, 
                             em(hp($A.5), hp($B.5))^(~ex.2*~x.5), em(hp($A.5), hp($B.5))^(~ey.3*~x.5)
                            >)
                   ) @ #vk )
              case Reveal_session_key_case_1
              by contradiction /* from formulas */
            next
              case Reveal_session_key_case_2
              by contradiction /* from formulas */
            next
              case c_kdf
              solve( !KU( em(hp($A.5), hp($B.5))^(~ex.2*~ey.3*~x.5) ) @ #vk.5 )
                case Init_1_case_1
                by solve( !KU( ~ey.4 ) @ #vk.13 )
              next
                case Init_1_case_2
                by solve( !KU( ~ey.4 ) @ #vk.13 )
              next
                case Init_1_case_3
                by solve( !KU( ~ex.3 ) @ #vk.20 )
              next
                case Init_1_case_4
                by solve( !KU( ~ex.3 ) @ #vk.20 )
              next
                case Init_1_case_5
                solve( !KU( ~s.2 ) @ #vk.27 )
                  case Reveal_master_key
                  by solve( !KU( ~ey.4 ) @ #vk.28 )
                qed
              next
                case Init_1_case_6
                solve( !KU( ~s.2 ) @ #vk.27 )
                  case Reveal_master_key
                  by solve( !KU( ~ey.4 ) @ #vk.28 )
                qed
              next
                case Resp_1_case_1
                by solve( !KU( ~ex.3 ) @ #vk.14 )
              next
                case Resp_1_case_2
                by solve( !KU( ~ex.3 ) @ #vk.14 )
              next
                case Resp_1_case_3
                by solve( !KU( ~ey.4 ) @ #vk.21 )
              next
                case Resp_1_case_4
                by solve( !KU( ~ey.4 ) @ #vk.21 )
              next
                case Resp_1_case_5
                solve( !KU( ~x.6 ) @ #vk.29 )
                  case Reveal_master_key
                  by solve( !KU( ~ex.3 ) @ #vk.28 )
                qed
              next
                case Resp_1_case_6
                solve( !KU( ~x.6 ) @ #vk.29 )
                  case Reveal_master_key
                  by solve( !KU( ~ex.3 ) @ #vk.28 )
                qed
              next
                case Reveal_ltk_case_1
                by solve( !KU( ~ex.3 ) @ #vk.15 )
              next
                case Reveal_ltk_case_2
                by solve( !KU( ~ex.3 ) @ #vk.15 )
              next
                case c_exp
                by solve( !KU( ~ex.2 ) @ #vk.15 )
              qed
            qed
          qed
        qed
      next
        case Resp_1
        solve( !LTK( $B.2, pmult(~x.2, hp($B.2)) ) ▶₁ #i3 )
          case KGC_request
          solve( Match( ~ey,
                        <'Resp', $B.2, $A.2, X.1, em(hp($A.2), hp($B.2))^(~ey.1*~x.2)>
                 ) @ #i4 )
            case Init_2
            by solve( Init( ~ex.1, $A.4, $B.4, X.2 ) ▶₀ #i4 )
          qed
        qed
      qed
    qed
  qed
next
  case case_2
  solve( Accept( test, A, B, x ) @ #i1 )
    case Init_2
    solve( Init( ~ex, $A.1, $B.1, X ) ▶₀ #i1 )
      case Init_1
      solve( !KU( kdf(<z, $A.1, $B.1, em(hp($A.1), hp($B.1))^(~ex*~s), Y>)
             ) @ #vk )
        case Reveal_session_key_case_1
        by contradiction /* from formulas */
      next
        case Reveal_session_key_case_2
        by contradiction /* from formulas */
      next
        case c_kdf
        solve( splitEqs(0) )
          case split_case_1
          solve( !KU( Y.1^~ex.1 ) @ #vk.3 )
            case Init_1
            solve( !KU( ~s.1 ) @ #vk.12 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case c_exp
            by solve( !KU( ~ex.1 ) @ #vk.12 )
          qed
        next
          case split_case_2
          solve( !KU( x.1^(~ex.1*x.2) ) @ #vk.3 )
            case Init_1_case_01
            solve( !KU( em(hp($A.2), hp($B.2))^~s.1 ) @ #vk.10 )
              case Init_1_case_1
              by solve( !KU( ~ex.3 ) @ #vk.12 )
            next
              case Init_1_case_2
              by solve( !KU( ~ex.3 ) @ #vk.12 )
            next
              case Resp_1_case_1
              by solve( !KU( ~ey ) @ #vk.13 )
            next
              case Resp_1_case_2
              by solve( !KU( ~ey ) @ #vk.13 )
            next
              case Reveal_ltk_case_1
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_2
              by contradiction /* from formulas */
            next
              case c_exp
              solve( !KU( ~s.1 ) @ #vk.12 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            qed
          next
            case Init_1_case_02
            by solve( !KU( ~ex.3 ) @ #vk.11 )
          next
            case Init_1_case_03
            solve( !KU( em(hp($A.2), hp($B.2))^(~s.1*x.3) ) @ #vk.10 )
              case Init_1_case_01
              by solve( !KU( ~ex.3 ) @ #vk.11 )
            next
              case Init_1_case_02
              by solve( !KU( ~ex.3 ) @ #vk.11 )
            next
              case Init_1_case_03
              solve( !KU( ~s.2 ) @ #vk.13 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_04
              solve( !KU( ~s.2 ) @ #vk.13 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_05
              by solve( !KU( ~ex.3 ) @ #vk.13 )
            next
              case Init_1_case_06
              by solve( !KU( ~ex.3 ) @ #vk.13 )
            next
              case Init_1_case_07
              solve( !KU( ~s.2 ) @ #vk.18 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_08
              solve( !KU( ~s.2 ) @ #vk.18 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_09
              solve( !KU( ~s.2 ) @ #vk.19 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_10
              by solve( !KU( ~ex.3 ) @ #vk.27 )
            next
              case Init_1_case_11
              solve( !KU( ~s.2 ) @ #vk.19 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_12
              by solve( !KU( ~ex.3 ) @ #vk.27 )
            next
              case Init_1_case_13
              by solve( !KU( ~ex.3 ) @ #vk.18 )
            next
              case Init_1_case_14
              by solve( !KU( ~ex.3 ) @ #vk.18 )
            next
              case Init_1_case_15
              solve( !KU( ~s.2 ) @ #vk.28 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_16
              solve( !KU( ~s.2 ) @ #vk.28 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_17
              by solve( !KU( ~ex.3 ) @ #vk.16 )
            next
              case Init_1_case_18
              by solve( !KU( ~ex.3 ) @ #vk.16 )
            next
              case Init_1_case_19
              solve( !KU( ~s.2 ) @ #vk.28 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_20
              by solve( !KU( ~ex.3 ) @ #vk.36 )
            next
              case Init_1_case_21
              solve( !KU( ~s.2 ) @ #vk.28 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_22
              by solve( !KU( ~ex.3 ) @ #vk.36 )
            next
              case Init_1_case_23
              by solve( !KU( ~ex.3 ) @ #vk.23 )
            next
              case Init_1_case_24
              by solve( !KU( ~ex.3 ) @ #vk.23 )
            next
              case Init_1_case_25
              solve( !KU( ~s.2 ) @ #vk.31 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_26
              solve( !KU( ~s.2 ) @ #vk.31 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_27
              solve( !KU( ~s.2 ) @ #vk.38 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_28
              solve( !KU( ~s.2 ) @ #vk.38 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_01
              by solve( !KU( ~ey ) @ #vk.11 )
            next
              case Resp_1_case_02
              by solve( !KU( ~ey ) @ #vk.11 )
            next
              case Resp_1_case_03
              solve( !KU( ~x.4 ) @ #vk.15 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_04
              solve( !KU( ~x.4 ) @ #vk.15 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_05
              by solve( !KU( ~ey ) @ #vk.14 )
            next
              case Resp_1_case_06
              by solve( !KU( ~ey ) @ #vk.14 )
            next
              case Resp_1_case_07
              solve( !KU( ~x.4 ) @ #vk.19 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_08
              solve( !KU( ~x.4 ) @ #vk.19 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_09
              solve( !KU( ~x.4 ) @ #vk.20 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_10
              by solve( !KU( ~ey ) @ #vk.28 )
            next
              case Resp_1_case_11
              solve( !KU( ~x.4 ) @ #vk.20 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_12
              by solve( !KU( ~ey ) @ #vk.28 )
            next
              case Resp_1_case_13
              by solve( !KU( ~ey ) @ #vk.19 )
            next
              case Resp_1_case_14
              by solve( !KU( ~ey ) @ #vk.19 )
            next
              case Resp_1_case_15
              solve( !KU( ~x.4 ) @ #vk.29 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_16
              solve( !KU( ~x.4 ) @ #vk.29 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_17
              by solve( !KU( ~ey ) @ #vk.17 )
            next
              case Resp_1_case_18
              by solve( !KU( ~ey ) @ #vk.17 )
            next
              case Resp_1_case_19
              solve( !KU( ~x.4 ) @ #vk.29 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_20
              by solve( !KU( ~ey ) @ #vk.37 )
            next
              case Resp_1_case_21
              solve( !KU( ~x.4 ) @ #vk.29 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_22
              by solve( !KU( ~ey ) @ #vk.37 )
            next
              case Resp_1_case_23
              by solve( !KU( ~ey ) @ #vk.24 )
            next
              case Resp_1_case_24
              by solve( !KU( ~ey ) @ #vk.24 )
            next
              case Resp_1_case_25
              solve( !KU( ~x.4 ) @ #vk.32 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_26
              solve( !KU( ~x.4 ) @ #vk.32 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_27
              solve( !KU( ~x.4 ) @ #vk.39 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_28
              solve( !KU( ~x.4 ) @ #vk.39 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Reveal_ltk_case_01
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_02
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_03
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_04
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_05
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_06
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_07
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_08
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_09
              by contradiction /* non-normal bilinear pairing rule instance */
            next
              case Reveal_ltk_case_10
              by contradiction /* non-normal bilinear pairing rule instance */
            next
              case Reveal_ltk_case_11
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_12
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_13
              by contradiction /* non-normal bilinear pairing rule instance */
            next
              case Reveal_ltk_case_14
              by contradiction /* non-normal bilinear pairing rule instance */
            next
              case c_exp
              solve( !KU( ~s.1 ) @ #vk.14 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            qed
          next
            case Init_1_case_04
            by solve( !KU( ~ex.3 ) @ #vk.12 )
          next
            case Init_1_case_05
            by solve( !KU( ~ex.3 ) @ #vk.15 )
          next
            case Init_1_case_06
            by solve( !KU( ~ex.2 ) @ #vk.18 )
          next
            case Init_1_case_07
            by solve( !KU( ~ex.2 ) @ #vk.15 )
          next
            case Init_1_case_08
            solve( !KU( ~s.1 ) @ #vk.18 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_09
            solve( !KU( ~s.1 ) @ #vk.17 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_10
            solve( !KU( ~s.1 ) @ #vk.15 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_11
            by solve( !KU( ~ex.3 ) @ #vk.17 )
          next
            case Init_1_case_12
            by solve( !KU( ~ex.2 ) @ #vk.25 )
          next
            case Init_1_case_13
            by solve( !KU( ~ex.3 ) @ #vk.17 )
          next
            case Init_1_case_14
            solve( !KU( ~s.1 ) @ #vk.25 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_15
            solve( !KU( ~s.1 ) @ #vk.22 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_01
            by solve( !KU( ~ex.2 ) @ #vk.12 )
          next
            case Resp_1_case_02
            by solve( !KU( ~ex.2 ) @ #vk.13 )
          next
            case Resp_1_case_03
            by solve( !KU( ~ex.2 ) @ #vk.16 )
          next
            case Resp_1_case_04
            by solve( !KU( ~ey ) @ #vk.19 )
          next
            case Resp_1_case_05
            by solve( !KU( ~ex.2 ) @ #vk.16 )
          next
            case Resp_1_case_06
            solve( !KU( ~x.3 ) @ #vk.19 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_07
            by solve( !KU( ~ex.2 ) @ #vk.18 )
          next
            case Resp_1_case_08
            by solve( !KU( ~ey ) @ #vk.26 )
          next
            case Resp_1_case_09
            by solve( !KU( ~ex.2 ) @ #vk.18 )
          next
            case Resp_1_case_10
            solve( !KU( ~x.3 ) @ #vk.26 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Reveal_ltk_case_1
            by solve( !KU( ~ex.2 ) @ #vk.12 )
          next
            case Reveal_ltk_case_2
            by solve( !KU( ~ex.2 ) @ #vk.13 )
          next
            case Reveal_ltk_case_3
            by solve( !KU( ~ex.2 ) @ #vk.11 )
          next
            case Reveal_ltk_case_4
            by solve( !KU( ~ex.2 ) @ #vk.12 )
          next
            case c_exp
            by solve( !KU( ~ex.1 ) @ #vk.13 )
          qed
        next
          case split_case_3
          solve( !KU( z.1^inv(~ex.1) ) @ #vk.10 )
            case c_exp
            by solve( !KU( ~ex.1 ) @ #vk.13 )
          qed
        next
          case split_case_4
          solve( !KU( x.1^inv((~ex.1*x.2)) ) @ #vk.10 )
            case c_exp
            by solve( !KU( ~ex.1 ) @ #vk.14 )
          qed
        next
          case split_case_5
          solve( !KU( x.1^(x.2*inv(~ex.1)) ) @ #vk.10 )
            case Init_1_case_01
            by solve( !KU( ~ex.3 ) @ #vk.12 )
          next
            case Init_1_case_02
            by solve( !KU( ~ex.3 ) @ #vk.14 )
          next
            case Init_1_case_03
            by solve( !KU( ~ex.2 ) @ #vk.16 )
          next
            case Init_1_case_04
            by solve( !KU( ~ex.2 ) @ #vk.17 )
          next
            case Init_1_case_05
            solve( !KU( ~s.1 ) @ #vk.16 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_06
            solve( !KU( ~s.1 ) @ #vk.17 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_07
            by solve( !KU( ~ex.2 ) @ #vk.15 )
          next
            case Init_1_case_08
            solve( !KU( ~s.1 ) @ #vk.15 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_09
            by solve( !KU( ~ex.2 ) @ #vk.22 )
          next
            case Init_1_case_10
            solve( !KU( ~s.1 ) @ #vk.22 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_01
            by solve( !KU( ~ex.2 ) @ #vk.13 )
          next
            case Resp_1_case_02
            by solve( !KU( ~ex.2 ) @ #vk.15 )
          next
            case Resp_1_case_03
            by solve( !KU( ~ey ) @ #vk.17 )
          next
            case Resp_1_case_04
            by solve( !KU( ~ey ) @ #vk.18 )
          next
            case Resp_1_case_05
            solve( !KU( ~x.3 ) @ #vk.19 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_06
            solve( !KU( ~x.3 ) @ #vk.20 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_07
            by solve( !KU( ~ey ) @ #vk.16 )
          next
            case Resp_1_case_08
            by solve( !KU( ~ex.2 ) @ #vk.16 )
          next
            case Resp_1_case_09
            by solve( !KU( ~ey ) @ #vk.23 )
          next
            case Resp_1_case_10
            by solve( !KU( ~ex.2 ) @ #vk.23 )
          next
            case Reveal_ltk_case_1
            by solve( !KU( ~ex.2 ) @ #vk.13 )
          next
            case Reveal_ltk_case_2
            by solve( !KU( ~ex.2 ) @ #vk.15 )
          next
            case Reveal_ltk_case_3
            by solve( !KU( ~ex.2 ) @ #vk.12 )
          next
            case Reveal_ltk_case_4
            by solve( !KU( ~ex.2 ) @ #vk.14 )
          next
            case c_exp
            by solve( !KU( ~ex.1 ) @ #vk.15 )
          qed
        next
          case split_case_6
          solve( !KU( x.1^(x.2*inv((~ex.1*x.3))) ) @ #vk.10 )
            case Init_1_case_01
            by solve( !KU( ~ex.3 ) @ #vk.13 )
          next
            case Init_1_case_02
            by solve( !KU( ~ex.3 ) @ #vk.15 )
          next
            case Init_1_case_03
            by solve( !KU( ~ex.2 ) @ #vk.16 )
          next
            case Init_1_case_04
            by solve( !KU( ~ex.2 ) @ #vk.17 )
          next
            case Init_1_case_05
            solve( !KU( ~s.1 ) @ #vk.16 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_06
            solve( !KU( ~s.1 ) @ #vk.17 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_07
            by solve( !KU( ~ex.2 ) @ #vk.15 )
          next
            case Init_1_case_08
            solve( !KU( ~s.1 ) @ #vk.15 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_09
            by solve( !KU( ~ex.2 ) @ #vk.23 )
          next
            case Init_1_case_10
            solve( !KU( ~s.1 ) @ #vk.23 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_01
            by solve( !KU( ~ex.2 ) @ #vk.14 )
          next
            case Resp_1_case_02
            by solve( !KU( ~ex.2 ) @ #vk.16 )
          next
            case Resp_1_case_03
            by solve( !KU( ~ey ) @ #vk.17 )
          next
            case Resp_1_case_04
            by solve( !KU( ~ey ) @ #vk.18 )
          next
            case Resp_1_case_05
            solve( !KU( ~x.4 ) @ #vk.17 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_06
            solve( !KU( ~x.4 ) @ #vk.18 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_07
            by solve( !KU( ~ey ) @ #vk.16 )
          next
            case Resp_1_case_08
            solve( !KU( ~x.4 ) @ #vk.17 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_09
            by solve( !KU( ~ey ) @ #vk.24 )
          next
            case Resp_1_case_10
            solve( !KU( ~x.4 ) @ #vk.25 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Reveal_ltk_case_1
            by solve( !KU( ~ex.2 ) @ #vk.14 )
          next
            case Reveal_ltk_case_2
            by solve( !KU( ~ex.2 ) @ #vk.16 )
          next
            case Reveal_ltk_case_3
            by solve( !KU( ~ex.2 ) @ #vk.13 )
          next
            case Reveal_ltk_case_4
            by solve( !KU( ~ex.2 ) @ #vk.15 )
          next
            case c_exp
            by solve( !KU( ~ex.1 ) @ #vk.16 )
          qed
        next
          case split_case_7
          by contradiction /* from formulas */
        qed
      qed
    qed
  next
    case Resp_1
    solve( !LTK( $B.1, pmult(~x.1, hp($B.1)) ) ▶₁ #i1 )
      case KGC_request
      solve( !KU( kdf(<z, $A.1, $B.1, X, em(hp($A.1), hp($B.1))^(~ey*~x.1)>)
             ) @ #vk )
        case Reveal_session_key_case_1
        by contradiction /* from formulas */
      next
        case Reveal_session_key_case_2
        by contradiction /* from formulas */
      next
        case c_kdf
        solve( splitEqs(0) )
          case split_case_1
          solve( !KU( X.1^~ey.1 ) @ #vk.3 )
            case Resp_1
            solve( !KU( ~x.2 ) @ #vk.13 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case c_exp
            by solve( !KU( ~ey.1 ) @ #vk.12 )
          qed
        next
          case split_case_2
          solve( !KU( x.2^(~ey.1*x.3) ) @ #vk.3 )
            case Init_1_case_01
            by solve( !KU( ~ey.2 ) @ #vk.11 )
          next
            case Init_1_case_02
            by solve( !KU( ~ey.2 ) @ #vk.12 )
          next
            case Init_1_case_03
            by solve( !KU( ~ey.2 ) @ #vk.15 )
          next
            case Init_1_case_04
            by solve( !KU( ~ex ) @ #vk.18 )
          next
            case Init_1_case_05
            by solve( !KU( ~ey.2 ) @ #vk.15 )
          next
            case Init_1_case_06
            solve( !KU( ~s ) @ #vk.18 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_07
            by solve( !KU( ~ey.2 ) @ #vk.17 )
          next
            case Init_1_case_08
            by solve( !KU( ~ex ) @ #vk.25 )
          next
            case Init_1_case_09
            by solve( !KU( ~ey.2 ) @ #vk.17 )
          next
            case Init_1_case_10
            solve( !KU( ~s ) @ #vk.25 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_01
            solve( !KU( em(hp($A.2), hp($B.2))^~x.4 ) @ #vk.11 )
              case Init_1_case_1
              by solve( !KU( ~ex ) @ #vk.13 )
            next
              case Init_1_case_2
              by solve( !KU( ~ex ) @ #vk.13 )
            next
              case Resp_1_case_1
              by solve( !KU( ~ey.3 ) @ #vk.14 )
            next
              case Resp_1_case_2
              by solve( !KU( ~ey.3 ) @ #vk.14 )
            next
              case Reveal_ltk_case_1
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_2
              by contradiction /* from formulas */
            next
              case c_exp
              solve( !KU( ~x.4 ) @ #vk.13 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            qed
          next
            case Resp_1_case_02
            by solve( !KU( ~ey.3 ) @ #vk.12 )
          next
            case Resp_1_case_03
            by solve( !KU( ~ey.3 ) @ #vk.13 )
          next
            case Resp_1_case_04
            solve( !KU( em(hp($A.2), hp($B.2))^(~x.4*x.5) ) @ #vk.11 )
              case Init_1_case_01
              by solve( !KU( ~ex ) @ #vk.12 )
            next
              case Init_1_case_02
              by solve( !KU( ~ex ) @ #vk.12 )
            next
              case Init_1_case_03
              solve( !KU( ~s ) @ #vk.15 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_04
              by solve( !KU( ~ex ) @ #vk.14 )
            next
              case Init_1_case_05
              solve( !KU( ~s ) @ #vk.15 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_06
              by solve( !KU( ~ex ) @ #vk.14 )
            next
              case Init_1_case_07
              solve( !KU( ~s ) @ #vk.19 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_08
              solve( !KU( ~s ) @ #vk.19 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_09
              solve( !KU( ~s ) @ #vk.20 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_10
              by solve( !KU( ~ex ) @ #vk.19 )
            next
              case Init_1_case_11
              solve( !KU( ~s ) @ #vk.20 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_12
              by solve( !KU( ~ex ) @ #vk.19 )
            next
              case Init_1_case_13
              by solve( !KU( ~ex ) @ #vk.28 )
            next
              case Init_1_case_14
              by solve( !KU( ~ex ) @ #vk.28 )
            next
              case Init_1_case_15
              solve( !KU( ~s ) @ #vk.29 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_16
              solve( !KU( ~s ) @ #vk.29 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_17
              by solve( !KU( ~ex ) @ #vk.17 )
            next
              case Init_1_case_18
              by solve( !KU( ~ex ) @ #vk.17 )
            next
              case Init_1_case_19
              solve( !KU( ~s ) @ #vk.29 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_20
              by solve( !KU( ~ex ) @ #vk.24 )
            next
              case Init_1_case_21
              solve( !KU( ~s ) @ #vk.29 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_22
              by solve( !KU( ~ex ) @ #vk.24 )
            next
              case Init_1_case_23
              by solve( !KU( ~ex ) @ #vk.37 )
            next
              case Init_1_case_24
              by solve( !KU( ~ex ) @ #vk.37 )
            next
              case Init_1_case_25
              solve( !KU( ~s ) @ #vk.32 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_26
              solve( !KU( ~s ) @ #vk.32 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_27
              solve( !KU( ~s ) @ #vk.39 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Init_1_case_28
              solve( !KU( ~s ) @ #vk.39 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_01
              by solve( !KU( ~ey.3 ) @ #vk.12 )
            next
              case Resp_1_case_02
              by solve( !KU( ~ey.3 ) @ #vk.12 )
            next
              case Resp_1_case_03
              solve( !KU( ~x.6 ) @ #vk.16 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_04
              by solve( !KU( ~ey.3 ) @ #vk.15 )
            next
              case Resp_1_case_05
              solve( !KU( ~x.6 ) @ #vk.16 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_06
              by solve( !KU( ~ey.3 ) @ #vk.15 )
            next
              case Resp_1_case_07
              solve( !KU( ~x.6 ) @ #vk.20 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_08
              solve( !KU( ~x.6 ) @ #vk.20 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_09
              solve( !KU( ~x.6 ) @ #vk.21 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_10
              by solve( !KU( ~ey.3 ) @ #vk.29 )
            next
              case Resp_1_case_11
              by solve( !KU( ~ey.3 ) @ #vk.20 )
            next
              case Resp_1_case_12
              solve( !KU( ~x.6 ) @ #vk.21 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_13
              by solve( !KU( ~ey.3 ) @ #vk.29 )
            next
              case Resp_1_case_14
              by solve( !KU( ~ey.3 ) @ #vk.20 )
            next
              case Resp_1_case_15
              solve( !KU( ~x.6 ) @ #vk.30 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_16
              solve( !KU( ~x.6 ) @ #vk.30 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_17
              by solve( !KU( ~ey.3 ) @ #vk.18 )
            next
              case Resp_1_case_18
              by solve( !KU( ~ey.3 ) @ #vk.18 )
            next
              case Resp_1_case_19
              solve( !KU( ~x.6 ) @ #vk.30 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_20
              by solve( !KU( ~ey.3 ) @ #vk.38 )
            next
              case Resp_1_case_21
              by solve( !KU( ~ey.3 ) @ #vk.25 )
            next
              case Resp_1_case_22
              solve( !KU( ~x.6 ) @ #vk.30 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_23
              by solve( !KU( ~ey.3 ) @ #vk.38 )
            next
              case Resp_1_case_24
              by solve( !KU( ~ey.3 ) @ #vk.25 )
            next
              case Resp_1_case_25
              solve( !KU( ~x.6 ) @ #vk.33 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_26
              solve( !KU( ~x.6 ) @ #vk.33 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_27
              solve( !KU( ~x.6 ) @ #vk.40 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Resp_1_case_28
              solve( !KU( ~x.6 ) @ #vk.40 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            next
              case Reveal_ltk_case_01
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_02
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_03
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_04
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_05
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_06
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_07
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_08
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_09
              by contradiction /* non-normal bilinear pairing rule instance */
            next
              case Reveal_ltk_case_10
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_11
              by contradiction /* non-normal bilinear pairing rule instance */
            next
              case Reveal_ltk_case_12
              by contradiction /* from formulas */
            next
              case Reveal_ltk_case_13
              by contradiction /* non-normal bilinear pairing rule instance */
            next
              case Reveal_ltk_case_14
              by contradiction /* non-normal bilinear pairing rule instance */
            next
              case c_exp
              solve( !KU( ~x.4 ) @ #vk.15 )
                case Reveal_master_key
                by contradiction /* from formulas */
              qed
            qed
          next
            case Resp_1_case_05
            by solve( !KU( ~ey.3 ) @ #vk.16 )
          next
            case Resp_1_case_06
            by solve( !KU( ~ey.2 ) @ #vk.19 )
          next
            case Resp_1_case_07
            by solve( !KU( ~ey.3 ) @ #vk.16 )
          next
            case Resp_1_case_08
            solve( !KU( ~x.4 ) @ #vk.19 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_09
            solve( !KU( ~x.4 ) @ #vk.18 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_10
            solve( !KU( ~x.4 ) @ #vk.16 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_11
            by solve( !KU( ~ey.3 ) @ #vk.18 )
          next
            case Resp_1_case_12
            by solve( !KU( ~ey.2 ) @ #vk.26 )
          next
            case Resp_1_case_13
            by solve( !KU( ~ey.3 ) @ #vk.18 )
          next
            case Resp_1_case_14
            solve( !KU( ~x.4 ) @ #vk.26 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_15
            solve( !KU( ~x.4 ) @ #vk.23 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Reveal_ltk_case_1
            by solve( !KU( ~ey.2 ) @ #vk.12 )
          next
            case Reveal_ltk_case_2
            by solve( !KU( ~ey.2 ) @ #vk.13 )
          next
            case Reveal_ltk_case_3
            by solve( !KU( ~ey.2 ) @ #vk.11 )
          next
            case Reveal_ltk_case_4
            by solve( !KU( ~ey.2 ) @ #vk.12 )
          next
            case c_exp
            by solve( !KU( ~ey.1 ) @ #vk.13 )
          qed
        next
          case split_case_3
          solve( !KU( z.1^inv(~ey.1) ) @ #vk.9 )
            case c_exp
            by solve( !KU( ~ey.1 ) @ #vk.13 )
          qed
        next
          case split_case_4
          solve( !KU( x.2^inv((~ey.1*x.3)) ) @ #vk.9 )
            case c_exp
            by solve( !KU( ~ey.1 ) @ #vk.14 )
          qed
        next
          case split_case_5
          solve( !KU( x.2^(x.3*inv(~ey.1)) ) @ #vk.9 )
            case Init_1_case_01
            by solve( !KU( ~ey.2 ) @ #vk.12 )
          next
            case Init_1_case_02
            by solve( !KU( ~ey.2 ) @ #vk.14 )
          next
            case Init_1_case_03
            by solve( !KU( ~ex ) @ #vk.16 )
          next
            case Init_1_case_04
            by solve( !KU( ~ex ) @ #vk.17 )
          next
            case Init_1_case_05
            solve( !KU( ~s ) @ #vk.16 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_06
            solve( !KU( ~s ) @ #vk.17 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_07
            by solve( !KU( ~ex ) @ #vk.15 )
          next
            case Init_1_case_08
            solve( !KU( ~s ) @ #vk.15 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_09
            by solve( !KU( ~ex ) @ #vk.22 )
          next
            case Init_1_case_10
            solve( !KU( ~s ) @ #vk.22 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_01
            by solve( !KU( ~ey.3 ) @ #vk.13 )
          next
            case Resp_1_case_02
            by solve( !KU( ~ey.3 ) @ #vk.15 )
          next
            case Resp_1_case_03
            by solve( !KU( ~ey.2 ) @ #vk.17 )
          next
            case Resp_1_case_04
            by solve( !KU( ~ey.2 ) @ #vk.18 )
          next
            case Resp_1_case_05
            solve( !KU( ~x.4 ) @ #vk.19 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_06
            solve( !KU( ~x.4 ) @ #vk.20 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_07
            by solve( !KU( ~ey.2 ) @ #vk.16 )
          next
            case Resp_1_case_08
            by solve( !KU( ~ey.3 ) @ #vk.16 )
          next
            case Resp_1_case_09
            by solve( !KU( ~ey.2 ) @ #vk.23 )
          next
            case Resp_1_case_10
            by solve( !KU( ~ey.3 ) @ #vk.23 )
          next
            case Reveal_ltk_case_1
            by solve( !KU( ~ey.2 ) @ #vk.13 )
          next
            case Reveal_ltk_case_2
            by solve( !KU( ~ey.2 ) @ #vk.15 )
          next
            case Reveal_ltk_case_3
            by solve( !KU( ~ey.2 ) @ #vk.12 )
          next
            case Reveal_ltk_case_4
            by solve( !KU( ~ey.2 ) @ #vk.14 )
          next
            case c_exp
            by solve( !KU( ~ey.1 ) @ #vk.15 )
          qed
        next
          case split_case_6
          solve( !KU( x.2^(x.3*inv((~ey.1*x.4))) ) @ #vk.9 )
            case Init_1_case_01
            by solve( !KU( ~ey.2 ) @ #vk.13 )
          next
            case Init_1_case_02
            by solve( !KU( ~ey.2 ) @ #vk.15 )
          next
            case Init_1_case_03
            by solve( !KU( ~ex ) @ #vk.16 )
          next
            case Init_1_case_04
            by solve( !KU( ~ex ) @ #vk.17 )
          next
            case Init_1_case_05
            solve( !KU( ~s ) @ #vk.16 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_06
            solve( !KU( ~s ) @ #vk.17 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_07
            by solve( !KU( ~ex ) @ #vk.15 )
          next
            case Init_1_case_08
            solve( !KU( ~s ) @ #vk.15 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Init_1_case_09
            by solve( !KU( ~ex ) @ #vk.23 )
          next
            case Init_1_case_10
            solve( !KU( ~s ) @ #vk.23 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_01
            by solve( !KU( ~ey.3 ) @ #vk.14 )
          next
            case Resp_1_case_02
            by solve( !KU( ~ey.3 ) @ #vk.16 )
          next
            case Resp_1_case_03
            by solve( !KU( ~ey.2 ) @ #vk.17 )
          next
            case Resp_1_case_04
            by solve( !KU( ~ey.2 ) @ #vk.18 )
          next
            case Resp_1_case_05
            solve( !KU( ~x.5 ) @ #vk.17 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_06
            solve( !KU( ~x.5 ) @ #vk.18 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_07
            by solve( !KU( ~ey.2 ) @ #vk.16 )
          next
            case Resp_1_case_08
            solve( !KU( ~x.5 ) @ #vk.17 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Resp_1_case_09
            by solve( !KU( ~ey.2 ) @ #vk.24 )
          next
            case Resp_1_case_10
            solve( !KU( ~x.5 ) @ #vk.25 )
              case Reveal_master_key
              by contradiction /* from formulas */
            qed
          next
            case Reveal_ltk_case_1
            by solve( !KU( ~ey.2 ) @ #vk.14 )
          next
            case Reveal_ltk_case_2
            by solve( !KU( ~ey.2 ) @ #vk.16 )
          next
            case Reveal_ltk_case_3
            by solve( !KU( ~ey.2 ) @ #vk.13 )
          next
            case Reveal_ltk_case_4
            by solve( !KU( ~ey.2 ) @ #vk.15 )
          next
            case c_exp
            by solve( !KU( ~ey.1 ) @ #vk.16 )
          qed
        next
          case split_case_7
          by contradiction /* from formulas */
        qed
      qed
    qed
  qed
qed











/*
WARNING: the following wellformedness checks failed!

Message Derivation Checks
=========================

  The variables of the following rule(s) are not derivable from their premises, you may be performing unintended pattern matching.

Rule Init_1: 
Failed to derive Variable(s): ~s

Rule Resp_1: 
Failed to derive Variable(s): ~s
*/

/*
Generated from:
Tamarin version 1.11.0
Maude version 3.2.1
Git revision: d8e8266fc8aa702ff3c4d08608a7fbbe124eea65, branch: cyclic-squashed
Compiled at: 2024-11-27 09:37:37.786154 UTC
*/

end
/* Output

==============================================================================
summary of summaries:

analyzed: examples/ake/bilinear/Scott.spthy

  output:          examples/ake/bilinear/Scott.spthy.tmp
  processing time: 8.34s
  
  WARNING: 1 wellformedness check failed!
           The analysis results might be wrong!
  
  key_agreement_reachable (exists-trace): verified (10 steps)
  key_secrecy (all-traces): verified (516 steps)

==============================================================================
*/
