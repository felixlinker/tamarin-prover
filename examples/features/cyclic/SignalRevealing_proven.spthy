theory Signal begin

// Function signature and definition of the equational theory E

builtins: diffie-hellman
functions: decrypts/2, fst/1, kdf/1, pair/2, sdec/2, senc/2, snd/1,
           true/0
equations:
    decrypts(senc(m, k), k) = true,
    fst(<x.1, x.2>) = x.1,
    sdec(senc(x.1, x.2), x.2) = x.1,
    snd(<x.1, x.2>) = x.2

tactic: noeqs
presort: i
deprio: {id}
  regex"splitEqs"



heuristic: {noeqs}

/* looping facts with injective instances: Session/8 */





restriction Eq:
  "∀ a b #x. (Eq( a, b ) @ #x) ⇒ (a = b)"
  // safety formula

restriction Neq:
  "∀ a b #x. (Neq( a, b ) @ #x) ⇒ (¬(a = b))"
  // safety formula

rule (modulo E) KeyGen:
   [ Fr( ~ltk ), Fr( ~prek ) ]
  -->
   [
   !SecretKeys( $A, ~ltk, ~prek ),
   !PublicKeys( $A, 'g'^~ltk, 'g'^~prek ), Out( 'g'^~ltk ),
   Out( 'g'^~prek )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) RevealLtk:
   [ !SecretKeys( $A, ~ltk, ~prek ) ]
  --[ Reveal( 'g'^~ltk ) ]->
   [ Out( ~ltk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) RevealPrek:
   [ !SecretKeys( $A, ~ltk, ~prek ) ]
  --[ Reveal( 'g'^~prek ) ]->
   [ Out( ~prek ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) RevealEphemeral:
   [ !EphemeralDH( $A, ~x ) ] --[ Reveal( 'g'^~x ) ]-> [ Out( ~x ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) SenderStart:
   [
   Fr( ~id ), Fr( ~x ), Fr( ~m ), !SecretKeys( $A, ~ltk, prek ),
   !PublicKeys( $B, ltpk, prepk )
   ]
  --[ Neq( $A, $B ), Send( ~m, 'g'^~x, prepk ), GenEph( 'g'^~x ) ]->
   [
   !EphemeralDH( $A, ~x ),
   Session( ~id, $A, 'S', ~x, $B, prepk,
            kdf(<'rk', kdf(<prepk^~ltk, ltpk^~x, prepk^~x>)>),
            kdf(<'ck', kdf(<'rk', kdf(<prepk^~ltk, ltpk^~x, prepk^~x>)>)>)
   ),
   Out( <'g'^~x, 
         senc(~m,
              kdf(<'mk', 
                   kdf(<'ck', kdf(<'rk', kdf(<prepk^~ltk, ltpk^~x, prepk^~x>)>)>)>))
        >
   )
   ]

  /*
  rule (modulo AC) SenderStart:
     [
     Fr( ~id ), Fr( ~x ), Fr( ~m ), !SecretKeys( $A, ~ltk, prek ),
     !PublicKeys( $B, ltpk, prepk )
     ]
    --[ Neq( $A, $B ), Send( ~m, 'g'^~x, prepk ), GenEph( 'g'^~x ) ]->
     [
     !EphemeralDH( $A, ~x ),
     Session( ~id, $A, 'S', ~x, $B, prepk,
              kdf(<'rk', kdf(<z, z.1, z.2>)>),
              kdf(<'ck', kdf(<'rk', kdf(<z, z.1, z.2>)>)>)
     ),
     Out( <'g'^~x, 
           senc(~m, kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<z, z.1, z.2>)>)>)>))
          >
     )
     ]
    variants (modulo AC)
      1. ~ltk  = ~ltk.3
         ~x    = ~x.3
         ltpk  = ltpk.3
         prepk = prepk.3
         z     = prepk.3^~ltk.3
         z.1   = ltpk.3^~x.3
         z.2   = prepk.3^~x.3
    
      2. ~ltk  = ~ltk.3
         ~x    = ~x.3
         ltpk  = DH_neutral
         prepk = prepk.3
         z     = prepk.3^~ltk.3
         z.1   = DH_neutral
         z.2   = prepk.3^~x.3
    
      3. ~ltk  = ~ltk.3
         ~x    = ~x.4
         ltpk  = x.5^inv(~x.4)
         prepk = prepk.3
         z     = prepk.3^~ltk.3
         z.1   = x.5
         z.2   = prepk.3^~x.4
    
      4. ~ltk  = ~ltk.3
         ~x    = ~x.5
         ltpk  = DH_neutral
         prepk = x.7^inv(~x.5)
         z     = x.7^(~ltk.3*inv(~x.5))
         z.1   = DH_neutral
         z.2   = x.7
    
      5. ~ltk  = ~ltk.3
         ~x    = ~x.5
         ltpk  = x.6^inv((~x.5*x.7))
         prepk = prepk.3
         z     = prepk.3^~ltk.3
         z.1   = x.6^inv(x.7)
         z.2   = prepk.3^~x.5
    
      6. ~ltk  = ~ltk.3
         ~x    = ~x.5
         ltpk  = x.6^(x.7*inv(~x.5))
         prepk = prepk.3
         z     = prepk.3^~ltk.3
         z.1   = x.6^x.7
         z.2   = prepk.3^~x.5
    
      7. ~ltk  = ~ltk.3
         ~x    = ~x.6
         ltpk  = ltpk.3
         prepk = x.9^inv(~x.6)
         z     = x.9^(~ltk.3*inv(~x.6))
         z.1   = ltpk.3^~x.6
         z.2   = x.9
    
      8. ~ltk  = ~ltk.3
         ~x    = ~x.6
         ltpk  = DH_neutral
         prepk = x.8^inv((~x.6*x.9))
         z     = x.8^(~ltk.3*inv((~x.6*x.9)))
         z.1   = DH_neutral
         z.2   = x.8^inv(x.9)
    
      9. ~ltk  = ~ltk.3
         ~x    = ~x.6
         ltpk  = DH_neutral
         prepk = x.8^(x.9*inv(~x.6))
         z     = x.8^(~ltk.3*x.9*inv(~x.6))
         z.1   = DH_neutral
         z.2   = x.8^x.9
    
     10. ~ltk  = ~ltk.3
         ~x    = ~x.6
         ltpk  = x.7^inv(~x.6)
         prepk = x.9^inv(~x.6)
         z     = x.9^(~ltk.3*inv(~x.6))
         z.1   = x.7
         z.2   = x.9
    
     11. ~ltk  = ~ltk.3
         ~x    = ~x.6
         ltpk  = x.7^(x.8*inv((~x.6*x.9)))
         prepk = prepk.3
         z     = prepk.3^~ltk.3
         z.1   = x.7^(x.8*inv(x.9))
         z.2   = prepk.3^~x.6
    
     12. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = ltpk.3
         prepk = x.5^x.6
         z     = x.5^(~ltk.3*x.6)
         z.1   = ltpk.3^~x.7
         z.2   = x.5^(x.6*~x.7)
    
     13. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = ltpk.3
         prepk = x.10^inv((~x.7*x.11))
         z     = x.10^(~ltk.3*inv((~x.7*x.11)))
         z.1   = ltpk.3^~x.7
         z.2   = x.10^inv(x.11)
    
     14. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = ltpk.3
         prepk = x.10^(x.11*inv(~x.7))
         z     = x.10^(~ltk.3*x.11*inv(~x.7))
         z.1   = ltpk.3^~x.7
         z.2   = x.10^x.11
    
     15. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = DH_neutral
         prepk = x.5^x.6
         z     = x.5^(~ltk.3*x.6)
         z.1   = DH_neutral
         z.2   = x.5^(x.6*~x.7)
    
     16. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = DH_neutral
         prepk = x.9^(x.10*inv((~x.7*x.11)))
         z     = x.9^(~ltk.3*x.10*inv((~x.7*x.11)))
         z.1   = DH_neutral
         z.2   = x.9^(x.10*inv(x.11))
    
     17. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = x.5^x.6
         prepk = prepk.3
         z     = prepk.3^~ltk.3
         z.1   = x.5^(x.6*~x.7)
         z.2   = prepk.3^~x.7
    
     18. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = x.8^x.9
         prepk = x.11^inv(~x.7)
         z     = x.11^(~ltk.3*inv(~x.7))
         z.1   = x.8^(~x.7*x.9)
         z.2   = x.11
    
     19. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = x.8^inv(~x.7)
         prepk = x.10^x.11
         z     = x.10^(~ltk.3*x.11)
         z.1   = x.8
         z.2   = x.10^(~x.7*x.11)
    
     20. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = x.8^inv(~x.7)
         prepk = x.10^inv((~x.7*x.11))
         z     = x.10^(~ltk.3*inv((~x.7*x.11)))
         z.1   = x.8
         z.2   = x.10^inv(x.11)
    
     21. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = x.8^inv(~x.7)
         prepk = x.10^(x.11*inv(~x.7))
         z     = x.10^(~ltk.3*x.11*inv(~x.7))
         z.1   = x.8
         z.2   = x.10^x.11
    
     22. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = x.8^inv((~x.7*x.9))
         prepk = x.11^inv(~x.7)
         z     = x.11^(~ltk.3*inv(~x.7))
         z.1   = x.8^inv(x.9)
         z.2   = x.11
    
     23. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = x.8^(x.9*inv(~x.7))
         prepk = x.11^inv(~x.7)
         z     = x.11^(~ltk.3*inv(~x.7))
         z.1   = x.8^x.9
         z.2   = x.11
    
     24. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = ltpk.3
         prepk = x.11^(x.12*inv((~x.8*x.13)))
         z     = x.11^(~ltk.3*x.12*inv((~x.8*x.13)))
         z.1   = ltpk.3^~x.8
         z.2   = x.11^(x.12*inv(x.13))
    
     25. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^x.10
         prepk = x.12^inv((~x.8*x.13))
         z     = x.12^(~ltk.3*inv((~x.8*x.13)))
         z.1   = x.9^(~x.8*x.10)
         z.2   = x.12^inv(x.13)
    
     26. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^x.10
         prepk = x.12^(x.13*inv(~x.8))
         z     = x.12^(~ltk.3*x.13*inv(~x.8))
         z.1   = x.9^(~x.8*x.10)
         z.2   = x.12^x.13
    
     27. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^inv(~x.8)
         prepk = x.11^(x.12*inv((~x.8*x.13)))
         z     = x.11^(~ltk.3*x.12*inv((~x.8*x.13)))
         z.1   = x.9
         z.2   = x.11^(x.12*inv(x.13))
    
     28. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^inv((~x.8*x.10))
         prepk = x.12^x.13
         z     = x.12^(~ltk.3*x.13)
         z.1   = x.9^inv(x.10)
         z.2   = x.12^(~x.8*x.13)
    
     29. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^inv((~x.8*x.10))
         prepk = x.12^inv((~x.8*x.13))
         z     = x.12^(~ltk.3*inv((~x.8*x.13)))
         z.1   = x.9^inv(x.10)
         z.2   = x.12^inv(x.13)
    
     30. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^inv((~x.8*x.10))
         prepk = x.12^(x.13*inv(~x.8))
         z     = x.12^(~ltk.3*x.13*inv(~x.8))
         z.1   = x.9^inv(x.10)
         z.2   = x.12^x.13
    
     31. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^(x.10*inv(~x.8))
         prepk = x.12^x.13
         z     = x.12^(~ltk.3*x.13)
         z.1   = x.9^x.10
         z.2   = x.12^(~x.8*x.13)
    
     32. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^(x.10*inv(~x.8))
         prepk = x.12^inv((~x.8*x.13))
         z     = x.12^(~ltk.3*inv((~x.8*x.13)))
         z.1   = x.9^x.10
         z.2   = x.12^inv(x.13)
    
     33. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^(x.10*inv(~x.8))
         prepk = x.12^(x.13*inv(~x.8))
         z     = x.12^(~ltk.3*x.13*inv(~x.8))
         z.1   = x.9^x.10
         z.2   = x.12^x.13
    
     34. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^(x.10*inv((~x.8*x.11)))
         prepk = x.13^inv(~x.8)
         z     = x.13^(~ltk.3*inv(~x.8))
         z.1   = x.9^(x.10*inv(x.11))
         z.2   = x.13
    
     35. ~ltk  = ~ltk.3
         ~x    = ~x.9
         ltpk  = x.10^x.11
         prepk = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.13^(~ltk.3*x.14*inv((~x.9*x.15)))
         z.1   = x.10^(~x.9*x.11)
         z.2   = x.13^(x.14*inv(x.15))
    
     36. ~ltk  = ~ltk.3
         ~x    = ~x.9
         ltpk  = x.10^inv((~x.9*x.11))
         prepk = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.13^(~ltk.3*x.14*inv((~x.9*x.15)))
         z.1   = x.10^inv(x.11)
         z.2   = x.13^(x.14*inv(x.15))
    
     37. ~ltk  = ~ltk.3
         ~x    = ~x.9
         ltpk  = x.10^(x.11*inv(~x.9))
         prepk = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.13^(~ltk.3*x.14*inv((~x.9*x.15)))
         z.1   = x.10^x.11
         z.2   = x.13^(x.14*inv(x.15))
    
     38. ~ltk  = ~ltk.3
         ~x    = ~x.9
         ltpk  = x.10^(x.11*inv((~x.9*x.12)))
         prepk = x.14^x.15
         z     = x.14^(~ltk.3*x.15)
         z.1   = x.10^(x.11*inv(x.12))
         z.2   = x.14^(~x.9*x.15)
    
     39. ~ltk  = ~ltk.3
         ~x    = ~x.9
         ltpk  = x.10^(x.11*inv((~x.9*x.12)))
         prepk = x.14^inv((~x.9*x.15))
         z     = x.14^(~ltk.3*inv((~x.9*x.15)))
         z.1   = x.10^(x.11*inv(x.12))
         z.2   = x.14^inv(x.15)
    
     40. ~ltk  = ~ltk.3
         ~x    = ~x.9
         ltpk  = x.10^(x.11*inv((~x.9*x.12)))
         prepk = x.14^(x.15*inv(~x.9))
         z     = x.14^(~ltk.3*x.15*inv(~x.9))
         z.1   = x.10^(x.11*inv(x.12))
         z.2   = x.14^x.15
    
     41. ~ltk  = ~ltk.3
         ~x    = ~x.10
         ltpk  = x.11^(x.12*inv((~x.10*x.13)))
         prepk = x.15^(x.16*inv((~x.10*x.17)))
         z     = x.15^(~ltk.3*x.16*inv((~x.10*x.17)))
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.15^(x.16*inv(x.17))
    
     42. ~ltk  = ~ltk.3
         ~x    = ~x.13
         ltpk  = x.8^x.9
         prepk = x.11^x.12
         z     = x.11^(~ltk.3*x.12)
         z.1   = x.8^(x.9*~x.13)
         z.2   = x.11^(x.12*~x.13)
    
     43. ~ltk  = ~x.6
         ~x    = ~x.6
         ltpk  = DH_neutral
         prepk = x.9^inv(~x.6)
         z     = x.9
         z.1   = DH_neutral
         z.2   = x.9
    
     44. ~ltk  = ~x.7
         ~x    = ~x.7
         ltpk  = ltpk.3
         prepk = x.11^inv(~x.7)
         z     = x.11
         z.1   = ltpk.3^~x.7
         z.2   = x.11
    
     45. ~ltk  = ~x.7
         ~x    = ~x.7
         ltpk  = DH_neutral
         prepk = x.10^inv((~x.7*x.11))
         z     = x.10^inv(x.11)
         z.1   = DH_neutral
         z.2   = x.10^inv(x.11)
    
     46. ~ltk  = ~x.7
         ~x    = ~x.7
         ltpk  = DH_neutral
         prepk = x.10^(x.11*inv(~x.7))
         z     = x.10^x.11
         z.1   = DH_neutral
         z.2   = x.10^x.11
    
     47. ~ltk  = ~x.7
         ~x    = ~x.7
         ltpk  = x.9^inv(~x.7)
         prepk = x.11^inv(~x.7)
         z     = x.11
         z.1   = x.9
         z.2   = x.11
    
     48. ~ltk  = ~x.7
         ~x    = ~x.9
         ltpk  = DH_neutral
         prepk = x.11^inv((~x.7*~x.9))
         z     = x.11^inv(~x.9)
         z.1   = DH_neutral
         z.2   = x.11^inv(~x.7)
    
     49. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = ltpk.3
         prepk = x.12^inv((~x.8*x.13))
         z     = x.12^inv(x.13)
         z.1   = ltpk.3^~x.8
         z.2   = x.12^inv(x.13)
    
     50. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = ltpk.3
         prepk = x.12^(x.13*inv(~x.8))
         z     = x.12^x.13
         z.1   = ltpk.3^~x.8
         z.2   = x.12^x.13
    
     51. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = DH_neutral
         prepk = x.11^(x.12*inv((~x.8*x.13)))
         z     = x.11^(x.12*inv(x.13))
         z.1   = DH_neutral
         z.2   = x.11^(x.12*inv(x.13))
    
     52. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = x.10^x.11
         prepk = x.13^inv(~x.8)
         z     = x.13
         z.1   = x.10^(~x.8*x.11)
         z.2   = x.13
    
     53. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = x.10^inv(~x.8)
         prepk = x.12^inv((~x.8*x.13))
         z     = x.12^inv(x.13)
         z.1   = x.10
         z.2   = x.12^inv(x.13)
    
     54. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = x.10^inv(~x.8)
         prepk = x.12^(x.13*inv(~x.8))
         z     = x.12^x.13
         z.1   = x.10
         z.2   = x.12^x.13
    
     55. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = x.10^inv((~x.8*x.11))
         prepk = x.13^inv(~x.8)
         z     = x.13
         z.1   = x.10^inv(x.11)
         z.2   = x.13
    
     56. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = x.10^(x.11*inv(~x.8))
         prepk = x.13^inv(~x.8)
         z     = x.13
         z.1   = x.10^x.11
         z.2   = x.13
    
     57. ~ltk  = ~x.8
         ~x    = ~x.10
         ltpk  = ltpk.3
         prepk = x.13^inv((~x.8*~x.10))
         z     = x.13^inv(~x.10)
         z.1   = ltpk.3^~x.10
         z.2   = x.13^inv(~x.8)
    
     58. ~ltk  = ~x.8
         ~x    = ~x.10
         ltpk  = DH_neutral
         prepk = x.12^inv((~x.8*~x.10*x.13))
         z     = x.12^inv((~x.10*x.13))
         z.1   = DH_neutral
         z.2   = x.12^inv((~x.8*x.13))
    
     59. ~ltk  = ~x.8
         ~x    = ~x.10
         ltpk  = DH_neutral
         prepk = x.12^(x.13*inv((~x.8*~x.10)))
         z     = x.12^(x.13*inv(~x.10))
         z.1   = DH_neutral
         z.2   = x.12^(x.13*inv(~x.8))
    
     60. ~ltk  = ~x.8
         ~x    = ~x.10
         ltpk  = x.11^inv(~x.10)
         prepk = x.13^inv(~x.8)
         z     = x.13
         z.1   = x.11
         z.2   = x.13^(~x.10*inv(~x.8))
    
     61. ~ltk  = ~x.8
         ~x    = ~x.10
         ltpk  = x.11^inv(~x.10)
         prepk = x.13^inv((~x.8*~x.10))
         z     = x.13^inv(~x.10)
         z.1   = x.11
         z.2   = x.13^inv(~x.8)
    
     62. ~ltk  = ~x.8
         ~x    = ~x.13
         ltpk  = DH_neutral
         prepk = x.12^inv(~x.8)
         z     = x.12
         z.1   = DH_neutral
         z.2   = x.12^(~x.13*inv(~x.8))
    
     63. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = ltpk.3
         prepk = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.13^(x.14*inv(x.15))
         z.1   = ltpk.3^~x.9
         z.2   = x.13^(x.14*inv(x.15))
    
     64. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^x.12
         prepk = x.14^inv((~x.9*x.15))
         z     = x.14^inv(x.15)
         z.1   = x.11^(~x.9*x.12)
         z.2   = x.14^inv(x.15)
    
     65. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^x.12
         prepk = x.14^(x.15*inv(~x.9))
         z     = x.14^x.15
         z.1   = x.11^(~x.9*x.12)
         z.2   = x.14^x.15
    
     66. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^inv(~x.9)
         prepk = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.13^(x.14*inv(x.15))
         z.1   = x.11
         z.2   = x.13^(x.14*inv(x.15))
    
     67. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^inv((~x.9*x.12))
         prepk = x.14^inv((~x.9*x.15))
         z     = x.14^inv(x.15)
         z.1   = x.11^inv(x.12)
         z.2   = x.14^inv(x.15)
    
     68. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^inv((~x.9*x.12))
         prepk = x.14^(x.15*inv(~x.9))
         z     = x.14^x.15
         z.1   = x.11^inv(x.12)
         z.2   = x.14^x.15
    
     69. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^(x.12*inv(~x.9))
         prepk = x.14^inv((~x.9*x.15))
         z     = x.14^inv(x.15)
         z.1   = x.11^x.12
         z.2   = x.14^inv(x.15)
    
     70. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^(x.12*inv(~x.9))
         prepk = x.14^(x.15*inv(~x.9))
         z     = x.14^x.15
         z.1   = x.11^x.12
         z.2   = x.14^x.15
    
     71. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         prepk = x.15^inv(~x.9)
         z     = x.15
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.15
    
     72. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = ltpk.3
         prepk = x.14^inv((~x.9*~x.11*x.15))
         z     = x.14^inv((~x.11*x.15))
         z.1   = ltpk.3^~x.11
         z.2   = x.14^inv((~x.9*x.15))
    
     73. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = ltpk.3
         prepk = x.14^(x.15*inv((~x.9*~x.11)))
         z     = x.14^(x.15*inv(~x.11))
         z.1   = ltpk.3^~x.11
         z.2   = x.14^(x.15*inv(~x.9))
    
     74. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = DH_neutral
         prepk = x.13^(x.14*inv((~x.9*~x.11*x.15)))
         z     = x.13^(x.14*inv((~x.11*x.15)))
         z.1   = DH_neutral
         z.2   = x.13^(x.14*inv((~x.9*x.15)))
    
     75. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^x.13
         prepk = x.15^inv((~x.9*~x.11))
         z     = x.15^inv(~x.11)
         z.1   = x.12^(~x.11*x.13)
         z.2   = x.15^inv(~x.9)
    
     76. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^inv(~x.11)
         prepk = x.14^inv((~x.9*~x.11*x.15))
         z     = x.14^inv((~x.11*x.15))
         z.1   = x.12
         z.2   = x.14^inv((~x.9*x.15))
    
     77. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^inv(~x.11)
         prepk = x.14^inv((~x.9*x.15))
         z     = x.14^inv(x.15)
         z.1   = x.12
         z.2   = x.14^(~x.11*inv((~x.9*x.15)))
    
     78. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^inv(~x.11)
         prepk = x.14^(x.15*inv(~x.9))
         z     = x.14^x.15
         z.1   = x.12
         z.2   = x.14^(~x.11*x.15*inv(~x.9))
    
     79. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^inv(~x.11)
         prepk = x.14^(x.15*inv((~x.9*~x.11)))
         z     = x.14^(x.15*inv(~x.11))
         z.1   = x.12
         z.2   = x.14^(x.15*inv(~x.9))
    
     80. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^inv((~x.11*x.13))
         prepk = x.15^inv(~x.9)
         z     = x.15
         z.1   = x.12^inv(x.13)
         z.2   = x.15^(~x.11*inv(~x.9))
    
     81. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^inv((~x.11*x.13))
         prepk = x.15^inv((~x.9*~x.11))
         z     = x.15^inv(~x.11)
         z.1   = x.12^inv(x.13)
         z.2   = x.15^inv(~x.9)
    
     82. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^(x.13*inv(~x.11))
         prepk = x.15^inv(~x.9)
         z     = x.15
         z.1   = x.12^x.13
         z.2   = x.15^(~x.11*inv(~x.9))
    
     83. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^(x.13*inv(~x.11))
         prepk = x.15^inv((~x.9*~x.11))
         z     = x.15^inv(~x.11)
         z.1   = x.12^x.13
         z.2   = x.15^inv(~x.9)
    
     84. ~ltk  = ~x.9
         ~x    = ~x.15
         ltpk  = ltpk.3
         prepk = x.14^inv(~x.9)
         z     = x.14
         z.1   = ltpk.3^~x.15
         z.2   = x.14^(~x.15*inv(~x.9))
    
     85. ~ltk  = ~x.9
         ~x    = ~x.15
         ltpk  = DH_neutral
         prepk = x.13^inv((~x.9*x.14))
         z     = x.13^inv(x.14)
         z.1   = DH_neutral
         z.2   = x.13^(~x.15*inv((~x.9*x.14)))
    
     86. ~ltk  = ~x.9
         ~x    = ~x.15
         ltpk  = DH_neutral
         prepk = x.13^(x.14*inv(~x.9))
         z     = x.13^x.14
         z.1   = DH_neutral
         z.2   = x.13^(x.14*~x.15*inv(~x.9))
    
     87. ~ltk  = ~x.10
         ~x    = ~x.10
         ltpk  = x.12^x.13
         prepk = x.15^(x.16*inv((~x.10*x.17)))
         z     = x.15^(x.16*inv(x.17))
         z.1   = x.12^(~x.10*x.13)
         z.2   = x.15^(x.16*inv(x.17))
    
     88. ~ltk  = ~x.10
         ~x    = ~x.10
         ltpk  = x.12^inv((~x.10*x.13))
         prepk = x.15^(x.16*inv((~x.10*x.17)))
         z     = x.15^(x.16*inv(x.17))
         z.1   = x.12^inv(x.13)
         z.2   = x.15^(x.16*inv(x.17))
    
     89. ~ltk  = ~x.10
         ~x    = ~x.10
         ltpk  = x.12^(x.13*inv(~x.10))
         prepk = x.15^(x.16*inv((~x.10*x.17)))
         z     = x.15^(x.16*inv(x.17))
         z.1   = x.12^x.13
         z.2   = x.15^(x.16*inv(x.17))
    
     90. ~ltk  = ~x.10
         ~x    = ~x.10
         ltpk  = x.12^(x.13*inv((~x.10*x.14)))
         prepk = x.16^inv((~x.10*x.17))
         z     = x.16^inv(x.17)
         z.1   = x.12^(x.13*inv(x.14))
         z.2   = x.16^inv(x.17)
    
     91. ~ltk  = ~x.10
         ~x    = ~x.10
         ltpk  = x.12^(x.13*inv((~x.10*x.14)))
         prepk = x.16^(x.17*inv(~x.10))
         z     = x.16^x.17
         z.1   = x.12^(x.13*inv(x.14))
         z.2   = x.16^x.17
    
     92. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = ltpk.3
         prepk = x.15^(x.16*inv((~x.10*~x.12*x.17)))
         z     = x.15^(x.16*inv((~x.12*x.17)))
         z.1   = ltpk.3^~x.12
         z.2   = x.15^(x.16*inv((~x.10*x.17)))
    
     93. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^x.14
         prepk = x.16^inv((~x.10*~x.12*x.17))
         z     = x.16^inv((~x.12*x.17))
         z.1   = x.13^(~x.12*x.14)
         z.2   = x.16^inv((~x.10*x.17))
    
     94. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^x.14
         prepk = x.16^(x.17*inv((~x.10*~x.12)))
         z     = x.16^(x.17*inv(~x.12))
         z.1   = x.13^(~x.12*x.14)
         z.2   = x.16^(x.17*inv(~x.10))
    
     95. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^inv(~x.12)
         prepk = x.15^(x.16*inv((~x.10*~x.12*x.17)))
         z     = x.15^(x.16*inv((~x.12*x.17)))
         z.1   = x.13
         z.2   = x.15^(x.16*inv((~x.10*x.17)))
    
     96. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^inv(~x.12)
         prepk = x.15^(x.16*inv((~x.10*x.17)))
         z     = x.15^(x.16*inv(x.17))
         z.1   = x.13
         z.2   = x.15^(~x.12*x.16*inv((~x.10*x.17)))
    
     97. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^inv((~x.12*x.14))
         prepk = x.16^inv((~x.10*~x.12*x.17))
         z     = x.16^inv((~x.12*x.17))
         z.1   = x.13^inv(x.14)
         z.2   = x.16^inv((~x.10*x.17))
    
     98. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^inv((~x.12*x.14))
         prepk = x.16^inv((~x.10*x.17))
         z     = x.16^inv(x.17)
         z.1   = x.13^inv(x.14)
         z.2   = x.16^(~x.12*inv((~x.10*x.17)))
    
     99. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^inv((~x.12*x.14))
         prepk = x.16^(x.17*inv(~x.10))
         z     = x.16^x.17
         z.1   = x.13^inv(x.14)
         z.2   = x.16^(~x.12*x.17*inv(~x.10))
    
    100. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^inv((~x.12*x.14))
         prepk = x.16^(x.17*inv((~x.10*~x.12)))
         z     = x.16^(x.17*inv(~x.12))
         z.1   = x.13^inv(x.14)
         z.2   = x.16^(x.17*inv(~x.10))
    
    101. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^(x.14*inv(~x.12))
         prepk = x.16^inv((~x.10*~x.12*x.17))
         z     = x.16^inv((~x.12*x.17))
         z.1   = x.13^x.14
         z.2   = x.16^inv((~x.10*x.17))
    
    102. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^(x.14*inv(~x.12))
         prepk = x.16^inv((~x.10*x.17))
         z     = x.16^inv(x.17)
         z.1   = x.13^x.14
         z.2   = x.16^(~x.12*inv((~x.10*x.17)))
    
    103. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^(x.14*inv(~x.12))
         prepk = x.16^(x.17*inv(~x.10))
         z     = x.16^x.17
         z.1   = x.13^x.14
         z.2   = x.16^(~x.12*x.17*inv(~x.10))
    
    104. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^(x.14*inv(~x.12))
         prepk = x.16^(x.17*inv((~x.10*~x.12)))
         z     = x.16^(x.17*inv(~x.12))
         z.1   = x.13^x.14
         z.2   = x.16^(x.17*inv(~x.10))
    
    105. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^(x.14*inv((~x.12*x.15)))
         prepk = x.17^inv(~x.10)
         z     = x.17
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.17^(~x.12*inv(~x.10))
    
    106. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^(x.14*inv((~x.12*x.15)))
         prepk = x.17^inv((~x.10*~x.12))
         z     = x.17^inv(~x.12)
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.17^inv(~x.10)
    
    107. ~ltk  = ~x.10
         ~x    = ~x.17
         ltpk  = ltpk.3
         prepk = x.15^inv((~x.10*x.16))
         z     = x.15^inv(x.16)
         z.1   = ltpk.3^~x.17
         z.2   = x.15^(~x.17*inv((~x.10*x.16)))
    
    108. ~ltk  = ~x.10
         ~x    = ~x.17
         ltpk  = ltpk.3
         prepk = x.15^(x.16*inv(~x.10))
         z     = x.15^x.16
         z.1   = ltpk.3^~x.17
         z.2   = x.15^(x.16*~x.17*inv(~x.10))
    
    109. ~ltk  = ~x.10
         ~x    = ~x.17
         ltpk  = DH_neutral
         prepk = x.14^(x.15*inv((~x.10*x.16)))
         z     = x.14^(x.15*inv(x.16))
         z.1   = DH_neutral
         z.2   = x.14^(x.15*~x.17*inv((~x.10*x.16)))
    
    110. ~ltk  = ~x.10
         ~x    = ~x.17
         ltpk  = x.13^x.14
         prepk = x.16^inv(~x.10)
         z     = x.16
         z.1   = x.13^(x.14*~x.17)
         z.2   = x.16^(~x.17*inv(~x.10))
    
    111. ~ltk  = ~x.11
         ~x    = ~x.11
         ltpk  = x.13^(x.14*inv((~x.11*x.15)))
         prepk = x.17^(x.18*inv((~x.11*x.19)))
         z     = x.17^(x.18*inv(x.19))
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.17^(x.18*inv(x.19))
    
    112. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^x.15
         prepk = x.17^(x.18*inv((~x.11*~x.13*x.19)))
         z     = x.17^(x.18*inv((~x.13*x.19)))
         z.1   = x.14^(~x.13*x.15)
         z.2   = x.17^(x.18*inv((~x.11*x.19)))
    
    113. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^inv((~x.13*x.15))
         prepk = x.17^(x.18*inv((~x.11*~x.13*x.19)))
         z     = x.17^(x.18*inv((~x.13*x.19)))
         z.1   = x.14^inv(x.15)
         z.2   = x.17^(x.18*inv((~x.11*x.19)))
    
    114. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^inv((~x.13*x.15))
         prepk = x.17^(x.18*inv((~x.11*x.19)))
         z     = x.17^(x.18*inv(x.19))
         z.1   = x.14^inv(x.15)
         z.2   = x.17^(~x.13*x.18*inv((~x.11*x.19)))
    
    115. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^(x.15*inv(~x.13))
         prepk = x.17^(x.18*inv((~x.11*~x.13*x.19)))
         z     = x.17^(x.18*inv((~x.13*x.19)))
         z.1   = x.14^x.15
         z.2   = x.17^(x.18*inv((~x.11*x.19)))
    
    116. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^(x.15*inv(~x.13))
         prepk = x.17^(x.18*inv((~x.11*x.19)))
         z     = x.17^(x.18*inv(x.19))
         z.1   = x.14^x.15
         z.2   = x.17^(~x.13*x.18*inv((~x.11*x.19)))
    
    117. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^(x.15*inv((~x.13*x.16)))
         prepk = x.18^inv((~x.11*~x.13*x.19))
         z     = x.18^inv((~x.13*x.19))
         z.1   = x.14^(x.15*inv(x.16))
         z.2   = x.18^inv((~x.11*x.19))
    
    118. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^(x.15*inv((~x.13*x.16)))
         prepk = x.18^inv((~x.11*x.19))
         z     = x.18^inv(x.19)
         z.1   = x.14^(x.15*inv(x.16))
         z.2   = x.18^(~x.13*inv((~x.11*x.19)))
    
    119. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^(x.15*inv((~x.13*x.16)))
         prepk = x.18^(x.19*inv(~x.11))
         z     = x.18^x.19
         z.1   = x.14^(x.15*inv(x.16))
         z.2   = x.18^(~x.13*x.19*inv(~x.11))
    
    120. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^(x.15*inv((~x.13*x.16)))
         prepk = x.18^(x.19*inv((~x.11*~x.13)))
         z     = x.18^(x.19*inv(~x.13))
         z.1   = x.14^(x.15*inv(x.16))
         z.2   = x.18^(x.19*inv(~x.11))
    
    121. ~ltk  = ~x.11
         ~x    = ~x.19
         ltpk  = ltpk.3
         prepk = x.16^(x.17*inv((~x.11*x.18)))
         z     = x.16^(x.17*inv(x.18))
         z.1   = ltpk.3^~x.19
         z.2   = x.16^(x.17*~x.19*inv((~x.11*x.18)))
    
    122. ~ltk  = ~x.11
         ~x    = ~x.19
         ltpk  = x.14^x.15
         prepk = x.17^inv((~x.11*x.18))
         z     = x.17^inv(x.18)
         z.1   = x.14^(x.15*~x.19)
         z.2   = x.17^(~x.19*inv((~x.11*x.18)))
    
    123. ~ltk  = ~x.11
         ~x    = ~x.19
         ltpk  = x.14^x.15
         prepk = x.17^(x.18*inv(~x.11))
         z     = x.17^x.18
         z.1   = x.14^(x.15*~x.19)
         z.2   = x.17^(x.18*~x.19*inv(~x.11))
    
    124. ~ltk  = ~x.12
         ~x    = ~x.14
         ltpk  = x.15^(x.16*inv((~x.14*x.17)))
         prepk = x.19^(x.20*inv((~x.12*~x.14*x.21)))
         z     = x.19^(x.20*inv((~x.14*x.21)))
         z.1   = x.15^(x.16*inv(x.17))
         z.2   = x.19^(x.20*inv((~x.12*x.21)))
    
    125. ~ltk  = ~x.12
         ~x    = ~x.14
         ltpk  = x.15^(x.16*inv((~x.14*x.17)))
         prepk = x.19^(x.20*inv((~x.12*x.21)))
         z     = x.19^(x.20*inv(x.21))
         z.1   = x.15^(x.16*inv(x.17))
         z.2   = x.19^(~x.14*x.20*inv((~x.12*x.21)))
    
    126. ~ltk  = ~x.12
         ~x    = ~x.21
         ltpk  = x.15^x.16
         prepk = x.18^(x.19*inv((~x.12*x.20)))
         z     = x.18^(x.19*inv(x.20))
         z.1   = x.15^(x.16*~x.21)
         z.2   = x.18^(x.19*~x.21*inv((~x.12*x.20)))
    
    127. ~x    = ~x.3
         ltpk  = ltpk.3
         prepk = DH_neutral
         z     = DH_neutral
         z.1   = ltpk.3^~x.3
         z.2   = DH_neutral
    
    128. ~x    = ~x.4
         ltpk  = x.5^inv(~x.4)
         prepk = DH_neutral
         z     = DH_neutral
         z.1   = x.5
         z.2   = DH_neutral
    
    129. ~x    = ~x.5
         ltpk  = x.6^inv((~x.5*x.7))
         prepk = DH_neutral
         z     = DH_neutral
         z.1   = x.6^inv(x.7)
         z.2   = DH_neutral
    
    130. ~x    = ~x.5
         ltpk  = x.6^(x.7*inv(~x.5))
         prepk = DH_neutral
         z     = DH_neutral
         z.1   = x.6^x.7
         z.2   = DH_neutral
    
    131. ~x    = ~x.6
         ltpk  = x.7^(x.8*inv((~x.6*x.9)))
         prepk = DH_neutral
         z     = DH_neutral
         z.1   = x.7^(x.8*inv(x.9))
         z.2   = DH_neutral
    
    132. ~x    = ~x.7
         ltpk  = x.5^x.6
         prepk = DH_neutral
         z     = DH_neutral
         z.1   = x.5^(x.6*~x.7)
         z.2   = DH_neutral
    
    133. ltpk  = DH_neutral
         prepk = DH_neutral
         z     = DH_neutral
         z.1   = DH_neutral
         z.2   = DH_neutral
  */

rule (modulo E) Send:
   [ Fr( ~m ), Session( ~id, $A, 'S', ~x, $B, pc, rk, ck ) ]
  --[ Send( ~m, 'g'^~x, pc ) ]->
   [
   Session( ~id, $A, 'S', ~x, $B, pc, rk, kdf(<'ck', ck>) ),
   Out( senc(~m, kdf(<'mk', kdf(<'ck', ck>)>)) )
   ]

  // loop breaker: [1]
  /* has exactly the trivial AC variant */

rule (modulo E) ReceiverStart:
   [
   Fr( ~id ), !SecretKeys( $A, ~ltk, ~prek ),
   !PublicKeys( $B, ltpk, prepk ), In( <pc, enc> )
   ]
  --[
  Neq( $A, $B ),
  Receive( sdec(enc,
                kdf(<'mk', 
                     kdf(<'ck', kdf(<'rk', kdf(<ltpk^~prek, pc^~ltk, pc^~prek>)>)>)>))
  ),
  Eq( decrypts(enc,
               kdf(<'mk', 
                    kdf(<'ck', kdf(<'rk', kdf(<ltpk^~prek, pc^~ltk, pc^~prek>)>)>)>)),
      true
  )
  ]->
   [
   Session( ~id, $A, 'R', ~prek, $B, pc,
            kdf(<'rk', kdf(<ltpk^~prek, pc^~ltk, pc^~prek>)>),
            kdf(<'ck', kdf(<'rk', kdf(<ltpk^~prek, pc^~ltk, pc^~prek>)>)>)
   )
   ]

  /*
  rule (modulo AC) ReceiverStart:
     [
     Fr( ~id ), !SecretKeys( $A, ~ltk, ~prek ),
     !PublicKeys( $B, ltpk, prepk ), In( <pc, enc> )
     ]
    --[ Neq( $A, $B ), Receive( z.3 ), Eq( z.4, true ) ]->
     [
     Session( ~id, $A, 'R', ~prek, $B, pc,
              kdf(<'rk', kdf(<z, z.1, z.2>)>),
              kdf(<'ck', kdf(<'rk', kdf(<z, z.1, z.2>)>)>)
     )
     ]
    variants (modulo AC)
      1. ~ltk  = ~ltk.3
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = pc.3
         z     = ltpk.3^~prek.3
         z.1   = pc.3^~ltk.3
         z.2   = pc.3^~prek.3
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<ltpk.3^~prek.3, pc.3^~ltk.3, pc.3^~prek.3>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<ltpk.3^~prek.3, pc.3^~ltk.3, pc.3^~prek.3>)>)>)
                              >))
    
      2. ~ltk  = ~ltk.3
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.2^x.3
         z     = ltpk.3^~prek.3
         z.1   = x.2^(~ltk.3*x.3)
         z.2   = x.2^(~prek.3*x.3)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~prek.3, x.2^(~ltk.3*x.3), x.2^(~prek.3*x.3)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~prek.3, x.2^(~ltk.3*x.3), x.2^(~prek.3*x.3)>)
                                        >)
                                   >)
                              >))
    
      3. ~ltk  = ~ltk.3
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = pc.3
         z     = DH_neutral
         z.1   = pc.3^~ltk.3
         z.2   = pc.3^~prek.3
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, pc.3^~ltk.3, pc.3^~prek.3>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<DH_neutral, pc.3^~ltk.3, pc.3^~prek.3>)>)>)
                              >))
    
      4. ~ltk  = ~ltk.3
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.2^x.3
         z     = DH_neutral
         z.1   = x.2^(~ltk.3*x.3)
         z.2   = x.2^(~prek.3*x.3)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.2^(~ltk.3*x.3), x.2^(~prek.3*x.3)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.2^(~ltk.3*x.3), x.2^(~prek.3*x.3)>)>)
                                   >)
                              >))
    
      5. ~ltk  = ~ltk.3
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = x.2^x.3
         pc    = pc.3
         z     = x.2^(~prek.3*x.3)
         z.1   = pc.3^~ltk.3
         z.2   = pc.3^~prek.3
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.2^(~prek.3*x.3), pc.3^~ltk.3, pc.3^~prek.3>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.2^(~prek.3*x.3), pc.3^~ltk.3, pc.3^~prek.3>)>)
                                   >)
                              >))
    
      6. ~ltk  = ~ltk.3
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = x.4^x.5
         pc    = x.6^x.7
         z     = x.4^(~prek.3*x.5)
         z.1   = x.6^(~ltk.3*x.7)
         z.2   = x.6^(~prek.3*x.7)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.4^(~prek.3*x.5), x.6^(~ltk.3*x.7), x.6^(~prek.3*x.7)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.4^(~prek.3*x.5), x.6^(~ltk.3*x.7), x.6^(~prek.3*x.7)
                                             >)
                                        >)
                                   >)
                              >))
    
      7. ~ltk  = ~ltk.3
         ~prek = ~x.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.5^inv(~x.3)
         z     = DH_neutral
         z.1   = x.5^(~ltk.3*inv(~x.3))
         z.2   = x.5
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.5^(~ltk.3*inv(~x.3)), x.5>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<DH_neutral, x.5^(~ltk.3*inv(~x.3)), x.5>)>)>)
                              >))
    
      8. ~ltk  = ~ltk.3
         ~prek = ~x.3
         enc   = enc.3
         ltpk  = x.5^inv(~x.3)
         pc    = pc.3
         z     = x.5
         z.1   = pc.3^~ltk.3
         z.2   = pc.3^~x.3
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.5, pc.3^~ltk.3, pc.3^~x.3>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.5, pc.3^~ltk.3, pc.3^~x.3>)>)>)>))
    
      9. ~ltk  = ~ltk.3
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.7^inv(~x.4)
         z     = ltpk.3^~x.4
         z.1   = x.7^(~ltk.3*inv(~x.4))
         z.2   = x.7
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<ltpk.3^~x.4, x.7^(~ltk.3*inv(~x.4)), x.7>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<ltpk.3^~x.4, x.7^(~ltk.3*inv(~x.4)), x.7>)>)>)
                              >))
    
     10. ~ltk  = ~ltk.3
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.6^inv((~x.4*x.7))
         z     = DH_neutral
         z.1   = x.6^(~ltk.3*inv((~x.4*x.7)))
         z.2   = x.6^inv(x.7)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.6^(~ltk.3*inv((~x.4*x.7))), x.6^inv(x.7)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.6^(~ltk.3*inv((~x.4*x.7))), x.6^inv(x.7)
                                             >)
                                        >)
                                   >)
                              >))
    
     11. ~ltk  = ~ltk.3
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.6^(x.7*inv(~x.4))
         z     = DH_neutral
         z.1   = x.6^(~ltk.3*x.7*inv(~x.4))
         z.2   = x.6^x.7
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.6^(~ltk.3*x.7*inv(~x.4)), x.6^x.7>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.6^(~ltk.3*x.7*inv(~x.4)), x.6^x.7>)>)
                                   >)
                              >))
    
     12. ~ltk  = ~ltk.3
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = x.6^inv(~x.4)
         pc    = x.7^inv(~x.4)
         z     = x.6
         z.1   = x.7^(~ltk.3*inv(~x.4))
         z.2   = x.7
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.6, x.7^(~ltk.3*inv(~x.4)), x.7>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.6, x.7^(~ltk.3*inv(~x.4)), x.7>)>)>)
                              >))
    
     13. ~ltk  = ~ltk.3
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = x.6^inv((~x.4*x.7))
         pc    = pc.3
         z     = x.6^inv(x.7)
         z.1   = pc.3^~ltk.3
         z.2   = pc.3^~x.4
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.6^inv(x.7), pc.3^~ltk.3, pc.3^~x.4>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.6^inv(x.7), pc.3^~ltk.3, pc.3^~x.4>)>)
                                   >)
                              >))
    
     14. ~ltk  = ~ltk.3
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = x.6^(x.7*inv(~x.4))
         pc    = pc.3
         z     = x.6^x.7
         z.1   = pc.3^~ltk.3
         z.2   = pc.3^~x.4
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.6^x.7, pc.3^~ltk.3, pc.3^~x.4>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.6^x.7, pc.3^~ltk.3, pc.3^~x.4>)>)>)>))
    
     15. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.8^inv((~x.5*x.9))
         z     = ltpk.3^~x.5
         z.1   = x.8^(~ltk.3*inv((~x.5*x.9)))
         z.2   = x.8^inv(x.9)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~x.5, x.8^(~ltk.3*inv((~x.5*x.9))), x.8^inv(x.9)>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~x.5, x.8^(~ltk.3*inv((~x.5*x.9))), 
                                              x.8^inv(x.9)>)
                                        >)
                                   >)
                              >))
    
     16. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.8^(x.9*inv(~x.5))
         z     = ltpk.3^~x.5
         z.1   = x.8^(~ltk.3*x.9*inv(~x.5))
         z.2   = x.8^x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<ltpk.3^~x.5, x.8^(~ltk.3*x.9*inv(~x.5)), x.8^x.9>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~x.5, x.8^(~ltk.3*x.9*inv(~x.5)), x.8^x.9>)>)
                                   >)
                              >))
    
     17. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.7^(x.8*inv((~x.5*x.9)))
         z     = DH_neutral
         z.1   = x.7^(~ltk.3*x.8*inv((~x.5*x.9)))
         z.2   = x.7^(x.8*inv(x.9))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.7^(~ltk.3*x.8*inv((~x.5*x.9))), 
                                          x.7^(x.8*inv(x.9))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.7^(~ltk.3*x.8*inv((~x.5*x.9))), 
                                              x.7^(x.8*inv(x.9))>)
                                        >)
                                   >)
                              >))
    
     18. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^x.8
         pc    = x.9^inv(~x.5)
         z     = x.7^(~x.5*x.8)
         z.1   = x.9^(~ltk.3*inv(~x.5))
         z.2   = x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7^(~x.5*x.8), x.9^(~ltk.3*inv(~x.5)), x.9>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.7^(~x.5*x.8), x.9^(~ltk.3*inv(~x.5)), x.9>)>)
                                   >)
                              >))
    
     19. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^inv(~x.5)
         pc    = x.8^x.9
         z     = x.7
         z.1   = x.8^(~ltk.3*x.9)
         z.2   = x.8^(~x.5*x.9)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7, x.8^(~ltk.3*x.9), x.8^(~x.5*x.9)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.7, x.8^(~ltk.3*x.9), x.8^(~x.5*x.9)>)>)>)
                              >))
    
     20. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^inv(~x.5)
         pc    = x.8^inv((~x.5*x.9))
         z     = x.7
         z.1   = x.8^(~ltk.3*inv((~x.5*x.9)))
         z.2   = x.8^inv(x.9)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7, x.8^(~ltk.3*inv((~x.5*x.9))), x.8^inv(x.9)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.7, x.8^(~ltk.3*inv((~x.5*x.9))), x.8^inv(x.9)>)>)
                                   >)
                              >))
    
     21. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^inv(~x.5)
         pc    = x.8^(x.9*inv(~x.5))
         z     = x.7
         z.1   = x.8^(~ltk.3*x.9*inv(~x.5))
         z.2   = x.8^x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7, x.8^(~ltk.3*x.9*inv(~x.5)), x.8^x.9>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.7, x.8^(~ltk.3*x.9*inv(~x.5)), x.8^x.9>)>)>)
                              >))
    
     22. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^inv((~x.5*x.8))
         pc    = x.9^inv(~x.5)
         z     = x.7^inv(x.8)
         z.1   = x.9^(~ltk.3*inv(~x.5))
         z.2   = x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7^inv(x.8), x.9^(~ltk.3*inv(~x.5)), x.9>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.7^inv(x.8), x.9^(~ltk.3*inv(~x.5)), x.9>)>)>)
                              >))
    
     23. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^(x.8*inv(~x.5))
         pc    = x.9^inv(~x.5)
         z     = x.7^x.8
         z.1   = x.9^(~ltk.3*inv(~x.5))
         z.2   = x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.7^x.8, x.9^(~ltk.3*inv(~x.5)), x.9>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.7^x.8, x.9^(~ltk.3*inv(~x.5)), x.9>)>)
                                   >)
                              >))
    
     24. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^(x.8*inv((~x.5*x.9)))
         pc    = pc.3
         z     = x.7^(x.8*inv(x.9))
         z.1   = pc.3^~ltk.3
         z.2   = pc.3^~x.5
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7^(x.8*inv(x.9)), pc.3^~ltk.3, pc.3^~x.5>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.7^(x.8*inv(x.9)), pc.3^~ltk.3, pc.3^~x.5>)>)>)
                              >))
    
     25. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = ltpk.3^~x.6
         z.1   = x.9^(~ltk.3*x.10*inv((~x.6*x.11)))
         z.2   = x.9^(x.10*inv(x.11))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~x.6, x.9^(~ltk.3*x.10*inv((~x.6*x.11))), 
                                          x.9^(x.10*inv(x.11))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~x.6, x.9^(~ltk.3*x.10*inv((~x.6*x.11))), 
                                              x.9^(x.10*inv(x.11))>)
                                        >)
                                   >)
                              >))
    
     26. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^x.9
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^(~x.6*x.9)
         z.1   = x.10^(~ltk.3*inv((~x.6*x.11)))
         z.2   = x.10^inv(x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^(~x.6*x.9), x.10^(~ltk.3*inv((~x.6*x.11))), 
                                          x.10^inv(x.11)>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^(~x.6*x.9), x.10^(~ltk.3*inv((~x.6*x.11))), 
                                              x.10^inv(x.11)>)
                                        >)
                                   >)
                              >))
    
     27. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^x.9
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^(~x.6*x.9)
         z.1   = x.10^(~ltk.3*x.11*inv(~x.6))
         z.2   = x.10^x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^(~x.6*x.9), x.10^(~ltk.3*x.11*inv(~x.6)), x.10^x.11>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^(~x.6*x.9), x.10^(~ltk.3*x.11*inv(~x.6)), 
                                              x.10^x.11>)
                                        >)
                                   >)
                              >))
    
     28. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = x.8
         z.1   = x.9^(~ltk.3*x.10*inv((~x.6*x.11)))
         z.2   = x.9^(x.10*inv(x.11))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8, x.9^(~ltk.3*x.10*inv((~x.6*x.11))), 
                                          x.9^(x.10*inv(x.11))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8, x.9^(~ltk.3*x.10*inv((~x.6*x.11))), 
                                              x.9^(x.10*inv(x.11))>)
                                        >)
                                   >)
                              >))
    
     29. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv((~x.6*x.9))
         pc    = x.10^x.11
         z     = x.8^inv(x.9)
         z.1   = x.10^(~ltk.3*x.11)
         z.2   = x.10^(~x.6*x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^inv(x.9), x.10^(~ltk.3*x.11), x.10^(~x.6*x.11)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^inv(x.9), x.10^(~ltk.3*x.11), x.10^(~x.6*x.11)>)>)
                                   >)
                              >))
    
     30. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv((~x.6*x.9))
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^inv(x.9)
         z.1   = x.10^(~ltk.3*inv((~x.6*x.11)))
         z.2   = x.10^inv(x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^inv(x.9), x.10^(~ltk.3*inv((~x.6*x.11))), 
                                          x.10^inv(x.11)>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^inv(x.9), x.10^(~ltk.3*inv((~x.6*x.11))), 
                                              x.10^inv(x.11)>)
                                        >)
                                   >)
                              >))
    
     31. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv((~x.6*x.9))
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^inv(x.9)
         z.1   = x.10^(~ltk.3*x.11*inv(~x.6))
         z.2   = x.10^x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^inv(x.9), x.10^(~ltk.3*x.11*inv(~x.6)), x.10^x.11>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^inv(x.9), x.10^(~ltk.3*x.11*inv(~x.6)), x.10^x.11
                                             >)
                                        >)
                                   >)
                              >))
    
     32. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^(x.9*inv(~x.6))
         pc    = x.10^x.11
         z     = x.8^x.9
         z.1   = x.10^(~ltk.3*x.11)
         z.2   = x.10^(~x.6*x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^x.9, x.10^(~ltk.3*x.11), x.10^(~x.6*x.11)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.8^x.9, x.10^(~ltk.3*x.11), x.10^(~x.6*x.11)>)
                                        >)
                                   >)
                              >))
    
     33. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^(x.9*inv(~x.6))
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^x.9
         z.1   = x.10^(~ltk.3*inv((~x.6*x.11)))
         z.2   = x.10^inv(x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^x.9, x.10^(~ltk.3*inv((~x.6*x.11))), x.10^inv(x.11)>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^x.9, x.10^(~ltk.3*inv((~x.6*x.11))), 
                                              x.10^inv(x.11)>)
                                        >)
                                   >)
                              >))
    
     34. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^(x.9*inv(~x.6))
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^x.9
         z.1   = x.10^(~ltk.3*x.11*inv(~x.6))
         z.2   = x.10^x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^x.9, x.10^(~ltk.3*x.11*inv(~x.6)), x.10^x.11>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^x.9, x.10^(~ltk.3*x.11*inv(~x.6)), x.10^x.11>)>)
                                   >)
                              >))
    
     35. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^(x.9*inv((~x.6*x.10)))
         pc    = x.11^inv(~x.6)
         z     = x.8^(x.9*inv(x.10))
         z.1   = x.11^(~ltk.3*inv(~x.6))
         z.2   = x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^(x.9*inv(x.10)), x.11^(~ltk.3*inv(~x.6)), x.11>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^(x.9*inv(x.10)), x.11^(~ltk.3*inv(~x.6)), x.11>)>)
                                   >)
                              >))
    
     36. ~ltk  = ~ltk.3
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^x.10
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^(~x.7*x.10)
         z.1   = x.11^(~ltk.3*x.12*inv((~x.7*x.13)))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(~x.7*x.10), x.11^(~ltk.3*x.12*inv((~x.7*x.13))), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(~x.7*x.10), x.11^(~ltk.3*x.12*inv((~x.7*x.13))), 
                                              x.11^(x.12*inv(x.13))>)
                                        >)
                                   >)
                              >))
    
     37. ~ltk  = ~ltk.3
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^inv(x.10)
         z.1   = x.11^(~ltk.3*x.12*inv((~x.7*x.13)))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^inv(x.10), x.11^(~ltk.3*x.12*inv((~x.7*x.13))), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^inv(x.10), x.11^(~ltk.3*x.12*inv((~x.7*x.13))), 
                                              x.11^(x.12*inv(x.13))>)
                                        >)
                                   >)
                              >))
    
     38. ~ltk  = ~ltk.3
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^x.10
         z.1   = x.11^(~ltk.3*x.12*inv((~x.7*x.13)))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^x.10, x.11^(~ltk.3*x.12*inv((~x.7*x.13))), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^x.10, x.11^(~ltk.3*x.12*inv((~x.7*x.13))), 
                                              x.11^(x.12*inv(x.13))>)
                                        >)
                                   >)
                              >))
    
     39. ~ltk  = ~ltk.3
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv((~x.7*x.11)))
         pc    = x.12^x.13
         z     = x.9^(x.10*inv(x.11))
         z.1   = x.12^(~ltk.3*x.13)
         z.2   = x.12^(~x.7*x.13)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(x.10*inv(x.11)), x.12^(~ltk.3*x.13), x.12^(~x.7*x.13)
                                         >)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(x.10*inv(x.11)), x.12^(~ltk.3*x.13), 
                                              x.12^(~x.7*x.13)>)
                                        >)
                                   >)
                              >))
    
     40. ~ltk  = ~ltk.3
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv((~x.7*x.11)))
         pc    = x.12^inv((~x.7*x.13))
         z     = x.9^(x.10*inv(x.11))
         z.1   = x.12^(~ltk.3*inv((~x.7*x.13)))
         z.2   = x.12^inv(x.13)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(x.10*inv(x.11)), x.12^(~ltk.3*inv((~x.7*x.13))), 
                                          x.12^inv(x.13)>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(x.10*inv(x.11)), x.12^(~ltk.3*inv((~x.7*x.13))), 
                                              x.12^inv(x.13)>)
                                        >)
                                   >)
                              >))
    
     41. ~ltk  = ~ltk.3
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv((~x.7*x.11)))
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.9^(x.10*inv(x.11))
         z.1   = x.12^(~ltk.3*x.13*inv(~x.7))
         z.2   = x.12^x.13
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(x.10*inv(x.11)), x.12^(~ltk.3*x.13*inv(~x.7)), 
                                          x.12^x.13>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(x.10*inv(x.11)), x.12^(~ltk.3*x.13*inv(~x.7)), 
                                              x.12^x.13>)
                                        >)
                                   >)
                              >))
    
     42. ~ltk  = ~ltk.3
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13^(~ltk.3*x.14*inv((~x.8*x.15)))
         z.2   = x.13^(x.14*inv(x.15))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), 
                                          x.13^(~ltk.3*x.14*inv((~x.8*x.15))), x.13^(x.14*inv(x.15))
                                         >)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(x.11*inv(x.12)), 
                                              x.13^(~ltk.3*x.14*inv((~x.8*x.15))), 
                                              x.13^(x.14*inv(x.15))>)
                                        >)
                                   >)
                              >))
    
     43. ~ltk  = ~x.3
         ~prek = ~x.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.5^inv(~x.3)
         z     = DH_neutral
         z.1   = x.5
         z.2   = x.5
         z.3   = sdec(enc.3,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, x.5, x.5>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, x.5, x.5>)>)>)>))
    
     44. ~ltk  = ~x.3
         ~prek = ~x.3
         enc   = senc(x.4,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, x.5, x.5>)>)>)>))
         ltpk  = DH_neutral
         pc    = x.5^inv(~x.3)
         z     = DH_neutral
         z.1   = x.5
         z.2   = x.5
         z.3   = x.4
         z.4   = true
    
     45. ~ltk  = ~x.4
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.7^inv(~x.4)
         z     = DH_neutral
         z.1   = x.7
         z.2   = x.7^(~prek.3*inv(~x.4))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.7, x.7^(~prek.3*inv(~x.4))>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<DH_neutral, x.7, x.7^(~prek.3*inv(~x.4))>)>)>)
                              >))
    
     46. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.7^inv(~x.4)
         z     = ltpk.3^~x.4
         z.1   = x.7
         z.2   = x.7
         z.3   = sdec(enc.3,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<ltpk.3^~x.4, x.7, x.7>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<ltpk.3^~x.4, x.7, x.7>)>)>)
                              >))
    
     47. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.6^inv((~x.4*x.7))
         z     = DH_neutral
         z.1   = x.6^inv(x.7)
         z.2   = x.6^inv(x.7)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.6^inv(x.7), x.6^inv(x.7)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<DH_neutral, x.6^inv(x.7), x.6^inv(x.7)>)>)>)
                              >))
    
     48. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.6^(x.7*inv(~x.4))
         z     = DH_neutral
         z.1   = x.6^x.7
         z.2   = x.6^x.7
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, x.6^x.7, x.6^x.7>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, x.6^x.7, x.6^x.7>)>)>)>))
    
     49. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = x.6^inv(~x.4)
         pc    = x.7^inv(~x.4)
         z     = x.6
         z.1   = x.7
         z.2   = x.7
         z.3   = sdec(enc.3,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.6, x.7, x.7>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.6, x.7, x.7>)>)>)>))
    
     50. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = senc(x.5,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.6, x.7, x.7>)>)>)>))
         ltpk  = x.6^inv(~x.4)
         pc    = x.7^inv(~x.4)
         z     = x.6
         z.1   = x.7
         z.2   = x.7
         z.3   = x.5
         z.4   = true
    
     51. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = senc(x.5,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, x.6^x.7, x.6^x.7>)>)>)>))
         ltpk  = DH_neutral
         pc    = x.6^(x.7*inv(~x.4))
         z     = DH_neutral
         z.1   = x.6^x.7
         z.2   = x.6^x.7
         z.3   = x.5
         z.4   = true
    
     52. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = senc(x.5,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.6^inv(x.7), x.6^inv(x.7)>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = x.6^inv((~x.4*x.7))
         z     = DH_neutral
         z.1   = x.6^inv(x.7)
         z.2   = x.6^inv(x.7)
         z.3   = x.5
         z.4   = true
    
     53. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = senc(x.5,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.6^~x.4, x.7, x.7>)>)>)>))
         ltpk  = x.6
         pc    = x.7^inv(~x.4)
         z     = x.6^~x.4
         z.1   = x.7
         z.2   = x.7
         z.3   = x.5
         z.4   = true
    
     54. ~ltk  = ~x.4
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.7^inv((~x.4*~x.5))
         z     = DH_neutral
         z.1   = x.7^inv(~x.5)
         z.2   = x.7^inv(~x.4)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.7^inv(~x.5), x.7^inv(~x.4)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<DH_neutral, x.7^inv(~x.5), x.7^inv(~x.4)>)>)>)
                              >))
    
     55. ~ltk  = ~x.4
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.7, x.7^(~x.5*inv(~x.4))>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = x.7^inv(~x.4)
         z     = DH_neutral
         z.1   = x.7
         z.2   = x.7^(~x.5*inv(~x.4))
         z.3   = x.6
         z.4   = true
    
     56. ~ltk  = ~x.4
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, x.7^~x.4, x.7^~x.5>)>)>)>))
         ltpk  = DH_neutral
         pc    = x.7
         z     = DH_neutral
         z.1   = x.7^~x.4
         z.2   = x.7^~x.5
         z.3   = x.6
         z.4   = true
    
     57. ~ltk  = ~x.4
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.7^inv(~x.5), x.7^inv(~x.4)>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = x.7^inv((~x.4*~x.5))
         z     = DH_neutral
         z.1   = x.7^inv(~x.5)
         z.2   = x.7^inv(~x.4)
         z.3   = x.6
         z.4   = true
    
     58. ~ltk  = ~x.4
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.7^(~x.4*inv(~x.5)), x.7>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = x.7^inv(~x.5)
         z     = DH_neutral
         z.1   = x.7^(~x.4*inv(~x.5))
         z.2   = x.7
         z.3   = x.6
         z.4   = true
    
     59. ~ltk  = ~x.5
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.9^inv(~x.5)
         z     = ltpk.3^~prek.3
         z.1   = x.9
         z.2   = x.9^(~prek.3*inv(~x.5))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<ltpk.3^~prek.3, x.9, x.9^(~prek.3*inv(~x.5))>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<ltpk.3^~prek.3, x.9, x.9^(~prek.3*inv(~x.5))>)>)
                                   >)
                              >))
    
     60. ~ltk  = ~x.5
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.8^inv((~x.5*x.9))
         z     = DH_neutral
         z.1   = x.8^inv(x.9)
         z.2   = x.8^(~prek.3*inv((~x.5*x.9)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.8^inv(x.9), x.8^(~prek.3*inv((~x.5*x.9)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.8^inv(x.9), 
                                              x.8^(~prek.3*inv((~x.5*x.9)))>)
                                        >)
                                   >)
                              >))
    
     61. ~ltk  = ~x.5
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.8^(x.9*inv(~x.5))
         z     = DH_neutral
         z.1   = x.8^x.9
         z.2   = x.8^(~prek.3*x.9*inv(~x.5))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.8^x.9, x.8^(~prek.3*x.9*inv(~x.5))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.8^x.9, x.8^(~prek.3*x.9*inv(~x.5))>)>)
                                   >)
                              >))
    
     62. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.8^inv((~x.5*x.9))
         z     = ltpk.3^~x.5
         z.1   = x.8^inv(x.9)
         z.2   = x.8^inv(x.9)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<ltpk.3^~x.5, x.8^inv(x.9), x.8^inv(x.9)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<ltpk.3^~x.5, x.8^inv(x.9), x.8^inv(x.9)>)>)>)
                              >))
    
     63. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.8^(x.9*inv(~x.5))
         z     = ltpk.3^~x.5
         z.1   = x.8^x.9
         z.2   = x.8^x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<ltpk.3^~x.5, x.8^x.9, x.8^x.9>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<ltpk.3^~x.5, x.8^x.9, x.8^x.9>)>)>)>))
    
     64. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.7^(x.8*inv((~x.5*x.9)))
         z     = DH_neutral
         z.1   = x.7^(x.8*inv(x.9))
         z.2   = x.7^(x.8*inv(x.9))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.7^(x.8*inv(x.9)), x.7^(x.8*inv(x.9))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.7^(x.8*inv(x.9)), x.7^(x.8*inv(x.9))>)>)
                                   >)
                              >))
    
     65. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^x.8
         pc    = x.9^inv(~x.5)
         z     = x.7^(~x.5*x.8)
         z.1   = x.9
         z.2   = x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.7^(~x.5*x.8), x.9, x.9>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.7^(~x.5*x.8), x.9, x.9>)>)>)>))
    
     66. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^inv(~x.5)
         pc    = x.8^inv((~x.5*x.9))
         z     = x.7
         z.1   = x.8^inv(x.9)
         z.2   = x.8^inv(x.9)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.7, x.8^inv(x.9), x.8^inv(x.9)>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.7, x.8^inv(x.9), x.8^inv(x.9)>)>)>)>))
    
     67. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^inv(~x.5)
         pc    = x.8^(x.9*inv(~x.5))
         z     = x.7
         z.1   = x.8^x.9
         z.2   = x.8^x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7, x.8^x.9, x.8^x.9>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7, x.8^x.9, x.8^x.9>)>)>)
                              >))
    
     68. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^inv((~x.5*x.8))
         pc    = x.9^inv(~x.5)
         z     = x.7^inv(x.8)
         z.1   = x.9
         z.2   = x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7^inv(x.8), x.9, x.9>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7^inv(x.8), x.9, x.9>)>)>)
                              >))
    
     69. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^(x.8*inv(~x.5))
         pc    = x.9^inv(~x.5)
         z     = x.7^x.8
         z.1   = x.9
         z.2   = x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7^x.8, x.9, x.9>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7^x.8, x.9, x.9>)>)>)>))
    
     70. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7, x.8^x.9, x.8^x.9>)>)>)
                          >))
         ltpk  = x.7^inv(~x.5)
         pc    = x.8^(x.9*inv(~x.5))
         z     = x.7
         z.1   = x.8^x.9
         z.2   = x.8^x.9
         z.3   = x.6
         z.4   = true
    
     71. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.7, x.8^inv(x.9), x.8^inv(x.9)>)>)>)>))
         ltpk  = x.7^inv(~x.5)
         pc    = x.8^inv((~x.5*x.9))
         z     = x.7
         z.1   = x.8^inv(x.9)
         z.2   = x.8^inv(x.9)
         z.3   = x.6
         z.4   = true
    
     72. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.7^(x.8*inv(x.9)), x.7^(x.8*inv(x.9))>)>)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.7^(x.8*inv((~x.5*x.9)))
         z     = DH_neutral
         z.1   = x.7^(x.8*inv(x.9))
         z.2   = x.7^(x.8*inv(x.9))
         z.3   = x.6
         z.4   = true
    
     73. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.7^~x.5, x.8^x.9, x.8^x.9>)>)>)>))
         ltpk  = x.7
         pc    = x.8^(x.9*inv(~x.5))
         z     = x.7^~x.5
         z.1   = x.8^x.9
         z.2   = x.8^x.9
         z.3   = x.6
         z.4   = true
    
     74. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.7^~x.5, x.8^inv(x.9), x.8^inv(x.9)>)>)
                               >)
                          >))
         ltpk  = x.7
         pc    = x.8^inv((~x.5*x.9))
         z     = x.7^~x.5
         z.1   = x.8^inv(x.9)
         z.2   = x.8^inv(x.9)
         z.3   = x.6
         z.4   = true
    
     75. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7^x.8, x.9, x.9>)>)>)>))
         ltpk  = x.7^(x.8*inv(~x.5))
         pc    = x.9^inv(~x.5)
         z     = x.7^x.8
         z.1   = x.9
         z.2   = x.9
         z.3   = x.6
         z.4   = true
    
     76. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7^inv(x.8), x.9, x.9>)>)>)
                          >))
         ltpk  = x.7^inv((~x.5*x.8))
         pc    = x.9^inv(~x.5)
         z     = x.7^inv(x.8)
         z.1   = x.9
         z.2   = x.9
         z.3   = x.6
         z.4   = true
    
     77. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.7^(~x.5*x.8), x.9, x.9>)>)>)>))
         ltpk  = x.7^x.8
         pc    = x.9^inv(~x.5)
         z     = x.7^(~x.5*x.8)
         z.1   = x.9
         z.2   = x.9
         z.3   = x.6
         z.4   = true
    
     78. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.9^inv((~x.5*~x.6))
         z     = ltpk.3^~x.6
         z.1   = x.9^inv(~x.6)
         z.2   = x.9^inv(~x.5)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<ltpk.3^~x.6, x.9^inv(~x.6), x.9^inv(~x.5)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<ltpk.3^~x.6, x.9^inv(~x.6), x.9^inv(~x.5)>)>)>)
                              >))
    
     79. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.8^inv((~x.5*~x.6*x.9))
         z     = DH_neutral
         z.1   = x.8^inv((~x.6*x.9))
         z.2   = x.8^inv((~x.5*x.9))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.8^inv((~x.6*x.9)), x.8^inv((~x.5*x.9))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.8^inv((~x.6*x.9)), x.8^inv((~x.5*x.9))>)
                                        >)
                                   >)
                              >))
    
     80. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.8^(x.9*inv((~x.5*~x.6)))
         z     = DH_neutral
         z.1   = x.8^(x.9*inv(~x.6))
         z.2   = x.8^(x.9*inv(~x.5))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.8^(x.9*inv(~x.6)), x.8^(x.9*inv(~x.5))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.8^(x.9*inv(~x.6)), x.8^(x.9*inv(~x.5))>)
                                        >)
                                   >)
                              >))
    
     81. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^inv(~x.5)
         z     = x.8
         z.1   = x.9
         z.2   = x.9^(~x.6*inv(~x.5))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9, x.9^(~x.6*inv(~x.5))>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9, x.9^(~x.6*inv(~x.5))>)>)>)>))
    
     82. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^inv((~x.5*~x.6))
         z     = x.8
         z.1   = x.9^inv(~x.6)
         z.2   = x.9^inv(~x.5)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9^inv(~x.6), x.9^inv(~x.5)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9^inv(~x.6), x.9^inv(~x.5)>)>)>)
                              >))
    
     83. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9, x.9^(~x.6*inv(~x.5))>)>)>)>))
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^inv(~x.5)
         z     = x.8
         z.1   = x.9
         z.2   = x.9^(~x.6*inv(~x.5))
         z.3   = x.7
         z.4   = true
    
     84. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9^~x.5, x.9^~x.6>)>)>)
                          >))
         ltpk  = x.8^inv(~x.6)
         pc    = x.9
         z     = x.8
         z.1   = x.9^~x.5
         z.2   = x.9^~x.6
         z.3   = x.7
         z.4   = true
    
     85. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9^inv(~x.6), x.9^inv(~x.5)>)>)>)
                          >))
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^inv((~x.5*~x.6))
         z     = x.8
         z.1   = x.9^inv(~x.6)
         z.2   = x.9^inv(~x.5)
         z.3   = x.7
         z.4   = true
    
     86. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9^(~x.5*inv(~x.6)), x.9>)>)>)>))
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^inv(~x.6)
         z     = x.8
         z.1   = x.9^(~x.5*inv(~x.6))
         z.2   = x.9
         z.3   = x.7
         z.4   = true
    
     87. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.8^x.9, x.8^(~x.6*x.9*inv(~x.5))>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = x.8^(x.9*inv(~x.5))
         z     = DH_neutral
         z.1   = x.8^x.9
         z.2   = x.8^(~x.6*x.9*inv(~x.5))
         z.3   = x.7
         z.4   = true
    
     88. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.8^inv(x.9), x.8^(~x.6*inv((~x.5*x.9)))>)>)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.8^inv((~x.5*x.9))
         z     = DH_neutral
         z.1   = x.8^inv(x.9)
         z.2   = x.8^(~x.6*inv((~x.5*x.9)))
         z.3   = x.7
         z.4   = true
    
     89. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.8^inv((~x.6*x.9)), x.8^inv((~x.5*x.9))>)>)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.8^inv((~x.5*~x.6*x.9))
         z     = DH_neutral
         z.1   = x.8^inv((~x.6*x.9))
         z.2   = x.8^inv((~x.5*x.9))
         z.3   = x.7
         z.4   = true
    
     90. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.8^(~x.5*x.9), x.8^(~x.6*x.9)>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = x.8^x.9
         z     = DH_neutral
         z.1   = x.8^(~x.5*x.9)
         z.2   = x.8^(~x.6*x.9)
         z.3   = x.7
         z.4   = true
    
     91. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.8^(~x.5*x.9*inv(~x.6)), x.8^x.9>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = x.8^(x.9*inv(~x.6))
         z     = DH_neutral
         z.1   = x.8^(~x.5*x.9*inv(~x.6))
         z.2   = x.8^x.9
         z.3   = x.7
         z.4   = true
    
     92. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.8^(~x.5*inv((~x.6*x.9))), x.8^inv(x.9)>)>)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.8^inv((~x.6*x.9))
         z     = DH_neutral
         z.1   = x.8^(~x.5*inv((~x.6*x.9)))
         z.2   = x.8^inv(x.9)
         z.3   = x.7
         z.4   = true
    
     93. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.8^(x.9*inv(~x.6)), x.8^(x.9*inv(~x.5))>)>)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.8^(x.9*inv((~x.5*~x.6)))
         z     = DH_neutral
         z.1   = x.8^(x.9*inv(~x.6))
         z.2   = x.8^(x.9*inv(~x.5))
         z.3   = x.7
         z.4   = true
    
     94. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^~x.6, x.9, x.9^(~x.6*inv(~x.5))>)>)
                               >)
                          >))
         ltpk  = x.8
         pc    = x.9^inv(~x.5)
         z     = x.8^~x.6
         z.1   = x.9
         z.2   = x.9^(~x.6*inv(~x.5))
         z.3   = x.7
         z.4   = true
    
     95. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^~x.6, x.9^~x.5, x.9^~x.6>)>)>)>))
         ltpk  = x.8
         pc    = x.9
         z     = x.8^~x.6
         z.1   = x.9^~x.5
         z.2   = x.9^~x.6
         z.3   = x.7
         z.4   = true
    
     96. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^~x.6, x.9^inv(~x.6), x.9^inv(~x.5)>)>)>)
                          >))
         ltpk  = x.8
         pc    = x.9^inv((~x.5*~x.6))
         z     = x.8^~x.6
         z.1   = x.9^inv(~x.6)
         z.2   = x.9^inv(~x.5)
         z.3   = x.7
         z.4   = true
    
     97. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^~x.6, x.9^(~x.5*inv(~x.6)), x.9>)>)
                               >)
                          >))
         ltpk  = x.8
         pc    = x.9^inv(~x.6)
         z     = x.8^~x.6
         z.1   = x.9^(~x.5*inv(~x.6))
         z.2   = x.9
         z.3   = x.7
         z.4   = true
    
     98. ~ltk  = ~x.6
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.10^inv((~x.6*x.11))
         z     = ltpk.3^~prek.3
         z.1   = x.10^inv(x.11)
         z.2   = x.10^(~prek.3*inv((~x.6*x.11)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~prek.3, x.10^inv(x.11), 
                                          x.10^(~prek.3*inv((~x.6*x.11)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~prek.3, x.10^inv(x.11), 
                                              x.10^(~prek.3*inv((~x.6*x.11)))>)
                                        >)
                                   >)
                              >))
    
     99. ~ltk  = ~x.6
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.10^(x.11*inv(~x.6))
         z     = ltpk.3^~prek.3
         z.1   = x.10^x.11
         z.2   = x.10^(~prek.3*x.11*inv(~x.6))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~prek.3, x.10^x.11, x.10^(~prek.3*x.11*inv(~x.6))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~prek.3, x.10^x.11, 
                                              x.10^(~prek.3*x.11*inv(~x.6))>)
                                        >)
                                   >)
                              >))
    
    100. ~ltk  = ~x.6
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = DH_neutral
         z.1   = x.9^(x.10*inv(x.11))
         z.2   = x.9^(~prek.3*x.10*inv((~x.6*x.11)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.9^(x.10*inv(x.11)), 
                                          x.9^(~prek.3*x.10*inv((~x.6*x.11)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.9^(x.10*inv(x.11)), 
                                              x.9^(~prek.3*x.10*inv((~x.6*x.11)))>)
                                        >)
                                   >)
                              >))
    
    101. ~ltk  = ~x.6
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = x.9^x.10
         pc    = x.11^inv(~x.6)
         z     = x.9^(~prek.3*x.10)
         z.1   = x.11
         z.2   = x.11^(~prek.3*inv(~x.6))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(~prek.3*x.10), x.11, x.11^(~prek.3*inv(~x.6))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(~prek.3*x.10), x.11, x.11^(~prek.3*inv(~x.6))>)>)
                                   >)
                              >))
    
    102. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = ltpk.3^~x.6
         z.1   = x.9^(x.10*inv(x.11))
         z.2   = x.9^(x.10*inv(x.11))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~x.6, x.9^(x.10*inv(x.11)), x.9^(x.10*inv(x.11))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~x.6, x.9^(x.10*inv(x.11)), 
                                              x.9^(x.10*inv(x.11))>)
                                        >)
                                   >)
                              >))
    
    103. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^x.9
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^(~x.6*x.9)
         z.1   = x.10^inv(x.11)
         z.2   = x.10^inv(x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^(~x.6*x.9), x.10^inv(x.11), x.10^inv(x.11)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.8^(~x.6*x.9), x.10^inv(x.11), x.10^inv(x.11)>)
                                        >)
                                   >)
                              >))
    
    104. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^x.9
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^(~x.6*x.9)
         z.1   = x.10^x.11
         z.2   = x.10^x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^(~x.6*x.9), x.10^x.11, x.10^x.11>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.8^(~x.6*x.9), x.10^x.11, x.10^x.11>)>)
                                   >)
                              >))
    
    105. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = x.8
         z.1   = x.9^(x.10*inv(x.11))
         z.2   = x.9^(x.10*inv(x.11))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8, x.9^(x.10*inv(x.11)), x.9^(x.10*inv(x.11))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8, x.9^(x.10*inv(x.11)), x.9^(x.10*inv(x.11))>)>)
                                   >)
                              >))
    
    106. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv((~x.6*x.9))
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^inv(x.9)
         z.1   = x.10^inv(x.11)
         z.2   = x.10^inv(x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^inv(x.9), x.10^inv(x.11), x.10^inv(x.11)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.8^inv(x.9), x.10^inv(x.11), x.10^inv(x.11)>)>)
                                   >)
                              >))
    
    107. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv((~x.6*x.9))
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^inv(x.9)
         z.1   = x.10^x.11
         z.2   = x.10^x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^inv(x.9), x.10^x.11, x.10^x.11>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.8^inv(x.9), x.10^x.11, x.10^x.11>)>)>)
                              >))
    
    108. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^(x.9*inv(~x.6))
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^x.9
         z.1   = x.10^inv(x.11)
         z.2   = x.10^inv(x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^x.9, x.10^inv(x.11), x.10^inv(x.11)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.8^x.9, x.10^inv(x.11), x.10^inv(x.11)>)>)>)
                              >))
    
    109. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^(x.9*inv(~x.6))
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^x.9
         z.1   = x.10^x.11
         z.2   = x.10^x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^x.9, x.10^x.11, x.10^x.11>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.8^x.9, x.10^x.11, x.10^x.11>)>)>)>))
    
    110. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^(x.9*inv((~x.6*x.10)))
         pc    = x.11^inv(~x.6)
         z     = x.8^(x.9*inv(x.10))
         z.1   = x.11
         z.2   = x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^(x.9*inv(x.10)), x.11, x.11>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.8^(x.9*inv(x.10)), x.11, x.11>)>)>)>))
    
    111. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8, x.9^(x.10*inv(x.11)), x.9^(x.10*inv(x.11))>)>)
                               >)
                          >))
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = x.8
         z.1   = x.9^(x.10*inv(x.11))
         z.2   = x.9^(x.10*inv(x.11))
         z.3   = x.7
         z.4   = true
    
    112. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^~x.6, x.9^(x.10*inv(x.11)), x.9^(x.10*inv(x.11))>)>)
                               >)
                          >))
         ltpk  = x.8
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = x.8^~x.6
         z.1   = x.9^(x.10*inv(x.11))
         z.2   = x.9^(x.10*inv(x.11))
         z.3   = x.7
         z.4   = true
    
    113. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^x.9, x.10^x.11, x.10^x.11>)>)>)>))
         ltpk  = x.8^(x.9*inv(~x.6))
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^x.9
         z.1   = x.10^x.11
         z.2   = x.10^x.11
         z.3   = x.7
         z.4   = true
    
    114. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^x.9, x.10^inv(x.11), x.10^inv(x.11)>)>)>)
                          >))
         ltpk  = x.8^(x.9*inv(~x.6))
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^x.9
         z.1   = x.10^inv(x.11)
         z.2   = x.10^inv(x.11)
         z.3   = x.7
         z.4   = true
    
    115. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^inv(x.9), x.10^x.11, x.10^x.11>)>)>)
                          >))
         ltpk  = x.8^inv((~x.6*x.9))
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^inv(x.9)
         z.1   = x.10^x.11
         z.2   = x.10^x.11
         z.3   = x.7
         z.4   = true
    
    116. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^inv(x.9), x.10^inv(x.11), x.10^inv(x.11)>)>)>)
                          >))
         ltpk  = x.8^inv((~x.6*x.9))
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^inv(x.9)
         z.1   = x.10^inv(x.11)
         z.2   = x.10^inv(x.11)
         z.3   = x.7
         z.4   = true
    
    117. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^(~x.6*x.9), x.10^x.11, x.10^x.11>)>)
                               >)
                          >))
         ltpk  = x.8^x.9
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^(~x.6*x.9)
         z.1   = x.10^x.11
         z.2   = x.10^x.11
         z.3   = x.7
         z.4   = true
    
    118. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^(~x.6*x.9), x.10^inv(x.11), x.10^inv(x.11)>)>)
                               >)
                          >))
         ltpk  = x.8^x.9
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^(~x.6*x.9)
         z.1   = x.10^inv(x.11)
         z.2   = x.10^inv(x.11)
         z.3   = x.7
         z.4   = true
    
    119. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^(x.9*inv(x.10)), x.11, x.11>)>)>)>))
         ltpk  = x.8^(x.9*inv((~x.6*x.10)))
         pc    = x.11^inv(~x.6)
         z     = x.8^(x.9*inv(x.10))
         z.1   = x.11
         z.2   = x.11
         z.3   = x.7
         z.4   = true
    
    120. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.10^inv((~x.6*~x.7*x.11))
         z     = ltpk.3^~x.7
         z.1   = x.10^inv((~x.7*x.11))
         z.2   = x.10^inv((~x.6*x.11))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~x.7, x.10^inv((~x.7*x.11)), x.10^inv((~x.6*x.11))
                                         >)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~x.7, x.10^inv((~x.7*x.11)), 
                                              x.10^inv((~x.6*x.11))>)
                                        >)
                                   >)
                              >))
    
    121. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.10^(x.11*inv((~x.6*~x.7)))
         z     = ltpk.3^~x.7
         z.1   = x.10^(x.11*inv(~x.7))
         z.2   = x.10^(x.11*inv(~x.6))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~x.7, x.10^(x.11*inv(~x.7)), x.10^(x.11*inv(~x.6))
                                         >)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~x.7, x.10^(x.11*inv(~x.7)), 
                                              x.10^(x.11*inv(~x.6))>)
                                        >)
                                   >)
                              >))
    
    122. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.9^(x.10*inv((~x.6*~x.7*x.11)))
         z     = DH_neutral
         z.1   = x.9^(x.10*inv((~x.7*x.11)))
         z.2   = x.9^(x.10*inv((~x.6*x.11)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.9^(x.10*inv((~x.7*x.11))), 
                                          x.9^(x.10*inv((~x.6*x.11)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.9^(x.10*inv((~x.7*x.11))), 
                                              x.9^(x.10*inv((~x.6*x.11)))>)
                                        >)
                                   >)
                              >))
    
    123. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^x.10
         pc    = x.11^inv((~x.6*~x.7))
         z     = x.9^(~x.7*x.10)
         z.1   = x.11^inv(~x.7)
         z.2   = x.11^inv(~x.6)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^(~x.7*x.10), x.11^inv(~x.7), x.11^inv(~x.6)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(~x.7*x.10), x.11^inv(~x.7), x.11^inv(~x.6)>)>)
                                   >)
                              >))
    
    124. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^inv((~x.6*~x.7*x.11))
         z     = x.9
         z.1   = x.10^inv((~x.7*x.11))
         z.2   = x.10^inv((~x.6*x.11))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^inv((~x.7*x.11)), x.10^inv((~x.6*x.11))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9, x.10^inv((~x.7*x.11)), x.10^inv((~x.6*x.11))>)>)
                                   >)
                              >))
    
    125. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^inv((~x.6*x.11))
         z     = x.9
         z.1   = x.10^inv(x.11)
         z.2   = x.10^(~x.7*inv((~x.6*x.11)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^inv(x.11), x.10^(~x.7*inv((~x.6*x.11)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9, x.10^inv(x.11), x.10^(~x.7*inv((~x.6*x.11)))>)>)
                                   >)
                              >))
    
    126. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.9
         z.1   = x.10^x.11
         z.2   = x.10^(~x.7*x.11*inv(~x.6))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^x.11, x.10^(~x.7*x.11*inv(~x.6))>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.9, x.10^x.11, x.10^(~x.7*x.11*inv(~x.6))>)>)>)
                              >))
    
    127. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^(x.11*inv((~x.6*~x.7)))
         z     = x.9
         z.1   = x.10^(x.11*inv(~x.7))
         z.2   = x.10^(x.11*inv(~x.6))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^(x.11*inv(~x.7)), x.10^(x.11*inv(~x.6))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9, x.10^(x.11*inv(~x.7)), x.10^(x.11*inv(~x.6))>)>)
                                   >)
                              >))
    
    128. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^inv(~x.6)
         z     = x.9^inv(x.10)
         z.1   = x.11
         z.2   = x.11^(~x.7*inv(~x.6))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^inv(x.10), x.11, x.11^(~x.7*inv(~x.6))>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.9^inv(x.10), x.11, x.11^(~x.7*inv(~x.6))>)>)>)
                              >))
    
    129. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^inv((~x.6*~x.7))
         z     = x.9^inv(x.10)
         z.1   = x.11^inv(~x.7)
         z.2   = x.11^inv(~x.6)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^inv(x.10), x.11^inv(~x.7), x.11^inv(~x.6)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.9^inv(x.10), x.11^inv(~x.7), x.11^inv(~x.6)>)
                                        >)
                                   >)
                              >))
    
    130. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^inv(~x.6)
         z     = x.9^x.10
         z.1   = x.11
         z.2   = x.11^(~x.7*inv(~x.6))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^x.10, x.11, x.11^(~x.7*inv(~x.6))>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.9^x.10, x.11, x.11^(~x.7*inv(~x.6))>)>)>)
                              >))
    
    131. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^inv((~x.6*~x.7))
         z     = x.9^x.10
         z.1   = x.11^inv(~x.7)
         z.2   = x.11^inv(~x.6)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^x.10, x.11^inv(~x.7), x.11^inv(~x.6)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.9^x.10, x.11^inv(~x.7), x.11^inv(~x.6)>)>)>)
                              >))
    
    132. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^x.11, x.10^(~x.7*x.11*inv(~x.6))>)>)>)
                          >))
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.9
         z.1   = x.10^x.11
         z.2   = x.10^(~x.7*x.11*inv(~x.6))
         z.3   = x.8
         z.4   = true
    
    133. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^inv(x.11), x.10^(~x.7*inv((~x.6*x.11)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^inv((~x.6*x.11))
         z     = x.9
         z.1   = x.10^inv(x.11)
         z.2   = x.10^(~x.7*inv((~x.6*x.11)))
         z.3   = x.8
         z.4   = true
    
    134. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^inv((~x.7*x.11)), x.10^inv((~x.6*x.11))>)
                                    >)
                               >)
                          >))
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^inv((~x.6*~x.7*x.11))
         z     = x.9
         z.1   = x.10^inv((~x.7*x.11))
         z.2   = x.10^inv((~x.6*x.11))
         z.3   = x.8
         z.4   = true
    
    135. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^(~x.6*x.11), x.10^(~x.7*x.11)>)>)>)
                          >))
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^x.11
         z     = x.9
         z.1   = x.10^(~x.6*x.11)
         z.2   = x.10^(~x.7*x.11)
         z.3   = x.8
         z.4   = true
    
    136. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^(~x.6*x.11*inv(~x.7)), x.10^x.11>)>)>)
                          >))
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^(x.11*inv(~x.7))
         z     = x.9
         z.1   = x.10^(~x.6*x.11*inv(~x.7))
         z.2   = x.10^x.11
         z.3   = x.8
         z.4   = true
    
    137. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^(~x.6*inv((~x.7*x.11))), x.10^inv(x.11)>)
                                    >)
                               >)
                          >))
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^inv((~x.7*x.11))
         z     = x.9
         z.1   = x.10^(~x.6*inv((~x.7*x.11)))
         z.2   = x.10^inv(x.11)
         z.3   = x.8
         z.4   = true
    
    138. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^(x.11*inv(~x.7)), x.10^(x.11*inv(~x.6))>)
                                    >)
                               >)
                          >))
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^(x.11*inv((~x.6*~x.7)))
         z     = x.9
         z.1   = x.10^(x.11*inv(~x.7))
         z.2   = x.10^(x.11*inv(~x.6))
         z.3   = x.8
         z.4   = true
    
    139. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.9^(~x.6*x.10*inv((~x.7*x.11))), 
                                          x.9^(x.10*inv(x.11))>)
                                    >)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.9^(x.10*inv((~x.7*x.11)))
         z     = DH_neutral
         z.1   = x.9^(~x.6*x.10*inv((~x.7*x.11)))
         z.2   = x.9^(x.10*inv(x.11))
         z.3   = x.8
         z.4   = true
    
    140. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.9^(x.10*inv(x.11)), 
                                          x.9^(~x.7*x.10*inv((~x.6*x.11)))>)
                                    >)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = DH_neutral
         z.1   = x.9^(x.10*inv(x.11))
         z.2   = x.9^(~x.7*x.10*inv((~x.6*x.11)))
         z.3   = x.8
         z.4   = true
    
    141. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.9^(x.10*inv((~x.7*x.11))), 
                                          x.9^(x.10*inv((~x.6*x.11)))>)
                                    >)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.9^(x.10*inv((~x.6*~x.7*x.11)))
         z     = DH_neutral
         z.1   = x.9^(x.10*inv((~x.7*x.11)))
         z.2   = x.9^(x.10*inv((~x.6*x.11)))
         z.3   = x.8
         z.4   = true
    
    142. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^~x.7, x.10^x.11, x.10^(~x.7*x.11*inv(~x.6))>)>)
                               >)
                          >))
         ltpk  = x.9
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.9^~x.7
         z.1   = x.10^x.11
         z.2   = x.10^(~x.7*x.11*inv(~x.6))
         z.3   = x.8
         z.4   = true
    
    143. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^~x.7, x.10^inv(x.11), x.10^(~x.7*inv((~x.6*x.11)))>)>)
                               >)
                          >))
         ltpk  = x.9
         pc    = x.10^inv((~x.6*x.11))
         z     = x.9^~x.7
         z.1   = x.10^inv(x.11)
         z.2   = x.10^(~x.7*inv((~x.6*x.11)))
         z.3   = x.8
         z.4   = true
    
    144. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^~x.7, x.10^inv((~x.7*x.11)), x.10^inv((~x.6*x.11))>)>)
                               >)
                          >))
         ltpk  = x.9
         pc    = x.10^inv((~x.6*~x.7*x.11))
         z     = x.9^~x.7
         z.1   = x.10^inv((~x.7*x.11))
         z.2   = x.10^inv((~x.6*x.11))
         z.3   = x.8
         z.4   = true
    
    145. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^~x.7, x.10^(~x.6*x.11), x.10^(~x.7*x.11)>)>)>)
                          >))
         ltpk  = x.9
         pc    = x.10^x.11
         z     = x.9^~x.7
         z.1   = x.10^(~x.6*x.11)
         z.2   = x.10^(~x.7*x.11)
         z.3   = x.8
         z.4   = true
    
    146. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^~x.7, x.10^(~x.6*x.11*inv(~x.7)), x.10^x.11>)>)
                               >)
                          >))
         ltpk  = x.9
         pc    = x.10^(x.11*inv(~x.7))
         z     = x.9^~x.7
         z.1   = x.10^(~x.6*x.11*inv(~x.7))
         z.2   = x.10^x.11
         z.3   = x.8
         z.4   = true
    
    147. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^~x.7, x.10^(~x.6*inv((~x.7*x.11))), x.10^inv(x.11)>)>)
                               >)
                          >))
         ltpk  = x.9
         pc    = x.10^inv((~x.7*x.11))
         z     = x.9^~x.7
         z.1   = x.10^(~x.6*inv((~x.7*x.11)))
         z.2   = x.10^inv(x.11)
         z.3   = x.8
         z.4   = true
    
    148. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^~x.7, x.10^(x.11*inv(~x.7)), x.10^(x.11*inv(~x.6))>)>)
                               >)
                          >))
         ltpk  = x.9
         pc    = x.10^(x.11*inv((~x.6*~x.7)))
         z     = x.9^~x.7
         z.1   = x.10^(x.11*inv(~x.7))
         z.2   = x.10^(x.11*inv(~x.6))
         z.3   = x.8
         z.4   = true
    
    149. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^x.10, x.11, x.11^(~x.7*inv(~x.6))>)>)>)
                          >))
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^inv(~x.6)
         z     = x.9^x.10
         z.1   = x.11
         z.2   = x.11^(~x.7*inv(~x.6))
         z.3   = x.8
         z.4   = true
    
    150. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.9^x.10, x.11^~x.6, x.11^~x.7>)>)>)>))
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11
         z     = x.9^x.10
         z.1   = x.11^~x.6
         z.2   = x.11^~x.7
         z.3   = x.8
         z.4   = true
    
    151. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^x.10, x.11^inv(~x.7), x.11^inv(~x.6)>)>)>)
                          >))
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^inv((~x.6*~x.7))
         z     = x.9^x.10
         z.1   = x.11^inv(~x.7)
         z.2   = x.11^inv(~x.6)
         z.3   = x.8
         z.4   = true
    
    152. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^x.10, x.11^(~x.6*inv(~x.7)), x.11>)>)>)
                          >))
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^inv(~x.7)
         z     = x.9^x.10
         z.1   = x.11^(~x.6*inv(~x.7))
         z.2   = x.11
         z.3   = x.8
         z.4   = true
    
    153. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^inv(x.10), x.11, x.11^(~x.7*inv(~x.6))>)>)>)
                          >))
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^inv(~x.6)
         z     = x.9^inv(x.10)
         z.1   = x.11
         z.2   = x.11^(~x.7*inv(~x.6))
         z.3   = x.8
         z.4   = true
    
    154. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.9^inv(x.10), x.11^~x.6, x.11^~x.7>)>)
                               >)
                          >))
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11
         z     = x.9^inv(x.10)
         z.1   = x.11^~x.6
         z.2   = x.11^~x.7
         z.3   = x.8
         z.4   = true
    
    155. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^inv(x.10), x.11^inv(~x.7), x.11^inv(~x.6)>)>)>)
                          >))
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^inv((~x.6*~x.7))
         z     = x.9^inv(x.10)
         z.1   = x.11^inv(~x.7)
         z.2   = x.11^inv(~x.6)
         z.3   = x.8
         z.4   = true
    
    156. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^inv(x.10), x.11^(~x.6*inv(~x.7)), x.11>)>)>)
                          >))
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^inv(~x.7)
         z     = x.9^inv(x.10)
         z.1   = x.11^(~x.6*inv(~x.7))
         z.2   = x.11
         z.3   = x.8
         z.4   = true
    
    157. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^(~x.7*x.10), x.11, x.11^(~x.7*inv(~x.6))>)>)>)
                          >))
         ltpk  = x.9^x.10
         pc    = x.11^inv(~x.6)
         z     = x.9^(~x.7*x.10)
         z.1   = x.11
         z.2   = x.11^(~x.7*inv(~x.6))
         z.3   = x.8
         z.4   = true
    
    158. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^(~x.7*x.10), x.11^~x.6, x.11^~x.7>)>)>)
                          >))
         ltpk  = x.9^x.10
         pc    = x.11
         z     = x.9^(~x.7*x.10)
         z.1   = x.11^~x.6
         z.2   = x.11^~x.7
         z.3   = x.8
         z.4   = true
    
    159. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^(~x.7*x.10), x.11^inv(~x.7), x.11^inv(~x.6)>)>)
                               >)
                          >))
         ltpk  = x.9^x.10
         pc    = x.11^inv((~x.6*~x.7))
         z     = x.9^(~x.7*x.10)
         z.1   = x.11^inv(~x.7)
         z.2   = x.11^inv(~x.6)
         z.3   = x.8
         z.4   = true
    
    160. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^(~x.7*x.10), x.11^(~x.6*inv(~x.7)), x.11>)>)>)
                          >))
         ltpk  = x.9^x.10
         pc    = x.11^inv(~x.7)
         z     = x.9^(~x.7*x.10)
         z.1   = x.11^(~x.6*inv(~x.7))
         z.2   = x.11
         z.3   = x.8
         z.4   = true
    
    161. ~ltk  = ~x.7
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = ltpk.3^~prek.3
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(~prek.3*x.12*inv((~x.7*x.13)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~prek.3, x.11^(x.12*inv(x.13)), 
                                          x.11^(~prek.3*x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~prek.3, x.11^(x.12*inv(x.13)), 
                                              x.11^(~prek.3*x.12*inv((~x.7*x.13)))>)
                                        >)
                                   >)
                              >))
    
    162. ~ltk  = ~x.7
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = x.10^x.11
         pc    = x.12^inv((~x.7*x.13))
         z     = x.10^(~prek.3*x.11)
         z.1   = x.12^inv(x.13)
         z.2   = x.12^(~prek.3*inv((~x.7*x.13)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~prek.3*x.11), x.12^inv(x.13), 
                                          x.12^(~prek.3*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(~prek.3*x.11), x.12^inv(x.13), 
                                              x.12^(~prek.3*inv((~x.7*x.13)))>)
                                        >)
                                   >)
                              >))
    
    163. ~ltk  = ~x.7
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = x.10^x.11
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.10^(~prek.3*x.11)
         z.1   = x.12^x.13
         z.2   = x.12^(~prek.3*x.13*inv(~x.7))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~prek.3*x.11), x.12^x.13, 
                                          x.12^(~prek.3*x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(~prek.3*x.11), x.12^x.13, 
                                              x.12^(~prek.3*x.13*inv(~x.7))>)
                                        >)
                                   >)
                              >))
    
    164. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^x.10
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^(~x.7*x.10)
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(~x.7*x.10), x.11^(x.12*inv(x.13)), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(~x.7*x.10), x.11^(x.12*inv(x.13)), 
                                              x.11^(x.12*inv(x.13))>)
                                        >)
                                   >)
                              >))
    
    165. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^inv(x.10)
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^inv(x.10), x.11^(x.12*inv(x.13)), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^inv(x.10), x.11^(x.12*inv(x.13)), 
                                              x.11^(x.12*inv(x.13))>)
                                        >)
                                   >)
                              >))
    
    166. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^x.10
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^x.10, x.11^(x.12*inv(x.13)), x.11^(x.12*inv(x.13))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^x.10, x.11^(x.12*inv(x.13)), x.11^(x.12*inv(x.13))
                                             >)
                                        >)
                                   >)
                              >))
    
    167. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv((~x.7*x.11)))
         pc    = x.12^inv((~x.7*x.13))
         z     = x.9^(x.10*inv(x.11))
         z.1   = x.12^inv(x.13)
         z.2   = x.12^inv(x.13)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(x.10*inv(x.11)), x.12^inv(x.13), x.12^inv(x.13)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(x.10*inv(x.11)), x.12^inv(x.13), x.12^inv(x.13)>)
                                        >)
                                   >)
                              >))
    
    168. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv((~x.7*x.11)))
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.9^(x.10*inv(x.11))
         z.1   = x.12^x.13
         z.2   = x.12^x.13
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^(x.10*inv(x.11)), x.12^x.13, x.12^x.13>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.9^(x.10*inv(x.11)), x.12^x.13, x.12^x.13>)>)>)
                              >))
    
    169. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^x.10, x.11^(x.12*inv(x.13)), x.11^(x.12*inv(x.13))>)>)
                               >)
                          >))
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^x.10
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = x.8
         z.4   = true
    
    170. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^inv(x.10), x.11^(x.12*inv(x.13)), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^inv(x.10)
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = x.8
         z.4   = true
    
    171. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(~x.7*x.10), x.11^(x.12*inv(x.13)), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         ltpk  = x.9^x.10
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^(~x.7*x.10)
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = x.8
         z.4   = true
    
    172. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^(x.10*inv(x.11)), x.12^x.13, x.12^x.13>)>)>)
                          >))
         ltpk  = x.9^(x.10*inv((~x.7*x.11)))
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.9^(x.10*inv(x.11))
         z.1   = x.12^x.13
         z.2   = x.12^x.13
         z.3   = x.8
         z.4   = true
    
    173. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(x.10*inv(x.11)), x.12^inv(x.13), x.12^inv(x.13)>)>)
                               >)
                          >))
         ltpk  = x.9^(x.10*inv((~x.7*x.11)))
         pc    = x.12^inv((~x.7*x.13))
         z     = x.9^(x.10*inv(x.11))
         z.1   = x.12^inv(x.13)
         z.2   = x.12^inv(x.13)
         z.3   = x.8
         z.4   = true
    
    174. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.11^(x.12*inv((~x.7*~x.8*x.13)))
         z     = ltpk.3^~x.8
         z.1   = x.11^(x.12*inv((~x.8*x.13)))
         z.2   = x.11^(x.12*inv((~x.7*x.13)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~x.8, x.11^(x.12*inv((~x.8*x.13))), 
                                          x.11^(x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~x.8, x.11^(x.12*inv((~x.8*x.13))), 
                                              x.11^(x.12*inv((~x.7*x.13)))>)
                                        >)
                                   >)
                              >))
    
    175. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^x.11
         pc    = x.12^inv((~x.7*~x.8*x.13))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^inv((~x.8*x.13))
         z.2   = x.12^inv((~x.7*x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^inv((~x.8*x.13)), 
                                          x.12^inv((~x.7*x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(~x.8*x.11), x.12^inv((~x.8*x.13)), 
                                              x.12^inv((~x.7*x.13))>)
                                        >)
                                   >)
                              >))
    
    176. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^x.11
         pc    = x.12^(x.13*inv((~x.7*~x.8)))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^(x.13*inv(~x.8))
         z.2   = x.12^(x.13*inv(~x.7))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^(x.13*inv(~x.8)), 
                                          x.12^(x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(~x.8*x.11), x.12^(x.13*inv(~x.8)), 
                                              x.12^(x.13*inv(~x.7))>)
                                        >)
                                   >)
                              >))
    
    177. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^inv(~x.8)
         pc    = x.11^(x.12*inv((~x.7*~x.8*x.13)))
         z     = x.10
         z.1   = x.11^(x.12*inv((~x.8*x.13)))
         z.2   = x.11^(x.12*inv((~x.7*x.13)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10, x.11^(x.12*inv((~x.8*x.13))), 
                                          x.11^(x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10, x.11^(x.12*inv((~x.8*x.13))), 
                                              x.11^(x.12*inv((~x.7*x.13)))>)
                                        >)
                                   >)
                              >))
    
    178. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^inv(~x.8)
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.10
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(~x.8*x.12*inv((~x.7*x.13)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10, x.11^(x.12*inv(x.13)), 
                                          x.11^(~x.8*x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10, x.11^(x.12*inv(x.13)), 
                                              x.11^(~x.8*x.12*inv((~x.7*x.13)))>)
                                        >)
                                   >)
                              >))
    
    179. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^inv((~x.7*~x.8*x.13))
         z     = x.10^inv(x.11)
         z.1   = x.12^inv((~x.8*x.13))
         z.2   = x.12^inv((~x.7*x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^inv((~x.8*x.13)), 
                                          x.12^inv((~x.7*x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^inv(x.11), x.12^inv((~x.8*x.13)), 
                                              x.12^inv((~x.7*x.13))>)
                                        >)
                                   >)
                              >))
    
    180. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^inv((~x.7*x.13))
         z     = x.10^inv(x.11)
         z.1   = x.12^inv(x.13)
         z.2   = x.12^(~x.8*inv((~x.7*x.13)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^inv(x.13), 
                                          x.12^(~x.8*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^inv(x.11), x.12^inv(x.13), 
                                              x.12^(~x.8*inv((~x.7*x.13)))>)
                                        >)
                                   >)
                              >))
    
    181. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.10^inv(x.11)
         z.1   = x.12^x.13
         z.2   = x.12^(~x.8*x.13*inv(~x.7))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^x.13, x.12^(~x.8*x.13*inv(~x.7))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^inv(x.11), x.12^x.13, x.12^(~x.8*x.13*inv(~x.7))
                                             >)
                                        >)
                                   >)
                              >))
    
    182. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^(x.13*inv((~x.7*~x.8)))
         z     = x.10^inv(x.11)
         z.1   = x.12^(x.13*inv(~x.8))
         z.2   = x.12^(x.13*inv(~x.7))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^(x.13*inv(~x.8)), 
                                          x.12^(x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^inv(x.11), x.12^(x.13*inv(~x.8)), 
                                              x.12^(x.13*inv(~x.7))>)
                                        >)
                                   >)
                              >))
    
    183. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^inv((~x.7*~x.8*x.13))
         z     = x.10^x.11
         z.1   = x.12^inv((~x.8*x.13))
         z.2   = x.12^inv((~x.7*x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^x.11, x.12^inv((~x.8*x.13)), x.12^inv((~x.7*x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^x.11, x.12^inv((~x.8*x.13)), 
                                              x.12^inv((~x.7*x.13))>)
                                        >)
                                   >)
                              >))
    
    184. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^inv((~x.7*x.13))
         z     = x.10^x.11
         z.1   = x.12^inv(x.13)
         z.2   = x.12^(~x.8*inv((~x.7*x.13)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^x.11, x.12^inv(x.13), x.12^(~x.8*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^x.11, x.12^inv(x.13), 
                                              x.12^(~x.8*inv((~x.7*x.13)))>)
                                        >)
                                   >)
                              >))
    
    185. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.10^x.11
         z.1   = x.12^x.13
         z.2   = x.12^(~x.8*x.13*inv(~x.7))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.10^x.11, x.12^x.13, x.12^(~x.8*x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^x.11, x.12^x.13, x.12^(~x.8*x.13*inv(~x.7))>)>)
                                   >)
                              >))
    
    186. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^(x.13*inv((~x.7*~x.8)))
         z     = x.10^x.11
         z.1   = x.12^(x.13*inv(~x.8))
         z.2   = x.12^(x.13*inv(~x.7))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^x.11, x.12^(x.13*inv(~x.8)), x.12^(x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^x.11, x.12^(x.13*inv(~x.8)), 
                                              x.12^(x.13*inv(~x.7))>)
                                        >)
                                   >)
                              >))
    
    187. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^inv(~x.7)
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13
         z.2   = x.13^(~x.8*inv(~x.7))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), x.13, x.13^(~x.8*inv(~x.7))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(x.11*inv(x.12)), x.13, x.13^(~x.8*inv(~x.7))>)>)
                                   >)
                              >))
    
    188. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^inv((~x.7*~x.8))
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13^inv(~x.8)
         z.2   = x.13^inv(~x.7)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), x.13^inv(~x.8), x.13^inv(~x.7)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(x.11*inv(x.12)), x.13^inv(~x.8), x.13^inv(~x.7)
                                             >)
                                        >)
                                   >)
                              >))
    
    189. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10, x.11^(~x.7*x.12*inv((~x.8*x.13))), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^inv(~x.8)
         pc    = x.11^(x.12*inv((~x.8*x.13)))
         z     = x.10
         z.1   = x.11^(~x.7*x.12*inv((~x.8*x.13)))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = x.9
         z.4   = true
    
    190. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10, x.11^(x.12*inv(x.13)), 
                                          x.11^(~x.8*x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^inv(~x.8)
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.10
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(~x.8*x.12*inv((~x.7*x.13)))
         z.3   = x.9
         z.4   = true
    
    191. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10, x.11^(x.12*inv((~x.8*x.13))), 
                                          x.11^(x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^inv(~x.8)
         pc    = x.11^(x.12*inv((~x.7*~x.8*x.13)))
         z     = x.10
         z.1   = x.11^(x.12*inv((~x.8*x.13)))
         z.2   = x.11^(x.12*inv((~x.7*x.13)))
         z.3   = x.9
         z.4   = true
    
    192. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^~x.8, x.11^(~x.7*x.12*inv((~x.8*x.13))), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10
         pc    = x.11^(x.12*inv((~x.8*x.13)))
         z     = x.10^~x.8
         z.1   = x.11^(~x.7*x.12*inv((~x.8*x.13)))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = x.9
         z.4   = true
    
    193. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^~x.8, x.11^(x.12*inv(x.13)), 
                                          x.11^(~x.8*x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.10^~x.8
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(~x.8*x.12*inv((~x.7*x.13)))
         z.3   = x.9
         z.4   = true
    
    194. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^~x.8, x.11^(x.12*inv((~x.8*x.13))), 
                                          x.11^(x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10
         pc    = x.11^(x.12*inv((~x.7*~x.8*x.13)))
         z     = x.10^~x.8
         z.1   = x.11^(x.12*inv((~x.8*x.13)))
         z.2   = x.11^(x.12*inv((~x.7*x.13)))
         z.3   = x.9
         z.4   = true
    
    195. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.10^x.11, x.12^x.13, x.12^(~x.8*x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.10^x.11
         z.1   = x.12^x.13
         z.2   = x.12^(~x.8*x.13*inv(~x.7))
         z.3   = x.9
         z.4   = true
    
    196. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^x.11, x.12^inv(x.13), x.12^(~x.8*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^inv((~x.7*x.13))
         z     = x.10^x.11
         z.1   = x.12^inv(x.13)
         z.2   = x.12^(~x.8*inv((~x.7*x.13)))
         z.3   = x.9
         z.4   = true
    
    197. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^x.11, x.12^inv((~x.8*x.13)), x.12^inv((~x.7*x.13))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^inv((~x.7*~x.8*x.13))
         z     = x.10^x.11
         z.1   = x.12^inv((~x.8*x.13))
         z.2   = x.12^inv((~x.7*x.13))
         z.3   = x.9
         z.4   = true
    
    198. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.10^x.11, x.12^(~x.7*x.13), x.12^(~x.8*x.13)>)>)>)
                          >))
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^x.13
         z     = x.10^x.11
         z.1   = x.12^(~x.7*x.13)
         z.2   = x.12^(~x.8*x.13)
         z.3   = x.9
         z.4   = true
    
    199. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.10^x.11, x.12^(~x.7*x.13*inv(~x.8)), x.12^x.13>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^(x.13*inv(~x.8))
         z     = x.10^x.11
         z.1   = x.12^(~x.7*x.13*inv(~x.8))
         z.2   = x.12^x.13
         z.3   = x.9
         z.4   = true
    
    200. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^x.11, x.12^(~x.7*inv((~x.8*x.13))), x.12^inv(x.13)>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^inv((~x.8*x.13))
         z     = x.10^x.11
         z.1   = x.12^(~x.7*inv((~x.8*x.13)))
         z.2   = x.12^inv(x.13)
         z.3   = x.9
         z.4   = true
    
    201. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^x.11, x.12^(x.13*inv(~x.8)), x.12^(x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^(x.13*inv((~x.7*~x.8)))
         z     = x.10^x.11
         z.1   = x.12^(x.13*inv(~x.8))
         z.2   = x.12^(x.13*inv(~x.7))
         z.3   = x.9
         z.4   = true
    
    202. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^x.13, x.12^(~x.8*x.13*inv(~x.7))>)>)
                               >)
                          >))
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.10^inv(x.11)
         z.1   = x.12^x.13
         z.2   = x.12^(~x.8*x.13*inv(~x.7))
         z.3   = x.9
         z.4   = true
    
    203. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^inv(x.13), 
                                          x.12^(~x.8*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^inv((~x.7*x.13))
         z     = x.10^inv(x.11)
         z.1   = x.12^inv(x.13)
         z.2   = x.12^(~x.8*inv((~x.7*x.13)))
         z.3   = x.9
         z.4   = true
    
    204. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^inv((~x.8*x.13)), 
                                          x.12^inv((~x.7*x.13))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^inv((~x.7*~x.8*x.13))
         z     = x.10^inv(x.11)
         z.1   = x.12^inv((~x.8*x.13))
         z.2   = x.12^inv((~x.7*x.13))
         z.3   = x.9
         z.4   = true
    
    205. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^(~x.7*x.13), x.12^(~x.8*x.13)>)>)
                               >)
                          >))
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^x.13
         z     = x.10^inv(x.11)
         z.1   = x.12^(~x.7*x.13)
         z.2   = x.12^(~x.8*x.13)
         z.3   = x.9
         z.4   = true
    
    206. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^(~x.7*x.13*inv(~x.8)), x.12^x.13>)>)
                               >)
                          >))
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^(x.13*inv(~x.8))
         z     = x.10^inv(x.11)
         z.1   = x.12^(~x.7*x.13*inv(~x.8))
         z.2   = x.12^x.13
         z.3   = x.9
         z.4   = true
    
    207. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^(~x.7*inv((~x.8*x.13))), 
                                          x.12^inv(x.13)>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^inv((~x.8*x.13))
         z     = x.10^inv(x.11)
         z.1   = x.12^(~x.7*inv((~x.8*x.13)))
         z.2   = x.12^inv(x.13)
         z.3   = x.9
         z.4   = true
    
    208. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^(x.13*inv(~x.8)), 
                                          x.12^(x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^(x.13*inv((~x.7*~x.8)))
         z     = x.10^inv(x.11)
         z.1   = x.12^(x.13*inv(~x.8))
         z.2   = x.12^(x.13*inv(~x.7))
         z.3   = x.9
         z.4   = true
    
    209. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^x.13, x.12^(~x.8*x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^x.11
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^x.13
         z.2   = x.12^(~x.8*x.13*inv(~x.7))
         z.3   = x.9
         z.4   = true
    
    210. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^inv(x.13), 
                                          x.12^(~x.8*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^x.11
         pc    = x.12^inv((~x.7*x.13))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^inv(x.13)
         z.2   = x.12^(~x.8*inv((~x.7*x.13)))
         z.3   = x.9
         z.4   = true
    
    211. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^inv((~x.8*x.13)), 
                                          x.12^inv((~x.7*x.13))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^x.11
         pc    = x.12^inv((~x.7*~x.8*x.13))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^inv((~x.8*x.13))
         z.2   = x.12^inv((~x.7*x.13))
         z.3   = x.9
         z.4   = true
    
    212. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^(~x.7*x.13), x.12^(~x.8*x.13)>)>)
                               >)
                          >))
         ltpk  = x.10^x.11
         pc    = x.12^x.13
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^(~x.7*x.13)
         z.2   = x.12^(~x.8*x.13)
         z.3   = x.9
         z.4   = true
    
    213. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^(~x.7*x.13*inv(~x.8)), x.12^x.13>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^x.11
         pc    = x.12^(x.13*inv(~x.8))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^(~x.7*x.13*inv(~x.8))
         z.2   = x.12^x.13
         z.3   = x.9
         z.4   = true
    
    214. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^(~x.7*inv((~x.8*x.13))), 
                                          x.12^inv(x.13)>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^x.11
         pc    = x.12^inv((~x.8*x.13))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^(~x.7*inv((~x.8*x.13)))
         z.2   = x.12^inv(x.13)
         z.3   = x.9
         z.4   = true
    
    215. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^(x.13*inv(~x.8)), 
                                          x.12^(x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^x.11
         pc    = x.12^(x.13*inv((~x.7*~x.8)))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^(x.13*inv(~x.8))
         z.2   = x.12^(x.13*inv(~x.7))
         z.3   = x.9
         z.4   = true
    
    216. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), x.13, x.13^(~x.8*inv(~x.7))>)>)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^inv(~x.7)
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13
         z.2   = x.13^(~x.8*inv(~x.7))
         z.3   = x.9
         z.4   = true
    
    217. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.10^(x.11*inv(x.12)), x.13^~x.7, x.13^~x.8>)>)>)
                          >))
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13^~x.7
         z.2   = x.13^~x.8
         z.3   = x.9
         z.4   = true
    
    218. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), x.13^inv(~x.8), x.13^inv(~x.7)>)>)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^inv((~x.7*~x.8))
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13^inv(~x.8)
         z.2   = x.13^inv(~x.7)
         z.3   = x.9
         z.4   = true
    
    219. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), x.13^(~x.7*inv(~x.8)), x.13>)>)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^inv(~x.8)
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13^(~x.7*inv(~x.8))
         z.2   = x.13
         z.3   = x.9
         z.4   = true
    
    220. ~ltk  = ~x.8
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = x.11^x.12
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.11^(~prek.3*x.12)
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(~prek.3*x.14*inv((~x.8*x.15)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(~prek.3*x.12), x.13^(x.14*inv(x.15)), 
                                          x.13^(~prek.3*x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^(~prek.3*x.12), x.13^(x.14*inv(x.15)), 
                                              x.13^(~prek.3*x.14*inv((~x.8*x.15)))>)
                                        >)
                                   >)
                              >))
    
    221. ~ltk  = ~x.8
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(x.14*inv(x.15))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), x.13^(x.14*inv(x.15)), 
                                          x.13^(x.14*inv(x.15))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(x.11*inv(x.12)), x.13^(x.14*inv(x.15)), 
                                              x.13^(x.14*inv(x.15))>)
                                        >)
                                   >)
                              >))
    
    222. ~ltk  = ~x.8
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), x.13^(x.14*inv(x.15)), 
                                          x.13^(x.14*inv(x.15))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(x.14*inv(x.15))
         z.3   = x.9
         z.4   = true
    
    223. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^x.12
         pc    = x.13^(x.14*inv((~x.8*~x.9*x.15)))
         z     = x.11^(~x.9*x.12)
         z.1   = x.13^(x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv((~x.8*x.15)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(~x.9*x.12), x.13^(x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^(~x.9*x.12), x.13^(x.14*inv((~x.9*x.15))), 
                                              x.13^(x.14*inv((~x.8*x.15)))>)
                                        >)
                                   >)
                              >))
    
    224. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^inv((~x.9*x.12))
         pc    = x.13^(x.14*inv((~x.8*~x.9*x.15)))
         z     = x.11^inv(x.12)
         z.1   = x.13^(x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv((~x.8*x.15)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^inv(x.12), x.13^(x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^inv(x.12), x.13^(x.14*inv((~x.9*x.15))), 
                                              x.13^(x.14*inv((~x.8*x.15)))>)
                                        >)
                                   >)
                              >))
    
    225. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^inv((~x.9*x.12))
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.11^inv(x.12)
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(~x.9*x.14*inv((~x.8*x.15)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^inv(x.12), x.13^(x.14*inv(x.15)), 
                                          x.13^(~x.9*x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^inv(x.12), x.13^(x.14*inv(x.15)), 
                                              x.13^(~x.9*x.14*inv((~x.8*x.15)))>)
                                        >)
                                   >)
                              >))
    
    226. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^(x.12*inv(~x.9))
         pc    = x.13^(x.14*inv((~x.8*~x.9*x.15)))
         z     = x.11^x.12
         z.1   = x.13^(x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv((~x.8*x.15)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^x.12, x.13^(x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^x.12, x.13^(x.14*inv((~x.9*x.15))), 
                                              x.13^(x.14*inv((~x.8*x.15)))>)
                                        >)
                                   >)
                              >))
    
    227. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^(x.12*inv(~x.9))
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.11^x.12
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(~x.9*x.14*inv((~x.8*x.15)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^x.12, x.13^(x.14*inv(x.15)), 
                                          x.13^(~x.9*x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^x.12, x.13^(x.14*inv(x.15)), 
                                              x.13^(~x.9*x.14*inv((~x.8*x.15)))>)
                                        >)
                                   >)
                              >))
    
    228. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^inv((~x.8*~x.9*x.15))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^inv((~x.9*x.15))
         z.2   = x.14^inv((~x.8*x.15))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^inv((~x.9*x.15)), 
                                          x.14^inv((~x.8*x.15))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^(x.12*inv(x.13)), x.14^inv((~x.9*x.15)), 
                                              x.14^inv((~x.8*x.15))>)
                                        >)
                                   >)
                              >))
    
    229. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^inv((~x.8*x.15))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^inv(x.15)
         z.2   = x.14^(~x.9*inv((~x.8*x.15)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^inv(x.15), 
                                          x.14^(~x.9*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^(x.12*inv(x.13)), x.14^inv(x.15), 
                                              x.14^(~x.9*inv((~x.8*x.15)))>)
                                        >)
                                   >)
                              >))
    
    230. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^(x.15*inv(~x.8))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^x.15
         z.2   = x.14^(~x.9*x.15*inv(~x.8))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^x.15, 
                                          x.14^(~x.9*x.15*inv(~x.8))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^(x.12*inv(x.13)), x.14^x.15, 
                                              x.14^(~x.9*x.15*inv(~x.8))>)
                                        >)
                                   >)
                              >))
    
    231. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^(x.15*inv((~x.8*~x.9)))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^(x.15*inv(~x.9))
         z.2   = x.14^(x.15*inv(~x.8))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^(x.15*inv(~x.9)), 
                                          x.14^(x.15*inv(~x.8))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^(x.12*inv(x.13)), x.14^(x.15*inv(~x.9)), 
                                              x.14^(x.15*inv(~x.8))>)
                                        >)
                                   >)
                              >))
    
    232. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^x.12, x.13^(~x.8*x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv(x.15))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv(~x.9))
         pc    = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.11^x.12
         z.1   = x.13^(~x.8*x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv(x.15))
         z.3   = x.10
         z.4   = true
    
    233. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^x.12, x.13^(x.14*inv(x.15)), 
                                          x.13^(~x.9*x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv(~x.9))
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.11^x.12
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(~x.9*x.14*inv((~x.8*x.15)))
         z.3   = x.10
         z.4   = true
    
    234. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^x.12, x.13^(x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv(~x.9))
         pc    = x.13^(x.14*inv((~x.8*~x.9*x.15)))
         z     = x.11^x.12
         z.1   = x.13^(x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv((~x.8*x.15)))
         z.3   = x.10
         z.4   = true
    
    235. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^inv(x.12), x.13^(~x.8*x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv(x.15))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^inv((~x.9*x.12))
         pc    = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.11^inv(x.12)
         z.1   = x.13^(~x.8*x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv(x.15))
         z.3   = x.10
         z.4   = true
    
    236. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^inv(x.12), x.13^(x.14*inv(x.15)), 
                                          x.13^(~x.9*x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^inv((~x.9*x.12))
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.11^inv(x.12)
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(~x.9*x.14*inv((~x.8*x.15)))
         z.3   = x.10
         z.4   = true
    
    237. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^inv(x.12), x.13^(x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^inv((~x.9*x.12))
         pc    = x.13^(x.14*inv((~x.8*~x.9*x.15)))
         z     = x.11^inv(x.12)
         z.1   = x.13^(x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv((~x.8*x.15)))
         z.3   = x.10
         z.4   = true
    
    238. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(~x.9*x.12), x.13^(~x.8*x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv(x.15))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^x.12
         pc    = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.11^(~x.9*x.12)
         z.1   = x.13^(~x.8*x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv(x.15))
         z.3   = x.10
         z.4   = true
    
    239. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(~x.9*x.12), x.13^(x.14*inv(x.15)), 
                                          x.13^(~x.9*x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^x.12
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.11^(~x.9*x.12)
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(~x.9*x.14*inv((~x.8*x.15)))
         z.3   = x.10
         z.4   = true
    
    240. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(~x.9*x.12), x.13^(x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^x.12
         pc    = x.13^(x.14*inv((~x.8*~x.9*x.15)))
         z     = x.11^(~x.9*x.12)
         z.1   = x.13^(x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv((~x.8*x.15)))
         z.3   = x.10
         z.4   = true
    
    241. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^x.15, 
                                          x.14^(~x.9*x.15*inv(~x.8))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^(x.15*inv(~x.8))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^x.15
         z.2   = x.14^(~x.9*x.15*inv(~x.8))
         z.3   = x.10
         z.4   = true
    
    242. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^inv(x.15), 
                                          x.14^(~x.9*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^inv((~x.8*x.15))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^inv(x.15)
         z.2   = x.14^(~x.9*inv((~x.8*x.15)))
         z.3   = x.10
         z.4   = true
    
    243. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^inv((~x.9*x.15)), 
                                          x.14^inv((~x.8*x.15))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^inv((~x.8*~x.9*x.15))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^inv((~x.9*x.15))
         z.2   = x.14^inv((~x.8*x.15))
         z.3   = x.10
         z.4   = true
    
    244. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^(~x.8*x.15), x.14^(~x.9*x.15)
                                         >)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^x.15
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^(~x.8*x.15)
         z.2   = x.14^(~x.9*x.15)
         z.3   = x.10
         z.4   = true
    
    245. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^(~x.8*x.15*inv(~x.9)), 
                                          x.14^x.15>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^(x.15*inv(~x.9))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^(~x.8*x.15*inv(~x.9))
         z.2   = x.14^x.15
         z.3   = x.10
         z.4   = true
    
    246. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^(~x.8*inv((~x.9*x.15))), 
                                          x.14^inv(x.15)>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^inv((~x.9*x.15))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^(~x.8*inv((~x.9*x.15)))
         z.2   = x.14^inv(x.15)
         z.3   = x.10
         z.4   = true
    
    247. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^(x.15*inv(~x.9)), 
                                          x.14^(x.15*inv(~x.8))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^(x.15*inv((~x.8*~x.9)))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^(x.15*inv(~x.9))
         z.2   = x.14^(x.15*inv(~x.8))
         z.3   = x.10
         z.4   = true
    
    248. ~ltk  = ~x.9
         ~prek = ~x.10
         enc   = enc.3
         ltpk  = x.12^(x.13*inv((~x.10*x.14)))
         pc    = x.15^(x.16*inv((~x.9*~x.10*x.17)))
         z     = x.12^(x.13*inv(x.14))
         z.1   = x.15^(x.16*inv((~x.10*x.17)))
         z.2   = x.15^(x.16*inv((~x.9*x.17)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.12^(x.13*inv(x.14)), x.15^(x.16*inv((~x.10*x.17))), 
                                          x.15^(x.16*inv((~x.9*x.17)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.12^(x.13*inv(x.14)), x.15^(x.16*inv((~x.10*x.17))), 
                                              x.15^(x.16*inv((~x.9*x.17)))>)
                                        >)
                                   >)
                              >))
    
    249. ~ltk  = ~x.9
         ~prek = ~x.10
         enc   = enc.3
         ltpk  = x.12^(x.13*inv((~x.10*x.14)))
         pc    = x.15^(x.16*inv((~x.9*x.17)))
         z     = x.12^(x.13*inv(x.14))
         z.1   = x.15^(x.16*inv(x.17))
         z.2   = x.15^(~x.10*x.16*inv((~x.9*x.17)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.12^(x.13*inv(x.14)), x.15^(x.16*inv(x.17)), 
                                          x.15^(~x.10*x.16*inv((~x.9*x.17)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.12^(x.13*inv(x.14)), x.15^(x.16*inv(x.17)), 
                                              x.15^(~x.10*x.16*inv((~x.9*x.17)))>)
                                        >)
                                   >)
                              >))
    
    250. ~ltk  = ~x.9
         ~prek = ~x.10
         enc   = senc(x.11,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.12^(x.13*inv(x.14)), 
                                          x.15^(~x.9*x.16*inv((~x.10*x.17))), x.15^(x.16*inv(x.17))
                                         >)
                                    >)
                               >)
                          >))
         ltpk  = x.12^(x.13*inv((~x.10*x.14)))
         pc    = x.15^(x.16*inv((~x.10*x.17)))
         z     = x.12^(x.13*inv(x.14))
         z.1   = x.15^(~x.9*x.16*inv((~x.10*x.17)))
         z.2   = x.15^(x.16*inv(x.17))
         z.3   = x.11
         z.4   = true
    
    251. ~ltk  = ~x.9
         ~prek = ~x.10
         enc   = senc(x.11,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.12^(x.13*inv(x.14)), x.15^(x.16*inv(x.17)), 
                                          x.15^(~x.10*x.16*inv((~x.9*x.17)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.12^(x.13*inv((~x.10*x.14)))
         pc    = x.15^(x.16*inv((~x.9*x.17)))
         z     = x.12^(x.13*inv(x.14))
         z.1   = x.15^(x.16*inv(x.17))
         z.2   = x.15^(~x.10*x.16*inv((~x.9*x.17)))
         z.3   = x.11
         z.4   = true
    
    252. ~ltk  = ~x.9
         ~prek = ~x.10
         enc   = senc(x.11,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.12^(x.13*inv(x.14)), x.15^(x.16*inv((~x.10*x.17))), 
                                          x.15^(x.16*inv((~x.9*x.17)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.12^(x.13*inv((~x.10*x.14)))
         pc    = x.15^(x.16*inv((~x.9*~x.10*x.17)))
         z     = x.12^(x.13*inv(x.14))
         z.1   = x.15^(x.16*inv((~x.10*x.17)))
         z.2   = x.15^(x.16*inv((~x.9*x.17)))
         z.3   = x.11
         z.4   = true
    
    253. ~prek = ~prek.3
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = DH_neutral
         z     = ltpk.3^~prek.3
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<ltpk.3^~prek.3, DH_neutral, DH_neutral>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<ltpk.3^~prek.3, DH_neutral, DH_neutral>)>)>)
                              >))
    
    254. ~prek = ~prek.3
         enc   = enc.3
         ltpk  = x.2^x.3
         pc    = DH_neutral
         z     = x.2^(~prek.3*x.3)
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.2^(~prek.3*x.3), DH_neutral, DH_neutral>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.2^(~prek.3*x.3), DH_neutral, DH_neutral>)>)>)
                              >))
    
    255. ~prek = ~x.3
         enc   = enc.3
         ltpk  = x.5^inv(~x.3)
         pc    = DH_neutral
         z     = x.5
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.5, DH_neutral, DH_neutral>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.5, DH_neutral, DH_neutral>)>)>)>))
    
    256. ~prek = ~x.3
         enc   = senc(x.4,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.5, DH_neutral, DH_neutral>)>)>)>))
         ltpk  = x.5^inv(~x.3)
         pc    = DH_neutral
         z     = x.5
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = x.4
         z.4   = true
    
    257. ~prek = ~x.3
         enc   = senc(x.4,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.5^~x.3, DH_neutral, DH_neutral>)>)>)
                          >))
         ltpk  = x.5
         pc    = DH_neutral
         z     = x.5^~x.3
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = x.4
         z.4   = true
    
    258. ~prek = ~x.4
         enc   = enc.3
         ltpk  = x.6^inv((~x.4*x.7))
         pc    = DH_neutral
         z     = x.6^inv(x.7)
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.6^inv(x.7), DH_neutral, DH_neutral>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.6^inv(x.7), DH_neutral, DH_neutral>)>)
                                   >)
                              >))
    
    259. ~prek = ~x.4
         enc   = enc.3
         ltpk  = x.6^(x.7*inv(~x.4))
         pc    = DH_neutral
         z     = x.6^x.7
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.6^x.7, DH_neutral, DH_neutral>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.6^x.7, DH_neutral, DH_neutral>)>)>)>))
    
    260. ~prek = ~x.4
         enc   = senc(x.5,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.6^x.7, DH_neutral, DH_neutral>)>)>)>))
         ltpk  = x.6^(x.7*inv(~x.4))
         pc    = DH_neutral
         z     = x.6^x.7
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = x.5
         z.4   = true
    
    261. ~prek = ~x.4
         enc   = senc(x.5,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.6^inv(x.7), DH_neutral, DH_neutral>)>)
                               >)
                          >))
         ltpk  = x.6^inv((~x.4*x.7))
         pc    = DH_neutral
         z     = x.6^inv(x.7)
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = x.5
         z.4   = true
    
    262. ~prek = ~x.4
         enc   = senc(x.5,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.6^(~x.4*x.7), DH_neutral, DH_neutral>)>)>)
                          >))
         ltpk  = x.6^x.7
         pc    = DH_neutral
         z     = x.6^(~x.4*x.7)
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = x.5
         z.4   = true
    
    263. ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^(x.8*inv((~x.5*x.9)))
         pc    = DH_neutral
         z     = x.7^(x.8*inv(x.9))
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7^(x.8*inv(x.9)), DH_neutral, DH_neutral>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.7^(x.8*inv(x.9)), DH_neutral, DH_neutral>)>)>)
                              >))
    
    264. ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7^(x.8*inv(x.9)), DH_neutral, DH_neutral>)>)>)
                          >))
         ltpk  = x.7^(x.8*inv((~x.5*x.9)))
         pc    = DH_neutral
         z     = x.7^(x.8*inv(x.9))
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = x.6
         z.4   = true
    
    265. enc   = enc.3
         ltpk  = DH_neutral
         pc    = DH_neutral
         z     = DH_neutral
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, DH_neutral, DH_neutral>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, DH_neutral, DH_neutral>)>)>)
                              >))
    
    266. enc   = senc(x.1,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, DH_neutral, DH_neutral>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = DH_neutral
         z     = DH_neutral
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = x.1
         z.4   = true
  */

rule (modulo E) Receive:
   [ In( enc ), Session( ~id, $A, 'R', ~x, $B, pc, rk, ck ) ]
  --[
  Receive( sdec(enc, kdf(<'mk', kdf(<'ck', ck>)>)) ),
  Eq( decrypts(enc, kdf(<'mk', kdf(<'ck', ck>)>)), true )
  ]->
   [ Session( ~id, $A, 'R', ~x, $B, pc, rk, kdf(<'ck', ck>) ) ]

  // loop breaker: [1]
  /*
  rule (modulo AC) Receive:
     [ In( enc ), Session( ~id, $A, 'R', ~x, $B, pc, rk, ck ) ]
    --[ Receive( z ), Eq( z.1, true ) ]->
     [ Session( ~id, $A, 'R', ~x, $B, pc, rk, kdf(<'ck', ck>) ) ]
    variants (modulo AC)
    1. ck    = x.2
       enc   = senc(x.3, kdf(<'mk', kdf(<'ck', x.2>)>))
       z     = x.3
       z.1   = true
    
    2. ck    = ck.3
       enc   = enc.3
       z     = sdec(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
       z.1   = decrypts(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
    // loop breaker: [1]
  */

rule (modulo E) OuterRatchetToSender:
   [
   Fr( ~x ), Fr( ~m ),
   Session( ~id, $A, 'R', drop, $B, pc, old_rk, old_ck )
   ]
  --[ Send( ~m, 'g'^~x, pc ), GenEph( 'g'^~x ) ]->
   [
   !EphemeralDH( $A, ~x ),
   Session( ~id, $A, 'S', ~x, $B, pc, kdf(<'rk', old_rk, pc^~x>),
            kdf(<'ck', kdf(<'rk', old_rk, pc^~x>)>)
   ),
   Out( <'g'^~x, 
         senc(~m, kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk, pc^~x>)>)>))>
   )
   ]

  /*
  rule (modulo AC) OuterRatchetToSender:
     [
     Fr( ~x ), Fr( ~m ),
     Session( ~id, $A, 'R', drop, $B, pc, old_rk, old_ck )
     ]
    --[ Send( ~m, 'g'^~x, pc ), GenEph( 'g'^~x ) ]->
     [
     !EphemeralDH( $A, ~x ),
     Session( ~id, $A, 'S', ~x, $B, pc, kdf(<'rk', old_rk, z>),
              kdf(<'ck', kdf(<'rk', old_rk, z>)>)
     ),
     Out( <'g'^~x, 
           senc(~m, kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk, z>)>)>))>
     )
     ]
    variants (modulo AC)
    1. ~x    = ~x.3
       pc    = pc.3
       z     = pc.3^~x.3
    
    2. ~x    = ~x.7
       pc    = x.5^x.6
       z     = x.5^(x.6*~x.7)
    
    3. ~x    = ~x.7
       pc    = x.11^inv(~x.7)
       z     = x.11
    
    4. ~x    = ~x.8
       pc    = x.12^inv((~x.8*x.13))
       z     = x.12^inv(x.13)
    
    5. ~x    = ~x.8
       pc    = x.12^(x.13*inv(~x.8))
       z     = x.12^x.13
    
    6. ~x    = ~x.9
       pc    = x.13^(x.14*inv((~x.9*x.15)))
       z     = x.13^(x.14*inv(x.15))
    
    7. pc    = DH_neutral
       z     = DH_neutral
  */

rule (modulo E) OuterRatchetToReceiver:
   [
   In( <pc, enc> ),
   Session( ~id, $A, 'S', ~x, $B, old_pc, old_rk, old_ck )
   ]
  --[
  Receive( sdec(enc,
                kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk, pc^~x>)>)>))
  ),
  Eq( decrypts(enc,
               kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk, pc^~x>)>)>)),
      true
  )
  ]->
   [
   Session( ~id, $A, 'R', ~x, $B, pc, kdf(<'rk', old_rk, pc^~x>),
            kdf(<'ck', kdf(<'rk', old_rk, pc^~x>)>)
   )
   ]

  // loop breaker: [1]
  /*
  rule (modulo AC) OuterRatchetToReceiver:
     [
     In( <pc, enc> ),
     Session( ~id, $A, 'S', ~x, $B, old_pc, old_rk, old_ck )
     ]
    --[ Receive( z.1 ), Eq( z.2, true ) ]->
     [
     Session( ~id, $A, 'R', ~x, $B, pc, kdf(<'rk', old_rk, z>),
              kdf(<'ck', kdf(<'rk', old_rk, z>)>)
     )
     ]
    variants (modulo AC)
     1. ~x    = ~x.3
        enc   = enc.3
        old_rk
              = old_rk.3
        pc    = pc.3
        z     = pc.3^~x.3
        z.1   = sdec(enc.3,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, pc.3^~x.3>)>)>))
        z.2   = decrypts(enc.3,
                         kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, pc.3^~x.3>)>)>))
    
     2. ~x    = ~x.6
        enc   = senc(x.7, kdf(<'mk', kdf(<'ck', kdf(<'rk', x.8, x.9>)>)>))
        old_rk
              = x.8
        pc    = x.9^inv(~x.6)
        z     = x.9
        z.1   = x.7
        z.2   = true
    
     3. ~x    = ~x.6
        enc   = senc(x.7,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', x.8, x.9^~x.6>)>)>))
        old_rk
              = x.8
        pc    = x.9
        z     = x.9^~x.6
        z.1   = x.7
        z.2   = true
    
     4. ~x    = ~x.7
        enc   = enc.3
        old_rk
              = old_rk.3
        pc    = x.5^x.6
        z     = x.5^(x.6*~x.7)
        z.1   = sdec(enc.3,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.5^(x.6*~x.7)>)>)>))
        z.2   = decrypts(enc.3,
                         kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.5^(x.6*~x.7)>)>)>))
    
     5. ~x    = ~x.7
        enc   = senc(x.8,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', x.9, x.10^x.11>)>)>))
        old_rk
              = x.9
        pc    = x.10^(x.11*inv(~x.7))
        z     = x.10^x.11
        z.1   = x.8
        z.2   = true
    
     6. ~x    = ~x.7
        enc   = senc(x.8,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', x.9, x.10^inv(x.11)>)>)>))
        old_rk
              = x.9
        pc    = x.10^inv((~x.7*x.11))
        z     = x.10^inv(x.11)
        z.1   = x.8
        z.2   = true
    
     7. ~x    = ~x.7
        enc   = senc(x.8,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', x.9, x.10^(~x.7*x.11)>)>)>))
        old_rk
              = x.9
        pc    = x.10^x.11
        z     = x.10^(~x.7*x.11)
        z.1   = x.8
        z.2   = true
    
     8. ~x    = ~x.8
        enc   = enc.3
        old_rk
              = old_rk.3
        pc    = x.13^inv(~x.8)
        z     = x.13
        z.1   = sdec(enc.3,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.13>)>)>))
        z.2   = decrypts(enc.3,
                         kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.13>)>)>))
    
     9. ~x    = ~x.8
        enc   = senc(x.9,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', x.10, x.11^(x.12*inv(x.13))>)>)>))
        old_rk
              = x.10
        pc    = x.11^(x.12*inv((~x.8*x.13)))
        z     = x.11^(x.12*inv(x.13))
        z.1   = x.9
        z.2   = true
    
    10. ~x    = ~x.9
        enc   = enc.3
        old_rk
              = old_rk.3
        pc    = x.14^inv((~x.9*x.15))
        z     = x.14^inv(x.15)
        z.1   = sdec(enc.3,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.14^inv(x.15)>)>)>))
        z.2   = decrypts(enc.3,
                         kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.14^inv(x.15)>)>)>))
    
    11. ~x    = ~x.9
        enc   = enc.3
        old_rk
              = old_rk.3
        pc    = x.14^(x.15*inv(~x.9))
        z     = x.14^x.15
        z.1   = sdec(enc.3,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.14^x.15>)>)>))
        z.2   = decrypts(enc.3,
                         kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.14^x.15>)>)>))
    
    12. ~x    = ~x.10
        enc   = enc.3
        old_rk
              = old_rk.3
        pc    = x.15^(x.16*inv((~x.10*x.17)))
        z     = x.15^(x.16*inv(x.17))
        z.1   = sdec(enc.3,
                     kdf(<'mk', 
                          kdf(<'ck', kdf(<'rk', old_rk.3, x.15^(x.16*inv(x.17))>)>)>))
        z.2   = decrypts(enc.3,
                         kdf(<'mk', 
                              kdf(<'ck', kdf(<'rk', old_rk.3, x.15^(x.16*inv(x.17))>)>)>))
    
    13. enc   = enc.3
        old_rk
              = old_rk.3
        pc    = DH_neutral
        z     = DH_neutral
        z.1   = sdec(enc.3,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, DH_neutral>)>)>))
        z.2   = decrypts(enc.3,
                         kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, DH_neutral>)>)>))
    
    14. enc   = senc(x.2,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', x.3, DH_neutral>)>)>))
        old_rk
              = x.3
        pc    = DH_neutral
        z     = DH_neutral
        z.1   = x.2
        z.2   = true
    // loop breaker: [1]
  */

lemma Exec:
  exists-trace
  "∃ m pc1 pc2 #x #y.
    (Receive( m ) @ #x) ∧ (Send( m, pc1, pc2 ) @ #y)"
/*
guarded formula characterizing all satisfying traces:
"∃ m pc1 pc2 #x #y.
  (Receive( m ) @ #x) ∧ (Send( m, pc1, pc2 ) @ #y)"
*/
by sorry

lemma Secrecy:
  all-traces
  "∀ m pc1 pc2 #t.
    (Send( m, pc1, pc2 ) @ #t) ⇒
    ((((¬(∃ #x. K( m ) @ #x)) ∨ (∃ #x. Reveal( pc1 ) @ #x)) ∨
      (∃ #x. Reveal( pc2 ) @ #x)) ∨
     (¬(∃ #x. GenEph( pc2 ) @ #x)))"
/*
guarded formula characterizing all counter-examples:
"∃ m pc1 pc2 #t.
  (Send( m, pc1, pc2 ) @ #t)
 ∧
  (∃ #x. (K( m ) @ #x)) ∧
  (∀ #x. (Reveal( pc1 ) @ #x) ⇒ ⊥) ∧
  (∀ #x. (Reveal( pc2 ) @ #x) ⇒ ⊥) ∧
  (∃ #x. (GenEph( pc2 ) @ #x))"
*/
simplify
solve( Send( x.2, pc1, pc2 ) @ #t )
  case OuterRatchetToSender
  solve( !KU( ~m.1 ) @ #vk )
    case OuterRatchetToSender_case_1
    solve( !KU( 'g'^(~ltk*~prek) ) @ #vk.19 )
      case KeyGen_case_1
      solve( !KU( ~prek.3 ) @ #vk.23 )
        case RevealPrek
        solve( GenEph( pc.1 ) @ #x.1 )
          case OuterRatchetToSender
          solve( !KU( 'g'^(~x.6*~x.10) ) @ #vk.15 )
            case OuterRatchetToSender_case_1
            solve( !KU( ~x.12 ) @ #vk.24 )
              case RevealEphemeral
              by contradiction /* from formulas */
            qed
          next
            case OuterRatchetToSender_case_2
            solve( !KU( ~x.12 ) @ #vk.24 )
              case RevealEphemeral_case_1
              by contradiction /* from formulas */
            next
              case RevealEphemeral_case_2
              by contradiction /* from formulas */
            next
              case RevealEphemeral_case_3
              by contradiction /* from formulas */
            qed
          next
            case OuterRatchetToSender_case_3
            solve( !KU( ~x.13 ) @ #vk.24 )
              case RevealEphemeral
              by contradiction /* from formulas */
            qed
          next
            case OuterRatchetToSender_case_4
            solve( !KU( ~x.13 ) @ #vk.24 )
              case RevealEphemeral
              by contradiction /* from formulas */
            qed
          next
            case c_exp
            solve( !KU( ~x.6 ) @ #vk.26 )
              case RevealEphemeral
              by contradiction /* from formulas */
            qed
          qed
        next
          case SenderStart
          solve( !KU( 'g'^(~x.6*~x.10) ) @ #vk.15 )
            case OuterRatchetToSender
            solve( !KU( ~x.12 ) @ #vk.24 )
              case RevealEphemeral
              by contradiction /* from formulas */
            qed
          next
            case SenderStart
            solve( !KU( ~x.12 ) @ #vk.24 )
              case RevealEphemeral
              by contradiction /* from formulas */
            qed
          next
            case c_exp
            solve( !KU( ~x.6 ) @ #vk.26 )
              case RevealEphemeral
              by contradiction /* from formulas */
            qed
          qed
        qed
      qed
    next
      case KeyGen_case_2
      solve( GenEph( pc.1 ) @ #x.1 )
        case OuterRatchetToSender
        solve( !KU( 'g'^(~x.6*~x.10) ) @ #vk.15 )
          case OuterRatchetToSender_case_1
          solve( !KU( ~x.12 ) @ #vk.24 )
            case RevealEphemeral
            by contradiction /* from formulas */
          qed
        next
          case OuterRatchetToSender_case_2
          solve( !KU( ~x.12 ) @ #vk.24 )
            case RevealEphemeral_case_1
            by contradiction /* from formulas */
          next
            case RevealEphemeral_case_2
            by contradiction /* from formulas */
          next
            case RevealEphemeral_case_3
            by contradiction /* from formulas */
          qed
        next
          case OuterRatchetToSender_case_3
          solve( !KU( ~x.13 ) @ #vk.24 )
            case RevealEphemeral
            by contradiction /* from formulas */
          qed
        next
          case OuterRatchetToSender_case_4
          solve( !KU( ~x.13 ) @ #vk.24 )
            case RevealEphemeral
            by contradiction /* from formulas */
          qed
        next
          case c_exp
          solve( !KU( ~x.6 ) @ #vk.26 )
            case RevealEphemeral
            by contradiction /* from formulas */
          qed
        qed
      next
        case SenderStart
        solve( !KU( 'g'^(~x.6*~x.10) ) @ #vk.15 )
          case OuterRatchetToSender
          solve( !KU( ~x.12 ) @ #vk.24 )
            case RevealEphemeral
            by contradiction /* from formulas */
          qed
        next
          case SenderStart
          solve( !KU( ~x.12 ) @ #vk.24 )
            case RevealEphemeral
            by contradiction /* from formulas */
          qed
        next
          case c_exp
          solve( !KU( ~x.6 ) @ #vk.26 )
            case RevealEphemeral
            by contradiction /* from formulas */
          qed
        qed
      qed
    next
      case c_exp
      solve( GenEph( pc.1 ) @ #x.1 )
        case OuterRatchetToSender
        solve( !KU( 'g'^(~x.6*~x.10) ) @ #vk.15 )
          case OuterRatchetToSender_case_1
          solve( !KU( ~x.12 ) @ #vk.29 )
            case RevealEphemeral
            by contradiction /* from formulas */
          qed
        next
          case OuterRatchetToSender_case_2
          solve( !KU( ~x.12 ) @ #vk.29 )
            case RevealEphemeral_case_1
            by contradiction /* from formulas */
          next
            case RevealEphemeral_case_2
            by contradiction /* from formulas */
          next
            case RevealEphemeral_case_3
            by contradiction /* from formulas */
          qed
        next
          case OuterRatchetToSender_case_3
          solve( !KU( ~x.13 ) @ #vk.29 )
            case RevealEphemeral
            by contradiction /* from formulas */
          qed
        next
          case OuterRatchetToSender_case_4
          solve( !KU( ~x.13 ) @ #vk.29 )
            case RevealEphemeral
            by contradiction /* from formulas */
          qed
        next
          case c_exp
          solve( !KU( ~x.6 ) @ #vk.31 )
            case RevealEphemeral
            by contradiction /* from formulas */
          qed
        qed
      next
        case SenderStart
        solve( !KU( 'g'^(~x.6*~x.10) ) @ #vk.15 )
          case OuterRatchetToSender
          solve( !KU( ~x.12 ) @ #vk.29 )
            case RevealEphemeral
            by contradiction /* from formulas */
          qed
        next
          case SenderStart
          solve( !KU( ~x.12 ) @ #vk.29 )
            case RevealEphemeral
            by contradiction /* from formulas */
          qed
        next
          case c_exp
          solve( !KU( ~x.6 ) @ #vk.31 )
            case RevealEphemeral
            by contradiction /* from formulas */
          qed
        qed
      qed
    qed
  next
    case OuterRatchetToSender_case_2
    solve( GenEph( pc.1 ) @ #x.1 )
      case OuterRatchetToSender
      solve( !KU( kdf(<'mk', 
                       kdf(<'ck', kdf(<'rk', old_rk.1, 'g'^(~x.7*~x.8)>)>)>)
             ) @ #vk.1 )
        case c_kdf
        solve( !KU( kdf(<'ck', kdf(<'rk', old_rk.1, 'g'^(~x.7*~x.8)>)>)
               ) @ #vk.5 )
          case c_kdf
          solve( !KU( kdf(<'rk', old_rk.1, 'g'^(~x.7*~x.8)>) ) @ #vk.8 )
            case c_kdf
            solve( !KU( 'g'^(~x.7*~x.8) ) @ #vk.13 )
              case OuterRatchetToSender_case_1
              solve( !KU( ~x.10 ) @ #vk.14 )
                case RevealEphemeral
                by contradiction /* from formulas */
              qed
            next
              case OuterRatchetToSender_case_2
              solve( !KU( ~x.11 ) @ #vk.14 )
                case RevealEphemeral
                by contradiction /* from formulas */
              qed
            next
              case OuterRatchetToSender_case_3
              solve( !KU( ~x.11 ) @ #vk.14 )
                case RevealEphemeral_case_1
                by contradiction /* from formulas */
              next
                case RevealEphemeral_case_2
                by contradiction /* from formulas */
              next
                case RevealEphemeral_case_3
                by contradiction /* from formulas */
              qed
            next
              case OuterRatchetToSender_case_4
              solve( !KU( ~x.11 ) @ #vk.14 )
                case RevealEphemeral
                by contradiction /* from formulas */
              qed
            next
              case c_exp
              solve( !KU( ~x.7 ) @ #vk.16 )
                case RevealEphemeral
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    next
      case SenderStart
      solve( !KU( kdf(<'mk', 
                       kdf(<'ck', kdf(<'rk', old_rk.1, 'g'^(~x.7*~x.8)>)>)>)
             ) @ #vk.1 )
        case c_kdf
        solve( !SecretKeys( $A.2, ~ltk, prek ) ▶₃ #x.1 )
          case KeyGen
          solve( !PublicKeys( $B.2, ltpk, prepk ) ▶₄ #x.1 )
            case KeyGen
            solve( !KU( kdf(<'ck', kdf(<'rk', old_rk.1, 'g'^(~x.7*~x.9)>)>)
                   ) @ #vk.5 )
              case c_kdf
              solve( !KU( kdf(<'rk', old_rk.1, 'g'^(~x.7*~x.9)>) ) @ #vk.8 )
                case c_kdf
                solve( !KU( 'g'^(~x.7*~x.9) ) @ #vk.13 )
                  case OuterRatchetToSender
                  solve( !KU( ~x.12 ) @ #vk.14 )
                    case RevealEphemeral
                    by contradiction /* from formulas */
                  qed
                next
                  case SenderStart
                  solve( !KU( ~x.11 ) @ #vk.14 )
                    case RevealEphemeral
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  solve( !KU( ~x.7 ) @ #vk.16 )
                    case RevealEphemeral
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case OuterRatchetToSender_case_3
    solve( GenEph( pc.1 ) @ #x.1 )
      case OuterRatchetToSender
      solve( !KU( kdf(<'mk', 
                       kdf(<'ck', 
                            kdf(<'rk', kdf(<'rk', old_rk.1, 'g'^(~x.11*~x.12)>), 
                                 'g'^(~x.7*~x.12)>)
                           >)
                      >)
             ) @ #vk.1 )
        case c_kdf
        solve( !KU( kdf(<'ck', 
                         kdf(<'rk', kdf(<'rk', old_rk.1, 'g'^(~x.11*~x.12)>), 
                              'g'^(~x.7*~x.12)>)
                        >)
               ) @ #vk.7 )
          case c_kdf
          solve( !KU( kdf(<'rk', kdf(<'rk', old_rk.1, 'g'^(~x.11*~x.12)>), 
                           'g'^(~x.7*~x.12)>)
                 ) @ #vk.10 )
            case c_kdf
            solve( !KU( kdf(<'rk', old_rk.1, 'g'^(~x.11*~x.12)>) ) @ #vk.14 )
              case c_kdf
              solve( !KU( 'g'^(~x.7*~x.12) ) @ #vk.15 )
                case OuterRatchetToSender_case_1
                solve( !KU( ~x.14 ) @ #vk.21 )
                  case RevealEphemeral
                  by contradiction /* from formulas */
                qed
              next
                case OuterRatchetToSender_case_2
                solve( !KU( ~x.15 ) @ #vk.21 )
                  case RevealEphemeral
                  by contradiction /* from formulas */
                qed
              next
                case OuterRatchetToSender_case_3
                solve( !KU( ~x.15 ) @ #vk.21 )
                  case RevealEphemeral
                  by contradiction /* from formulas */
                qed
              next
                case OuterRatchetToSender_case_4
                solve( !KU( ~x.15 ) @ #vk.21 )
                  case RevealEphemeral_case_1
                  by contradiction /* from formulas */
                next
                  case RevealEphemeral_case_2
                  by contradiction /* from formulas */
                next
                  case RevealEphemeral_case_3
                  by contradiction /* from formulas */
                qed
              next
                case c_exp
                solve( !KU( ~x.7 ) @ #vk.23 )
                  case RevealEphemeral
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case SenderStart
      solve( !KU( kdf(<'mk', 
                       kdf(<'ck', 
                            kdf(<'rk', kdf(<'rk', old_rk.1, 'g'^(~x.11*~x.12)>), 
                                 'g'^(~x.7*~x.12)>)
                           >)
                      >)
             ) @ #vk.1 )
        case c_kdf
        solve( !SecretKeys( $A.2, ~ltk, prek ) ▶₃ #x.1 )
          case KeyGen
          solve( !PublicKeys( $B.2, ltpk, prepk ) ▶₄ #x.1 )
            case KeyGen
            solve( !KU( kdf(<'ck', 
                             kdf(<'rk', kdf(<'rk', old_rk.1, 'g'^(~x.11*~x.13)>), 
                                  'g'^(~x.7*~x.13)>)
                            >)
                   ) @ #vk.7 )
              case c_kdf
              solve( !KU( kdf(<'rk', kdf(<'rk', old_rk.1, 'g'^(~x.11*~x.13)>), 
                               'g'^(~x.7*~x.13)>)
                     ) @ #vk.10 )
                case c_kdf
                solve( !KU( kdf(<'rk', old_rk.1, 'g'^(~x.11*~x.13)>) ) @ #vk.14 )
                  case c_kdf
                  solve( !KU( 'g'^(~x.7*~x.13) ) @ #vk.15 )
                    case OuterRatchetToSender
                    solve( !KU( ~x.16 ) @ #vk.21 )
                      case RevealEphemeral
                      by contradiction /* from formulas */
                    qed
                  next
                    case SenderStart
                    solve( !KU( ~x.15 ) @ #vk.21 )
                      case RevealEphemeral
                      by contradiction /* from formulas */
                    qed
                  next
                    case c_exp
                    solve( !KU( ~x.7 ) @ #vk.23 )
                      case RevealEphemeral
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
next
  case Send
  solve( !KU( ~m.1 ) @ #vk )
    case Send
    solve( !KU( kdf(<'mk', kdf(<'ck', ck.1>)>) ) @ #vk.1 )
      case c_kdf
      solve( !KU( kdf(<'ck', ck.1>) ) @ #vk.4 )
        case c_kdf
        solve( GenEph( pc.1 ) @ #x.1 )
          case OuterRatchetToSender
          solve( Session( ~id.1, $A.1, 'S', ~x.4, $B.1, 'g'^~x.5, rk.1, ck.1
                 ) ▶₁ #vr )
            case OuterRatchetToSender_case_1
            solve( !KU( kdf(<'ck', 
                             kdf(<'rk', 
                                  kdf(<'rk', 
                                       kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.7), 'g'^(~prek*~x.7)>)
                                      >), 
                                  'g'^(~x.6*~x.7)>)
                            >)
                   ) @ #vk.7 )
              case c_kdf
              solve( !KU( kdf(<'rk', 
                               kdf(<'rk', 
                                    kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.7), 'g'^(~prek*~x.7)>)>), 
                               'g'^(~x.6*~x.7)>)
                     ) @ #vk.13 )
                case c_kdf
                solve( !KU( kdf(<'rk', 
                                 kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.7), 'g'^(~prek*~x.7)>)>)
                       ) @ #vk.17 )
                  case c_kdf
                  solve( !KU( kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.7), 
                                   'g'^(~prek*~x.7)>)
                         ) @ #vk.21 )
                    case c_kdf
                    solve( !KU( 'g'^(~x.6*~x.7) ) @ #vk.18 )
                      case OuterRatchetToSender_case_1
                      solve( !KU( ~x.10 ) @ #vk.27 )
                        case RevealEphemeral
                        by contradiction /* from formulas */
                      qed
                    next
                      case OuterRatchetToSender_case_2
                      solve( !KU( ~x.10 ) @ #vk.27 )
                        case RevealEphemeral_case_1
                        by contradiction /* from formulas */
                      next
                        case RevealEphemeral_case_2
                        by contradiction /* from formulas */
                      next
                        case RevealEphemeral_case_3
                        by contradiction /* from formulas */
                      qed
                    next
                      case OuterRatchetToSender_case_3
                      solve( !KU( ~x.11 ) @ #vk.27 )
                        case RevealEphemeral
                        by contradiction /* from formulas */
                      qed
                    next
                      case OuterRatchetToSender_case_4
                      solve( !KU( ~x.11 ) @ #vk.27 )
                        case RevealEphemeral
                        by contradiction /* from formulas */
                      qed
                    next
                      case c_exp
                      solve( !KU( ~x.6 ) @ #vk.29 )
                        case RevealEphemeral
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                qed
              qed
            qed
          next
            case OuterRatchetToSender_case_2
            solve( !KU( kdf(<'ck', kdf(<'rk', old_rk.1, 'g'^(~x.6*~x.8)>)>)
                   ) @ #vk.7 )
              case c_kdf
              solve( !KU( kdf(<'rk', old_rk.1, 'g'^(~x.6*~x.8)>) ) @ #vk.11 )
                case c_kdf
                solve( !KU( 'g'^(~x.6*~x.8) ) @ #vk.16 )
                  case OuterRatchetToSender_case_1
                  solve( !KU( ~x.10 ) @ #vk.17 )
                    case RevealEphemeral
                    by contradiction /* from formulas */
                  qed
                next
                  case OuterRatchetToSender_case_2
                  solve( !KU( ~x.11 ) @ #vk.17 )
                    case RevealEphemeral
                    by contradiction /* from formulas */
                  qed
                next
                  case OuterRatchetToSender_case_3
                  solve( !KU( ~x.11 ) @ #vk.17 )
                    case RevealEphemeral_case_1
                    by contradiction /* from formulas */
                  next
                    case RevealEphemeral_case_2
                    by contradiction /* from formulas */
                  next
                    case RevealEphemeral_case_3
                    by contradiction /* from formulas */
                  qed
                next
                  case OuterRatchetToSender_case_4
                  solve( !KU( ~x.11 ) @ #vk.17 )
                    case RevealEphemeral
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  solve( !KU( ~x.6 ) @ #vk.19 )
                    case RevealEphemeral
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          next
            case OuterRatchetToSender_case_3
            solve( !KU( kdf(<'ck', 
                             kdf(<'rk', kdf(<'rk', old_rk.1, 'g'^(~x.7*~x.8)>), 'g'^(~x.6*~x.8)
                                 >)
                            >)
                   ) @ #vk.7 )
              case c_kdf
              solve( !KU( kdf(<'rk', kdf(<'rk', old_rk.1, 'g'^(~x.7*~x.8)>), 
                               'g'^(~x.6*~x.8)>)
                     ) @ #vk.13 )
                case c_kdf
                solve( !KU( kdf(<'rk', old_rk.1, 'g'^(~x.7*~x.8)>) ) @ #vk.17 )
                  case c_kdf
                  solve( !KU( 'g'^(~x.6*~x.8) ) @ #vk.18 )
                    case OuterRatchetToSender_case_1
                    solve( !KU( ~x.11 ) @ #vk.24 )
                      case RevealEphemeral
                      by contradiction /* from formulas */
                    qed
                  next
                    case OuterRatchetToSender_case_2
                    solve( !KU( ~x.12 ) @ #vk.24 )
                      case RevealEphemeral
                      by contradiction /* from formulas */
                    qed
                  next
                    case OuterRatchetToSender_case_3
                    solve( !KU( ~x.12 ) @ #vk.24 )
                      case RevealEphemeral
                      by contradiction /* from formulas */
                    qed
                  next
                    case OuterRatchetToSender_case_4
                    solve( !KU( ~x.12 ) @ #vk.24 )
                      case RevealEphemeral_case_1
                      by contradiction /* from formulas */
                    next
                      case RevealEphemeral_case_2
                      by contradiction /* from formulas */
                    next
                      case RevealEphemeral_case_3
                      by contradiction /* from formulas */
                    qed
                  next
                    case c_exp
                    solve( !KU( ~x.6 ) @ #vk.26 )
                      case RevealEphemeral
                      by contradiction /* from formulas */
                    qed
                  qed
                qed
              qed
            qed
          next
            case Send
            solve( !KU( kdf(<'ck', ck.2>) ) @ #vk.7 )
              case c_kdf
              search for cycle
              minimize for cyclic proofs
              solve( Session( ~id.1, $A.1, 'S', ~x.4, $B.1, 'g'^~x.5, rk.1, ck.2
                     ) ▶₁ #vr.2 )
                case OuterRatchetToSender_case_1
                solve( !KU( kdf(<'ck', 
                                 kdf(<'rk', 
                                      kdf(<'rk', 
                                           kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.7), 
                                                'g'^(~prek*~x.7)>)
                                          >), 
                                      'g'^(~x.6*~x.7)>)
                                >)
                       ) @ #vk.10 )
                  case c_kdf
                  solve( !KU( kdf(<'rk', 
                                   kdf(<'rk', 
                                        kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.7), 'g'^(~prek*~x.7)>)
                                       >), 
                                   'g'^(~x.6*~x.7)>)
                         ) @ #vk.16 )
                    case c_kdf
                    solve( !KU( kdf(<'rk', 
                                     kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.7), 'g'^(~prek*~x.7)>)>)
                           ) @ #vk.20 )
                      case c_kdf
                      solve( !KU( kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.7), 
                                       'g'^(~prek*~x.7)>)
                             ) @ #vk.24 )
                        case c_kdf
                        solve( !KU( 'g'^(~x.6*~x.7) ) @ #vk.21 )
                          case OuterRatchetToSender_case_1
                          solve( !KU( ~x.10 ) @ #vk.30 )
                            case RevealEphemeral
                            by contradiction /* from formulas */
                          qed
                        next
                          case OuterRatchetToSender_case_2
                          solve( !KU( ~x.10 ) @ #vk.30 )
                            case RevealEphemeral_case_1
                            by contradiction /* from formulas */
                          next
                            case RevealEphemeral_case_2
                            by contradiction /* from formulas */
                          next
                            case RevealEphemeral_case_3
                            by contradiction /* from formulas */
                          qed
                        next
                          case OuterRatchetToSender_case_3
                          solve( !KU( ~x.11 ) @ #vk.30 )
                            case RevealEphemeral
                            by contradiction /* from formulas */
                          qed
                        next
                          case OuterRatchetToSender_case_4
                          solve( !KU( ~x.11 ) @ #vk.30 )
                            case RevealEphemeral
                            by contradiction /* from formulas */
                          qed
                        next
                          case c_exp
                          solve( !KU( ~x.6 ) @ #vk.32 )
                            case RevealEphemeral
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case OuterRatchetToSender_case_2
                solve( !KU( kdf(<'ck', kdf(<'rk', old_rk.1, 'g'^(~x.6*~x.8)>)>)
                       ) @ #vk.10 )
                  case c_kdf
                  solve( !KU( kdf(<'rk', old_rk.1, 'g'^(~x.6*~x.8)>) ) @ #vk.14 )
                    case c_kdf
                    solve( !KU( 'g'^(~x.6*~x.8) ) @ #vk.19 )
                      case OuterRatchetToSender_case_1
                      solve( !KU( ~x.10 ) @ #vk.20 )
                        case RevealEphemeral
                        by contradiction /* from formulas */
                      qed
                    next
                      case OuterRatchetToSender_case_2
                      solve( !KU( ~x.11 ) @ #vk.20 )
                        case RevealEphemeral
                        by contradiction /* from formulas */
                      qed
                    next
                      case OuterRatchetToSender_case_3
                      solve( !KU( ~x.11 ) @ #vk.20 )
                        case RevealEphemeral_case_1
                        by contradiction /* from formulas */
                      next
                        case RevealEphemeral_case_2
                        by contradiction /* from formulas */
                      next
                        case RevealEphemeral_case_3
                        by contradiction /* from formulas */
                      qed
                    next
                      case OuterRatchetToSender_case_4
                      solve( !KU( ~x.11 ) @ #vk.20 )
                        case RevealEphemeral
                        by contradiction /* from formulas */
                      qed
                    next
                      case c_exp
                      solve( !KU( ~x.6 ) @ #vk.22 )
                        case RevealEphemeral
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                qed
              next
                case OuterRatchetToSender_case_3
                solve( !KU( kdf(<'ck', 
                                 kdf(<'rk', kdf(<'rk', old_rk.1, 'g'^(~x.7*~x.9)>), 'g'^(~x.6*~x.7)
                                     >)
                                >)
                       ) @ #vk.10 )
                  case c_kdf
                  solve( !KU( kdf(<'rk', kdf(<'rk', old_rk.1, 'g'^(~x.7*~x.9)>), 
                                   'g'^(~x.6*~x.7)>)
                         ) @ #vk.16 )
                    case c_kdf
                    solve( !KU( kdf(<'rk', old_rk.1, 'g'^(~x.7*~x.9)>) ) @ #vk.20 )
                      case c_kdf
                      solve( !KU( 'g'^(~x.6*~x.7) ) @ #vk.21 )
                        case OuterRatchetToSender_case_1
                        solve( !KU( ~x.11 ) @ #vk.27 )
                          case RevealEphemeral
                          by contradiction /* from formulas */
                        qed
                      next
                        case OuterRatchetToSender_case_2
                        solve( !KU( ~x.12 ) @ #vk.27 )
                          case RevealEphemeral
                          by contradiction /* from formulas */
                        qed
                      next
                        case OuterRatchetToSender_case_3
                        solve( !KU( ~x.12 ) @ #vk.27 )
                          case RevealEphemeral
                          by contradiction /* from formulas */
                        qed
                      next
                        case OuterRatchetToSender_case_4
                        solve( !KU( ~x.12 ) @ #vk.27 )
                          case RevealEphemeral_case_1
                          by contradiction /* from formulas */
                        next
                          case RevealEphemeral_case_2
                          by contradiction /* from formulas */
                        next
                          case RevealEphemeral_case_3
                          by contradiction /* from formulas */
                        qed
                      next
                        case c_exp
                        solve( !KU( ~x.6 ) @ #vk.29 )
                          case RevealEphemeral
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case Send
                solve( !KU( kdf(<'ck', ck.3>) ) @ #vk.10 )
                  case c_kdf
                  search for cycle
                  by contradiction /* cyclic backlink to CS id 13-0084 */
                qed
              qed
            qed
          qed
        next
          case SenderStart
          solve( Session( ~id.1, $A.1, 'S', ~x.4, $B.1, 'g'^~x.5, rk.1, ck.1
                 ) ▶₁ #vr )
            case OuterRatchetToSender_case_1
            solve( !KU( senc(x.8,
                             kdf(<'mk', 
                                  kdf(<'ck', 
                                       kdf(<'rk', 
                                            kdf(<'g'^(~ltk.1*~prek.1), 'g'^(~ltk.2*~x.7), 
                                                 'g'^(~prek.1*~x.7)>)
                                           >)
                                      >)
                                 >))
                   ) @ #vk.10 )
              case Send
              by solve( Session( ~id.3, $A.3, 'S', ~x.9, $B.3, pc.2, rk.2,
                                 kdf(<'rk', 
                                      kdf(<'g'^(~ltk.1*~prek.1), 'g'^(~ltk.2*~x.7), 
                                           'g'^(~prek.1*~x.7)>)
                                     >)
                        ) ▶₁ #vr.6 )
            next
              case SenderStart
              solve( !KU( kdf(<'ck', 
                               kdf(<'rk', 
                                    kdf(<'rk', 
                                         kdf(<'g'^(~ltk.3*~prek.3), 'g'^(~ltk.4*~x.9), 
                                              'g'^(~prek.3*~x.9)>)
                                        >), 
                                    'g'^(~x.6*~x.9)>)
                              >)
                     ) @ #vk.7 )
                case c_kdf
                solve( !KU( kdf(<'rk', 
                                 kdf(<'rk', 
                                      kdf(<'g'^(~ltk.3*~prek.3), 'g'^(~ltk.4*~x.9), 
                                           'g'^(~prek.3*~x.9)>)
                                     >), 
                                 'g'^(~x.6*~x.9)>)
                       ) @ #vk.13 )
                  case c_kdf
                  solve( !KU( kdf(<'rk', 
                                   kdf(<'g'^(~ltk.3*~prek.3), 'g'^(~ltk.4*~x.9), 'g'^(~prek.3*~x.9)
                                       >)
                                  >)
                         ) @ #vk.17 )
                    case c_kdf
                    solve( !KU( kdf(<'g'^(~ltk.3*~prek.3), 'g'^(~ltk.4*~x.9), 
                                     'g'^(~prek.3*~x.9)>)
                           ) @ #vk.21 )
                      case c_kdf
                      solve( !KU( 'g'^(~x.6*~x.9) ) @ #vk.18 )
                        case OuterRatchetToSender
                        solve( !KU( ~x.11 ) @ #vk.27 )
                          case RevealEphemeral
                          by contradiction /* from formulas */
                        qed
                      next
                        case SenderStart
                        solve( !KU( ~x.11 ) @ #vk.27 )
                          case RevealEphemeral
                          by contradiction /* from formulas */
                        qed
                      next
                        case c_exp
                        solve( !KU( ~x.6 ) @ #vk.29 )
                          case RevealEphemeral
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case c_senc
              solve( !KU( kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<'g'^(~ltk.1*~prek.1), 'g'^(~ltk.2*~x.7), 
                                              'g'^(~prek.1*~x.7)>)
                                        >)
                                   >)
                              >)
                     ) @ #vk.12 )
                case c_kdf
                solve( !KU( kdf(<'ck', 
                                 kdf(<'rk', 
                                      kdf(<'g'^(~ltk.1*~prek.1), 'g'^(~ltk.2*~x.7), 
                                           'g'^(~prek.1*~x.7)>)
                                     >)
                                >)
                       ) @ #vk.15 )
                  case c_kdf
                  solve( !KU( kdf(<'rk', 
                                   kdf(<'g'^(~ltk.1*~prek.1), 'g'^(~ltk.2*~x.7), 'g'^(~prek.1*~x.7)
                                       >)
                                  >)
                         ) @ #vk.18 )
                    case c_kdf
                    solve( !KU( kdf(<'g'^(~ltk.1*~prek.1), 'g'^(~ltk.2*~x.7), 
                                     'g'^(~prek.1*~x.7)>)
                           ) @ #vk.21 )
                      case c_kdf
                      solve( !KU( 'g'^(~ltk.1*~prek.1) ) @ #vk.23 )
                        case KeyGen_case_1
                        solve( !KU( ~prek.4 ) @ #vk.27 )
                          case RevealPrek
                          solve( !KU( 'g'^(~ltk.4*~x.7) ) @ #vk.25 )
                            case KeyGen
                            solve( !KU( ~x.9 ) @ #vk.28 )
                              case RevealEphemeral
                              by contradiction /* from formulas */
                            qed
                          next
                            case SenderStart
                            solve( !KU( ~ltk.7 ) @ #vk.28 )
                              case RevealLtk
                              solve( !KU( 'g'^(~prek.7*~x.9) ) @ #vk.26 )
                                case KeyGen
                                solve( !KU( ~x.10 ) @ #vk.29 )
                                  case RevealEphemeral
                                  by contradiction /* from formulas */
                                qed
                              next
                                case SenderStart
                                solve( !KU( kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.3*~prek.10), 
                                                                'g'^(~ltk.7*~x.10), 
                                                                'g'^(~prek.10*~x.10)>)
                                                          >), 
                                                      'g'^(~x.6*~x.10)>)
                                                >)
                                       ) @ #vk.7 )
                                  case c_kdf
                                  solve( !KU( kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.3*~prek.10), 
                                                             'g'^(~ltk.7*~x.10), 
                                                             'g'^(~prek.10*~x.10)>)
                                                       >), 
                                                   'g'^(~x.6*~x.10)>)
                                         ) @ #vk.32 )
                                    case c_kdf
                                    solve( !KU( 'g'^(~x.6*~x.10) ) @ #vk.37 )
                                      case OuterRatchetToSender
                                      solve( !KU( ~x.12 ) @ #vk.38 )
                                        case RevealEphemeral
                                        by contradiction /* from formulas */
                                      qed
                                    next
                                      case SenderStart
                                      solve( !KU( ~x.12 ) @ #vk.38 )
                                        case RevealEphemeral
                                        by contradiction /* from formulas */
                                      qed
                                    next
                                      case c_exp
                                      solve( !KU( ~x.6 ) @ #vk.40 )
                                        case RevealEphemeral
                                        by contradiction /* from formulas */
                                      qed
                                    qed
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~x.9 ) @ #vk.32 )
                                  case RevealEphemeral
                                  by contradiction /* from formulas */
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( ~x.7 ) @ #vk.31 )
                              case RevealEphemeral
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      next
                        case KeyGen_case_2
                        solve( !KU( ~ltk.4 ) @ #vk.27 )
                          case RevealLtk
                          solve( !KU( 'g'^(~ltk.3*~x.7) ) @ #vk.25 )
                            case KeyGen
                            solve( !KU( ~x.9 ) @ #vk.28 )
                              case RevealEphemeral
                              by contradiction /* from formulas */
                            qed
                          next
                            case SenderStart
                            solve( !KU( ~ltk.7 ) @ #vk.28 )
                              case RevealLtk
                              solve( !KU( 'g'^(~prek.7*~x.9) ) @ #vk.26 )
                                case KeyGen
                                solve( !KU( ~x.10 ) @ #vk.29 )
                                  case RevealEphemeral
                                  by contradiction /* from formulas */
                                qed
                              next
                                case SenderStart
                                solve( !KU( ~prek.10 ) @ #vk.29 )
                                  case RevealPrek
                                  solve( !KU( kdf(<'ck', 
                                                   kdf(<'rk', 
                                                        kdf(<'rk', 
                                                             kdf(<'g'^(~ltk.4*~prek.10), 
                                                                  'g'^(~x.10*~ltk.12), 
                                                                  'g'^(~prek.10*~x.10)>)
                                                            >), 
                                                        'g'^(~x.6*~x.10)>)
                                                  >)
                                         ) @ #vk.7 )
                                    case c_kdf
                                    solve( !KU( kdf(<'rk', 
                                                     kdf(<'rk', 
                                                          kdf(<'g'^(~ltk.4*~prek.10), 
                                                               'g'^(~x.10*~ltk.12), 
                                                               'g'^(~prek.10*~x.10)>)
                                                         >), 
                                                     'g'^(~x.6*~x.10)>)
                                           ) @ #vk.32 )
                                      case c_kdf
                                      solve( !KU( 'g'^(~x.6*~x.10) ) @ #vk.37 )
                                        case OuterRatchetToSender
                                        solve( !KU( ~x.12 ) @ #vk.38 )
                                          case RevealEphemeral
                                          by contradiction /* from formulas */
                                        qed
                                      next
                                        case SenderStart
                                        solve( !KU( ~x.12 ) @ #vk.38 )
                                          case RevealEphemeral
                                          by contradiction /* from formulas */
                                        qed
                                      next
                                        case c_exp
                                        solve( !KU( ~x.6 ) @ #vk.40 )
                                          case RevealEphemeral
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              next
                                case c_exp
                                solve( !KU( ~prek.7 ) @ #vk.31 )
                                  case RevealPrek
                                  solve( !KU( ~x.9 ) @ #vk.32 )
                                    case RevealEphemeral
                                    by contradiction /* from formulas */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_exp
                            solve( !KU( ~ltk.3 ) @ #vk.30 )
                              case RevealLtk
                              solve( !KU( ~x.7 ) @ #vk.31 )
                                case RevealEphemeral
                                by contradiction /* from formulas */
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_exp
                        solve( !KU( ~ltk.1 ) @ #vk.29 )
                          case RevealLtk
                          solve( !KU( ~prek.1 ) @ #vk.30 )
                            case RevealPrek
                            solve( !KU( kdf(<'ck', 
                                             kdf(<'rk', 
                                                  kdf(<'rk', 
                                                       kdf(<'g'^(~ltk.1*~prek.1), 
                                                            'g'^(~ltk.3*~x.7), 'g'^(~prek.1*~x.7)>)
                                                      >), 
                                                  'g'^(~x.6*~x.7)>)
                                            >)
                                   ) @ #vk.7 )
                              case c_kdf
                              solve( !KU( kdf(<'rk', 
                                               kdf(<'rk', 
                                                    kdf(<'g'^(~ltk.1*~prek.1), 'g'^(~ltk.3*~x.7), 
                                                         'g'^(~prek.1*~x.7)>)
                                                   >), 
                                               'g'^(~x.6*~x.7)>)
                                     ) @ #vk.33 )
                                case c_kdf
                                solve( !KU( 'g'^(~ltk.3*~x.7) ) @ #vk.25 )
                                  case KeyGen
                                  solve( !KU( ~x.9 ) @ #vk.39 )
                                    case RevealEphemeral
                                    by contradiction /* from formulas */
                                  qed
                                next
                                  case SenderStart
                                  solve( !KU( ~ltk.6 ) @ #vk.39 )
                                    case RevealLtk
                                    solve( !KU( 'g'^(~prek.6*~x.9) ) @ #vk.26 )
                                      case KeyGen
                                      solve( !KU( ~x.10 ) @ #vk.42 )
                                        case RevealEphemeral
                                        by contradiction /* from formulas */
                                      qed
                                    next
                                      case SenderStart
                                      solve( !KU( 'g'^(~x.6*~x.10) ) @ #vk.38 )
                                        case OuterRatchetToSender
                                        solve( !KU( ~x.12 ) @ #vk.45 )
                                          case RevealEphemeral
                                          by contradiction /* from formulas */
                                        qed
                                      next
                                        case SenderStart
                                        solve( !KU( ~x.12 ) @ #vk.45 )
                                          case RevealEphemeral
                                          by contradiction /* from formulas */
                                        qed
                                      next
                                        case c_exp
                                        solve( !KU( ~x.6 ) @ #vk.47 )
                                          case RevealEphemeral
                                          by contradiction /* from formulas */
                                        qed
                                      qed
                                    next
                                      case c_exp
                                      solve( !KU( ~x.9 ) @ #vk.45 )
                                        case RevealEphemeral
                                        by contradiction /* from formulas */
                                      qed
                                    qed
                                  qed
                                next
                                  case c_exp
                                  solve( !KU( ~ltk.3 ) @ #vk.41 )
                                    case RevealLtk
                                    solve( !KU( ~x.7 ) @ #vk.42 )
                                      case RevealEphemeral
                                      by contradiction /* from formulas */
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          next
            case OuterRatchetToSender_case_2
            solve( !KU( kdf(<'ck', kdf(<'rk', old_rk, 'g'^(~x.6*~x.8)>)>)
                   ) @ #vk.7 )
              case c_kdf
              solve( !KU( kdf(<'rk', old_rk, 'g'^(~x.6*~x.8)>) ) @ #vk.11 )
                case c_kdf
                solve( !KU( 'g'^(~x.6*~x.8) ) @ #vk.16 )
                  case OuterRatchetToSender
                  solve( !KU( ~x.11 ) @ #vk.17 )
                    case RevealEphemeral
                    by contradiction /* from formulas */
                  qed
                next
                  case SenderStart
                  solve( !KU( ~x.10 ) @ #vk.17 )
                    case RevealEphemeral
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  solve( !KU( ~x.6 ) @ #vk.19 )
                    case RevealEphemeral
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          next
            case OuterRatchetToSender_case_3
            solve( !KU( kdf(<'ck', 
                             kdf(<'rk', kdf(<'rk', old_rk, 'g'^(~x.7*~x.8)>), 'g'^(~x.6*~x.8)>)
                            >)
                   ) @ #vk.7 )
              case c_kdf
              solve( !KU( kdf(<'rk', kdf(<'rk', old_rk, 'g'^(~x.7*~x.8)>), 
                               'g'^(~x.6*~x.8)>)
                     ) @ #vk.13 )
                case c_kdf
                solve( !KU( 'g'^(~x.6*~x.8) ) @ #vk.18 )
                  case OuterRatchetToSender
                  solve( !KU( ~x.12 ) @ #vk.19 )
                    case RevealEphemeral
                    by contradiction /* from formulas */
                  qed
                next
                  case SenderStart
                  solve( !KU( ~x.11 ) @ #vk.19 )
                    case RevealEphemeral
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  solve( !KU( ~x.6 ) @ #vk.21 )
                    case RevealEphemeral
                    by contradiction /* from formulas */
                  qed
                qed
              qed
            qed
          next
            case Send
            solve( !KU( kdf(<'ck', ck.2>) ) @ #vk.7 )
              case c_kdf
              search for cycle
              minimize for cyclic proofs
              solve( Session( ~id.1, $A.1, 'S', ~x.4, $B.1, 'g'^~x.5, rk.1, ck.2
                     ) ▶₁ #vr.2 )
                case OuterRatchetToSender_case_1
                solve( !KU( kdf(<'ck', 
                                 kdf(<'rk', 
                                      kdf(<'rk', 
                                           kdf(<'g'^(~ltk.1*~prek.1), 'g'^(~ltk.2*~x.7), 
                                                'g'^(~prek.1*~x.7)>)
                                          >), 
                                      'g'^(~x.6*~x.7)>)
                                >)
                       ) @ #vk.10 )
                  case c_kdf
                  solve( !KU( kdf(<'rk', 
                                   kdf(<'rk', 
                                        kdf(<'g'^(~ltk.1*~prek.1), 'g'^(~ltk.2*~x.7), 
                                             'g'^(~prek.1*~x.7)>)
                                       >), 
                                   'g'^(~x.6*~x.7)>)
                         ) @ #vk.16 )
                    case c_kdf
                    solve( !KU( kdf(<'rk', 
                                     kdf(<'g'^(~ltk.1*~prek.1), 'g'^(~ltk.2*~x.7), 
                                          'g'^(~prek.1*~x.7)>)
                                    >)
                           ) @ #vk.20 )
                      case c_kdf
                      solve( !KU( kdf(<'g'^(~ltk.1*~prek.1), 'g'^(~ltk.2*~x.7), 
                                       'g'^(~prek.1*~x.7)>)
                             ) @ #vk.24 )
                        case c_kdf
                        solve( !KU( 'g'^(~x.6*~x.7) ) @ #vk.21 )
                          case OuterRatchetToSender
                          solve( !KU( ~x.10 ) @ #vk.30 )
                            case RevealEphemeral
                            by contradiction /* from formulas */
                          qed
                        next
                          case SenderStart
                          solve( !KU( ~x.10 ) @ #vk.30 )
                            case RevealEphemeral
                            by contradiction /* from formulas */
                          qed
                        next
                          case c_exp
                          solve( !KU( ~x.6 ) @ #vk.32 )
                            case RevealEphemeral
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case OuterRatchetToSender_case_2
                solve( !KU( kdf(<'ck', kdf(<'rk', old_rk, 'g'^(~x.6*~x.8)>)>)
                       ) @ #vk.10 )
                  case c_kdf
                  solve( !KU( kdf(<'rk', old_rk, 'g'^(~x.6*~x.8)>) ) @ #vk.14 )
                    case c_kdf
                    solve( !KU( 'g'^(~x.6*~x.8) ) @ #vk.19 )
                      case OuterRatchetToSender
                      solve( !KU( ~x.11 ) @ #vk.20 )
                        case RevealEphemeral
                        by contradiction /* from formulas */
                      qed
                    next
                      case SenderStart
                      solve( !KU( ~x.10 ) @ #vk.20 )
                        case RevealEphemeral
                        by contradiction /* from formulas */
                      qed
                    next
                      case c_exp
                      solve( !KU( ~x.6 ) @ #vk.22 )
                        case RevealEphemeral
                        by contradiction /* from formulas */
                      qed
                    qed
                  qed
                qed
              next
                case OuterRatchetToSender_case_3
                solve( !KU( kdf(<'ck', 
                                 kdf(<'rk', kdf(<'rk', old_rk, 'g'^(~x.7*~x.9)>), 'g'^(~x.6*~x.7)>)
                                >)
                       ) @ #vk.10 )
                  case c_kdf
                  solve( !KU( kdf(<'rk', kdf(<'rk', old_rk, 'g'^(~x.7*~x.9)>), 
                                   'g'^(~x.6*~x.7)>)
                         ) @ #vk.16 )
                    case c_kdf
                    solve( !KU( kdf(<'rk', old_rk, 'g'^(~x.7*~x.9)>) ) @ #vk.20 )
                      case c_kdf
                      solve( !KU( 'g'^(~x.6*~x.7) ) @ #vk.21 )
                        case OuterRatchetToSender
                        solve( !KU( ~x.12 ) @ #vk.27 )
                          case RevealEphemeral
                          by contradiction /* from formulas */
                        qed
                      next
                        case SenderStart
                        solve( !KU( ~x.11 ) @ #vk.27 )
                          case RevealEphemeral
                          by contradiction /* from formulas */
                        qed
                      next
                        case c_exp
                        solve( !KU( ~x.6 ) @ #vk.29 )
                          case RevealEphemeral
                          by contradiction /* from formulas */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case Send
                solve( !KU( kdf(<'ck', ck.3>) ) @ #vk.10 )
                  case c_kdf
                  search for cycle
                  by contradiction /* cyclic backlink to CS id 13-0004 */
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
next
  case SenderStart
  solve( !KU( ~m.1 ) @ #vk )
    case SenderStart
    by solve( GenEph( 'g'^~prek.1 ) @ #x.1 )
  qed
qed

















/* All wellformedness checks were successful. */

/*
Generated from:
Tamarin version 1.11.0
Maude version 3.2.1
Git revision: 4d53012802d3c526e3d794810cb15551163f4462, branch: rewrite-prover-regression
Compiled at: 2024-12-05 16:41:44.504428 UTC
*/

end