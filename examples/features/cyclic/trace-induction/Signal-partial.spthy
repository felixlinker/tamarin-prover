theory Signal begin

// Function signature and definition of the equational theory E

builtins: diffie-hellman
functions: decrypts/2, fst/1, kdf/1, pair/2, sdec/2, senc/2, snd/1,
           true/0
equations:
    decrypts(senc(m, k), k) = true,
    fst(<x.1, x.2>) = x.1,
    sdec(senc(x.1, x.2), x.2) = x.1,
    snd(<x.1, x.2>) = x.2



heuristic: O "signal-revealing.py"

/* looping facts with injective instances: Session/8 */



restriction Eq:
  "∀ a b #x. (Eq( a, b ) @ #x) ⇒ (a = b)"
  // safety formula

restriction Neq:
  "∀ a b #x. (Neq( a, b ) @ #x) ⇒ (¬(a = b))"
  // safety formula

rule (modulo E) KeyGen:
   [ Fr( ~ltk ), Fr( ~prek ) ]
  -->
   [
   !SecretKeys( $A, ~ltk, ~prek ),
   !PublicKeys( $A, 'g'^~ltk, 'g'^~prek ), Out( 'g'^~ltk ),
   Out( 'g'^~prek )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) SenderStart:
   [
   Fr( ~id ), Fr( ~x ), Fr( ~m ), !SecretKeys( $A, ~ltk, prek ),
   !PublicKeys( $B, ltpk, prepk )
   ]
  --[
  Neq( $A, $B ), Send( ~m ),
  DHSecrets( ~id, 'g'^~x, prepk, prepk^~x,
             kdf(<'rk', kdf(<prepk^~ltk, ltpk^~x, prepk^~x>)>)
  ),
  NewDHSecrets( ~id, 'g'^~x, prepk, prepk^~x,
                kdf(<'rk', kdf(<prepk^~ltk, ltpk^~x, prepk^~x>)>)
  )
  ]->
   [
   Session( ~id, $A, 'S', ~x, $B, prepk,
            kdf(<'rk', kdf(<prepk^~ltk, ltpk^~x, prepk^~x>)>),
            kdf(<'ck', kdf(<'rk', kdf(<prepk^~ltk, ltpk^~x, prepk^~x>)>)>)
   ),
   Out( <'g'^~x, 
         senc(~m,
              kdf(<'mk', 
                   kdf(<'ck', kdf(<'rk', kdf(<prepk^~ltk, ltpk^~x, prepk^~x>)>)>)>))
        >
   )
   ]

  /*
  rule (modulo AC) SenderStart:
     [
     Fr( ~id ), Fr( ~x ), Fr( ~m ), !SecretKeys( $A, ~ltk, prek ),
     !PublicKeys( $B, ltpk, prepk )
     ]
    --[
    Neq( $A, $B ), Send( ~m ),
    DHSecrets( ~id, 'g'^~x, prepk, z.2, kdf(<'rk', kdf(<z, z.1, z.2>)>)
    ),
    NewDHSecrets( ~id, 'g'^~x, prepk, z.2,
                  kdf(<'rk', kdf(<z, z.1, z.2>)>)
    )
    ]->
     [
     Session( ~id, $A, 'S', ~x, $B, prepk,
              kdf(<'rk', kdf(<z, z.1, z.2>)>),
              kdf(<'ck', kdf(<'rk', kdf(<z, z.1, z.2>)>)>)
     ),
     Out( <'g'^~x, 
           senc(~m, kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<z, z.1, z.2>)>)>)>))
          >
     )
     ]
    variants (modulo AC)
      1. ~ltk  = ~ltk.3
         ~x    = ~x.3
         ltpk  = ltpk.3
         prepk = prepk.3
         z     = prepk.3^~ltk.3
         z.1   = ltpk.3^~x.3
         z.2   = prepk.3^~x.3
    
      2. ~ltk  = ~ltk.3
         ~x    = ~x.3
         ltpk  = DH_neutral
         prepk = prepk.3
         z     = prepk.3^~ltk.3
         z.1   = DH_neutral
         z.2   = prepk.3^~x.3
    
      3. ~ltk  = ~ltk.3
         ~x    = ~x.4
         ltpk  = x.5^inv(~x.4)
         prepk = prepk.3
         z     = prepk.3^~ltk.3
         z.1   = x.5
         z.2   = prepk.3^~x.4
    
      4. ~ltk  = ~ltk.3
         ~x    = ~x.5
         ltpk  = DH_neutral
         prepk = x.7^inv(~x.5)
         z     = x.7^(~ltk.3*inv(~x.5))
         z.1   = DH_neutral
         z.2   = x.7
    
      5. ~ltk  = ~ltk.3
         ~x    = ~x.5
         ltpk  = x.6^inv((~x.5*x.7))
         prepk = prepk.3
         z     = prepk.3^~ltk.3
         z.1   = x.6^inv(x.7)
         z.2   = prepk.3^~x.5
    
      6. ~ltk  = ~ltk.3
         ~x    = ~x.5
         ltpk  = x.6^(x.7*inv(~x.5))
         prepk = prepk.3
         z     = prepk.3^~ltk.3
         z.1   = x.6^x.7
         z.2   = prepk.3^~x.5
    
      7. ~ltk  = ~ltk.3
         ~x    = ~x.6
         ltpk  = ltpk.3
         prepk = x.9^inv(~x.6)
         z     = x.9^(~ltk.3*inv(~x.6))
         z.1   = ltpk.3^~x.6
         z.2   = x.9
    
      8. ~ltk  = ~ltk.3
         ~x    = ~x.6
         ltpk  = DH_neutral
         prepk = x.8^inv((~x.6*x.9))
         z     = x.8^(~ltk.3*inv((~x.6*x.9)))
         z.1   = DH_neutral
         z.2   = x.8^inv(x.9)
    
      9. ~ltk  = ~ltk.3
         ~x    = ~x.6
         ltpk  = DH_neutral
         prepk = x.8^(x.9*inv(~x.6))
         z     = x.8^(~ltk.3*x.9*inv(~x.6))
         z.1   = DH_neutral
         z.2   = x.8^x.9
    
     10. ~ltk  = ~ltk.3
         ~x    = ~x.6
         ltpk  = x.7^inv(~x.6)
         prepk = x.9^inv(~x.6)
         z     = x.9^(~ltk.3*inv(~x.6))
         z.1   = x.7
         z.2   = x.9
    
     11. ~ltk  = ~ltk.3
         ~x    = ~x.6
         ltpk  = x.7^(x.8*inv((~x.6*x.9)))
         prepk = prepk.3
         z     = prepk.3^~ltk.3
         z.1   = x.7^(x.8*inv(x.9))
         z.2   = prepk.3^~x.6
    
     12. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = ltpk.3
         prepk = x.5^x.6
         z     = x.5^(~ltk.3*x.6)
         z.1   = ltpk.3^~x.7
         z.2   = x.5^(x.6*~x.7)
    
     13. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = ltpk.3
         prepk = x.10^inv((~x.7*x.11))
         z     = x.10^(~ltk.3*inv((~x.7*x.11)))
         z.1   = ltpk.3^~x.7
         z.2   = x.10^inv(x.11)
    
     14. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = ltpk.3
         prepk = x.10^(x.11*inv(~x.7))
         z     = x.10^(~ltk.3*x.11*inv(~x.7))
         z.1   = ltpk.3^~x.7
         z.2   = x.10^x.11
    
     15. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = DH_neutral
         prepk = x.5^x.6
         z     = x.5^(~ltk.3*x.6)
         z.1   = DH_neutral
         z.2   = x.5^(x.6*~x.7)
    
     16. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = DH_neutral
         prepk = x.9^(x.10*inv((~x.7*x.11)))
         z     = x.9^(~ltk.3*x.10*inv((~x.7*x.11)))
         z.1   = DH_neutral
         z.2   = x.9^(x.10*inv(x.11))
    
     17. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = x.5^x.6
         prepk = prepk.3
         z     = prepk.3^~ltk.3
         z.1   = x.5^(x.6*~x.7)
         z.2   = prepk.3^~x.7
    
     18. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = x.8^x.9
         prepk = x.11^inv(~x.7)
         z     = x.11^(~ltk.3*inv(~x.7))
         z.1   = x.8^(~x.7*x.9)
         z.2   = x.11
    
     19. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = x.8^inv(~x.7)
         prepk = x.10^x.11
         z     = x.10^(~ltk.3*x.11)
         z.1   = x.8
         z.2   = x.10^(~x.7*x.11)
    
     20. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = x.8^inv(~x.7)
         prepk = x.10^inv((~x.7*x.11))
         z     = x.10^(~ltk.3*inv((~x.7*x.11)))
         z.1   = x.8
         z.2   = x.10^inv(x.11)
    
     21. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = x.8^inv(~x.7)
         prepk = x.10^(x.11*inv(~x.7))
         z     = x.10^(~ltk.3*x.11*inv(~x.7))
         z.1   = x.8
         z.2   = x.10^x.11
    
     22. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = x.8^inv((~x.7*x.9))
         prepk = x.11^inv(~x.7)
         z     = x.11^(~ltk.3*inv(~x.7))
         z.1   = x.8^inv(x.9)
         z.2   = x.11
    
     23. ~ltk  = ~ltk.3
         ~x    = ~x.7
         ltpk  = x.8^(x.9*inv(~x.7))
         prepk = x.11^inv(~x.7)
         z     = x.11^(~ltk.3*inv(~x.7))
         z.1   = x.8^x.9
         z.2   = x.11
    
     24. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = ltpk.3
         prepk = x.11^(x.12*inv((~x.8*x.13)))
         z     = x.11^(~ltk.3*x.12*inv((~x.8*x.13)))
         z.1   = ltpk.3^~x.8
         z.2   = x.11^(x.12*inv(x.13))
    
     25. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^x.10
         prepk = x.12^inv((~x.8*x.13))
         z     = x.12^(~ltk.3*inv((~x.8*x.13)))
         z.1   = x.9^(~x.8*x.10)
         z.2   = x.12^inv(x.13)
    
     26. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^x.10
         prepk = x.12^(x.13*inv(~x.8))
         z     = x.12^(~ltk.3*x.13*inv(~x.8))
         z.1   = x.9^(~x.8*x.10)
         z.2   = x.12^x.13
    
     27. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^inv(~x.8)
         prepk = x.11^(x.12*inv((~x.8*x.13)))
         z     = x.11^(~ltk.3*x.12*inv((~x.8*x.13)))
         z.1   = x.9
         z.2   = x.11^(x.12*inv(x.13))
    
     28. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^inv((~x.8*x.10))
         prepk = x.12^x.13
         z     = x.12^(~ltk.3*x.13)
         z.1   = x.9^inv(x.10)
         z.2   = x.12^(~x.8*x.13)
    
     29. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^inv((~x.8*x.10))
         prepk = x.12^inv((~x.8*x.13))
         z     = x.12^(~ltk.3*inv((~x.8*x.13)))
         z.1   = x.9^inv(x.10)
         z.2   = x.12^inv(x.13)
    
     30. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^inv((~x.8*x.10))
         prepk = x.12^(x.13*inv(~x.8))
         z     = x.12^(~ltk.3*x.13*inv(~x.8))
         z.1   = x.9^inv(x.10)
         z.2   = x.12^x.13
    
     31. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^(x.10*inv(~x.8))
         prepk = x.12^x.13
         z     = x.12^(~ltk.3*x.13)
         z.1   = x.9^x.10
         z.2   = x.12^(~x.8*x.13)
    
     32. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^(x.10*inv(~x.8))
         prepk = x.12^inv((~x.8*x.13))
         z     = x.12^(~ltk.3*inv((~x.8*x.13)))
         z.1   = x.9^x.10
         z.2   = x.12^inv(x.13)
    
     33. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^(x.10*inv(~x.8))
         prepk = x.12^(x.13*inv(~x.8))
         z     = x.12^(~ltk.3*x.13*inv(~x.8))
         z.1   = x.9^x.10
         z.2   = x.12^x.13
    
     34. ~ltk  = ~ltk.3
         ~x    = ~x.8
         ltpk  = x.9^(x.10*inv((~x.8*x.11)))
         prepk = x.13^inv(~x.8)
         z     = x.13^(~ltk.3*inv(~x.8))
         z.1   = x.9^(x.10*inv(x.11))
         z.2   = x.13
    
     35. ~ltk  = ~ltk.3
         ~x    = ~x.9
         ltpk  = x.10^x.11
         prepk = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.13^(~ltk.3*x.14*inv((~x.9*x.15)))
         z.1   = x.10^(~x.9*x.11)
         z.2   = x.13^(x.14*inv(x.15))
    
     36. ~ltk  = ~ltk.3
         ~x    = ~x.9
         ltpk  = x.10^inv((~x.9*x.11))
         prepk = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.13^(~ltk.3*x.14*inv((~x.9*x.15)))
         z.1   = x.10^inv(x.11)
         z.2   = x.13^(x.14*inv(x.15))
    
     37. ~ltk  = ~ltk.3
         ~x    = ~x.9
         ltpk  = x.10^(x.11*inv(~x.9))
         prepk = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.13^(~ltk.3*x.14*inv((~x.9*x.15)))
         z.1   = x.10^x.11
         z.2   = x.13^(x.14*inv(x.15))
    
     38. ~ltk  = ~ltk.3
         ~x    = ~x.9
         ltpk  = x.10^(x.11*inv((~x.9*x.12)))
         prepk = x.14^x.15
         z     = x.14^(~ltk.3*x.15)
         z.1   = x.10^(x.11*inv(x.12))
         z.2   = x.14^(~x.9*x.15)
    
     39. ~ltk  = ~ltk.3
         ~x    = ~x.9
         ltpk  = x.10^(x.11*inv((~x.9*x.12)))
         prepk = x.14^inv((~x.9*x.15))
         z     = x.14^(~ltk.3*inv((~x.9*x.15)))
         z.1   = x.10^(x.11*inv(x.12))
         z.2   = x.14^inv(x.15)
    
     40. ~ltk  = ~ltk.3
         ~x    = ~x.9
         ltpk  = x.10^(x.11*inv((~x.9*x.12)))
         prepk = x.14^(x.15*inv(~x.9))
         z     = x.14^(~ltk.3*x.15*inv(~x.9))
         z.1   = x.10^(x.11*inv(x.12))
         z.2   = x.14^x.15
    
     41. ~ltk  = ~ltk.3
         ~x    = ~x.10
         ltpk  = x.11^(x.12*inv((~x.10*x.13)))
         prepk = x.15^(x.16*inv((~x.10*x.17)))
         z     = x.15^(~ltk.3*x.16*inv((~x.10*x.17)))
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.15^(x.16*inv(x.17))
    
     42. ~ltk  = ~ltk.3
         ~x    = ~x.13
         ltpk  = x.8^x.9
         prepk = x.11^x.12
         z     = x.11^(~ltk.3*x.12)
         z.1   = x.8^(x.9*~x.13)
         z.2   = x.11^(x.12*~x.13)
    
     43. ~ltk  = ~x.6
         ~x    = ~x.6
         ltpk  = DH_neutral
         prepk = x.9^inv(~x.6)
         z     = x.9
         z.1   = DH_neutral
         z.2   = x.9
    
     44. ~ltk  = ~x.7
         ~x    = ~x.7
         ltpk  = ltpk.3
         prepk = x.11^inv(~x.7)
         z     = x.11
         z.1   = ltpk.3^~x.7
         z.2   = x.11
    
     45. ~ltk  = ~x.7
         ~x    = ~x.7
         ltpk  = DH_neutral
         prepk = x.10^inv((~x.7*x.11))
         z     = x.10^inv(x.11)
         z.1   = DH_neutral
         z.2   = x.10^inv(x.11)
    
     46. ~ltk  = ~x.7
         ~x    = ~x.7
         ltpk  = DH_neutral
         prepk = x.10^(x.11*inv(~x.7))
         z     = x.10^x.11
         z.1   = DH_neutral
         z.2   = x.10^x.11
    
     47. ~ltk  = ~x.7
         ~x    = ~x.7
         ltpk  = x.9^inv(~x.7)
         prepk = x.11^inv(~x.7)
         z     = x.11
         z.1   = x.9
         z.2   = x.11
    
     48. ~ltk  = ~x.7
         ~x    = ~x.9
         ltpk  = DH_neutral
         prepk = x.11^inv((~x.7*~x.9))
         z     = x.11^inv(~x.9)
         z.1   = DH_neutral
         z.2   = x.11^inv(~x.7)
    
     49. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = ltpk.3
         prepk = x.12^inv((~x.8*x.13))
         z     = x.12^inv(x.13)
         z.1   = ltpk.3^~x.8
         z.2   = x.12^inv(x.13)
    
     50. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = ltpk.3
         prepk = x.12^(x.13*inv(~x.8))
         z     = x.12^x.13
         z.1   = ltpk.3^~x.8
         z.2   = x.12^x.13
    
     51. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = DH_neutral
         prepk = x.11^(x.12*inv((~x.8*x.13)))
         z     = x.11^(x.12*inv(x.13))
         z.1   = DH_neutral
         z.2   = x.11^(x.12*inv(x.13))
    
     52. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = x.10^x.11
         prepk = x.13^inv(~x.8)
         z     = x.13
         z.1   = x.10^(~x.8*x.11)
         z.2   = x.13
    
     53. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = x.10^inv(~x.8)
         prepk = x.12^inv((~x.8*x.13))
         z     = x.12^inv(x.13)
         z.1   = x.10
         z.2   = x.12^inv(x.13)
    
     54. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = x.10^inv(~x.8)
         prepk = x.12^(x.13*inv(~x.8))
         z     = x.12^x.13
         z.1   = x.10
         z.2   = x.12^x.13
    
     55. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = x.10^inv((~x.8*x.11))
         prepk = x.13^inv(~x.8)
         z     = x.13
         z.1   = x.10^inv(x.11)
         z.2   = x.13
    
     56. ~ltk  = ~x.8
         ~x    = ~x.8
         ltpk  = x.10^(x.11*inv(~x.8))
         prepk = x.13^inv(~x.8)
         z     = x.13
         z.1   = x.10^x.11
         z.2   = x.13
    
     57. ~ltk  = ~x.8
         ~x    = ~x.10
         ltpk  = ltpk.3
         prepk = x.13^inv((~x.8*~x.10))
         z     = x.13^inv(~x.10)
         z.1   = ltpk.3^~x.10
         z.2   = x.13^inv(~x.8)
    
     58. ~ltk  = ~x.8
         ~x    = ~x.10
         ltpk  = DH_neutral
         prepk = x.12^inv((~x.8*~x.10*x.13))
         z     = x.12^inv((~x.10*x.13))
         z.1   = DH_neutral
         z.2   = x.12^inv((~x.8*x.13))
    
     59. ~ltk  = ~x.8
         ~x    = ~x.10
         ltpk  = DH_neutral
         prepk = x.12^(x.13*inv((~x.8*~x.10)))
         z     = x.12^(x.13*inv(~x.10))
         z.1   = DH_neutral
         z.2   = x.12^(x.13*inv(~x.8))
    
     60. ~ltk  = ~x.8
         ~x    = ~x.10
         ltpk  = x.11^inv(~x.10)
         prepk = x.13^inv(~x.8)
         z     = x.13
         z.1   = x.11
         z.2   = x.13^(~x.10*inv(~x.8))
    
     61. ~ltk  = ~x.8
         ~x    = ~x.10
         ltpk  = x.11^inv(~x.10)
         prepk = x.13^inv((~x.8*~x.10))
         z     = x.13^inv(~x.10)
         z.1   = x.11
         z.2   = x.13^inv(~x.8)
    
     62. ~ltk  = ~x.8
         ~x    = ~x.13
         ltpk  = DH_neutral
         prepk = x.12^inv(~x.8)
         z     = x.12
         z.1   = DH_neutral
         z.2   = x.12^(~x.13*inv(~x.8))
    
     63. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = ltpk.3
         prepk = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.13^(x.14*inv(x.15))
         z.1   = ltpk.3^~x.9
         z.2   = x.13^(x.14*inv(x.15))
    
     64. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^x.12
         prepk = x.14^inv((~x.9*x.15))
         z     = x.14^inv(x.15)
         z.1   = x.11^(~x.9*x.12)
         z.2   = x.14^inv(x.15)
    
     65. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^x.12
         prepk = x.14^(x.15*inv(~x.9))
         z     = x.14^x.15
         z.1   = x.11^(~x.9*x.12)
         z.2   = x.14^x.15
    
     66. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^inv(~x.9)
         prepk = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.13^(x.14*inv(x.15))
         z.1   = x.11
         z.2   = x.13^(x.14*inv(x.15))
    
     67. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^inv((~x.9*x.12))
         prepk = x.14^inv((~x.9*x.15))
         z     = x.14^inv(x.15)
         z.1   = x.11^inv(x.12)
         z.2   = x.14^inv(x.15)
    
     68. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^inv((~x.9*x.12))
         prepk = x.14^(x.15*inv(~x.9))
         z     = x.14^x.15
         z.1   = x.11^inv(x.12)
         z.2   = x.14^x.15
    
     69. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^(x.12*inv(~x.9))
         prepk = x.14^inv((~x.9*x.15))
         z     = x.14^inv(x.15)
         z.1   = x.11^x.12
         z.2   = x.14^inv(x.15)
    
     70. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^(x.12*inv(~x.9))
         prepk = x.14^(x.15*inv(~x.9))
         z     = x.14^x.15
         z.1   = x.11^x.12
         z.2   = x.14^x.15
    
     71. ~ltk  = ~x.9
         ~x    = ~x.9
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         prepk = x.15^inv(~x.9)
         z     = x.15
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.15
    
     72. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = ltpk.3
         prepk = x.14^inv((~x.9*~x.11*x.15))
         z     = x.14^inv((~x.11*x.15))
         z.1   = ltpk.3^~x.11
         z.2   = x.14^inv((~x.9*x.15))
    
     73. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = ltpk.3
         prepk = x.14^(x.15*inv((~x.9*~x.11)))
         z     = x.14^(x.15*inv(~x.11))
         z.1   = ltpk.3^~x.11
         z.2   = x.14^(x.15*inv(~x.9))
    
     74. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = DH_neutral
         prepk = x.13^(x.14*inv((~x.9*~x.11*x.15)))
         z     = x.13^(x.14*inv((~x.11*x.15)))
         z.1   = DH_neutral
         z.2   = x.13^(x.14*inv((~x.9*x.15)))
    
     75. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^x.13
         prepk = x.15^inv((~x.9*~x.11))
         z     = x.15^inv(~x.11)
         z.1   = x.12^(~x.11*x.13)
         z.2   = x.15^inv(~x.9)
    
     76. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^inv(~x.11)
         prepk = x.14^inv((~x.9*~x.11*x.15))
         z     = x.14^inv((~x.11*x.15))
         z.1   = x.12
         z.2   = x.14^inv((~x.9*x.15))
    
     77. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^inv(~x.11)
         prepk = x.14^inv((~x.9*x.15))
         z     = x.14^inv(x.15)
         z.1   = x.12
         z.2   = x.14^(~x.11*inv((~x.9*x.15)))
    
     78. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^inv(~x.11)
         prepk = x.14^(x.15*inv(~x.9))
         z     = x.14^x.15
         z.1   = x.12
         z.2   = x.14^(~x.11*x.15*inv(~x.9))
    
     79. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^inv(~x.11)
         prepk = x.14^(x.15*inv((~x.9*~x.11)))
         z     = x.14^(x.15*inv(~x.11))
         z.1   = x.12
         z.2   = x.14^(x.15*inv(~x.9))
    
     80. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^inv((~x.11*x.13))
         prepk = x.15^inv(~x.9)
         z     = x.15
         z.1   = x.12^inv(x.13)
         z.2   = x.15^(~x.11*inv(~x.9))
    
     81. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^inv((~x.11*x.13))
         prepk = x.15^inv((~x.9*~x.11))
         z     = x.15^inv(~x.11)
         z.1   = x.12^inv(x.13)
         z.2   = x.15^inv(~x.9)
    
     82. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^(x.13*inv(~x.11))
         prepk = x.15^inv(~x.9)
         z     = x.15
         z.1   = x.12^x.13
         z.2   = x.15^(~x.11*inv(~x.9))
    
     83. ~ltk  = ~x.9
         ~x    = ~x.11
         ltpk  = x.12^(x.13*inv(~x.11))
         prepk = x.15^inv((~x.9*~x.11))
         z     = x.15^inv(~x.11)
         z.1   = x.12^x.13
         z.2   = x.15^inv(~x.9)
    
     84. ~ltk  = ~x.9
         ~x    = ~x.15
         ltpk  = ltpk.3
         prepk = x.14^inv(~x.9)
         z     = x.14
         z.1   = ltpk.3^~x.15
         z.2   = x.14^(~x.15*inv(~x.9))
    
     85. ~ltk  = ~x.9
         ~x    = ~x.15
         ltpk  = DH_neutral
         prepk = x.13^inv((~x.9*x.14))
         z     = x.13^inv(x.14)
         z.1   = DH_neutral
         z.2   = x.13^(~x.15*inv((~x.9*x.14)))
    
     86. ~ltk  = ~x.9
         ~x    = ~x.15
         ltpk  = DH_neutral
         prepk = x.13^(x.14*inv(~x.9))
         z     = x.13^x.14
         z.1   = DH_neutral
         z.2   = x.13^(x.14*~x.15*inv(~x.9))
    
     87. ~ltk  = ~x.10
         ~x    = ~x.10
         ltpk  = x.12^x.13
         prepk = x.15^(x.16*inv((~x.10*x.17)))
         z     = x.15^(x.16*inv(x.17))
         z.1   = x.12^(~x.10*x.13)
         z.2   = x.15^(x.16*inv(x.17))
    
     88. ~ltk  = ~x.10
         ~x    = ~x.10
         ltpk  = x.12^inv((~x.10*x.13))
         prepk = x.15^(x.16*inv((~x.10*x.17)))
         z     = x.15^(x.16*inv(x.17))
         z.1   = x.12^inv(x.13)
         z.2   = x.15^(x.16*inv(x.17))
    
     89. ~ltk  = ~x.10
         ~x    = ~x.10
         ltpk  = x.12^(x.13*inv(~x.10))
         prepk = x.15^(x.16*inv((~x.10*x.17)))
         z     = x.15^(x.16*inv(x.17))
         z.1   = x.12^x.13
         z.2   = x.15^(x.16*inv(x.17))
    
     90. ~ltk  = ~x.10
         ~x    = ~x.10
         ltpk  = x.12^(x.13*inv((~x.10*x.14)))
         prepk = x.16^inv((~x.10*x.17))
         z     = x.16^inv(x.17)
         z.1   = x.12^(x.13*inv(x.14))
         z.2   = x.16^inv(x.17)
    
     91. ~ltk  = ~x.10
         ~x    = ~x.10
         ltpk  = x.12^(x.13*inv((~x.10*x.14)))
         prepk = x.16^(x.17*inv(~x.10))
         z     = x.16^x.17
         z.1   = x.12^(x.13*inv(x.14))
         z.2   = x.16^x.17
    
     92. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = ltpk.3
         prepk = x.15^(x.16*inv((~x.10*~x.12*x.17)))
         z     = x.15^(x.16*inv((~x.12*x.17)))
         z.1   = ltpk.3^~x.12
         z.2   = x.15^(x.16*inv((~x.10*x.17)))
    
     93. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^x.14
         prepk = x.16^inv((~x.10*~x.12*x.17))
         z     = x.16^inv((~x.12*x.17))
         z.1   = x.13^(~x.12*x.14)
         z.2   = x.16^inv((~x.10*x.17))
    
     94. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^x.14
         prepk = x.16^(x.17*inv((~x.10*~x.12)))
         z     = x.16^(x.17*inv(~x.12))
         z.1   = x.13^(~x.12*x.14)
         z.2   = x.16^(x.17*inv(~x.10))
    
     95. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^inv(~x.12)
         prepk = x.15^(x.16*inv((~x.10*~x.12*x.17)))
         z     = x.15^(x.16*inv((~x.12*x.17)))
         z.1   = x.13
         z.2   = x.15^(x.16*inv((~x.10*x.17)))
    
     96. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^inv(~x.12)
         prepk = x.15^(x.16*inv((~x.10*x.17)))
         z     = x.15^(x.16*inv(x.17))
         z.1   = x.13
         z.2   = x.15^(~x.12*x.16*inv((~x.10*x.17)))
    
     97. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^inv((~x.12*x.14))
         prepk = x.16^inv((~x.10*~x.12*x.17))
         z     = x.16^inv((~x.12*x.17))
         z.1   = x.13^inv(x.14)
         z.2   = x.16^inv((~x.10*x.17))
    
     98. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^inv((~x.12*x.14))
         prepk = x.16^inv((~x.10*x.17))
         z     = x.16^inv(x.17)
         z.1   = x.13^inv(x.14)
         z.2   = x.16^(~x.12*inv((~x.10*x.17)))
    
     99. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^inv((~x.12*x.14))
         prepk = x.16^(x.17*inv(~x.10))
         z     = x.16^x.17
         z.1   = x.13^inv(x.14)
         z.2   = x.16^(~x.12*x.17*inv(~x.10))
    
    100. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^inv((~x.12*x.14))
         prepk = x.16^(x.17*inv((~x.10*~x.12)))
         z     = x.16^(x.17*inv(~x.12))
         z.1   = x.13^inv(x.14)
         z.2   = x.16^(x.17*inv(~x.10))
    
    101. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^(x.14*inv(~x.12))
         prepk = x.16^inv((~x.10*~x.12*x.17))
         z     = x.16^inv((~x.12*x.17))
         z.1   = x.13^x.14
         z.2   = x.16^inv((~x.10*x.17))
    
    102. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^(x.14*inv(~x.12))
         prepk = x.16^inv((~x.10*x.17))
         z     = x.16^inv(x.17)
         z.1   = x.13^x.14
         z.2   = x.16^(~x.12*inv((~x.10*x.17)))
    
    103. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^(x.14*inv(~x.12))
         prepk = x.16^(x.17*inv(~x.10))
         z     = x.16^x.17
         z.1   = x.13^x.14
         z.2   = x.16^(~x.12*x.17*inv(~x.10))
    
    104. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^(x.14*inv(~x.12))
         prepk = x.16^(x.17*inv((~x.10*~x.12)))
         z     = x.16^(x.17*inv(~x.12))
         z.1   = x.13^x.14
         z.2   = x.16^(x.17*inv(~x.10))
    
    105. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^(x.14*inv((~x.12*x.15)))
         prepk = x.17^inv(~x.10)
         z     = x.17
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.17^(~x.12*inv(~x.10))
    
    106. ~ltk  = ~x.10
         ~x    = ~x.12
         ltpk  = x.13^(x.14*inv((~x.12*x.15)))
         prepk = x.17^inv((~x.10*~x.12))
         z     = x.17^inv(~x.12)
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.17^inv(~x.10)
    
    107. ~ltk  = ~x.10
         ~x    = ~x.17
         ltpk  = ltpk.3
         prepk = x.15^inv((~x.10*x.16))
         z     = x.15^inv(x.16)
         z.1   = ltpk.3^~x.17
         z.2   = x.15^(~x.17*inv((~x.10*x.16)))
    
    108. ~ltk  = ~x.10
         ~x    = ~x.17
         ltpk  = ltpk.3
         prepk = x.15^(x.16*inv(~x.10))
         z     = x.15^x.16
         z.1   = ltpk.3^~x.17
         z.2   = x.15^(x.16*~x.17*inv(~x.10))
    
    109. ~ltk  = ~x.10
         ~x    = ~x.17
         ltpk  = DH_neutral
         prepk = x.14^(x.15*inv((~x.10*x.16)))
         z     = x.14^(x.15*inv(x.16))
         z.1   = DH_neutral
         z.2   = x.14^(x.15*~x.17*inv((~x.10*x.16)))
    
    110. ~ltk  = ~x.10
         ~x    = ~x.17
         ltpk  = x.13^x.14
         prepk = x.16^inv(~x.10)
         z     = x.16
         z.1   = x.13^(x.14*~x.17)
         z.2   = x.16^(~x.17*inv(~x.10))
    
    111. ~ltk  = ~x.11
         ~x    = ~x.11
         ltpk  = x.13^(x.14*inv((~x.11*x.15)))
         prepk = x.17^(x.18*inv((~x.11*x.19)))
         z     = x.17^(x.18*inv(x.19))
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.17^(x.18*inv(x.19))
    
    112. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^x.15
         prepk = x.17^(x.18*inv((~x.11*~x.13*x.19)))
         z     = x.17^(x.18*inv((~x.13*x.19)))
         z.1   = x.14^(~x.13*x.15)
         z.2   = x.17^(x.18*inv((~x.11*x.19)))
    
    113. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^inv((~x.13*x.15))
         prepk = x.17^(x.18*inv((~x.11*~x.13*x.19)))
         z     = x.17^(x.18*inv((~x.13*x.19)))
         z.1   = x.14^inv(x.15)
         z.2   = x.17^(x.18*inv((~x.11*x.19)))
    
    114. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^inv((~x.13*x.15))
         prepk = x.17^(x.18*inv((~x.11*x.19)))
         z     = x.17^(x.18*inv(x.19))
         z.1   = x.14^inv(x.15)
         z.2   = x.17^(~x.13*x.18*inv((~x.11*x.19)))
    
    115. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^(x.15*inv(~x.13))
         prepk = x.17^(x.18*inv((~x.11*~x.13*x.19)))
         z     = x.17^(x.18*inv((~x.13*x.19)))
         z.1   = x.14^x.15
         z.2   = x.17^(x.18*inv((~x.11*x.19)))
    
    116. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^(x.15*inv(~x.13))
         prepk = x.17^(x.18*inv((~x.11*x.19)))
         z     = x.17^(x.18*inv(x.19))
         z.1   = x.14^x.15
         z.2   = x.17^(~x.13*x.18*inv((~x.11*x.19)))
    
    117. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^(x.15*inv((~x.13*x.16)))
         prepk = x.18^inv((~x.11*~x.13*x.19))
         z     = x.18^inv((~x.13*x.19))
         z.1   = x.14^(x.15*inv(x.16))
         z.2   = x.18^inv((~x.11*x.19))
    
    118. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^(x.15*inv((~x.13*x.16)))
         prepk = x.18^inv((~x.11*x.19))
         z     = x.18^inv(x.19)
         z.1   = x.14^(x.15*inv(x.16))
         z.2   = x.18^(~x.13*inv((~x.11*x.19)))
    
    119. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^(x.15*inv((~x.13*x.16)))
         prepk = x.18^(x.19*inv(~x.11))
         z     = x.18^x.19
         z.1   = x.14^(x.15*inv(x.16))
         z.2   = x.18^(~x.13*x.19*inv(~x.11))
    
    120. ~ltk  = ~x.11
         ~x    = ~x.13
         ltpk  = x.14^(x.15*inv((~x.13*x.16)))
         prepk = x.18^(x.19*inv((~x.11*~x.13)))
         z     = x.18^(x.19*inv(~x.13))
         z.1   = x.14^(x.15*inv(x.16))
         z.2   = x.18^(x.19*inv(~x.11))
    
    121. ~ltk  = ~x.11
         ~x    = ~x.19
         ltpk  = ltpk.3
         prepk = x.16^(x.17*inv((~x.11*x.18)))
         z     = x.16^(x.17*inv(x.18))
         z.1   = ltpk.3^~x.19
         z.2   = x.16^(x.17*~x.19*inv((~x.11*x.18)))
    
    122. ~ltk  = ~x.11
         ~x    = ~x.19
         ltpk  = x.14^x.15
         prepk = x.17^inv((~x.11*x.18))
         z     = x.17^inv(x.18)
         z.1   = x.14^(x.15*~x.19)
         z.2   = x.17^(~x.19*inv((~x.11*x.18)))
    
    123. ~ltk  = ~x.11
         ~x    = ~x.19
         ltpk  = x.14^x.15
         prepk = x.17^(x.18*inv(~x.11))
         z     = x.17^x.18
         z.1   = x.14^(x.15*~x.19)
         z.2   = x.17^(x.18*~x.19*inv(~x.11))
    
    124. ~ltk  = ~x.12
         ~x    = ~x.14
         ltpk  = x.15^(x.16*inv((~x.14*x.17)))
         prepk = x.19^(x.20*inv((~x.12*~x.14*x.21)))
         z     = x.19^(x.20*inv((~x.14*x.21)))
         z.1   = x.15^(x.16*inv(x.17))
         z.2   = x.19^(x.20*inv((~x.12*x.21)))
    
    125. ~ltk  = ~x.12
         ~x    = ~x.14
         ltpk  = x.15^(x.16*inv((~x.14*x.17)))
         prepk = x.19^(x.20*inv((~x.12*x.21)))
         z     = x.19^(x.20*inv(x.21))
         z.1   = x.15^(x.16*inv(x.17))
         z.2   = x.19^(~x.14*x.20*inv((~x.12*x.21)))
    
    126. ~ltk  = ~x.12
         ~x    = ~x.21
         ltpk  = x.15^x.16
         prepk = x.18^(x.19*inv((~x.12*x.20)))
         z     = x.18^(x.19*inv(x.20))
         z.1   = x.15^(x.16*~x.21)
         z.2   = x.18^(x.19*~x.21*inv((~x.12*x.20)))
    
    127. ~x    = ~x.3
         ltpk  = ltpk.3
         prepk = DH_neutral
         z     = DH_neutral
         z.1   = ltpk.3^~x.3
         z.2   = DH_neutral
    
    128. ~x    = ~x.4
         ltpk  = x.5^inv(~x.4)
         prepk = DH_neutral
         z     = DH_neutral
         z.1   = x.5
         z.2   = DH_neutral
    
    129. ~x    = ~x.5
         ltpk  = x.6^inv((~x.5*x.7))
         prepk = DH_neutral
         z     = DH_neutral
         z.1   = x.6^inv(x.7)
         z.2   = DH_neutral
    
    130. ~x    = ~x.5
         ltpk  = x.6^(x.7*inv(~x.5))
         prepk = DH_neutral
         z     = DH_neutral
         z.1   = x.6^x.7
         z.2   = DH_neutral
    
    131. ~x    = ~x.6
         ltpk  = x.7^(x.8*inv((~x.6*x.9)))
         prepk = DH_neutral
         z     = DH_neutral
         z.1   = x.7^(x.8*inv(x.9))
         z.2   = DH_neutral
    
    132. ~x    = ~x.7
         ltpk  = x.5^x.6
         prepk = DH_neutral
         z     = DH_neutral
         z.1   = x.5^(x.6*~x.7)
         z.2   = DH_neutral
    
    133. ltpk  = DH_neutral
         prepk = DH_neutral
         z     = DH_neutral
         z.1   = DH_neutral
         z.2   = DH_neutral
  */

rule (modulo E) Send:
   [ Fr( ~m ), Session( ~id, $A, 'S', ~x, $B, pc, rk, ck ) ]
  --[
  Send( ~m ), DHSecrets( ~id, 'g'^~x, pc, pc^~x, rk ),
  ChainKey( ~id, kdf(<'ck', ck>) )
  ]->
   [
   Session( ~id, $A, 'S', ~x, $B, pc, rk, kdf(<'ck', ck>) ),
   Out( senc(~m, kdf(<'mk', kdf(<'ck', ck>)>)) )
   ]

  // loop breaker: [1]
  /*
  rule (modulo AC) Send:
     [ Fr( ~m ), Session( ~id, $A, 'S', ~x, $B, pc, rk, ck ) ]
    --[
    Send( ~m ), DHSecrets( ~id, 'g'^~x, pc, z, rk ),
    ChainKey( ~id, kdf(<'ck', ck>) )
    ]->
     [
     Session( ~id, $A, 'S', ~x, $B, pc, rk, kdf(<'ck', ck>) ),
     Out( senc(~m, kdf(<'mk', kdf(<'ck', ck>)>)) )
     ]
    variants (modulo AC)
    1. ~x    = ~x.3
       pc    = pc.3
       z     = pc.3^~x.3
    
    2. ~x    = ~x.5
       pc    = x.7^inv(~x.5)
       z     = x.7
    
    3. ~x    = ~x.6
       pc    = x.8^inv((~x.6*x.9))
       z     = x.8^inv(x.9)
    
    4. ~x    = ~x.6
       pc    = x.8^(x.9*inv(~x.6))
       z     = x.8^x.9
    
    5. ~x    = ~x.7
       pc    = x.5^x.6
       z     = x.5^(x.6*~x.7)
    
    6. ~x    = ~x.7
       pc    = x.9^(x.10*inv((~x.7*x.11)))
       z     = x.9^(x.10*inv(x.11))
    
    7. pc    = DH_neutral
       z     = DH_neutral
    // loop breaker: [1]
  */

rule (modulo E) ReceiverStart:
   [
   Fr( ~id ), !SecretKeys( $A, ~ltk, ~prek ),
   !PublicKeys( $B, ltpk, prepk ), In( <pc, enc> )
   ]
  --[
  Neq( $A, $B ), Neq( pc, DH_neutral ), Neq( pc, 'g' ),
  Receive( sdec(enc,
                kdf(<'mk', 
                     kdf(<'ck', kdf(<'rk', kdf(<ltpk^~prek, pc^~ltk, pc^~prek>)>)>)>))
  ),
  DHSecrets( ~id, 'g'^~prek, pc, pc^~prek,
             kdf(<'rk', kdf(<ltpk^~prek, pc^~ltk, pc^~prek>)>)
  ),
  NewDHSecrets( ~id, 'g'^~prek, pc, pc^~prek,
                kdf(<'rk', kdf(<ltpk^~prek, pc^~ltk, pc^~prek>)>)
  ),
  Eq( decrypts(enc,
               kdf(<'mk', 
                    kdf(<'ck', kdf(<'rk', kdf(<ltpk^~prek, pc^~ltk, pc^~prek>)>)>)>)),
      true
  )
  ]->
   [
   Session( ~id, $A, 'R', ~prek, $B, pc,
            kdf(<'rk', kdf(<ltpk^~prek, pc^~ltk, pc^~prek>)>),
            kdf(<'ck', kdf(<'rk', kdf(<ltpk^~prek, pc^~ltk, pc^~prek>)>)>)
   )
   ]

  /*
  rule (modulo AC) ReceiverStart:
     [
     Fr( ~id ), !SecretKeys( $A, ~ltk, ~prek ),
     !PublicKeys( $B, ltpk, prepk ), In( <pc, enc> )
     ]
    --[
    Neq( $A, $B ), Neq( pc, DH_neutral ), Neq( pc, 'g' ),
    Receive( z.3 ),
    DHSecrets( ~id, 'g'^~prek, pc, z.2, kdf(<'rk', kdf(<z, z.1, z.2>)>)
    ),
    NewDHSecrets( ~id, 'g'^~prek, pc, z.2,
                  kdf(<'rk', kdf(<z, z.1, z.2>)>)
    ),
    Eq( z.4, true )
    ]->
     [
     Session( ~id, $A, 'R', ~prek, $B, pc,
              kdf(<'rk', kdf(<z, z.1, z.2>)>),
              kdf(<'ck', kdf(<'rk', kdf(<z, z.1, z.2>)>)>)
     )
     ]
    variants (modulo AC)
      1. ~ltk  = ~ltk.3
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = pc.3
         z     = ltpk.3^~prek.3
         z.1   = pc.3^~ltk.3
         z.2   = pc.3^~prek.3
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<ltpk.3^~prek.3, pc.3^~ltk.3, pc.3^~prek.3>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<ltpk.3^~prek.3, pc.3^~ltk.3, pc.3^~prek.3>)>)>)
                              >))
    
      2. ~ltk  = ~ltk.3
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.2^x.3
         z     = ltpk.3^~prek.3
         z.1   = x.2^(~ltk.3*x.3)
         z.2   = x.2^(~prek.3*x.3)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~prek.3, x.2^(~ltk.3*x.3), x.2^(~prek.3*x.3)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~prek.3, x.2^(~ltk.3*x.3), x.2^(~prek.3*x.3)>)
                                        >)
                                   >)
                              >))
    
      3. ~ltk  = ~ltk.3
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = pc.3
         z     = DH_neutral
         z.1   = pc.3^~ltk.3
         z.2   = pc.3^~prek.3
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, pc.3^~ltk.3, pc.3^~prek.3>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<DH_neutral, pc.3^~ltk.3, pc.3^~prek.3>)>)>)
                              >))
    
      4. ~ltk  = ~ltk.3
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.2^x.3
         z     = DH_neutral
         z.1   = x.2^(~ltk.3*x.3)
         z.2   = x.2^(~prek.3*x.3)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.2^(~ltk.3*x.3), x.2^(~prek.3*x.3)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.2^(~ltk.3*x.3), x.2^(~prek.3*x.3)>)>)
                                   >)
                              >))
    
      5. ~ltk  = ~ltk.3
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = x.2^x.3
         pc    = pc.3
         z     = x.2^(~prek.3*x.3)
         z.1   = pc.3^~ltk.3
         z.2   = pc.3^~prek.3
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.2^(~prek.3*x.3), pc.3^~ltk.3, pc.3^~prek.3>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.2^(~prek.3*x.3), pc.3^~ltk.3, pc.3^~prek.3>)>)
                                   >)
                              >))
    
      6. ~ltk  = ~ltk.3
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = x.4^x.5
         pc    = x.6^x.7
         z     = x.4^(~prek.3*x.5)
         z.1   = x.6^(~ltk.3*x.7)
         z.2   = x.6^(~prek.3*x.7)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.4^(~prek.3*x.5), x.6^(~ltk.3*x.7), x.6^(~prek.3*x.7)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.4^(~prek.3*x.5), x.6^(~ltk.3*x.7), x.6^(~prek.3*x.7)
                                             >)
                                        >)
                                   >)
                              >))
    
      7. ~ltk  = ~ltk.3
         ~prek = ~x.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.5^inv(~x.3)
         z     = DH_neutral
         z.1   = x.5^(~ltk.3*inv(~x.3))
         z.2   = x.5
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.5^(~ltk.3*inv(~x.3)), x.5>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<DH_neutral, x.5^(~ltk.3*inv(~x.3)), x.5>)>)>)
                              >))
    
      8. ~ltk  = ~ltk.3
         ~prek = ~x.3
         enc   = enc.3
         ltpk  = x.5^inv(~x.3)
         pc    = pc.3
         z     = x.5
         z.1   = pc.3^~ltk.3
         z.2   = pc.3^~x.3
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.5, pc.3^~ltk.3, pc.3^~x.3>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.5, pc.3^~ltk.3, pc.3^~x.3>)>)>)>))
    
      9. ~ltk  = ~ltk.3
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.7^inv(~x.4)
         z     = ltpk.3^~x.4
         z.1   = x.7^(~ltk.3*inv(~x.4))
         z.2   = x.7
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<ltpk.3^~x.4, x.7^(~ltk.3*inv(~x.4)), x.7>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<ltpk.3^~x.4, x.7^(~ltk.3*inv(~x.4)), x.7>)>)>)
                              >))
    
     10. ~ltk  = ~ltk.3
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.6^inv((~x.4*x.7))
         z     = DH_neutral
         z.1   = x.6^(~ltk.3*inv((~x.4*x.7)))
         z.2   = x.6^inv(x.7)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.6^(~ltk.3*inv((~x.4*x.7))), x.6^inv(x.7)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.6^(~ltk.3*inv((~x.4*x.7))), x.6^inv(x.7)
                                             >)
                                        >)
                                   >)
                              >))
    
     11. ~ltk  = ~ltk.3
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.6^(x.7*inv(~x.4))
         z     = DH_neutral
         z.1   = x.6^(~ltk.3*x.7*inv(~x.4))
         z.2   = x.6^x.7
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.6^(~ltk.3*x.7*inv(~x.4)), x.6^x.7>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.6^(~ltk.3*x.7*inv(~x.4)), x.6^x.7>)>)
                                   >)
                              >))
    
     12. ~ltk  = ~ltk.3
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = x.6^inv(~x.4)
         pc    = x.7^inv(~x.4)
         z     = x.6
         z.1   = x.7^(~ltk.3*inv(~x.4))
         z.2   = x.7
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.6, x.7^(~ltk.3*inv(~x.4)), x.7>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.6, x.7^(~ltk.3*inv(~x.4)), x.7>)>)>)
                              >))
    
     13. ~ltk  = ~ltk.3
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = x.6^inv((~x.4*x.7))
         pc    = pc.3
         z     = x.6^inv(x.7)
         z.1   = pc.3^~ltk.3
         z.2   = pc.3^~x.4
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.6^inv(x.7), pc.3^~ltk.3, pc.3^~x.4>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.6^inv(x.7), pc.3^~ltk.3, pc.3^~x.4>)>)
                                   >)
                              >))
    
     14. ~ltk  = ~ltk.3
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = x.6^(x.7*inv(~x.4))
         pc    = pc.3
         z     = x.6^x.7
         z.1   = pc.3^~ltk.3
         z.2   = pc.3^~x.4
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.6^x.7, pc.3^~ltk.3, pc.3^~x.4>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.6^x.7, pc.3^~ltk.3, pc.3^~x.4>)>)>)>))
    
     15. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.8^inv((~x.5*x.9))
         z     = ltpk.3^~x.5
         z.1   = x.8^(~ltk.3*inv((~x.5*x.9)))
         z.2   = x.8^inv(x.9)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~x.5, x.8^(~ltk.3*inv((~x.5*x.9))), x.8^inv(x.9)>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~x.5, x.8^(~ltk.3*inv((~x.5*x.9))), 
                                              x.8^inv(x.9)>)
                                        >)
                                   >)
                              >))
    
     16. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.8^(x.9*inv(~x.5))
         z     = ltpk.3^~x.5
         z.1   = x.8^(~ltk.3*x.9*inv(~x.5))
         z.2   = x.8^x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<ltpk.3^~x.5, x.8^(~ltk.3*x.9*inv(~x.5)), x.8^x.9>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~x.5, x.8^(~ltk.3*x.9*inv(~x.5)), x.8^x.9>)>)
                                   >)
                              >))
    
     17. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.7^(x.8*inv((~x.5*x.9)))
         z     = DH_neutral
         z.1   = x.7^(~ltk.3*x.8*inv((~x.5*x.9)))
         z.2   = x.7^(x.8*inv(x.9))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.7^(~ltk.3*x.8*inv((~x.5*x.9))), 
                                          x.7^(x.8*inv(x.9))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.7^(~ltk.3*x.8*inv((~x.5*x.9))), 
                                              x.7^(x.8*inv(x.9))>)
                                        >)
                                   >)
                              >))
    
     18. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^x.8
         pc    = x.9^inv(~x.5)
         z     = x.7^(~x.5*x.8)
         z.1   = x.9^(~ltk.3*inv(~x.5))
         z.2   = x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7^(~x.5*x.8), x.9^(~ltk.3*inv(~x.5)), x.9>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.7^(~x.5*x.8), x.9^(~ltk.3*inv(~x.5)), x.9>)>)
                                   >)
                              >))
    
     19. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^inv(~x.5)
         pc    = x.8^x.9
         z     = x.7
         z.1   = x.8^(~ltk.3*x.9)
         z.2   = x.8^(~x.5*x.9)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7, x.8^(~ltk.3*x.9), x.8^(~x.5*x.9)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.7, x.8^(~ltk.3*x.9), x.8^(~x.5*x.9)>)>)>)
                              >))
    
     20. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^inv(~x.5)
         pc    = x.8^inv((~x.5*x.9))
         z     = x.7
         z.1   = x.8^(~ltk.3*inv((~x.5*x.9)))
         z.2   = x.8^inv(x.9)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7, x.8^(~ltk.3*inv((~x.5*x.9))), x.8^inv(x.9)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.7, x.8^(~ltk.3*inv((~x.5*x.9))), x.8^inv(x.9)>)>)
                                   >)
                              >))
    
     21. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^inv(~x.5)
         pc    = x.8^(x.9*inv(~x.5))
         z     = x.7
         z.1   = x.8^(~ltk.3*x.9*inv(~x.5))
         z.2   = x.8^x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7, x.8^(~ltk.3*x.9*inv(~x.5)), x.8^x.9>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.7, x.8^(~ltk.3*x.9*inv(~x.5)), x.8^x.9>)>)>)
                              >))
    
     22. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^inv((~x.5*x.8))
         pc    = x.9^inv(~x.5)
         z     = x.7^inv(x.8)
         z.1   = x.9^(~ltk.3*inv(~x.5))
         z.2   = x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7^inv(x.8), x.9^(~ltk.3*inv(~x.5)), x.9>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.7^inv(x.8), x.9^(~ltk.3*inv(~x.5)), x.9>)>)>)
                              >))
    
     23. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^(x.8*inv(~x.5))
         pc    = x.9^inv(~x.5)
         z     = x.7^x.8
         z.1   = x.9^(~ltk.3*inv(~x.5))
         z.2   = x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.7^x.8, x.9^(~ltk.3*inv(~x.5)), x.9>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.7^x.8, x.9^(~ltk.3*inv(~x.5)), x.9>)>)
                                   >)
                              >))
    
     24. ~ltk  = ~ltk.3
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^(x.8*inv((~x.5*x.9)))
         pc    = pc.3
         z     = x.7^(x.8*inv(x.9))
         z.1   = pc.3^~ltk.3
         z.2   = pc.3^~x.5
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7^(x.8*inv(x.9)), pc.3^~ltk.3, pc.3^~x.5>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.7^(x.8*inv(x.9)), pc.3^~ltk.3, pc.3^~x.5>)>)>)
                              >))
    
     25. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = ltpk.3^~x.6
         z.1   = x.9^(~ltk.3*x.10*inv((~x.6*x.11)))
         z.2   = x.9^(x.10*inv(x.11))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~x.6, x.9^(~ltk.3*x.10*inv((~x.6*x.11))), 
                                          x.9^(x.10*inv(x.11))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~x.6, x.9^(~ltk.3*x.10*inv((~x.6*x.11))), 
                                              x.9^(x.10*inv(x.11))>)
                                        >)
                                   >)
                              >))
    
     26. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^x.9
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^(~x.6*x.9)
         z.1   = x.10^(~ltk.3*inv((~x.6*x.11)))
         z.2   = x.10^inv(x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^(~x.6*x.9), x.10^(~ltk.3*inv((~x.6*x.11))), 
                                          x.10^inv(x.11)>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^(~x.6*x.9), x.10^(~ltk.3*inv((~x.6*x.11))), 
                                              x.10^inv(x.11)>)
                                        >)
                                   >)
                              >))
    
     27. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^x.9
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^(~x.6*x.9)
         z.1   = x.10^(~ltk.3*x.11*inv(~x.6))
         z.2   = x.10^x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^(~x.6*x.9), x.10^(~ltk.3*x.11*inv(~x.6)), x.10^x.11>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^(~x.6*x.9), x.10^(~ltk.3*x.11*inv(~x.6)), 
                                              x.10^x.11>)
                                        >)
                                   >)
                              >))
    
     28. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = x.8
         z.1   = x.9^(~ltk.3*x.10*inv((~x.6*x.11)))
         z.2   = x.9^(x.10*inv(x.11))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8, x.9^(~ltk.3*x.10*inv((~x.6*x.11))), 
                                          x.9^(x.10*inv(x.11))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8, x.9^(~ltk.3*x.10*inv((~x.6*x.11))), 
                                              x.9^(x.10*inv(x.11))>)
                                        >)
                                   >)
                              >))
    
     29. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv((~x.6*x.9))
         pc    = x.10^x.11
         z     = x.8^inv(x.9)
         z.1   = x.10^(~ltk.3*x.11)
         z.2   = x.10^(~x.6*x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^inv(x.9), x.10^(~ltk.3*x.11), x.10^(~x.6*x.11)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^inv(x.9), x.10^(~ltk.3*x.11), x.10^(~x.6*x.11)>)>)
                                   >)
                              >))
    
     30. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv((~x.6*x.9))
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^inv(x.9)
         z.1   = x.10^(~ltk.3*inv((~x.6*x.11)))
         z.2   = x.10^inv(x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^inv(x.9), x.10^(~ltk.3*inv((~x.6*x.11))), 
                                          x.10^inv(x.11)>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^inv(x.9), x.10^(~ltk.3*inv((~x.6*x.11))), 
                                              x.10^inv(x.11)>)
                                        >)
                                   >)
                              >))
    
     31. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv((~x.6*x.9))
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^inv(x.9)
         z.1   = x.10^(~ltk.3*x.11*inv(~x.6))
         z.2   = x.10^x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^inv(x.9), x.10^(~ltk.3*x.11*inv(~x.6)), x.10^x.11>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^inv(x.9), x.10^(~ltk.3*x.11*inv(~x.6)), x.10^x.11
                                             >)
                                        >)
                                   >)
                              >))
    
     32. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^(x.9*inv(~x.6))
         pc    = x.10^x.11
         z     = x.8^x.9
         z.1   = x.10^(~ltk.3*x.11)
         z.2   = x.10^(~x.6*x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^x.9, x.10^(~ltk.3*x.11), x.10^(~x.6*x.11)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.8^x.9, x.10^(~ltk.3*x.11), x.10^(~x.6*x.11)>)
                                        >)
                                   >)
                              >))
    
     33. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^(x.9*inv(~x.6))
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^x.9
         z.1   = x.10^(~ltk.3*inv((~x.6*x.11)))
         z.2   = x.10^inv(x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^x.9, x.10^(~ltk.3*inv((~x.6*x.11))), x.10^inv(x.11)>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^x.9, x.10^(~ltk.3*inv((~x.6*x.11))), 
                                              x.10^inv(x.11)>)
                                        >)
                                   >)
                              >))
    
     34. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^(x.9*inv(~x.6))
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^x.9
         z.1   = x.10^(~ltk.3*x.11*inv(~x.6))
         z.2   = x.10^x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^x.9, x.10^(~ltk.3*x.11*inv(~x.6)), x.10^x.11>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^x.9, x.10^(~ltk.3*x.11*inv(~x.6)), x.10^x.11>)>)
                                   >)
                              >))
    
     35. ~ltk  = ~ltk.3
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^(x.9*inv((~x.6*x.10)))
         pc    = x.11^inv(~x.6)
         z     = x.8^(x.9*inv(x.10))
         z.1   = x.11^(~ltk.3*inv(~x.6))
         z.2   = x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^(x.9*inv(x.10)), x.11^(~ltk.3*inv(~x.6)), x.11>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8^(x.9*inv(x.10)), x.11^(~ltk.3*inv(~x.6)), x.11>)>)
                                   >)
                              >))
    
     36. ~ltk  = ~ltk.3
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^x.10
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^(~x.7*x.10)
         z.1   = x.11^(~ltk.3*x.12*inv((~x.7*x.13)))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(~x.7*x.10), x.11^(~ltk.3*x.12*inv((~x.7*x.13))), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(~x.7*x.10), x.11^(~ltk.3*x.12*inv((~x.7*x.13))), 
                                              x.11^(x.12*inv(x.13))>)
                                        >)
                                   >)
                              >))
    
     37. ~ltk  = ~ltk.3
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^inv(x.10)
         z.1   = x.11^(~ltk.3*x.12*inv((~x.7*x.13)))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^inv(x.10), x.11^(~ltk.3*x.12*inv((~x.7*x.13))), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^inv(x.10), x.11^(~ltk.3*x.12*inv((~x.7*x.13))), 
                                              x.11^(x.12*inv(x.13))>)
                                        >)
                                   >)
                              >))
    
     38. ~ltk  = ~ltk.3
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^x.10
         z.1   = x.11^(~ltk.3*x.12*inv((~x.7*x.13)))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^x.10, x.11^(~ltk.3*x.12*inv((~x.7*x.13))), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^x.10, x.11^(~ltk.3*x.12*inv((~x.7*x.13))), 
                                              x.11^(x.12*inv(x.13))>)
                                        >)
                                   >)
                              >))
    
     39. ~ltk  = ~ltk.3
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv((~x.7*x.11)))
         pc    = x.12^x.13
         z     = x.9^(x.10*inv(x.11))
         z.1   = x.12^(~ltk.3*x.13)
         z.2   = x.12^(~x.7*x.13)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(x.10*inv(x.11)), x.12^(~ltk.3*x.13), x.12^(~x.7*x.13)
                                         >)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(x.10*inv(x.11)), x.12^(~ltk.3*x.13), 
                                              x.12^(~x.7*x.13)>)
                                        >)
                                   >)
                              >))
    
     40. ~ltk  = ~ltk.3
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv((~x.7*x.11)))
         pc    = x.12^inv((~x.7*x.13))
         z     = x.9^(x.10*inv(x.11))
         z.1   = x.12^(~ltk.3*inv((~x.7*x.13)))
         z.2   = x.12^inv(x.13)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(x.10*inv(x.11)), x.12^(~ltk.3*inv((~x.7*x.13))), 
                                          x.12^inv(x.13)>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(x.10*inv(x.11)), x.12^(~ltk.3*inv((~x.7*x.13))), 
                                              x.12^inv(x.13)>)
                                        >)
                                   >)
                              >))
    
     41. ~ltk  = ~ltk.3
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv((~x.7*x.11)))
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.9^(x.10*inv(x.11))
         z.1   = x.12^(~ltk.3*x.13*inv(~x.7))
         z.2   = x.12^x.13
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(x.10*inv(x.11)), x.12^(~ltk.3*x.13*inv(~x.7)), 
                                          x.12^x.13>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(x.10*inv(x.11)), x.12^(~ltk.3*x.13*inv(~x.7)), 
                                              x.12^x.13>)
                                        >)
                                   >)
                              >))
    
     42. ~ltk  = ~ltk.3
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13^(~ltk.3*x.14*inv((~x.8*x.15)))
         z.2   = x.13^(x.14*inv(x.15))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), 
                                          x.13^(~ltk.3*x.14*inv((~x.8*x.15))), x.13^(x.14*inv(x.15))
                                         >)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(x.11*inv(x.12)), 
                                              x.13^(~ltk.3*x.14*inv((~x.8*x.15))), 
                                              x.13^(x.14*inv(x.15))>)
                                        >)
                                   >)
                              >))
    
     43. ~ltk  = ~x.3
         ~prek = ~x.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.5^inv(~x.3)
         z     = DH_neutral
         z.1   = x.5
         z.2   = x.5
         z.3   = sdec(enc.3,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, x.5, x.5>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, x.5, x.5>)>)>)>))
    
     44. ~ltk  = ~x.3
         ~prek = ~x.3
         enc   = senc(x.4,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, x.5, x.5>)>)>)>))
         ltpk  = DH_neutral
         pc    = x.5^inv(~x.3)
         z     = DH_neutral
         z.1   = x.5
         z.2   = x.5
         z.3   = x.4
         z.4   = true
    
     45. ~ltk  = ~x.4
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.7^inv(~x.4)
         z     = DH_neutral
         z.1   = x.7
         z.2   = x.7^(~prek.3*inv(~x.4))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.7, x.7^(~prek.3*inv(~x.4))>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<DH_neutral, x.7, x.7^(~prek.3*inv(~x.4))>)>)>)
                              >))
    
     46. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.7^inv(~x.4)
         z     = ltpk.3^~x.4
         z.1   = x.7
         z.2   = x.7
         z.3   = sdec(enc.3,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<ltpk.3^~x.4, x.7, x.7>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<ltpk.3^~x.4, x.7, x.7>)>)>)
                              >))
    
     47. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.6^inv((~x.4*x.7))
         z     = DH_neutral
         z.1   = x.6^inv(x.7)
         z.2   = x.6^inv(x.7)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.6^inv(x.7), x.6^inv(x.7)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<DH_neutral, x.6^inv(x.7), x.6^inv(x.7)>)>)>)
                              >))
    
     48. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.6^(x.7*inv(~x.4))
         z     = DH_neutral
         z.1   = x.6^x.7
         z.2   = x.6^x.7
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, x.6^x.7, x.6^x.7>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, x.6^x.7, x.6^x.7>)>)>)>))
    
     49. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = enc.3
         ltpk  = x.6^inv(~x.4)
         pc    = x.7^inv(~x.4)
         z     = x.6
         z.1   = x.7
         z.2   = x.7
         z.3   = sdec(enc.3,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.6, x.7, x.7>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.6, x.7, x.7>)>)>)>))
    
     50. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = senc(x.5,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.6, x.7, x.7>)>)>)>))
         ltpk  = x.6^inv(~x.4)
         pc    = x.7^inv(~x.4)
         z     = x.6
         z.1   = x.7
         z.2   = x.7
         z.3   = x.5
         z.4   = true
    
     51. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = senc(x.5,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, x.6^x.7, x.6^x.7>)>)>)>))
         ltpk  = DH_neutral
         pc    = x.6^(x.7*inv(~x.4))
         z     = DH_neutral
         z.1   = x.6^x.7
         z.2   = x.6^x.7
         z.3   = x.5
         z.4   = true
    
     52. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = senc(x.5,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.6^inv(x.7), x.6^inv(x.7)>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = x.6^inv((~x.4*x.7))
         z     = DH_neutral
         z.1   = x.6^inv(x.7)
         z.2   = x.6^inv(x.7)
         z.3   = x.5
         z.4   = true
    
     53. ~ltk  = ~x.4
         ~prek = ~x.4
         enc   = senc(x.5,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.6^~x.4, x.7, x.7>)>)>)>))
         ltpk  = x.6
         pc    = x.7^inv(~x.4)
         z     = x.6^~x.4
         z.1   = x.7
         z.2   = x.7
         z.3   = x.5
         z.4   = true
    
     54. ~ltk  = ~x.4
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.7^inv((~x.4*~x.5))
         z     = DH_neutral
         z.1   = x.7^inv(~x.5)
         z.2   = x.7^inv(~x.4)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.7^inv(~x.5), x.7^inv(~x.4)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<DH_neutral, x.7^inv(~x.5), x.7^inv(~x.4)>)>)>)
                              >))
    
     55. ~ltk  = ~x.4
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.7, x.7^(~x.5*inv(~x.4))>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = x.7^inv(~x.4)
         z     = DH_neutral
         z.1   = x.7
         z.2   = x.7^(~x.5*inv(~x.4))
         z.3   = x.6
         z.4   = true
    
     56. ~ltk  = ~x.4
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, x.7^~x.4, x.7^~x.5>)>)>)>))
         ltpk  = DH_neutral
         pc    = x.7
         z     = DH_neutral
         z.1   = x.7^~x.4
         z.2   = x.7^~x.5
         z.3   = x.6
         z.4   = true
    
     57. ~ltk  = ~x.4
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.7^inv(~x.5), x.7^inv(~x.4)>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = x.7^inv((~x.4*~x.5))
         z     = DH_neutral
         z.1   = x.7^inv(~x.5)
         z.2   = x.7^inv(~x.4)
         z.3   = x.6
         z.4   = true
    
     58. ~ltk  = ~x.4
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.7^(~x.4*inv(~x.5)), x.7>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = x.7^inv(~x.5)
         z     = DH_neutral
         z.1   = x.7^(~x.4*inv(~x.5))
         z.2   = x.7
         z.3   = x.6
         z.4   = true
    
     59. ~ltk  = ~x.5
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.9^inv(~x.5)
         z     = ltpk.3^~prek.3
         z.1   = x.9
         z.2   = x.9^(~prek.3*inv(~x.5))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<ltpk.3^~prek.3, x.9, x.9^(~prek.3*inv(~x.5))>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<ltpk.3^~prek.3, x.9, x.9^(~prek.3*inv(~x.5))>)>)
                                   >)
                              >))
    
     60. ~ltk  = ~x.5
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.8^inv((~x.5*x.9))
         z     = DH_neutral
         z.1   = x.8^inv(x.9)
         z.2   = x.8^(~prek.3*inv((~x.5*x.9)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.8^inv(x.9), x.8^(~prek.3*inv((~x.5*x.9)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.8^inv(x.9), 
                                              x.8^(~prek.3*inv((~x.5*x.9)))>)
                                        >)
                                   >)
                              >))
    
     61. ~ltk  = ~x.5
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.8^(x.9*inv(~x.5))
         z     = DH_neutral
         z.1   = x.8^x.9
         z.2   = x.8^(~prek.3*x.9*inv(~x.5))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.8^x.9, x.8^(~prek.3*x.9*inv(~x.5))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.8^x.9, x.8^(~prek.3*x.9*inv(~x.5))>)>)
                                   >)
                              >))
    
     62. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.8^inv((~x.5*x.9))
         z     = ltpk.3^~x.5
         z.1   = x.8^inv(x.9)
         z.2   = x.8^inv(x.9)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<ltpk.3^~x.5, x.8^inv(x.9), x.8^inv(x.9)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<ltpk.3^~x.5, x.8^inv(x.9), x.8^inv(x.9)>)>)>)
                              >))
    
     63. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.8^(x.9*inv(~x.5))
         z     = ltpk.3^~x.5
         z.1   = x.8^x.9
         z.2   = x.8^x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<ltpk.3^~x.5, x.8^x.9, x.8^x.9>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<ltpk.3^~x.5, x.8^x.9, x.8^x.9>)>)>)>))
    
     64. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.7^(x.8*inv((~x.5*x.9)))
         z     = DH_neutral
         z.1   = x.7^(x.8*inv(x.9))
         z.2   = x.7^(x.8*inv(x.9))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.7^(x.8*inv(x.9)), x.7^(x.8*inv(x.9))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.7^(x.8*inv(x.9)), x.7^(x.8*inv(x.9))>)>)
                                   >)
                              >))
    
     65. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^x.8
         pc    = x.9^inv(~x.5)
         z     = x.7^(~x.5*x.8)
         z.1   = x.9
         z.2   = x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.7^(~x.5*x.8), x.9, x.9>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.7^(~x.5*x.8), x.9, x.9>)>)>)>))
    
     66. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^inv(~x.5)
         pc    = x.8^inv((~x.5*x.9))
         z     = x.7
         z.1   = x.8^inv(x.9)
         z.2   = x.8^inv(x.9)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.7, x.8^inv(x.9), x.8^inv(x.9)>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.7, x.8^inv(x.9), x.8^inv(x.9)>)>)>)>))
    
     67. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^inv(~x.5)
         pc    = x.8^(x.9*inv(~x.5))
         z     = x.7
         z.1   = x.8^x.9
         z.2   = x.8^x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7, x.8^x.9, x.8^x.9>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7, x.8^x.9, x.8^x.9>)>)>)
                              >))
    
     68. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^inv((~x.5*x.8))
         pc    = x.9^inv(~x.5)
         z     = x.7^inv(x.8)
         z.1   = x.9
         z.2   = x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7^inv(x.8), x.9, x.9>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7^inv(x.8), x.9, x.9>)>)>)
                              >))
    
     69. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^(x.8*inv(~x.5))
         pc    = x.9^inv(~x.5)
         z     = x.7^x.8
         z.1   = x.9
         z.2   = x.9
         z.3   = sdec(enc.3,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7^x.8, x.9, x.9>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7^x.8, x.9, x.9>)>)>)>))
    
     70. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7, x.8^x.9, x.8^x.9>)>)>)
                          >))
         ltpk  = x.7^inv(~x.5)
         pc    = x.8^(x.9*inv(~x.5))
         z     = x.7
         z.1   = x.8^x.9
         z.2   = x.8^x.9
         z.3   = x.6
         z.4   = true
    
     71. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.7, x.8^inv(x.9), x.8^inv(x.9)>)>)>)>))
         ltpk  = x.7^inv(~x.5)
         pc    = x.8^inv((~x.5*x.9))
         z     = x.7
         z.1   = x.8^inv(x.9)
         z.2   = x.8^inv(x.9)
         z.3   = x.6
         z.4   = true
    
     72. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.7^(x.8*inv(x.9)), x.7^(x.8*inv(x.9))>)>)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.7^(x.8*inv((~x.5*x.9)))
         z     = DH_neutral
         z.1   = x.7^(x.8*inv(x.9))
         z.2   = x.7^(x.8*inv(x.9))
         z.3   = x.6
         z.4   = true
    
     73. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.7^~x.5, x.8^x.9, x.8^x.9>)>)>)>))
         ltpk  = x.7
         pc    = x.8^(x.9*inv(~x.5))
         z     = x.7^~x.5
         z.1   = x.8^x.9
         z.2   = x.8^x.9
         z.3   = x.6
         z.4   = true
    
     74. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.7^~x.5, x.8^inv(x.9), x.8^inv(x.9)>)>)
                               >)
                          >))
         ltpk  = x.7
         pc    = x.8^inv((~x.5*x.9))
         z     = x.7^~x.5
         z.1   = x.8^inv(x.9)
         z.2   = x.8^inv(x.9)
         z.3   = x.6
         z.4   = true
    
     75. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7^x.8, x.9, x.9>)>)>)>))
         ltpk  = x.7^(x.8*inv(~x.5))
         pc    = x.9^inv(~x.5)
         z     = x.7^x.8
         z.1   = x.9
         z.2   = x.9
         z.3   = x.6
         z.4   = true
    
     76. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.7^inv(x.8), x.9, x.9>)>)>)
                          >))
         ltpk  = x.7^inv((~x.5*x.8))
         pc    = x.9^inv(~x.5)
         z     = x.7^inv(x.8)
         z.1   = x.9
         z.2   = x.9
         z.3   = x.6
         z.4   = true
    
     77. ~ltk  = ~x.5
         ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.7^(~x.5*x.8), x.9, x.9>)>)>)>))
         ltpk  = x.7^x.8
         pc    = x.9^inv(~x.5)
         z     = x.7^(~x.5*x.8)
         z.1   = x.9
         z.2   = x.9
         z.3   = x.6
         z.4   = true
    
     78. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.9^inv((~x.5*~x.6))
         z     = ltpk.3^~x.6
         z.1   = x.9^inv(~x.6)
         z.2   = x.9^inv(~x.5)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<ltpk.3^~x.6, x.9^inv(~x.6), x.9^inv(~x.5)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<ltpk.3^~x.6, x.9^inv(~x.6), x.9^inv(~x.5)>)>)>)
                              >))
    
     79. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.8^inv((~x.5*~x.6*x.9))
         z     = DH_neutral
         z.1   = x.8^inv((~x.6*x.9))
         z.2   = x.8^inv((~x.5*x.9))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.8^inv((~x.6*x.9)), x.8^inv((~x.5*x.9))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.8^inv((~x.6*x.9)), x.8^inv((~x.5*x.9))>)
                                        >)
                                   >)
                              >))
    
     80. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.8^(x.9*inv((~x.5*~x.6)))
         z     = DH_neutral
         z.1   = x.8^(x.9*inv(~x.6))
         z.2   = x.8^(x.9*inv(~x.5))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.8^(x.9*inv(~x.6)), x.8^(x.9*inv(~x.5))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.8^(x.9*inv(~x.6)), x.8^(x.9*inv(~x.5))>)
                                        >)
                                   >)
                              >))
    
     81. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^inv(~x.5)
         z     = x.8
         z.1   = x.9
         z.2   = x.9^(~x.6*inv(~x.5))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9, x.9^(~x.6*inv(~x.5))>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9, x.9^(~x.6*inv(~x.5))>)>)>)>))
    
     82. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^inv((~x.5*~x.6))
         z     = x.8
         z.1   = x.9^inv(~x.6)
         z.2   = x.9^inv(~x.5)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9^inv(~x.6), x.9^inv(~x.5)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9^inv(~x.6), x.9^inv(~x.5)>)>)>)
                              >))
    
     83. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9, x.9^(~x.6*inv(~x.5))>)>)>)>))
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^inv(~x.5)
         z     = x.8
         z.1   = x.9
         z.2   = x.9^(~x.6*inv(~x.5))
         z.3   = x.7
         z.4   = true
    
     84. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9^~x.5, x.9^~x.6>)>)>)
                          >))
         ltpk  = x.8^inv(~x.6)
         pc    = x.9
         z     = x.8
         z.1   = x.9^~x.5
         z.2   = x.9^~x.6
         z.3   = x.7
         z.4   = true
    
     85. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9^inv(~x.6), x.9^inv(~x.5)>)>)>)
                          >))
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^inv((~x.5*~x.6))
         z     = x.8
         z.1   = x.9^inv(~x.6)
         z.2   = x.9^inv(~x.5)
         z.3   = x.7
         z.4   = true
    
     86. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8, x.9^(~x.5*inv(~x.6)), x.9>)>)>)>))
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^inv(~x.6)
         z     = x.8
         z.1   = x.9^(~x.5*inv(~x.6))
         z.2   = x.9
         z.3   = x.7
         z.4   = true
    
     87. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.8^x.9, x.8^(~x.6*x.9*inv(~x.5))>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = x.8^(x.9*inv(~x.5))
         z     = DH_neutral
         z.1   = x.8^x.9
         z.2   = x.8^(~x.6*x.9*inv(~x.5))
         z.3   = x.7
         z.4   = true
    
     88. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.8^inv(x.9), x.8^(~x.6*inv((~x.5*x.9)))>)>)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.8^inv((~x.5*x.9))
         z     = DH_neutral
         z.1   = x.8^inv(x.9)
         z.2   = x.8^(~x.6*inv((~x.5*x.9)))
         z.3   = x.7
         z.4   = true
    
     89. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.8^inv((~x.6*x.9)), x.8^inv((~x.5*x.9))>)>)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.8^inv((~x.5*~x.6*x.9))
         z     = DH_neutral
         z.1   = x.8^inv((~x.6*x.9))
         z.2   = x.8^inv((~x.5*x.9))
         z.3   = x.7
         z.4   = true
    
     90. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.8^(~x.5*x.9), x.8^(~x.6*x.9)>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = x.8^x.9
         z     = DH_neutral
         z.1   = x.8^(~x.5*x.9)
         z.2   = x.8^(~x.6*x.9)
         z.3   = x.7
         z.4   = true
    
     91. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<DH_neutral, x.8^(~x.5*x.9*inv(~x.6)), x.8^x.9>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = x.8^(x.9*inv(~x.6))
         z     = DH_neutral
         z.1   = x.8^(~x.5*x.9*inv(~x.6))
         z.2   = x.8^x.9
         z.3   = x.7
         z.4   = true
    
     92. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.8^(~x.5*inv((~x.6*x.9))), x.8^inv(x.9)>)>)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.8^inv((~x.6*x.9))
         z     = DH_neutral
         z.1   = x.8^(~x.5*inv((~x.6*x.9)))
         z.2   = x.8^inv(x.9)
         z.3   = x.7
         z.4   = true
    
     93. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.8^(x.9*inv(~x.6)), x.8^(x.9*inv(~x.5))>)>)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.8^(x.9*inv((~x.5*~x.6)))
         z     = DH_neutral
         z.1   = x.8^(x.9*inv(~x.6))
         z.2   = x.8^(x.9*inv(~x.5))
         z.3   = x.7
         z.4   = true
    
     94. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^~x.6, x.9, x.9^(~x.6*inv(~x.5))>)>)
                               >)
                          >))
         ltpk  = x.8
         pc    = x.9^inv(~x.5)
         z     = x.8^~x.6
         z.1   = x.9
         z.2   = x.9^(~x.6*inv(~x.5))
         z.3   = x.7
         z.4   = true
    
     95. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^~x.6, x.9^~x.5, x.9^~x.6>)>)>)>))
         ltpk  = x.8
         pc    = x.9
         z     = x.8^~x.6
         z.1   = x.9^~x.5
         z.2   = x.9^~x.6
         z.3   = x.7
         z.4   = true
    
     96. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^~x.6, x.9^inv(~x.6), x.9^inv(~x.5)>)>)>)
                          >))
         ltpk  = x.8
         pc    = x.9^inv((~x.5*~x.6))
         z     = x.8^~x.6
         z.1   = x.9^inv(~x.6)
         z.2   = x.9^inv(~x.5)
         z.3   = x.7
         z.4   = true
    
     97. ~ltk  = ~x.5
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^~x.6, x.9^(~x.5*inv(~x.6)), x.9>)>)
                               >)
                          >))
         ltpk  = x.8
         pc    = x.9^inv(~x.6)
         z     = x.8^~x.6
         z.1   = x.9^(~x.5*inv(~x.6))
         z.2   = x.9
         z.3   = x.7
         z.4   = true
    
     98. ~ltk  = ~x.6
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.10^inv((~x.6*x.11))
         z     = ltpk.3^~prek.3
         z.1   = x.10^inv(x.11)
         z.2   = x.10^(~prek.3*inv((~x.6*x.11)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~prek.3, x.10^inv(x.11), 
                                          x.10^(~prek.3*inv((~x.6*x.11)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~prek.3, x.10^inv(x.11), 
                                              x.10^(~prek.3*inv((~x.6*x.11)))>)
                                        >)
                                   >)
                              >))
    
     99. ~ltk  = ~x.6
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.10^(x.11*inv(~x.6))
         z     = ltpk.3^~prek.3
         z.1   = x.10^x.11
         z.2   = x.10^(~prek.3*x.11*inv(~x.6))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~prek.3, x.10^x.11, x.10^(~prek.3*x.11*inv(~x.6))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~prek.3, x.10^x.11, 
                                              x.10^(~prek.3*x.11*inv(~x.6))>)
                                        >)
                                   >)
                              >))
    
    100. ~ltk  = ~x.6
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = DH_neutral
         z.1   = x.9^(x.10*inv(x.11))
         z.2   = x.9^(~prek.3*x.10*inv((~x.6*x.11)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.9^(x.10*inv(x.11)), 
                                          x.9^(~prek.3*x.10*inv((~x.6*x.11)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.9^(x.10*inv(x.11)), 
                                              x.9^(~prek.3*x.10*inv((~x.6*x.11)))>)
                                        >)
                                   >)
                              >))
    
    101. ~ltk  = ~x.6
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = x.9^x.10
         pc    = x.11^inv(~x.6)
         z     = x.9^(~prek.3*x.10)
         z.1   = x.11
         z.2   = x.11^(~prek.3*inv(~x.6))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(~prek.3*x.10), x.11, x.11^(~prek.3*inv(~x.6))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(~prek.3*x.10), x.11, x.11^(~prek.3*inv(~x.6))>)>)
                                   >)
                              >))
    
    102. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = ltpk.3^~x.6
         z.1   = x.9^(x.10*inv(x.11))
         z.2   = x.9^(x.10*inv(x.11))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~x.6, x.9^(x.10*inv(x.11)), x.9^(x.10*inv(x.11))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~x.6, x.9^(x.10*inv(x.11)), 
                                              x.9^(x.10*inv(x.11))>)
                                        >)
                                   >)
                              >))
    
    103. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^x.9
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^(~x.6*x.9)
         z.1   = x.10^inv(x.11)
         z.2   = x.10^inv(x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^(~x.6*x.9), x.10^inv(x.11), x.10^inv(x.11)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.8^(~x.6*x.9), x.10^inv(x.11), x.10^inv(x.11)>)
                                        >)
                                   >)
                              >))
    
    104. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^x.9
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^(~x.6*x.9)
         z.1   = x.10^x.11
         z.2   = x.10^x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^(~x.6*x.9), x.10^x.11, x.10^x.11>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.8^(~x.6*x.9), x.10^x.11, x.10^x.11>)>)
                                   >)
                              >))
    
    105. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = x.8
         z.1   = x.9^(x.10*inv(x.11))
         z.2   = x.9^(x.10*inv(x.11))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8, x.9^(x.10*inv(x.11)), x.9^(x.10*inv(x.11))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.8, x.9^(x.10*inv(x.11)), x.9^(x.10*inv(x.11))>)>)
                                   >)
                              >))
    
    106. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv((~x.6*x.9))
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^inv(x.9)
         z.1   = x.10^inv(x.11)
         z.2   = x.10^inv(x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^inv(x.9), x.10^inv(x.11), x.10^inv(x.11)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.8^inv(x.9), x.10^inv(x.11), x.10^inv(x.11)>)>)
                                   >)
                              >))
    
    107. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^inv((~x.6*x.9))
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^inv(x.9)
         z.1   = x.10^x.11
         z.2   = x.10^x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^inv(x.9), x.10^x.11, x.10^x.11>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.8^inv(x.9), x.10^x.11, x.10^x.11>)>)>)
                              >))
    
    108. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^(x.9*inv(~x.6))
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^x.9
         z.1   = x.10^inv(x.11)
         z.2   = x.10^inv(x.11)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^x.9, x.10^inv(x.11), x.10^inv(x.11)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.8^x.9, x.10^inv(x.11), x.10^inv(x.11)>)>)>)
                              >))
    
    109. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^(x.9*inv(~x.6))
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^x.9
         z.1   = x.10^x.11
         z.2   = x.10^x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^x.9, x.10^x.11, x.10^x.11>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.8^x.9, x.10^x.11, x.10^x.11>)>)>)>))
    
    110. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = enc.3
         ltpk  = x.8^(x.9*inv((~x.6*x.10)))
         pc    = x.11^inv(~x.6)
         z     = x.8^(x.9*inv(x.10))
         z.1   = x.11
         z.2   = x.11
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^(x.9*inv(x.10)), x.11, x.11>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.8^(x.9*inv(x.10)), x.11, x.11>)>)>)>))
    
    111. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8, x.9^(x.10*inv(x.11)), x.9^(x.10*inv(x.11))>)>)
                               >)
                          >))
         ltpk  = x.8^inv(~x.6)
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = x.8
         z.1   = x.9^(x.10*inv(x.11))
         z.2   = x.9^(x.10*inv(x.11))
         z.3   = x.7
         z.4   = true
    
    112. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.8^~x.6, x.9^(x.10*inv(x.11)), x.9^(x.10*inv(x.11))>)>)
                               >)
                          >))
         ltpk  = x.8
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = x.8^~x.6
         z.1   = x.9^(x.10*inv(x.11))
         z.2   = x.9^(x.10*inv(x.11))
         z.3   = x.7
         z.4   = true
    
    113. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^x.9, x.10^x.11, x.10^x.11>)>)>)>))
         ltpk  = x.8^(x.9*inv(~x.6))
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^x.9
         z.1   = x.10^x.11
         z.2   = x.10^x.11
         z.3   = x.7
         z.4   = true
    
    114. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^x.9, x.10^inv(x.11), x.10^inv(x.11)>)>)>)
                          >))
         ltpk  = x.8^(x.9*inv(~x.6))
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^x.9
         z.1   = x.10^inv(x.11)
         z.2   = x.10^inv(x.11)
         z.3   = x.7
         z.4   = true
    
    115. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^inv(x.9), x.10^x.11, x.10^x.11>)>)>)
                          >))
         ltpk  = x.8^inv((~x.6*x.9))
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^inv(x.9)
         z.1   = x.10^x.11
         z.2   = x.10^x.11
         z.3   = x.7
         z.4   = true
    
    116. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^inv(x.9), x.10^inv(x.11), x.10^inv(x.11)>)>)>)
                          >))
         ltpk  = x.8^inv((~x.6*x.9))
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^inv(x.9)
         z.1   = x.10^inv(x.11)
         z.2   = x.10^inv(x.11)
         z.3   = x.7
         z.4   = true
    
    117. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^(~x.6*x.9), x.10^x.11, x.10^x.11>)>)
                               >)
                          >))
         ltpk  = x.8^x.9
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.8^(~x.6*x.9)
         z.1   = x.10^x.11
         z.2   = x.10^x.11
         z.3   = x.7
         z.4   = true
    
    118. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.8^(~x.6*x.9), x.10^inv(x.11), x.10^inv(x.11)>)>)
                               >)
                          >))
         ltpk  = x.8^x.9
         pc    = x.10^inv((~x.6*x.11))
         z     = x.8^(~x.6*x.9)
         z.1   = x.10^inv(x.11)
         z.2   = x.10^inv(x.11)
         z.3   = x.7
         z.4   = true
    
    119. ~ltk  = ~x.6
         ~prek = ~x.6
         enc   = senc(x.7,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.8^(x.9*inv(x.10)), x.11, x.11>)>)>)>))
         ltpk  = x.8^(x.9*inv((~x.6*x.10)))
         pc    = x.11^inv(~x.6)
         z     = x.8^(x.9*inv(x.10))
         z.1   = x.11
         z.2   = x.11
         z.3   = x.7
         z.4   = true
    
    120. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.10^inv((~x.6*~x.7*x.11))
         z     = ltpk.3^~x.7
         z.1   = x.10^inv((~x.7*x.11))
         z.2   = x.10^inv((~x.6*x.11))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~x.7, x.10^inv((~x.7*x.11)), x.10^inv((~x.6*x.11))
                                         >)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~x.7, x.10^inv((~x.7*x.11)), 
                                              x.10^inv((~x.6*x.11))>)
                                        >)
                                   >)
                              >))
    
    121. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.10^(x.11*inv((~x.6*~x.7)))
         z     = ltpk.3^~x.7
         z.1   = x.10^(x.11*inv(~x.7))
         z.2   = x.10^(x.11*inv(~x.6))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~x.7, x.10^(x.11*inv(~x.7)), x.10^(x.11*inv(~x.6))
                                         >)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~x.7, x.10^(x.11*inv(~x.7)), 
                                              x.10^(x.11*inv(~x.6))>)
                                        >)
                                   >)
                              >))
    
    122. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = DH_neutral
         pc    = x.9^(x.10*inv((~x.6*~x.7*x.11)))
         z     = DH_neutral
         z.1   = x.9^(x.10*inv((~x.7*x.11)))
         z.2   = x.9^(x.10*inv((~x.6*x.11)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.9^(x.10*inv((~x.7*x.11))), 
                                          x.9^(x.10*inv((~x.6*x.11)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<DH_neutral, x.9^(x.10*inv((~x.7*x.11))), 
                                              x.9^(x.10*inv((~x.6*x.11)))>)
                                        >)
                                   >)
                              >))
    
    123. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^x.10
         pc    = x.11^inv((~x.6*~x.7))
         z     = x.9^(~x.7*x.10)
         z.1   = x.11^inv(~x.7)
         z.2   = x.11^inv(~x.6)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^(~x.7*x.10), x.11^inv(~x.7), x.11^inv(~x.6)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(~x.7*x.10), x.11^inv(~x.7), x.11^inv(~x.6)>)>)
                                   >)
                              >))
    
    124. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^inv((~x.6*~x.7*x.11))
         z     = x.9
         z.1   = x.10^inv((~x.7*x.11))
         z.2   = x.10^inv((~x.6*x.11))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^inv((~x.7*x.11)), x.10^inv((~x.6*x.11))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9, x.10^inv((~x.7*x.11)), x.10^inv((~x.6*x.11))>)>)
                                   >)
                              >))
    
    125. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^inv((~x.6*x.11))
         z     = x.9
         z.1   = x.10^inv(x.11)
         z.2   = x.10^(~x.7*inv((~x.6*x.11)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^inv(x.11), x.10^(~x.7*inv((~x.6*x.11)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9, x.10^inv(x.11), x.10^(~x.7*inv((~x.6*x.11)))>)>)
                                   >)
                              >))
    
    126. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.9
         z.1   = x.10^x.11
         z.2   = x.10^(~x.7*x.11*inv(~x.6))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^x.11, x.10^(~x.7*x.11*inv(~x.6))>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.9, x.10^x.11, x.10^(~x.7*x.11*inv(~x.6))>)>)>)
                              >))
    
    127. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^(x.11*inv((~x.6*~x.7)))
         z     = x.9
         z.1   = x.10^(x.11*inv(~x.7))
         z.2   = x.10^(x.11*inv(~x.6))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^(x.11*inv(~x.7)), x.10^(x.11*inv(~x.6))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9, x.10^(x.11*inv(~x.7)), x.10^(x.11*inv(~x.6))>)>)
                                   >)
                              >))
    
    128. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^inv(~x.6)
         z     = x.9^inv(x.10)
         z.1   = x.11
         z.2   = x.11^(~x.7*inv(~x.6))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^inv(x.10), x.11, x.11^(~x.7*inv(~x.6))>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.9^inv(x.10), x.11, x.11^(~x.7*inv(~x.6))>)>)>)
                              >))
    
    129. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^inv((~x.6*~x.7))
         z     = x.9^inv(x.10)
         z.1   = x.11^inv(~x.7)
         z.2   = x.11^inv(~x.6)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^inv(x.10), x.11^inv(~x.7), x.11^inv(~x.6)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.9^inv(x.10), x.11^inv(~x.7), x.11^inv(~x.6)>)
                                        >)
                                   >)
                              >))
    
    130. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^inv(~x.6)
         z     = x.9^x.10
         z.1   = x.11
         z.2   = x.11^(~x.7*inv(~x.6))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^x.10, x.11, x.11^(~x.7*inv(~x.6))>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.9^x.10, x.11, x.11^(~x.7*inv(~x.6))>)>)>)
                              >))
    
    131. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^inv((~x.6*~x.7))
         z     = x.9^x.10
         z.1   = x.11^inv(~x.7)
         z.2   = x.11^inv(~x.6)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^x.10, x.11^inv(~x.7), x.11^inv(~x.6)>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.9^x.10, x.11^inv(~x.7), x.11^inv(~x.6)>)>)>)
                              >))
    
    132. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^x.11, x.10^(~x.7*x.11*inv(~x.6))>)>)>)
                          >))
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.9
         z.1   = x.10^x.11
         z.2   = x.10^(~x.7*x.11*inv(~x.6))
         z.3   = x.8
         z.4   = true
    
    133. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^inv(x.11), x.10^(~x.7*inv((~x.6*x.11)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^inv((~x.6*x.11))
         z     = x.9
         z.1   = x.10^inv(x.11)
         z.2   = x.10^(~x.7*inv((~x.6*x.11)))
         z.3   = x.8
         z.4   = true
    
    134. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^inv((~x.7*x.11)), x.10^inv((~x.6*x.11))>)
                                    >)
                               >)
                          >))
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^inv((~x.6*~x.7*x.11))
         z     = x.9
         z.1   = x.10^inv((~x.7*x.11))
         z.2   = x.10^inv((~x.6*x.11))
         z.3   = x.8
         z.4   = true
    
    135. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^(~x.6*x.11), x.10^(~x.7*x.11)>)>)>)
                          >))
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^x.11
         z     = x.9
         z.1   = x.10^(~x.6*x.11)
         z.2   = x.10^(~x.7*x.11)
         z.3   = x.8
         z.4   = true
    
    136. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^(~x.6*x.11*inv(~x.7)), x.10^x.11>)>)>)
                          >))
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^(x.11*inv(~x.7))
         z     = x.9
         z.1   = x.10^(~x.6*x.11*inv(~x.7))
         z.2   = x.10^x.11
         z.3   = x.8
         z.4   = true
    
    137. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^(~x.6*inv((~x.7*x.11))), x.10^inv(x.11)>)
                                    >)
                               >)
                          >))
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^inv((~x.7*x.11))
         z     = x.9
         z.1   = x.10^(~x.6*inv((~x.7*x.11)))
         z.2   = x.10^inv(x.11)
         z.3   = x.8
         z.4   = true
    
    138. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9, x.10^(x.11*inv(~x.7)), x.10^(x.11*inv(~x.6))>)
                                    >)
                               >)
                          >))
         ltpk  = x.9^inv(~x.7)
         pc    = x.10^(x.11*inv((~x.6*~x.7)))
         z     = x.9
         z.1   = x.10^(x.11*inv(~x.7))
         z.2   = x.10^(x.11*inv(~x.6))
         z.3   = x.8
         z.4   = true
    
    139. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.9^(~x.6*x.10*inv((~x.7*x.11))), 
                                          x.9^(x.10*inv(x.11))>)
                                    >)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.9^(x.10*inv((~x.7*x.11)))
         z     = DH_neutral
         z.1   = x.9^(~x.6*x.10*inv((~x.7*x.11)))
         z.2   = x.9^(x.10*inv(x.11))
         z.3   = x.8
         z.4   = true
    
    140. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.9^(x.10*inv(x.11)), 
                                          x.9^(~x.7*x.10*inv((~x.6*x.11)))>)
                                    >)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.9^(x.10*inv((~x.6*x.11)))
         z     = DH_neutral
         z.1   = x.9^(x.10*inv(x.11))
         z.2   = x.9^(~x.7*x.10*inv((~x.6*x.11)))
         z.3   = x.8
         z.4   = true
    
    141. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<DH_neutral, x.9^(x.10*inv((~x.7*x.11))), 
                                          x.9^(x.10*inv((~x.6*x.11)))>)
                                    >)
                               >)
                          >))
         ltpk  = DH_neutral
         pc    = x.9^(x.10*inv((~x.6*~x.7*x.11)))
         z     = DH_neutral
         z.1   = x.9^(x.10*inv((~x.7*x.11)))
         z.2   = x.9^(x.10*inv((~x.6*x.11)))
         z.3   = x.8
         z.4   = true
    
    142. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^~x.7, x.10^x.11, x.10^(~x.7*x.11*inv(~x.6))>)>)
                               >)
                          >))
         ltpk  = x.9
         pc    = x.10^(x.11*inv(~x.6))
         z     = x.9^~x.7
         z.1   = x.10^x.11
         z.2   = x.10^(~x.7*x.11*inv(~x.6))
         z.3   = x.8
         z.4   = true
    
    143. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^~x.7, x.10^inv(x.11), x.10^(~x.7*inv((~x.6*x.11)))>)>)
                               >)
                          >))
         ltpk  = x.9
         pc    = x.10^inv((~x.6*x.11))
         z     = x.9^~x.7
         z.1   = x.10^inv(x.11)
         z.2   = x.10^(~x.7*inv((~x.6*x.11)))
         z.3   = x.8
         z.4   = true
    
    144. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^~x.7, x.10^inv((~x.7*x.11)), x.10^inv((~x.6*x.11))>)>)
                               >)
                          >))
         ltpk  = x.9
         pc    = x.10^inv((~x.6*~x.7*x.11))
         z     = x.9^~x.7
         z.1   = x.10^inv((~x.7*x.11))
         z.2   = x.10^inv((~x.6*x.11))
         z.3   = x.8
         z.4   = true
    
    145. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^~x.7, x.10^(~x.6*x.11), x.10^(~x.7*x.11)>)>)>)
                          >))
         ltpk  = x.9
         pc    = x.10^x.11
         z     = x.9^~x.7
         z.1   = x.10^(~x.6*x.11)
         z.2   = x.10^(~x.7*x.11)
         z.3   = x.8
         z.4   = true
    
    146. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^~x.7, x.10^(~x.6*x.11*inv(~x.7)), x.10^x.11>)>)
                               >)
                          >))
         ltpk  = x.9
         pc    = x.10^(x.11*inv(~x.7))
         z     = x.9^~x.7
         z.1   = x.10^(~x.6*x.11*inv(~x.7))
         z.2   = x.10^x.11
         z.3   = x.8
         z.4   = true
    
    147. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^~x.7, x.10^(~x.6*inv((~x.7*x.11))), x.10^inv(x.11)>)>)
                               >)
                          >))
         ltpk  = x.9
         pc    = x.10^inv((~x.7*x.11))
         z     = x.9^~x.7
         z.1   = x.10^(~x.6*inv((~x.7*x.11)))
         z.2   = x.10^inv(x.11)
         z.3   = x.8
         z.4   = true
    
    148. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^~x.7, x.10^(x.11*inv(~x.7)), x.10^(x.11*inv(~x.6))>)>)
                               >)
                          >))
         ltpk  = x.9
         pc    = x.10^(x.11*inv((~x.6*~x.7)))
         z     = x.9^~x.7
         z.1   = x.10^(x.11*inv(~x.7))
         z.2   = x.10^(x.11*inv(~x.6))
         z.3   = x.8
         z.4   = true
    
    149. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^x.10, x.11, x.11^(~x.7*inv(~x.6))>)>)>)
                          >))
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^inv(~x.6)
         z     = x.9^x.10
         z.1   = x.11
         z.2   = x.11^(~x.7*inv(~x.6))
         z.3   = x.8
         z.4   = true
    
    150. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.9^x.10, x.11^~x.6, x.11^~x.7>)>)>)>))
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11
         z     = x.9^x.10
         z.1   = x.11^~x.6
         z.2   = x.11^~x.7
         z.3   = x.8
         z.4   = true
    
    151. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^x.10, x.11^inv(~x.7), x.11^inv(~x.6)>)>)>)
                          >))
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^inv((~x.6*~x.7))
         z     = x.9^x.10
         z.1   = x.11^inv(~x.7)
         z.2   = x.11^inv(~x.6)
         z.3   = x.8
         z.4   = true
    
    152. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^x.10, x.11^(~x.6*inv(~x.7)), x.11>)>)>)
                          >))
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^inv(~x.7)
         z     = x.9^x.10
         z.1   = x.11^(~x.6*inv(~x.7))
         z.2   = x.11
         z.3   = x.8
         z.4   = true
    
    153. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^inv(x.10), x.11, x.11^(~x.7*inv(~x.6))>)>)>)
                          >))
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^inv(~x.6)
         z     = x.9^inv(x.10)
         z.1   = x.11
         z.2   = x.11^(~x.7*inv(~x.6))
         z.3   = x.8
         z.4   = true
    
    154. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.9^inv(x.10), x.11^~x.6, x.11^~x.7>)>)
                               >)
                          >))
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11
         z     = x.9^inv(x.10)
         z.1   = x.11^~x.6
         z.2   = x.11^~x.7
         z.3   = x.8
         z.4   = true
    
    155. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^inv(x.10), x.11^inv(~x.7), x.11^inv(~x.6)>)>)>)
                          >))
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^inv((~x.6*~x.7))
         z     = x.9^inv(x.10)
         z.1   = x.11^inv(~x.7)
         z.2   = x.11^inv(~x.6)
         z.3   = x.8
         z.4   = true
    
    156. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^inv(x.10), x.11^(~x.6*inv(~x.7)), x.11>)>)>)
                          >))
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^inv(~x.7)
         z     = x.9^inv(x.10)
         z.1   = x.11^(~x.6*inv(~x.7))
         z.2   = x.11
         z.3   = x.8
         z.4   = true
    
    157. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^(~x.7*x.10), x.11, x.11^(~x.7*inv(~x.6))>)>)>)
                          >))
         ltpk  = x.9^x.10
         pc    = x.11^inv(~x.6)
         z     = x.9^(~x.7*x.10)
         z.1   = x.11
         z.2   = x.11^(~x.7*inv(~x.6))
         z.3   = x.8
         z.4   = true
    
    158. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^(~x.7*x.10), x.11^~x.6, x.11^~x.7>)>)>)
                          >))
         ltpk  = x.9^x.10
         pc    = x.11
         z     = x.9^(~x.7*x.10)
         z.1   = x.11^~x.6
         z.2   = x.11^~x.7
         z.3   = x.8
         z.4   = true
    
    159. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^(~x.7*x.10), x.11^inv(~x.7), x.11^inv(~x.6)>)>)
                               >)
                          >))
         ltpk  = x.9^x.10
         pc    = x.11^inv((~x.6*~x.7))
         z     = x.9^(~x.7*x.10)
         z.1   = x.11^inv(~x.7)
         z.2   = x.11^inv(~x.6)
         z.3   = x.8
         z.4   = true
    
    160. ~ltk  = ~x.6
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^(~x.7*x.10), x.11^(~x.6*inv(~x.7)), x.11>)>)>)
                          >))
         ltpk  = x.9^x.10
         pc    = x.11^inv(~x.7)
         z     = x.9^(~x.7*x.10)
         z.1   = x.11^(~x.6*inv(~x.7))
         z.2   = x.11
         z.3   = x.8
         z.4   = true
    
    161. ~ltk  = ~x.7
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = ltpk.3^~prek.3
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(~prek.3*x.12*inv((~x.7*x.13)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~prek.3, x.11^(x.12*inv(x.13)), 
                                          x.11^(~prek.3*x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~prek.3, x.11^(x.12*inv(x.13)), 
                                              x.11^(~prek.3*x.12*inv((~x.7*x.13)))>)
                                        >)
                                   >)
                              >))
    
    162. ~ltk  = ~x.7
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = x.10^x.11
         pc    = x.12^inv((~x.7*x.13))
         z     = x.10^(~prek.3*x.11)
         z.1   = x.12^inv(x.13)
         z.2   = x.12^(~prek.3*inv((~x.7*x.13)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~prek.3*x.11), x.12^inv(x.13), 
                                          x.12^(~prek.3*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(~prek.3*x.11), x.12^inv(x.13), 
                                              x.12^(~prek.3*inv((~x.7*x.13)))>)
                                        >)
                                   >)
                              >))
    
    163. ~ltk  = ~x.7
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = x.10^x.11
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.10^(~prek.3*x.11)
         z.1   = x.12^x.13
         z.2   = x.12^(~prek.3*x.13*inv(~x.7))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~prek.3*x.11), x.12^x.13, 
                                          x.12^(~prek.3*x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(~prek.3*x.11), x.12^x.13, 
                                              x.12^(~prek.3*x.13*inv(~x.7))>)
                                        >)
                                   >)
                              >))
    
    164. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^x.10
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^(~x.7*x.10)
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(~x.7*x.10), x.11^(x.12*inv(x.13)), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(~x.7*x.10), x.11^(x.12*inv(x.13)), 
                                              x.11^(x.12*inv(x.13))>)
                                        >)
                                   >)
                              >))
    
    165. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^inv(x.10)
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^inv(x.10), x.11^(x.12*inv(x.13)), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^inv(x.10), x.11^(x.12*inv(x.13)), 
                                              x.11^(x.12*inv(x.13))>)
                                        >)
                                   >)
                              >))
    
    166. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^x.10
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^x.10, x.11^(x.12*inv(x.13)), x.11^(x.12*inv(x.13))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^x.10, x.11^(x.12*inv(x.13)), x.11^(x.12*inv(x.13))
                                             >)
                                        >)
                                   >)
                              >))
    
    167. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv((~x.7*x.11)))
         pc    = x.12^inv((~x.7*x.13))
         z     = x.9^(x.10*inv(x.11))
         z.1   = x.12^inv(x.13)
         z.2   = x.12^inv(x.13)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(x.10*inv(x.11)), x.12^inv(x.13), x.12^inv(x.13)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.9^(x.10*inv(x.11)), x.12^inv(x.13), x.12^inv(x.13)>)
                                        >)
                                   >)
                              >))
    
    168. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = enc.3
         ltpk  = x.9^(x.10*inv((~x.7*x.11)))
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.9^(x.10*inv(x.11))
         z.1   = x.12^x.13
         z.2   = x.12^x.13
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^(x.10*inv(x.11)), x.12^x.13, x.12^x.13>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.9^(x.10*inv(x.11)), x.12^x.13, x.12^x.13>)>)>)
                              >))
    
    169. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^x.10, x.11^(x.12*inv(x.13)), x.11^(x.12*inv(x.13))>)>)
                               >)
                          >))
         ltpk  = x.9^(x.10*inv(~x.7))
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^x.10
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = x.8
         z.4   = true
    
    170. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^inv(x.10), x.11^(x.12*inv(x.13)), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         ltpk  = x.9^inv((~x.7*x.10))
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^inv(x.10)
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = x.8
         z.4   = true
    
    171. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(~x.7*x.10), x.11^(x.12*inv(x.13)), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         ltpk  = x.9^x.10
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.9^(~x.7*x.10)
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = x.8
         z.4   = true
    
    172. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.9^(x.10*inv(x.11)), x.12^x.13, x.12^x.13>)>)>)
                          >))
         ltpk  = x.9^(x.10*inv((~x.7*x.11)))
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.9^(x.10*inv(x.11))
         z.1   = x.12^x.13
         z.2   = x.12^x.13
         z.3   = x.8
         z.4   = true
    
    173. ~ltk  = ~x.7
         ~prek = ~x.7
         enc   = senc(x.8,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.9^(x.10*inv(x.11)), x.12^inv(x.13), x.12^inv(x.13)>)>)
                               >)
                          >))
         ltpk  = x.9^(x.10*inv((~x.7*x.11)))
         pc    = x.12^inv((~x.7*x.13))
         z     = x.9^(x.10*inv(x.11))
         z.1   = x.12^inv(x.13)
         z.2   = x.12^inv(x.13)
         z.3   = x.8
         z.4   = true
    
    174. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = x.11^(x.12*inv((~x.7*~x.8*x.13)))
         z     = ltpk.3^~x.8
         z.1   = x.11^(x.12*inv((~x.8*x.13)))
         z.2   = x.11^(x.12*inv((~x.7*x.13)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<ltpk.3^~x.8, x.11^(x.12*inv((~x.8*x.13))), 
                                          x.11^(x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<ltpk.3^~x.8, x.11^(x.12*inv((~x.8*x.13))), 
                                              x.11^(x.12*inv((~x.7*x.13)))>)
                                        >)
                                   >)
                              >))
    
    175. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^x.11
         pc    = x.12^inv((~x.7*~x.8*x.13))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^inv((~x.8*x.13))
         z.2   = x.12^inv((~x.7*x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^inv((~x.8*x.13)), 
                                          x.12^inv((~x.7*x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(~x.8*x.11), x.12^inv((~x.8*x.13)), 
                                              x.12^inv((~x.7*x.13))>)
                                        >)
                                   >)
                              >))
    
    176. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^x.11
         pc    = x.12^(x.13*inv((~x.7*~x.8)))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^(x.13*inv(~x.8))
         z.2   = x.12^(x.13*inv(~x.7))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^(x.13*inv(~x.8)), 
                                          x.12^(x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(~x.8*x.11), x.12^(x.13*inv(~x.8)), 
                                              x.12^(x.13*inv(~x.7))>)
                                        >)
                                   >)
                              >))
    
    177. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^inv(~x.8)
         pc    = x.11^(x.12*inv((~x.7*~x.8*x.13)))
         z     = x.10
         z.1   = x.11^(x.12*inv((~x.8*x.13)))
         z.2   = x.11^(x.12*inv((~x.7*x.13)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10, x.11^(x.12*inv((~x.8*x.13))), 
                                          x.11^(x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10, x.11^(x.12*inv((~x.8*x.13))), 
                                              x.11^(x.12*inv((~x.7*x.13)))>)
                                        >)
                                   >)
                              >))
    
    178. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^inv(~x.8)
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.10
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(~x.8*x.12*inv((~x.7*x.13)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10, x.11^(x.12*inv(x.13)), 
                                          x.11^(~x.8*x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10, x.11^(x.12*inv(x.13)), 
                                              x.11^(~x.8*x.12*inv((~x.7*x.13)))>)
                                        >)
                                   >)
                              >))
    
    179. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^inv((~x.7*~x.8*x.13))
         z     = x.10^inv(x.11)
         z.1   = x.12^inv((~x.8*x.13))
         z.2   = x.12^inv((~x.7*x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^inv((~x.8*x.13)), 
                                          x.12^inv((~x.7*x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^inv(x.11), x.12^inv((~x.8*x.13)), 
                                              x.12^inv((~x.7*x.13))>)
                                        >)
                                   >)
                              >))
    
    180. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^inv((~x.7*x.13))
         z     = x.10^inv(x.11)
         z.1   = x.12^inv(x.13)
         z.2   = x.12^(~x.8*inv((~x.7*x.13)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^inv(x.13), 
                                          x.12^(~x.8*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^inv(x.11), x.12^inv(x.13), 
                                              x.12^(~x.8*inv((~x.7*x.13)))>)
                                        >)
                                   >)
                              >))
    
    181. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.10^inv(x.11)
         z.1   = x.12^x.13
         z.2   = x.12^(~x.8*x.13*inv(~x.7))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^x.13, x.12^(~x.8*x.13*inv(~x.7))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^inv(x.11), x.12^x.13, x.12^(~x.8*x.13*inv(~x.7))
                                             >)
                                        >)
                                   >)
                              >))
    
    182. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^(x.13*inv((~x.7*~x.8)))
         z     = x.10^inv(x.11)
         z.1   = x.12^(x.13*inv(~x.8))
         z.2   = x.12^(x.13*inv(~x.7))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^(x.13*inv(~x.8)), 
                                          x.12^(x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^inv(x.11), x.12^(x.13*inv(~x.8)), 
                                              x.12^(x.13*inv(~x.7))>)
                                        >)
                                   >)
                              >))
    
    183. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^inv((~x.7*~x.8*x.13))
         z     = x.10^x.11
         z.1   = x.12^inv((~x.8*x.13))
         z.2   = x.12^inv((~x.7*x.13))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^x.11, x.12^inv((~x.8*x.13)), x.12^inv((~x.7*x.13))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^x.11, x.12^inv((~x.8*x.13)), 
                                              x.12^inv((~x.7*x.13))>)
                                        >)
                                   >)
                              >))
    
    184. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^inv((~x.7*x.13))
         z     = x.10^x.11
         z.1   = x.12^inv(x.13)
         z.2   = x.12^(~x.8*inv((~x.7*x.13)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^x.11, x.12^inv(x.13), x.12^(~x.8*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^x.11, x.12^inv(x.13), 
                                              x.12^(~x.8*inv((~x.7*x.13)))>)
                                        >)
                                   >)
                              >))
    
    185. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.10^x.11
         z.1   = x.12^x.13
         z.2   = x.12^(~x.8*x.13*inv(~x.7))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.10^x.11, x.12^x.13, x.12^(~x.8*x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^x.11, x.12^x.13, x.12^(~x.8*x.13*inv(~x.7))>)>)
                                   >)
                              >))
    
    186. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^(x.13*inv((~x.7*~x.8)))
         z     = x.10^x.11
         z.1   = x.12^(x.13*inv(~x.8))
         z.2   = x.12^(x.13*inv(~x.7))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^x.11, x.12^(x.13*inv(~x.8)), x.12^(x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^x.11, x.12^(x.13*inv(~x.8)), 
                                              x.12^(x.13*inv(~x.7))>)
                                        >)
                                   >)
                              >))
    
    187. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^inv(~x.7)
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13
         z.2   = x.13^(~x.8*inv(~x.7))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), x.13, x.13^(~x.8*inv(~x.7))>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(x.11*inv(x.12)), x.13, x.13^(~x.8*inv(~x.7))>)>)
                                   >)
                              >))
    
    188. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^inv((~x.7*~x.8))
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13^inv(~x.8)
         z.2   = x.13^inv(~x.7)
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), x.13^inv(~x.8), x.13^inv(~x.7)>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(x.11*inv(x.12)), x.13^inv(~x.8), x.13^inv(~x.7)
                                             >)
                                        >)
                                   >)
                              >))
    
    189. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10, x.11^(~x.7*x.12*inv((~x.8*x.13))), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^inv(~x.8)
         pc    = x.11^(x.12*inv((~x.8*x.13)))
         z     = x.10
         z.1   = x.11^(~x.7*x.12*inv((~x.8*x.13)))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = x.9
         z.4   = true
    
    190. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10, x.11^(x.12*inv(x.13)), 
                                          x.11^(~x.8*x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^inv(~x.8)
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.10
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(~x.8*x.12*inv((~x.7*x.13)))
         z.3   = x.9
         z.4   = true
    
    191. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10, x.11^(x.12*inv((~x.8*x.13))), 
                                          x.11^(x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^inv(~x.8)
         pc    = x.11^(x.12*inv((~x.7*~x.8*x.13)))
         z     = x.10
         z.1   = x.11^(x.12*inv((~x.8*x.13)))
         z.2   = x.11^(x.12*inv((~x.7*x.13)))
         z.3   = x.9
         z.4   = true
    
    192. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^~x.8, x.11^(~x.7*x.12*inv((~x.8*x.13))), 
                                          x.11^(x.12*inv(x.13))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10
         pc    = x.11^(x.12*inv((~x.8*x.13)))
         z     = x.10^~x.8
         z.1   = x.11^(~x.7*x.12*inv((~x.8*x.13)))
         z.2   = x.11^(x.12*inv(x.13))
         z.3   = x.9
         z.4   = true
    
    193. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^~x.8, x.11^(x.12*inv(x.13)), 
                                          x.11^(~x.8*x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10
         pc    = x.11^(x.12*inv((~x.7*x.13)))
         z     = x.10^~x.8
         z.1   = x.11^(x.12*inv(x.13))
         z.2   = x.11^(~x.8*x.12*inv((~x.7*x.13)))
         z.3   = x.9
         z.4   = true
    
    194. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^~x.8, x.11^(x.12*inv((~x.8*x.13))), 
                                          x.11^(x.12*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10
         pc    = x.11^(x.12*inv((~x.7*~x.8*x.13)))
         z     = x.10^~x.8
         z.1   = x.11^(x.12*inv((~x.8*x.13)))
         z.2   = x.11^(x.12*inv((~x.7*x.13)))
         z.3   = x.9
         z.4   = true
    
    195. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.10^x.11, x.12^x.13, x.12^(~x.8*x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.10^x.11
         z.1   = x.12^x.13
         z.2   = x.12^(~x.8*x.13*inv(~x.7))
         z.3   = x.9
         z.4   = true
    
    196. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^x.11, x.12^inv(x.13), x.12^(~x.8*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^inv((~x.7*x.13))
         z     = x.10^x.11
         z.1   = x.12^inv(x.13)
         z.2   = x.12^(~x.8*inv((~x.7*x.13)))
         z.3   = x.9
         z.4   = true
    
    197. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^x.11, x.12^inv((~x.8*x.13)), x.12^inv((~x.7*x.13))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^inv((~x.7*~x.8*x.13))
         z     = x.10^x.11
         z.1   = x.12^inv((~x.8*x.13))
         z.2   = x.12^inv((~x.7*x.13))
         z.3   = x.9
         z.4   = true
    
    198. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.10^x.11, x.12^(~x.7*x.13), x.12^(~x.8*x.13)>)>)>)
                          >))
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^x.13
         z     = x.10^x.11
         z.1   = x.12^(~x.7*x.13)
         z.2   = x.12^(~x.8*x.13)
         z.3   = x.9
         z.4   = true
    
    199. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.10^x.11, x.12^(~x.7*x.13*inv(~x.8)), x.12^x.13>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^(x.13*inv(~x.8))
         z     = x.10^x.11
         z.1   = x.12^(~x.7*x.13*inv(~x.8))
         z.2   = x.12^x.13
         z.3   = x.9
         z.4   = true
    
    200. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^x.11, x.12^(~x.7*inv((~x.8*x.13))), x.12^inv(x.13)>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^inv((~x.8*x.13))
         z     = x.10^x.11
         z.1   = x.12^(~x.7*inv((~x.8*x.13)))
         z.2   = x.12^inv(x.13)
         z.3   = x.9
         z.4   = true
    
    201. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^x.11, x.12^(x.13*inv(~x.8)), x.12^(x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv(~x.8))
         pc    = x.12^(x.13*inv((~x.7*~x.8)))
         z     = x.10^x.11
         z.1   = x.12^(x.13*inv(~x.8))
         z.2   = x.12^(x.13*inv(~x.7))
         z.3   = x.9
         z.4   = true
    
    202. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^x.13, x.12^(~x.8*x.13*inv(~x.7))>)>)
                               >)
                          >))
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.10^inv(x.11)
         z.1   = x.12^x.13
         z.2   = x.12^(~x.8*x.13*inv(~x.7))
         z.3   = x.9
         z.4   = true
    
    203. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^inv(x.13), 
                                          x.12^(~x.8*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^inv((~x.7*x.13))
         z     = x.10^inv(x.11)
         z.1   = x.12^inv(x.13)
         z.2   = x.12^(~x.8*inv((~x.7*x.13)))
         z.3   = x.9
         z.4   = true
    
    204. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^inv((~x.8*x.13)), 
                                          x.12^inv((~x.7*x.13))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^inv((~x.7*~x.8*x.13))
         z     = x.10^inv(x.11)
         z.1   = x.12^inv((~x.8*x.13))
         z.2   = x.12^inv((~x.7*x.13))
         z.3   = x.9
         z.4   = true
    
    205. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^(~x.7*x.13), x.12^(~x.8*x.13)>)>)
                               >)
                          >))
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^x.13
         z     = x.10^inv(x.11)
         z.1   = x.12^(~x.7*x.13)
         z.2   = x.12^(~x.8*x.13)
         z.3   = x.9
         z.4   = true
    
    206. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^(~x.7*x.13*inv(~x.8)), x.12^x.13>)>)
                               >)
                          >))
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^(x.13*inv(~x.8))
         z     = x.10^inv(x.11)
         z.1   = x.12^(~x.7*x.13*inv(~x.8))
         z.2   = x.12^x.13
         z.3   = x.9
         z.4   = true
    
    207. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^(~x.7*inv((~x.8*x.13))), 
                                          x.12^inv(x.13)>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^inv((~x.8*x.13))
         z     = x.10^inv(x.11)
         z.1   = x.12^(~x.7*inv((~x.8*x.13)))
         z.2   = x.12^inv(x.13)
         z.3   = x.9
         z.4   = true
    
    208. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^inv(x.11), x.12^(x.13*inv(~x.8)), 
                                          x.12^(x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^inv((~x.8*x.11))
         pc    = x.12^(x.13*inv((~x.7*~x.8)))
         z     = x.10^inv(x.11)
         z.1   = x.12^(x.13*inv(~x.8))
         z.2   = x.12^(x.13*inv(~x.7))
         z.3   = x.9
         z.4   = true
    
    209. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^x.13, x.12^(~x.8*x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^x.11
         pc    = x.12^(x.13*inv(~x.7))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^x.13
         z.2   = x.12^(~x.8*x.13*inv(~x.7))
         z.3   = x.9
         z.4   = true
    
    210. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^inv(x.13), 
                                          x.12^(~x.8*inv((~x.7*x.13)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^x.11
         pc    = x.12^inv((~x.7*x.13))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^inv(x.13)
         z.2   = x.12^(~x.8*inv((~x.7*x.13)))
         z.3   = x.9
         z.4   = true
    
    211. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^inv((~x.8*x.13)), 
                                          x.12^inv((~x.7*x.13))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^x.11
         pc    = x.12^inv((~x.7*~x.8*x.13))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^inv((~x.8*x.13))
         z.2   = x.12^inv((~x.7*x.13))
         z.3   = x.9
         z.4   = true
    
    212. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^(~x.7*x.13), x.12^(~x.8*x.13)>)>)
                               >)
                          >))
         ltpk  = x.10^x.11
         pc    = x.12^x.13
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^(~x.7*x.13)
         z.2   = x.12^(~x.8*x.13)
         z.3   = x.9
         z.4   = true
    
    213. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^(~x.7*x.13*inv(~x.8)), x.12^x.13>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^x.11
         pc    = x.12^(x.13*inv(~x.8))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^(~x.7*x.13*inv(~x.8))
         z.2   = x.12^x.13
         z.3   = x.9
         z.4   = true
    
    214. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^(~x.7*inv((~x.8*x.13))), 
                                          x.12^inv(x.13)>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^x.11
         pc    = x.12^inv((~x.8*x.13))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^(~x.7*inv((~x.8*x.13)))
         z.2   = x.12^inv(x.13)
         z.3   = x.9
         z.4   = true
    
    215. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(~x.8*x.11), x.12^(x.13*inv(~x.8)), 
                                          x.12^(x.13*inv(~x.7))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^x.11
         pc    = x.12^(x.13*inv((~x.7*~x.8)))
         z     = x.10^(~x.8*x.11)
         z.1   = x.12^(x.13*inv(~x.8))
         z.2   = x.12^(x.13*inv(~x.7))
         z.3   = x.9
         z.4   = true
    
    216. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), x.13, x.13^(~x.8*inv(~x.7))>)>)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^inv(~x.7)
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13
         z.2   = x.13^(~x.8*inv(~x.7))
         z.3   = x.9
         z.4   = true
    
    217. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.10^(x.11*inv(x.12)), x.13^~x.7, x.13^~x.8>)>)>)
                          >))
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13^~x.7
         z.2   = x.13^~x.8
         z.3   = x.9
         z.4   = true
    
    218. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), x.13^inv(~x.8), x.13^inv(~x.7)>)>)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^inv((~x.7*~x.8))
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13^inv(~x.8)
         z.2   = x.13^inv(~x.7)
         z.3   = x.9
         z.4   = true
    
    219. ~ltk  = ~x.7
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), x.13^(~x.7*inv(~x.8)), x.13>)>)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^inv(~x.8)
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13^(~x.7*inv(~x.8))
         z.2   = x.13
         z.3   = x.9
         z.4   = true
    
    220. ~ltk  = ~x.8
         ~prek = ~prek.3
         enc   = enc.3
         ltpk  = x.11^x.12
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.11^(~prek.3*x.12)
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(~prek.3*x.14*inv((~x.8*x.15)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(~prek.3*x.12), x.13^(x.14*inv(x.15)), 
                                          x.13^(~prek.3*x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^(~prek.3*x.12), x.13^(x.14*inv(x.15)), 
                                              x.13^(~prek.3*x.14*inv((~x.8*x.15)))>)
                                        >)
                                   >)
                              >))
    
    221. ~ltk  = ~x.8
         ~prek = ~x.8
         enc   = enc.3
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(x.14*inv(x.15))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), x.13^(x.14*inv(x.15)), 
                                          x.13^(x.14*inv(x.15))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.10^(x.11*inv(x.12)), x.13^(x.14*inv(x.15)), 
                                              x.13^(x.14*inv(x.15))>)
                                        >)
                                   >)
                              >))
    
    222. ~ltk  = ~x.8
         ~prek = ~x.8
         enc   = senc(x.9,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.10^(x.11*inv(x.12)), x.13^(x.14*inv(x.15)), 
                                          x.13^(x.14*inv(x.15))>)
                                    >)
                               >)
                          >))
         ltpk  = x.10^(x.11*inv((~x.8*x.12)))
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.10^(x.11*inv(x.12))
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(x.14*inv(x.15))
         z.3   = x.9
         z.4   = true
    
    223. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^x.12
         pc    = x.13^(x.14*inv((~x.8*~x.9*x.15)))
         z     = x.11^(~x.9*x.12)
         z.1   = x.13^(x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv((~x.8*x.15)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(~x.9*x.12), x.13^(x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^(~x.9*x.12), x.13^(x.14*inv((~x.9*x.15))), 
                                              x.13^(x.14*inv((~x.8*x.15)))>)
                                        >)
                                   >)
                              >))
    
    224. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^inv((~x.9*x.12))
         pc    = x.13^(x.14*inv((~x.8*~x.9*x.15)))
         z     = x.11^inv(x.12)
         z.1   = x.13^(x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv((~x.8*x.15)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^inv(x.12), x.13^(x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^inv(x.12), x.13^(x.14*inv((~x.9*x.15))), 
                                              x.13^(x.14*inv((~x.8*x.15)))>)
                                        >)
                                   >)
                              >))
    
    225. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^inv((~x.9*x.12))
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.11^inv(x.12)
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(~x.9*x.14*inv((~x.8*x.15)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^inv(x.12), x.13^(x.14*inv(x.15)), 
                                          x.13^(~x.9*x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^inv(x.12), x.13^(x.14*inv(x.15)), 
                                              x.13^(~x.9*x.14*inv((~x.8*x.15)))>)
                                        >)
                                   >)
                              >))
    
    226. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^(x.12*inv(~x.9))
         pc    = x.13^(x.14*inv((~x.8*~x.9*x.15)))
         z     = x.11^x.12
         z.1   = x.13^(x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv((~x.8*x.15)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^x.12, x.13^(x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^x.12, x.13^(x.14*inv((~x.9*x.15))), 
                                              x.13^(x.14*inv((~x.8*x.15)))>)
                                        >)
                                   >)
                              >))
    
    227. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^(x.12*inv(~x.9))
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.11^x.12
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(~x.9*x.14*inv((~x.8*x.15)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^x.12, x.13^(x.14*inv(x.15)), 
                                          x.13^(~x.9*x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^x.12, x.13^(x.14*inv(x.15)), 
                                              x.13^(~x.9*x.14*inv((~x.8*x.15)))>)
                                        >)
                                   >)
                              >))
    
    228. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^inv((~x.8*~x.9*x.15))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^inv((~x.9*x.15))
         z.2   = x.14^inv((~x.8*x.15))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^inv((~x.9*x.15)), 
                                          x.14^inv((~x.8*x.15))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^(x.12*inv(x.13)), x.14^inv((~x.9*x.15)), 
                                              x.14^inv((~x.8*x.15))>)
                                        >)
                                   >)
                              >))
    
    229. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^inv((~x.8*x.15))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^inv(x.15)
         z.2   = x.14^(~x.9*inv((~x.8*x.15)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^inv(x.15), 
                                          x.14^(~x.9*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^(x.12*inv(x.13)), x.14^inv(x.15), 
                                              x.14^(~x.9*inv((~x.8*x.15)))>)
                                        >)
                                   >)
                              >))
    
    230. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^(x.15*inv(~x.8))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^x.15
         z.2   = x.14^(~x.9*x.15*inv(~x.8))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^x.15, 
                                          x.14^(~x.9*x.15*inv(~x.8))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^(x.12*inv(x.13)), x.14^x.15, 
                                              x.14^(~x.9*x.15*inv(~x.8))>)
                                        >)
                                   >)
                              >))
    
    231. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = enc.3
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^(x.15*inv((~x.8*~x.9)))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^(x.15*inv(~x.9))
         z.2   = x.14^(x.15*inv(~x.8))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^(x.15*inv(~x.9)), 
                                          x.14^(x.15*inv(~x.8))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.11^(x.12*inv(x.13)), x.14^(x.15*inv(~x.9)), 
                                              x.14^(x.15*inv(~x.8))>)
                                        >)
                                   >)
                              >))
    
    232. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^x.12, x.13^(~x.8*x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv(x.15))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv(~x.9))
         pc    = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.11^x.12
         z.1   = x.13^(~x.8*x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv(x.15))
         z.3   = x.10
         z.4   = true
    
    233. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^x.12, x.13^(x.14*inv(x.15)), 
                                          x.13^(~x.9*x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv(~x.9))
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.11^x.12
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(~x.9*x.14*inv((~x.8*x.15)))
         z.3   = x.10
         z.4   = true
    
    234. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^x.12, x.13^(x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv(~x.9))
         pc    = x.13^(x.14*inv((~x.8*~x.9*x.15)))
         z     = x.11^x.12
         z.1   = x.13^(x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv((~x.8*x.15)))
         z.3   = x.10
         z.4   = true
    
    235. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^inv(x.12), x.13^(~x.8*x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv(x.15))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^inv((~x.9*x.12))
         pc    = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.11^inv(x.12)
         z.1   = x.13^(~x.8*x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv(x.15))
         z.3   = x.10
         z.4   = true
    
    236. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^inv(x.12), x.13^(x.14*inv(x.15)), 
                                          x.13^(~x.9*x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^inv((~x.9*x.12))
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.11^inv(x.12)
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(~x.9*x.14*inv((~x.8*x.15)))
         z.3   = x.10
         z.4   = true
    
    237. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^inv(x.12), x.13^(x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^inv((~x.9*x.12))
         pc    = x.13^(x.14*inv((~x.8*~x.9*x.15)))
         z     = x.11^inv(x.12)
         z.1   = x.13^(x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv((~x.8*x.15)))
         z.3   = x.10
         z.4   = true
    
    238. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(~x.9*x.12), x.13^(~x.8*x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv(x.15))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^x.12
         pc    = x.13^(x.14*inv((~x.9*x.15)))
         z     = x.11^(~x.9*x.12)
         z.1   = x.13^(~x.8*x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv(x.15))
         z.3   = x.10
         z.4   = true
    
    239. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(~x.9*x.12), x.13^(x.14*inv(x.15)), 
                                          x.13^(~x.9*x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^x.12
         pc    = x.13^(x.14*inv((~x.8*x.15)))
         z     = x.11^(~x.9*x.12)
         z.1   = x.13^(x.14*inv(x.15))
         z.2   = x.13^(~x.9*x.14*inv((~x.8*x.15)))
         z.3   = x.10
         z.4   = true
    
    240. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(~x.9*x.12), x.13^(x.14*inv((~x.9*x.15))), 
                                          x.13^(x.14*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^x.12
         pc    = x.13^(x.14*inv((~x.8*~x.9*x.15)))
         z     = x.11^(~x.9*x.12)
         z.1   = x.13^(x.14*inv((~x.9*x.15)))
         z.2   = x.13^(x.14*inv((~x.8*x.15)))
         z.3   = x.10
         z.4   = true
    
    241. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^x.15, 
                                          x.14^(~x.9*x.15*inv(~x.8))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^(x.15*inv(~x.8))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^x.15
         z.2   = x.14^(~x.9*x.15*inv(~x.8))
         z.3   = x.10
         z.4   = true
    
    242. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^inv(x.15), 
                                          x.14^(~x.9*inv((~x.8*x.15)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^inv((~x.8*x.15))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^inv(x.15)
         z.2   = x.14^(~x.9*inv((~x.8*x.15)))
         z.3   = x.10
         z.4   = true
    
    243. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^inv((~x.9*x.15)), 
                                          x.14^inv((~x.8*x.15))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^inv((~x.8*~x.9*x.15))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^inv((~x.9*x.15))
         z.2   = x.14^inv((~x.8*x.15))
         z.3   = x.10
         z.4   = true
    
    244. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^(~x.8*x.15), x.14^(~x.9*x.15)
                                         >)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^x.15
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^(~x.8*x.15)
         z.2   = x.14^(~x.9*x.15)
         z.3   = x.10
         z.4   = true
    
    245. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^(~x.8*x.15*inv(~x.9)), 
                                          x.14^x.15>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^(x.15*inv(~x.9))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^(~x.8*x.15*inv(~x.9))
         z.2   = x.14^x.15
         z.3   = x.10
         z.4   = true
    
    246. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^(~x.8*inv((~x.9*x.15))), 
                                          x.14^inv(x.15)>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^inv((~x.9*x.15))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^(~x.8*inv((~x.9*x.15)))
         z.2   = x.14^inv(x.15)
         z.3   = x.10
         z.4   = true
    
    247. ~ltk  = ~x.8
         ~prek = ~x.9
         enc   = senc(x.10,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.11^(x.12*inv(x.13)), x.14^(x.15*inv(~x.9)), 
                                          x.14^(x.15*inv(~x.8))>)
                                    >)
                               >)
                          >))
         ltpk  = x.11^(x.12*inv((~x.9*x.13)))
         pc    = x.14^(x.15*inv((~x.8*~x.9)))
         z     = x.11^(x.12*inv(x.13))
         z.1   = x.14^(x.15*inv(~x.9))
         z.2   = x.14^(x.15*inv(~x.8))
         z.3   = x.10
         z.4   = true
    
    248. ~ltk  = ~x.9
         ~prek = ~x.10
         enc   = enc.3
         ltpk  = x.12^(x.13*inv((~x.10*x.14)))
         pc    = x.15^(x.16*inv((~x.9*~x.10*x.17)))
         z     = x.12^(x.13*inv(x.14))
         z.1   = x.15^(x.16*inv((~x.10*x.17)))
         z.2   = x.15^(x.16*inv((~x.9*x.17)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.12^(x.13*inv(x.14)), x.15^(x.16*inv((~x.10*x.17))), 
                                          x.15^(x.16*inv((~x.9*x.17)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.12^(x.13*inv(x.14)), x.15^(x.16*inv((~x.10*x.17))), 
                                              x.15^(x.16*inv((~x.9*x.17)))>)
                                        >)
                                   >)
                              >))
    
    249. ~ltk  = ~x.9
         ~prek = ~x.10
         enc   = enc.3
         ltpk  = x.12^(x.13*inv((~x.10*x.14)))
         pc    = x.15^(x.16*inv((~x.9*x.17)))
         z     = x.12^(x.13*inv(x.14))
         z.1   = x.15^(x.16*inv(x.17))
         z.2   = x.15^(~x.10*x.16*inv((~x.9*x.17)))
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.12^(x.13*inv(x.14)), x.15^(x.16*inv(x.17)), 
                                          x.15^(~x.10*x.16*inv((~x.9*x.17)))>)
                                    >)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<x.12^(x.13*inv(x.14)), x.15^(x.16*inv(x.17)), 
                                              x.15^(~x.10*x.16*inv((~x.9*x.17)))>)
                                        >)
                                   >)
                              >))
    
    250. ~ltk  = ~x.9
         ~prek = ~x.10
         enc   = senc(x.11,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.12^(x.13*inv(x.14)), 
                                          x.15^(~x.9*x.16*inv((~x.10*x.17))), x.15^(x.16*inv(x.17))
                                         >)
                                    >)
                               >)
                          >))
         ltpk  = x.12^(x.13*inv((~x.10*x.14)))
         pc    = x.15^(x.16*inv((~x.10*x.17)))
         z     = x.12^(x.13*inv(x.14))
         z.1   = x.15^(~x.9*x.16*inv((~x.10*x.17)))
         z.2   = x.15^(x.16*inv(x.17))
         z.3   = x.11
         z.4   = true
    
    251. ~ltk  = ~x.9
         ~prek = ~x.10
         enc   = senc(x.11,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.12^(x.13*inv(x.14)), x.15^(x.16*inv(x.17)), 
                                          x.15^(~x.10*x.16*inv((~x.9*x.17)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.12^(x.13*inv((~x.10*x.14)))
         pc    = x.15^(x.16*inv((~x.9*x.17)))
         z     = x.12^(x.13*inv(x.14))
         z.1   = x.15^(x.16*inv(x.17))
         z.2   = x.15^(~x.10*x.16*inv((~x.9*x.17)))
         z.3   = x.11
         z.4   = true
    
    252. ~ltk  = ~x.9
         ~prek = ~x.10
         enc   = senc(x.11,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<x.12^(x.13*inv(x.14)), x.15^(x.16*inv((~x.10*x.17))), 
                                          x.15^(x.16*inv((~x.9*x.17)))>)
                                    >)
                               >)
                          >))
         ltpk  = x.12^(x.13*inv((~x.10*x.14)))
         pc    = x.15^(x.16*inv((~x.9*~x.10*x.17)))
         z     = x.12^(x.13*inv(x.14))
         z.1   = x.15^(x.16*inv((~x.10*x.17)))
         z.2   = x.15^(x.16*inv((~x.9*x.17)))
         z.3   = x.11
         z.4   = true
    
    253. ~prek = ~prek.3
         enc   = enc.3
         ltpk  = ltpk.3
         pc    = DH_neutral
         z     = ltpk.3^~prek.3
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<ltpk.3^~prek.3, DH_neutral, DH_neutral>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<ltpk.3^~prek.3, DH_neutral, DH_neutral>)>)>)
                              >))
    
    254. ~prek = ~prek.3
         enc   = enc.3
         ltpk  = x.2^x.3
         pc    = DH_neutral
         z     = x.2^(~prek.3*x.3)
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.2^(~prek.3*x.3), DH_neutral, DH_neutral>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.2^(~prek.3*x.3), DH_neutral, DH_neutral>)>)>)
                              >))
    
    255. ~prek = ~x.3
         enc   = enc.3
         ltpk  = x.5^inv(~x.3)
         pc    = DH_neutral
         z     = x.5
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.5, DH_neutral, DH_neutral>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.5, DH_neutral, DH_neutral>)>)>)>))
    
    256. ~prek = ~x.3
         enc   = senc(x.4,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.5, DH_neutral, DH_neutral>)>)>)>))
         ltpk  = x.5^inv(~x.3)
         pc    = DH_neutral
         z     = x.5
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = x.4
         z.4   = true
    
    257. ~prek = ~x.3
         enc   = senc(x.4,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.5^~x.3, DH_neutral, DH_neutral>)>)>)
                          >))
         ltpk  = x.5
         pc    = DH_neutral
         z     = x.5^~x.3
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = x.4
         z.4   = true
    
    258. ~prek = ~x.4
         enc   = enc.3
         ltpk  = x.6^inv((~x.4*x.7))
         pc    = DH_neutral
         z     = x.6^inv(x.7)
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.6^inv(x.7), DH_neutral, DH_neutral>)>)
                               >)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.6^inv(x.7), DH_neutral, DH_neutral>)>)
                                   >)
                              >))
    
    259. ~prek = ~x.4
         enc   = enc.3
         ltpk  = x.6^(x.7*inv(~x.4))
         pc    = DH_neutral
         z     = x.6^x.7
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.6^x.7, DH_neutral, DH_neutral>)>)>)>))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<x.6^x.7, DH_neutral, DH_neutral>)>)>)>))
    
    260. ~prek = ~x.4
         enc   = senc(x.5,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.6^x.7, DH_neutral, DH_neutral>)>)>)>))
         ltpk  = x.6^(x.7*inv(~x.4))
         pc    = DH_neutral
         z     = x.6^x.7
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = x.5
         z.4   = true
    
    261. ~prek = ~x.4
         enc   = senc(x.5,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<x.6^inv(x.7), DH_neutral, DH_neutral>)>)
                               >)
                          >))
         ltpk  = x.6^inv((~x.4*x.7))
         pc    = DH_neutral
         z     = x.6^inv(x.7)
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = x.5
         z.4   = true
    
    262. ~prek = ~x.4
         enc   = senc(x.5,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.6^(~x.4*x.7), DH_neutral, DH_neutral>)>)>)
                          >))
         ltpk  = x.6^x.7
         pc    = DH_neutral
         z     = x.6^(~x.4*x.7)
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = x.5
         z.4   = true
    
    263. ~prek = ~x.5
         enc   = enc.3
         ltpk  = x.7^(x.8*inv((~x.5*x.9)))
         pc    = DH_neutral
         z     = x.7^(x.8*inv(x.9))
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7^(x.8*inv(x.9)), DH_neutral, DH_neutral>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', kdf(<x.7^(x.8*inv(x.9)), DH_neutral, DH_neutral>)>)>)
                              >))
    
    264. ~prek = ~x.5
         enc   = senc(x.6,
                      kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', kdf(<x.7^(x.8*inv(x.9)), DH_neutral, DH_neutral>)>)>)
                          >))
         ltpk  = x.7^(x.8*inv((~x.5*x.9)))
         pc    = DH_neutral
         z     = x.7^(x.8*inv(x.9))
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = x.6
         z.4   = true
    
    265. enc   = enc.3
         ltpk  = DH_neutral
         pc    = DH_neutral
         z     = DH_neutral
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = sdec(enc.3,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, DH_neutral, DH_neutral>)>)>)
                          >))
         z.4   = decrypts(enc.3,
                          kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, DH_neutral, DH_neutral>)>)>)
                              >))
    
    266. enc   = senc(x.1,
                      kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<DH_neutral, DH_neutral, DH_neutral>)>)>)
                          >))
         ltpk  = DH_neutral
         pc    = DH_neutral
         z     = DH_neutral
         z.1   = DH_neutral
         z.2   = DH_neutral
         z.3   = x.1
         z.4   = true
  */

rule (modulo E) Receive:
   [ In( enc ), Session( ~id, $A, 'R', ~x, $B, pc, rk, ck ) ]
  --[
  Receive( sdec(enc, kdf(<'mk', kdf(<'ck', ck>)>)) ),
  DHSecrets( ~id, 'g'^~x, pc, pc^~x, rk ),
  Eq( decrypts(enc, kdf(<'mk', kdf(<'ck', ck>)>)), true )
  ]->
   [ Session( ~id, $A, 'R', ~x, $B, pc, rk, kdf(<'ck', ck>) ) ]

  // loop breaker: [1]
  /*
  rule (modulo AC) Receive:
     [ In( enc ), Session( ~id, $A, 'R', ~x, $B, pc, rk, ck ) ]
    --[
    Receive( z ), DHSecrets( ~id, 'g'^~x, pc, z.1, rk ),
    Eq( z.2, true )
    ]->
     [ Session( ~id, $A, 'R', ~x, $B, pc, rk, kdf(<'ck', ck>) ) ]
    variants (modulo AC)
     1. ~x    = ~x.3
        ck    = ck.3
        enc   = enc.3
        pc    = pc.3
        z     = sdec(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
        z.1   = pc.3^~x.3
        z.2   = decrypts(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
    
     2. ~x    = ~x.6
        ck    = ck.3
        enc   = enc.3
        pc    = x.9^inv(~x.6)
        z     = sdec(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
        z.1   = x.9
        z.2   = decrypts(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
    
     3. ~x    = ~x.6
        ck    = x.7
        enc   = senc(x.8, kdf(<'mk', kdf(<'ck', x.7>)>))
        pc    = x.9^inv(~x.6)
        z     = x.8
        z.1   = x.9
        z.2   = true
    
     4. ~x    = ~x.7
        ck    = ck.3
        enc   = enc.3
        pc    = x.5^x.6
        z     = sdec(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
        z.1   = x.5^(x.6*~x.7)
        z.2   = decrypts(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
    
     5. ~x    = ~x.7
        ck    = ck.3
        enc   = enc.3
        pc    = x.10^inv((~x.7*x.11))
        z     = sdec(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
        z.1   = x.10^inv(x.11)
        z.2   = decrypts(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
    
     6. ~x    = ~x.7
        ck    = ck.3
        enc   = enc.3
        pc    = x.10^(x.11*inv(~x.7))
        z     = sdec(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
        z.1   = x.10^x.11
        z.2   = decrypts(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
    
     7. ~x    = ~x.7
        ck    = x.5
        enc   = senc(x.6, kdf(<'mk', kdf(<'ck', x.5>)>))
        pc    = pc.3
        z     = x.6
        z.1   = pc.3^~x.7
        z.2   = true
    
     8. ~x    = ~x.7
        ck    = x.8
        enc   = senc(x.9, kdf(<'mk', kdf(<'ck', x.8>)>))
        pc    = x.10^inv((~x.7*x.11))
        z     = x.9
        z.1   = x.10^inv(x.11)
        z.2   = true
    
     9. ~x    = ~x.7
        ck    = x.8
        enc   = senc(x.9, kdf(<'mk', kdf(<'ck', x.8>)>))
        pc    = x.10^(x.11*inv(~x.7))
        z     = x.9
        z.1   = x.10^x.11
        z.2   = true
    
    10. ~x    = ~x.8
        ck    = ck.3
        enc   = enc.3
        pc    = x.11^(x.12*inv((~x.8*x.13)))
        z     = sdec(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
        z.1   = x.11^(x.12*inv(x.13))
        z.2   = decrypts(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
    
    11. ~x    = ~x.8
        ck    = x.9
        enc   = senc(x.10, kdf(<'mk', kdf(<'ck', x.9>)>))
        pc    = x.11^(x.12*inv((~x.8*x.13)))
        z     = x.10
        z.1   = x.11^(x.12*inv(x.13))
        z.2   = true
    
    12. ~x    = ~x.11
        ck    = x.7
        enc   = senc(x.8, kdf(<'mk', kdf(<'ck', x.7>)>))
        pc    = x.9^x.10
        z     = x.8
        z.1   = x.9^(x.10*~x.11)
        z.2   = true
    
    13. ck    = ck.3
        enc   = enc.3
        pc    = DH_neutral
        z     = sdec(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
        z.1   = DH_neutral
        z.2   = decrypts(enc.3, kdf(<'mk', kdf(<'ck', ck.3>)>))
    
    14. ck    = x.4
        enc   = senc(x.5, kdf(<'mk', kdf(<'ck', x.4>)>))
        pc    = DH_neutral
        z     = x.5
        z.1   = DH_neutral
        z.2   = true
    // loop breaker: [1]
  */

rule (modulo E) OuterRatchetToSender:
   [
   Fr( ~x ), Fr( ~m ),
   Session( ~id, $A, 'R', drop, $B, pc, old_rk, old_ck )
   ]
  --[
  ToSender( ~id, 'g'^~x, pc^~x ), Send( ~m ),
  DHSecrets( ~id, 'g'^~x, pc, pc^~x, kdf(<'rk', old_rk, pc^~x>) ),
  NewDHSecrets( ~id, 'g'^~x, pc, pc^~x, kdf(<'rk', old_rk, pc^~x>) )
  ]->
   [
   Session( ~id, $A, 'S', ~x, $B, pc, kdf(<'rk', old_rk, pc^~x>),
            kdf(<'ck', kdf(<'rk', old_rk, pc^~x>)>)
   ),
   Out( <'g'^~x, 
         senc(~m, kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk, pc^~x>)>)>))>
   )
   ]

  // loop breaker: [2]
  /*
  rule (modulo AC) OuterRatchetToSender:
     [
     Fr( ~x ), Fr( ~m ),
     Session( ~id, $A, 'R', drop, $B, pc, old_rk, old_ck )
     ]
    --[
    ToSender( ~id, 'g'^~x, z ), Send( ~m ),
    DHSecrets( ~id, 'g'^~x, pc, z, kdf(<'rk', old_rk, z>) ),
    NewDHSecrets( ~id, 'g'^~x, pc, z, kdf(<'rk', old_rk, z>) )
    ]->
     [
     Session( ~id, $A, 'S', ~x, $B, pc, kdf(<'rk', old_rk, z>),
              kdf(<'ck', kdf(<'rk', old_rk, z>)>)
     ),
     Out( <'g'^~x, 
           senc(~m, kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk, z>)>)>))>
     )
     ]
    variants (modulo AC)
    1. ~x    = ~x.3
       pc    = pc.3
       z     = pc.3^~x.3
    
    2. ~x    = ~x.7
       pc    = x.5^x.6
       z     = x.5^(x.6*~x.7)
    
    3. ~x    = ~x.7
       pc    = x.11^inv(~x.7)
       z     = x.11
    
    4. ~x    = ~x.8
       pc    = x.12^inv((~x.8*x.13))
       z     = x.12^inv(x.13)
    
    5. ~x    = ~x.8
       pc    = x.12^(x.13*inv(~x.8))
       z     = x.12^x.13
    
    6. ~x    = ~x.9
       pc    = x.13^(x.14*inv((~x.9*x.15)))
       z     = x.13^(x.14*inv(x.15))
    
    7. pc    = DH_neutral
       z     = DH_neutral
    // loop breaker: [2]
  */

rule (modulo E) OuterRatchetToReceiver:
   [
   In( <pc, enc> ),
   Session( ~id, $A, 'S', ~x, $B, old_pc, old_rk, old_ck )
   ]
  --[
  Neq( pc, DH_neutral ), Neq( pc, 'g' ),
  Receive( sdec(enc,
                kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk, pc^~x>)>)>))
  ),
  DHSecrets( ~id, 'g'^~x, pc, pc^~x, kdf(<'rk', old_rk, pc^~x>) ),
  NewDHSecrets( ~id, 'g'^~x, pc, pc^~x, kdf(<'rk', old_rk, pc^~x>) ),
  Eq( decrypts(enc,
               kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk, pc^~x>)>)>)),
      true
  )
  ]->
   [
   Session( ~id, $A, 'R', ~x, $B, pc, kdf(<'rk', old_rk, pc^~x>),
            kdf(<'ck', kdf(<'rk', old_rk, pc^~x>)>)
   )
   ]

  /*
  rule (modulo AC) OuterRatchetToReceiver:
     [
     In( <pc, enc> ),
     Session( ~id, $A, 'S', ~x, $B, old_pc, old_rk, old_ck )
     ]
    --[
    Neq( pc, DH_neutral ), Neq( pc, 'g' ), Receive( z.1 ),
    DHSecrets( ~id, 'g'^~x, pc, z, kdf(<'rk', old_rk, z>) ),
    NewDHSecrets( ~id, 'g'^~x, pc, z, kdf(<'rk', old_rk, z>) ),
    Eq( z.2, true )
    ]->
     [
     Session( ~id, $A, 'R', ~x, $B, pc, kdf(<'rk', old_rk, z>),
              kdf(<'ck', kdf(<'rk', old_rk, z>)>)
     )
     ]
    variants (modulo AC)
     1. ~x    = ~x.3
        enc   = enc.3
        old_rk
              = old_rk.3
        pc    = pc.3
        z     = pc.3^~x.3
        z.1   = sdec(enc.3,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, pc.3^~x.3>)>)>))
        z.2   = decrypts(enc.3,
                         kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, pc.3^~x.3>)>)>))
    
     2. ~x    = ~x.6
        enc   = senc(x.7, kdf(<'mk', kdf(<'ck', kdf(<'rk', x.8, x.9>)>)>))
        old_rk
              = x.8
        pc    = x.9^inv(~x.6)
        z     = x.9
        z.1   = x.7
        z.2   = true
    
     3. ~x    = ~x.6
        enc   = senc(x.7,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', x.8, x.9^~x.6>)>)>))
        old_rk
              = x.8
        pc    = x.9
        z     = x.9^~x.6
        z.1   = x.7
        z.2   = true
    
     4. ~x    = ~x.7
        enc   = enc.3
        old_rk
              = old_rk.3
        pc    = x.5^x.6
        z     = x.5^(x.6*~x.7)
        z.1   = sdec(enc.3,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.5^(x.6*~x.7)>)>)>))
        z.2   = decrypts(enc.3,
                         kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.5^(x.6*~x.7)>)>)>))
    
     5. ~x    = ~x.7
        enc   = senc(x.8,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', x.9, x.10^x.11>)>)>))
        old_rk
              = x.9
        pc    = x.10^(x.11*inv(~x.7))
        z     = x.10^x.11
        z.1   = x.8
        z.2   = true
    
     6. ~x    = ~x.7
        enc   = senc(x.8,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', x.9, x.10^inv(x.11)>)>)>))
        old_rk
              = x.9
        pc    = x.10^inv((~x.7*x.11))
        z     = x.10^inv(x.11)
        z.1   = x.8
        z.2   = true
    
     7. ~x    = ~x.7
        enc   = senc(x.8,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', x.9, x.10^(~x.7*x.11)>)>)>))
        old_rk
              = x.9
        pc    = x.10^x.11
        z     = x.10^(~x.7*x.11)
        z.1   = x.8
        z.2   = true
    
     8. ~x    = ~x.8
        enc   = enc.3
        old_rk
              = old_rk.3
        pc    = x.13^inv(~x.8)
        z     = x.13
        z.1   = sdec(enc.3,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.13>)>)>))
        z.2   = decrypts(enc.3,
                         kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.13>)>)>))
    
     9. ~x    = ~x.8
        enc   = senc(x.9,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', x.10, x.11^(x.12*inv(x.13))>)>)>))
        old_rk
              = x.10
        pc    = x.11^(x.12*inv((~x.8*x.13)))
        z     = x.11^(x.12*inv(x.13))
        z.1   = x.9
        z.2   = true
    
    10. ~x    = ~x.9
        enc   = enc.3
        old_rk
              = old_rk.3
        pc    = x.14^inv((~x.9*x.15))
        z     = x.14^inv(x.15)
        z.1   = sdec(enc.3,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.14^inv(x.15)>)>)>))
        z.2   = decrypts(enc.3,
                         kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.14^inv(x.15)>)>)>))
    
    11. ~x    = ~x.9
        enc   = enc.3
        old_rk
              = old_rk.3
        pc    = x.14^(x.15*inv(~x.9))
        z     = x.14^x.15
        z.1   = sdec(enc.3,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.14^x.15>)>)>))
        z.2   = decrypts(enc.3,
                         kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, x.14^x.15>)>)>))
    
    12. ~x    = ~x.10
        enc   = enc.3
        old_rk
              = old_rk.3
        pc    = x.15^(x.16*inv((~x.10*x.17)))
        z     = x.15^(x.16*inv(x.17))
        z.1   = sdec(enc.3,
                     kdf(<'mk', 
                          kdf(<'ck', kdf(<'rk', old_rk.3, x.15^(x.16*inv(x.17))>)>)>))
        z.2   = decrypts(enc.3,
                         kdf(<'mk', 
                              kdf(<'ck', kdf(<'rk', old_rk.3, x.15^(x.16*inv(x.17))>)>)>))
    
    13. enc   = enc.3
        old_rk
              = old_rk.3
        pc    = DH_neutral
        z     = DH_neutral
        z.1   = sdec(enc.3,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, DH_neutral>)>)>))
        z.2   = decrypts(enc.3,
                         kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.3, DH_neutral>)>)>))
    
    14. enc   = senc(x.4,
                     kdf(<'mk', kdf(<'ck', kdf(<'rk', x.5, DH_neutral>)>)>))
        old_rk
              = x.5
        pc    = DH_neutral
        z     = DH_neutral
        z.1   = x.4
        z.2   = true
  */

lemma Exec:
  exists-trace "∃ m #x #y. (Receive( m ) @ #x) ∧ (Send( m ) @ #y)"
/*
guarded formula characterizing all satisfying traces:
"∃ m #x #y. (Receive( m ) @ #x) ∧ (Send( m ) @ #y)"
*/
by sorry

lemma OuterLoopStepSender [reuse, use_induction]:
  all-traces
  "∀ m id pc1 pc2 ss rk #a.
    (((DHSecrets( id, pc1, pc2, ss, rk ) @ #a) ∧ (Send( m ) @ #a)) ∧
     (¬(NewDHSecrets( id, pc1, pc2, ss, rk ) @ #a))) ⇒
    (∃ m.1 #b.
      ((NewDHSecrets( id, pc1, pc2, ss, rk ) @ #b) ∧
       (Send( m.1 ) @ #b)) ∧
      (#b < #a))"
/*
guarded formula characterizing all counter-examples:
"∃ m id pc1 pc2 ss rk #a.
  (DHSecrets( id, pc1, pc2, ss, rk ) @ #a) ∧ (Send( m ) @ #a)
 ∧
  (¬(NewDHSecrets( id, pc1, pc2, ss, rk ) @ #a)) ∧
  (∀ m.1 #b.
    (NewDHSecrets( id, pc1, pc2, ss, rk ) @ #b) ∧ (Send( m.1 ) @ #b)
   ⇒
    ¬(#b < #a))"
*/
induction
  case empty_trace
  by contradiction
next
  case non_empty_trace
  solve( (last(#a))  ∥ (NewDHSecrets( id, pc1, pc2, ss, rk ) @ #a)  ∥
         (∃ m #b.
           (NewDHSecrets( id, pc1, pc2, ss, rk ) @ #b) ∧ (Send( m ) @ #b)
          ∧
           (¬(last(#b))) ∧ (#b < #a)) )
    case case_1
    solve( DHSecrets( id, pc1, pc2, ss, rk ) @ #a )
      case OuterRatchetToReceiver
      by contradiction
    next
      case OuterRatchetToSender
      by contradiction
    next
      case Receive
      by solve( Send( m ) @ #a )
    next
      case ReceiverStart
      by contradiction
    next
      case Send
      solve( Send( m ) @ #a )
        case Send
        solve( splitEqs(0) )
          case split_case_1
          solve( Session( ~id.1, $A, 'S', ~x.1, $B, pc.1, rk.1, ck ) ▶₁ #a )
            case OuterRatchetToSender
            by contradiction
          next
            case Send
            by contradiction
          next
            case SenderStart
            by contradiction
          qed
        next
          case split_case_2
          solve( Session( ~id.1, $A, 'S', ~x.1, $B, z.1^inv(~x.1), rk.1, ck
                 ) ▶₁ #a )
            case OuterRatchetToSender
            by contradiction
          next
            case Send
            by contradiction
          qed
        next
          case split_case_3
          solve( Session( ~id.1, $A, 'S', ~x.1, $B, x.2^inv((~x.1*x.3)),
                          rk.1, ck
                 ) ▶₁ #a )
            case OuterRatchetToSender
            by contradiction
          next
            case Send
            by contradiction
          qed
        next
          case split_case_4
          solve( Session( ~id.1, $A, 'S', ~x.1, $B, x.2^(x.3*inv(~x.1)),
                          rk.1, ck
                 ) ▶₁ #a )
            case OuterRatchetToSender
            by contradiction
          next
            case Send
            by contradiction
          qed
        next
          case split_case_5
          solve( Session( ~id.1, $A, 'S', ~x.1, $B, x.2^x.3, rk.1, ck
                 ) ▶₁ #a )
            case OuterRatchetToSender
            by contradiction
          next
            case Send
            by contradiction
          next
            case SenderStart
            by contradiction
          qed
        next
          case split_case_6
          solve( Session( ~id.1, $A, 'S', ~x.1, $B,
                          x.2^(x.3*inv((~x.1*x.4))), rk.1, ck
                 ) ▶₁ #a )
            case OuterRatchetToSender
            by contradiction
          next
            case Send
            by contradiction
          qed
        next
          case split_case_7
          solve( Session( ~id.1, $A, 'S', ~x, $B, DH_neutral, rk.1, ck
                 ) ▶₁ #a )
            case OuterRatchetToSender
            by contradiction
          next
            case Send
            by contradiction
          qed
        qed
      qed
    next
      case SenderStart
      by contradiction
    qed
  next
    case case_2
    by contradiction
  next
    case case_3
    by contradiction
  qed
qed

lemma OuterLoopStepReceiver [reuse, use_induction]:
  all-traces
  "∀ m id pc1 pc2 ss rk #a.
    (((DHSecrets( id, pc1, pc2, ss, rk ) @ #a) ∧ (Receive( m ) @ #a)) ∧
     (¬(NewDHSecrets( id, pc1, pc2, ss, rk ) @ #a))) ⇒
    (∃ m.1 #b.
      ((NewDHSecrets( id, pc1, pc2, ss, rk ) @ #b) ∧
       (Receive( m.1 ) @ #b)) ∧
      (#b < #a))"
/*
guarded formula characterizing all counter-examples:
"∃ m id pc1 pc2 ss rk #a.
  (DHSecrets( id, pc1, pc2, ss, rk ) @ #a) ∧ (Receive( m ) @ #a)
 ∧
  (¬(NewDHSecrets( id, pc1, pc2, ss, rk ) @ #a)) ∧
  (∀ m.1 #b.
    (NewDHSecrets( id, pc1, pc2, ss, rk ) @ #b) ∧ (Receive( m.1 ) @ #b)
   ⇒
    ¬(#b < #a))"
*/
induction
  case empty_trace
  by contradiction
next
  case non_empty_trace
  solve( (last(#a))  ∥ (NewDHSecrets( id, pc1, pc2, ss, rk ) @ #a)  ∥
         (∃ m #b.
           (NewDHSecrets( id, pc1, pc2, ss, rk ) @ #b) ∧ (Receive( m ) @ #b)
          ∧
           (¬(last(#b))) ∧ (#b < #a)) )
    case case_1
    solve( DHSecrets( id, pc1, pc2, ss, rk ) @ #a )
      case OuterRatchetToReceiver
      by contradiction
    next
      case OuterRatchetToSender
      by contradiction
    next
      case Receive
      solve( Receive( m ) @ #a )
        case Receive
        solve( splitEqs(0) )
          case split_case_1
          solve( Session( ~id.1, $A, 'R', ~x.9, $B, pc.1, rk.1, ck ) ▶₁ #a )
            case OuterRatchetToReceiver_case_1
            by contradiction
          next
            case OuterRatchetToReceiver_case_2
            by contradiction
          next
            case OuterRatchetToReceiver_case_3
            by contradiction
          next
            case Receive
            by contradiction
          next
            case ReceiverStart
            by contradiction
          qed
        next
          case split_case_2
          solve( Session( ~id.1, $A, 'R', ~x.9, $B, z.3^inv(~x.9), rk.1, ck
                 ) ▶₁ #a )
            case OuterRatchetToReceiver_case_1
            by contradiction
          next
            case OuterRatchetToReceiver_case_2
            by contradiction
          next
            case OuterRatchetToReceiver_case_3
            by contradiction
          next
            case Receive
            by contradiction
          next
            case ReceiverStart
            by contradiction
          qed
        next
          case split_case_3
          solve( Session( ~id.1, $A, 'R', ~x.9, $B, x.10^x.11, rk.1, ck
                 ) ▶₁ #a )
            case OuterRatchetToReceiver_case_1
            by contradiction
          next
            case OuterRatchetToReceiver_case_2
            by contradiction
          next
            case OuterRatchetToReceiver_case_3
            by contradiction
          next
            case Receive
            by contradiction
          next
            case ReceiverStart
            by contradiction
          qed
        next
          case split_case_4
          solve( Session( ~id.1, $A, 'R', ~x.9, $B, x.10^inv((~x.9*x.11)),
                          rk.1, ck
                 ) ▶₁ #a )
            case OuterRatchetToReceiver_case_1
            by contradiction
          next
            case OuterRatchetToReceiver_case_2
            by contradiction
          next
            case OuterRatchetToReceiver_case_3
            by contradiction
          next
            case Receive
            by contradiction
          next
            case ReceiverStart
            by contradiction
          qed
        next
          case split_case_5
          solve( Session( ~id.1, $A, 'R', ~x.9, $B, x.10^(x.11*inv(~x.9)),
                          rk.1, ck
                 ) ▶₁ #a )
            case OuterRatchetToReceiver_case_1
            by contradiction
          next
            case OuterRatchetToReceiver_case_2
            by contradiction
          next
            case OuterRatchetToReceiver_case_3
            by contradiction
          next
            case Receive
            by contradiction
          next
            case ReceiverStart
            by contradiction
          qed
        next
          case split_case_6
          solve( Session( ~id.1, $A, 'R', ~x.9, $B,
                          x.10^(x.11*inv((~x.9*x.12))), rk.1, ck
                 ) ▶₁ #a )
            case OuterRatchetToReceiver_case_1
            by contradiction
          next
            case OuterRatchetToReceiver_case_2
            by contradiction
          next
            case OuterRatchetToReceiver_case_3
            by contradiction
          next
            case Receive
            by contradiction
          next
            case ReceiverStart
            by contradiction
          qed
        next
          case split_case_7
          solve( Session( ~id.1, $A, 'R', ~x, $B, DH_neutral, rk.1, ck
                 ) ▶₁ #a )
            case OuterRatchetToReceiver_case_1
            by contradiction
          next
            case OuterRatchetToReceiver_case_2
            by contradiction
          next
            case OuterRatchetToReceiver_case_3
            by contradiction
          next
            case Receive
            by contradiction
          next
            case ReceiverStart
            by contradiction
          qed
        qed
      qed
    next
      case ReceiverStart
      by contradiction
    next
      case Send
      by solve( Receive( m ) @ #a )
    next
      case SenderStart
      by contradiction
    qed
  next
    case case_2
    by contradiction
  next
    case case_3
    by contradiction
  qed
qed

lemma NoDHNeutral [reuse, use_induction,
                   hide_lemma=OuterLoopStepSender]:
  all-traces
  "∀ id pc1 ss rk #t.
    (DHSecrets( id, pc1, DH_neutral, ss, rk ) @ #t) ⇒ (⊥)"
/*
guarded formula characterizing all counter-examples:
"∃ id pc1 ss rk #t.
  (DHSecrets( id, pc1, DH_neutral, ss, rk ) @ #t)"
*/
induction
  case empty_trace
  by contradiction
next
  case non_empty_trace
  solve( DHSecrets( id, pc1, DH_neutral, ss, rk ) @ #t )
    case OuterRatchetToReceiver
    by contradiction
  next
    case OuterRatchetToSender
    by solve( Session( ~id.1, $A, 'R', drop, $B, DH_neutral, old_rk,
                       old_ck
              ) ▶₂ #t )
  next
    case Receive
    by solve( NewDHSecrets( ~id.1, 'g'^~x, DH_neutral, DH_neutral, rk.1
              ) @ #b )
  next
    case ReceiverStart
    by contradiction
  next
    case Send
    by solve( Session( ~id.1, $A, 'S', ~x, $B, DH_neutral, rk.1, ck
              ) ▶₁ #t )
  next
    case SenderStart
    solve( !SecretKeys( $A, ~ltk, prek ) ▶₃ #t )
      case KeyGen
      by solve( !PublicKeys( $B, ltpk, DH_neutral ) ▶₄ #t )
    qed
  qed
qed

lemma NoGenerator [reuse, use_induction,
                   hide_lemma=OuterLoopStepSender, hide_lemma=NoDHNeutral]:
  all-traces
  "∀ id pc1 ss rk #t.
    (DHSecrets( id, pc1, DH_neutral, ss, rk ) @ #t) ⇒ (⊥)"
/*
guarded formula characterizing all counter-examples:
"∃ id pc1 ss rk #t.
  (DHSecrets( id, pc1, DH_neutral, ss, rk ) @ #t)"
*/
induction
  case empty_trace
  by contradiction
next
  case non_empty_trace
  solve( DHSecrets( id, pc1, DH_neutral, ss, rk ) @ #t )
    case OuterRatchetToReceiver
    by contradiction
  next
    case OuterRatchetToSender
    by solve( Session( ~id.1, $A, 'R', drop, $B, DH_neutral, old_rk,
                       old_ck
              ) ▶₂ #t )
  next
    case Receive
    by solve( NewDHSecrets( ~id.1, 'g'^~x, DH_neutral, DH_neutral, rk.1
              ) @ #b )
  next
    case ReceiverStart
    by contradiction
  next
    case Send
    by solve( Session( ~id.1, $A, 'S', ~x, $B, DH_neutral, rk.1, ck
              ) ▶₁ #t )
  next
    case SenderStart
    solve( !SecretKeys( $A, ~ltk, prek ) ▶₃ #t )
      case KeyGen
      by solve( !PublicKeys( $B, ltpk, DH_neutral ) ▶₄ #t )
    qed
  qed
qed

lemma SSSecrecy [reuse, use_induction]:
  all-traces
  "∀ id pc1 pc2 ss rk #t.
    (DHSecrets( id, pc1, pc2, ss, rk ) @ #t) ⇒
    (¬(∃ #x. !KU( ss ) @ #x))"
/*
guarded formula characterizing all counter-examples:
"∃ id pc1 pc2 ss rk #t.
  (DHSecrets( id, pc1, pc2, ss, rk ) @ #t) ∧ ∃ #x. (!KU( ss ) @ #x)"
*/
induction
  case empty_trace
  by contradiction
next
  case non_empty_trace
  solve( (last(#t))  ∥ (∀ #x. (!KU( ss ) @ #x) ⇒ last(#x)) )
    case case_1
    by sorry
  next
    case case_2
    solve( DHSecrets( id, pc1, pc2, ss, rk ) @ #t )
      case OuterRatchetToReceiver
      solve( Session( ~id.1, $A, 'S', ~x.1, $B, old_pc, old_rk, old_ck
             ) ▶₁ #t )
        case OuterRatchetToSender
        solve( !KU( senc(z.1,
                         kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<'rk', old_rk.1, z.3>), z>)>)
                             >))
               ) @ #vk.2 )
          case OuterRatchetToSender
          solve( splitEqs(0) )
            case split_case_1
            solve( !KU( pc.2^~x.16 ) @ #x )
              case OuterRatchetToSender
              by contradiction
            next
              case c_exp
              by solve( !KU( ~x.16 ) @ #vk.4 )
            qed
          next
            case split_case_2
            by contradiction
          next
            case split_case_3
            solve( !KU( z.5^inv(~x.16) ) @ #vk.1 )
              case c_exp
              by contradiction
            qed
          next
            case split_case_4
            solve( !KU( x.17^(~x.16*x.18) ) @ #x )
              case KeyGen_case_1
              by solve( !KU( ~x.21 ) @ #vk.3 )
            next
              case KeyGen_case_2
              by solve( !KU( ~x.21 ) @ #vk.4 )
            next
              case KeyGen_case_3
              by solve( !KU( ~x.21 ) @ #vk.3 )
            next
              case KeyGen_case_4
              by solve( !KU( ~x.21 ) @ #vk.4 )
            next
              case OuterRatchetToSender_case_1
              by solve( !KU( ~x.22 ) @ #vk.3 )
            next
              case OuterRatchetToSender_case_2
              by solve( !KU( ~x.22 ) @ #vk.4 )
            next
              case OuterRatchetToSender_case_3
              solve( splitEqs(1) )
                case split_case_1
                solve( splitEqs(2) )
                  case split_case_1
                  by solve( !KU( ~x.24 ) @ #vk.3 )
                next
                  case split_case_2
                  by solve( !KU( ~x.24 ) @ #vk.4 )
                next
                  case split_case_3
                  solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                  'g'^(~x.25*inv((~x.24*x.26))), kdf(<'rk', old_rk.2, pc.3^~x.25>),
                                  old_ck.2
                         ) ▶₂ #vr.1 )
                    case Receive
                    by solve( NewDHSecrets( ~id.2, 'g'^~x.27,
                                            'g'^(~x.25*inv((~x.24*x.26))), 'g'^(~x.25*x.28),
                                            kdf(<'rk', old_rk.2, pc.3^~x.25>)
                              ) @ #b )
                  qed
                next
                  case split_case_4
                  solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                  'g'^(x.25*~x.26*inv(~x.24)), kdf(<'rk', old_rk.2, pc.3^~x.26>),
                                  old_ck.2
                         ) ▶₂ #vr.1 )
                    case Receive
                    by solve( NewDHSecrets( ~id.2, 'g'^~x.27,
                                            'g'^(x.25*~x.26*inv(~x.24)), 'g'^(x.25*x.28),
                                            kdf(<'rk', old_rk.2, pc.3^~x.26>)
                              ) @ #b )
                  qed
                next
                  case split_case_5
                  solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                  'g'^(~x.25*x.26*inv((~x.24*x.27))),
                                  kdf(<'rk', old_rk.2, pc.3^~x.25>), old_ck.2
                         ) ▶₂ #vr.1 )
                    case Receive
                    by solve( NewDHSecrets( ~id.2, 'g'^~x.28,
                                            'g'^(~x.25*x.26*inv((~x.24*x.27))),
                                            'g'^(x.29*x.30*x.31), kdf(<'rk', old_rk.2, pc.3^~x.25>)
                              ) @ #b )
                  qed
                qed
              next
                case split_case_2
                by contradiction
              next
                case split_case_3
                solve( splitEqs(2) )
                  case split_case_1
                  by solve( !KU( ~x.26 ) @ #vk.3 )
                next
                  case split_case_2
                  by solve( !KU( ~x.26 ) @ #vk.4 )
                next
                  case split_case_3
                  solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                  'g'^(~x.27*inv((~x.26*x.28))),
                                  kdf(<'rk', old_rk.2, x.24^(x.25*~x.27)>), old_ck.2
                         ) ▶₂ #vr.1 )
                    case OuterRatchetToReceiver_case_1
                    solve( !KU( 'g'^(~x.27*inv((~x.26*x.28))) ) @ #vk.6 )
                      case OuterRatchetToSender
                      by solve( !KU( ~x.32 ) @ #vk.10 )
                    next
                      case c_exp
                      by solve( !KU( ~x.27 ) @ #vk.10 )
                    qed
                  next
                    case OuterRatchetToReceiver_case_2
                    solve( !KU( 'g'^(~x.27*inv((~x.26*x.28))) ) @ #vk.6 )
                      case OuterRatchetToSender
                      by solve( !KU( ~x.32 ) @ #vk.10 )
                    next
                      case c_exp
                      by solve( !KU( ~x.27 ) @ #vk.10 )
                    qed
                  next
                    case OuterRatchetToReceiver_case_3
                    solve( !KU( 'g'^(~x.27*inv((~x.26*x.28))) ) @ #vk.6 )
                      case OuterRatchetToSender
                      by solve( !KU( ~x.32 ) @ #vk.10 )
                    next
                      case c_exp
                      by solve( !KU( ~x.27 ) @ #vk.10 )
                    qed
                  next
                    case Receive
                    solve( NewDHSecrets( ~id.2, 'g'^~x.29,
                                         'g'^(~x.27*inv((~x.26*x.28))), 'g'^(~x.27*x.30),
                                         kdf(<'rk', old_rk.2, x.24^(x.25*~x.27)>)
                           ) @ #b )
                      case OuterRatchetToReceiver
                      solve( !KU( 'g'^(~x.27*inv((~x.26*x.28))) ) @ #vk.7 )
                        case OuterRatchetToSender
                        by solve( !KU( ~x.52 ) @ #vk.11 )
                      next
                        case c_exp
                        by solve( !KU( ~x.27 ) @ #vk.11 )
                      qed
                    next
                      case OuterRatchetToSender
                      by solve( Receive( m.3 ) @ #b )
                    qed
                  qed
                next
                  case split_case_4
                  solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                  'g'^(x.27*~x.28*inv(~x.26)),
                                  kdf(<'rk', old_rk.2, x.24^(x.25*~x.28)>), old_ck.2
                         ) ▶₂ #vr.1 )
                    case OuterRatchetToReceiver_case_1
                    solve( !KU( 'g'^(x.27*~x.28*inv(~x.26)) ) @ #vk.5 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.31 ) @ #vk.8 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.31 ) @ #vk.8 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.31 ) @ #vk.8 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.31 ) @ #vk.8 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.33 ) @ #vk.10 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.32 ) @ #vk.8 )
                    next
                      case OuterRatchetToSender_case_3
                      by solve( !KU( ~x.32 ) @ #vk.8 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.32 ) @ #vk.8 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.32 ) @ #vk.8 )
                    next
                      case c_exp
                      by solve( !KU( ~x.28 ) @ #vk.10 )
                    qed
                  next
                    case OuterRatchetToReceiver_case_2
                    solve( !KU( 'g'^(x.27*~x.28*inv(~x.26)) ) @ #vk.5 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.31 ) @ #vk.8 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.31 ) @ #vk.8 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.31 ) @ #vk.8 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.31 ) @ #vk.8 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.33 ) @ #vk.10 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.32 ) @ #vk.8 )
                    next
                      case OuterRatchetToSender_case_3
                      by solve( !KU( ~x.32 ) @ #vk.8 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.32 ) @ #vk.8 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.32 ) @ #vk.8 )
                    next
                      case c_exp
                      by solve( !KU( ~x.28 ) @ #vk.10 )
                    qed
                  next
                    case OuterRatchetToReceiver_case_3
                    solve( !KU( 'g'^(x.27*~x.28*inv(~x.26)) ) @ #vk.5 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.31 ) @ #vk.8 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.31 ) @ #vk.8 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.31 ) @ #vk.8 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.31 ) @ #vk.8 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.33 ) @ #vk.10 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.32 ) @ #vk.8 )
                    next
                      case OuterRatchetToSender_case_3
                      by solve( !KU( ~x.32 ) @ #vk.8 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.32 ) @ #vk.8 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.32 ) @ #vk.8 )
                    next
                      case c_exp
                      by solve( !KU( ~x.28 ) @ #vk.10 )
                    qed
                  next
                    case Receive
                    solve( NewDHSecrets( ~id.2, 'g'^~x.29, 'g'^(x.27*~x.28*inv(~x.26)),
                                         'g'^(x.27*x.30), kdf(<'rk', old_rk.2, x.24^(x.25*~x.28)>)
                           ) @ #b )
                      case OuterRatchetToReceiver_case_1
                      by contradiction
                    next
                      case OuterRatchetToReceiver_case_2
                      by solve( !KU( ~x.33 ) @ #vk.3 )
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( 'g'^(x.41*~x.42*inv(~x.43)) ) @ #vk.6 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.44 ) @ #vk.9 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.44 ) @ #vk.9 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.44 ) @ #vk.9 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.44 ) @ #vk.9 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.49 ) @ #vk.14 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.45 ) @ #vk.9 )
                      next
                        case OuterRatchetToSender_case_3
                        by solve( !KU( ~x.45 ) @ #vk.9 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.45 ) @ #vk.9 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.45 ) @ #vk.9 )
                      next
                        case c_exp
                        by solve( !KU( ~x.42 ) @ #vk.11 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_4
                      by solve( !KU( ~x.32 ) @ #vk.8 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.33 ) @ #vk.3 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( Receive( m.3 ) @ #b )
                    next
                      case OuterRatchetToSender_case_3
                      by solve( !KU( ~x.32 ) @ #vk.5 )
                    qed
                  qed
                next
                  case split_case_5
                  solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                  'g'^(~x.27*x.28*inv((~x.26*x.29))),
                                  kdf(<'rk', old_rk.2, x.24^(x.25*~x.27)>), old_ck.2
                         ) ▶₂ #vr.1 )
                    case OuterRatchetToReceiver_case_1
                    solve( !KU( 'g'^(~x.27*x.28*inv((~x.26*x.29))) ) @ #vk.8 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.33 ) @ #vk.11 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.33 ) @ #vk.11 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.33 ) @ #vk.11 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.33 ) @ #vk.11 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.34 ) @ #vk.11 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.35 ) @ #vk.25 )
                    next
                      case OuterRatchetToSender_case_3
                      by solve( !KU( ~x.34 ) @ #vk.11 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.34 ) @ #vk.11 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.34 ) @ #vk.11 )
                    next
                      case c_exp
                      by solve( !KU( ~x.27 ) @ #vk.12 )
                    qed
                  next
                    case OuterRatchetToReceiver_case_2
                    solve( !KU( 'g'^(~x.27*x.28*inv((~x.26*x.29))) ) @ #vk.8 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.33 ) @ #vk.11 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.33 ) @ #vk.11 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.33 ) @ #vk.11 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.33 ) @ #vk.11 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.34 ) @ #vk.11 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.35 ) @ #vk.25 )
                    next
                      case OuterRatchetToSender_case_3
                      by solve( !KU( ~x.34 ) @ #vk.11 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.34 ) @ #vk.11 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.34 ) @ #vk.11 )
                    next
                      case c_exp
                      by solve( !KU( ~x.27 ) @ #vk.12 )
                    qed
                  next
                    case OuterRatchetToReceiver_case_3
                    solve( !KU( 'g'^(~x.27*x.28*inv((~x.26*x.29))) ) @ #vk.8 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.33 ) @ #vk.11 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.33 ) @ #vk.11 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.33 ) @ #vk.11 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.33 ) @ #vk.11 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.34 ) @ #vk.11 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.35 ) @ #vk.25 )
                    next
                      case OuterRatchetToSender_case_3
                      by solve( !KU( ~x.34 ) @ #vk.11 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.34 ) @ #vk.11 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.34 ) @ #vk.11 )
                    next
                      case c_exp
                      by solve( !KU( ~x.27 ) @ #vk.12 )
                    qed
                  next
                    case Receive
                    solve( NewDHSecrets( ~id.2, 'g'^~x.30,
                                         'g'^(~x.27*x.28*inv((~x.26*x.29))), 'g'^(x.31*x.32*x.33),
                                         kdf(<'rk', old_rk.2, x.24^(x.25*~x.27)>)
                           ) @ #b )
                      case OuterRatchetToReceiver_case_1
                      solve( !KU( 'g'^(x.28*~x.35*inv((~x.26*x.29))) ) @ #vk.9 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.58 ) @ #vk.12 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.57 ) @ #vk.24 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.58 ) @ #vk.12 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.57 ) @ #vk.24 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.60 ) @ #vk.26 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.59 ) @ #vk.12 )
                      next
                        case OuterRatchetToSender_case_3
                        by solve( !KU( ~x.57 ) @ #vk.24 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.59 ) @ #vk.12 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.57 ) @ #vk.24 )
                      next
                        case c_exp
                        by solve( !KU( ~x.35 ) @ #vk.14 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_2
                      solve( !KU( 'g'^(x.28*~x.35*inv((~x.26*x.29))) ) @ #vk.9 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.57 ) @ #vk.12 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.57 ) @ #vk.24 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.57 ) @ #vk.12 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.57 ) @ #vk.24 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.59 ) @ #vk.26 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.58 ) @ #vk.12 )
                      next
                        case OuterRatchetToSender_case_3
                        by solve( !KU( ~x.58 ) @ #vk.24 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.58 ) @ #vk.12 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.58 ) @ #vk.24 )
                      next
                        case c_exp
                        by solve( !KU( ~x.35 ) @ #vk.14 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( 'g'^(x.28*~x.43*inv((~x.41*x.42))) ) @ #vk.9 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.66 ) @ #vk.15 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.66 ) @ #vk.15 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.66 ) @ #vk.15 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.66 ) @ #vk.15 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.72 ) @ #vk.31 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.67 ) @ #vk.15 )
                      next
                        case OuterRatchetToSender_case_3
                        by solve( !KU( ~x.67 ) @ #vk.15 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.67 ) @ #vk.15 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.67 ) @ #vk.15 )
                      next
                        case c_exp
                        by solve( !KU( ~x.43 ) @ #vk.17 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_4
                      by solve( !KU( ~x.45 ) @ #vk.15 )
                    next
                      case OuterRatchetToReceiver_case_5
                      by solve( !KU( ~x.35 ) @ #vk.15 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( Receive( m.3 ) @ #b )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( Receive( m.3 ) @ #b )
                    next
                      case OuterRatchetToSender_case_3
                      by contradiction
                    next
                      case OuterRatchetToSender_case_4
                      by solve( !KU( ~x.45 ) @ #vk.12 )
                    next
                      case OuterRatchetToSender_case_5
                      by solve( !KU( ~x.35 ) @ #vk.12 )
                    qed
                  qed
                qed
              next
                case split_case_4
                solve( Session( ~id.3, $A.2, 'R', drop.2, $B.2, z.5^inv(~x.23),
                                old_rk.2, old_ck.3
                       ) ▶₂ #vr.3 )
                  case OuterRatchetToReceiver_case_1
                  solve( !KU( z.5^inv(~x.23) ) @ #vk.5 )
                    case c_exp
                    by contradiction
                  qed
                next
                  case OuterRatchetToReceiver_case_2
                  solve( !KU( z.5^inv(~x.23) ) @ #vk.5 )
                    case c_exp
                    by contradiction
                  qed
                next
                  case OuterRatchetToReceiver_case_3
                  solve( !KU( z.5^inv(~x.23) ) @ #vk.5 )
                    case c_exp
                    by contradiction
                  qed
                next
                  case Receive
                  solve( NewDHSecrets( ~id.3, 'g'^~x.24, z.5^inv(~x.23), z.7,
                                       old_rk.2
                         ) @ #b )
                    case OuterRatchetToReceiver
                    solve( !KU( z.5^inv(~x.23) ) @ #vk.6 )
                      case c_exp
                      by contradiction
                    qed
                  next
                    case OuterRatchetToSender
                    by solve( Receive( m.3 ) @ #b )
                  next
                    case ReceiverStart
                    solve( !KU( z.5^inv(~x.23) ) @ #vk.6 )
                      case c_exp
                      by contradiction
                    qed
                  next
                    case SenderStart
                    by solve( !PublicKeys( $B.3, ltpk, z.5^inv(~x.23) ) ▶₄ #b )
                  qed
                next
                  case ReceiverStart
                  solve( !KU( z.5^inv(~x.23) ) @ #vk.5 )
                    case c_exp
                    by contradiction
                  qed
                qed
              next
                case split_case_5
                solve( Session( ~id.3, $A.2, 'R', drop.2, $B.2,
                                x.24^inv((~x.23*x.25)), old_rk.2, old_ck.3
                       ) ▶₂ #vr.3 )
                  case OuterRatchetToReceiver_case_1
                  solve( !KU( x.24^inv((~x.23*x.25)) ) @ #vk.5 )
                    case c_exp
                    by solve( !KU( ~x.23 ) @ #vk.10 )
                  qed
                next
                  case OuterRatchetToReceiver_case_2
                  solve( !KU( x.24^inv((~x.23*x.25)) ) @ #vk.5 )
                    case c_exp
                    by solve( !KU( ~x.23 ) @ #vk.10 )
                  qed
                next
                  case OuterRatchetToReceiver_case_3
                  solve( !KU( x.24^inv((~x.23*x.25)) ) @ #vk.5 )
                    case c_exp
                    by solve( !KU( ~x.23 ) @ #vk.10 )
                  qed
                next
                  case Receive
                  solve( NewDHSecrets( ~id.3, 'g'^~x.26, x.24^inv((~x.23*x.25)),
                                       x.24^x.27, old_rk.2
                         ) @ #b )
                    case OuterRatchetToReceiver
                    solve( !KU( x.24^inv((~x.23*x.25)) ) @ #vk.6 )
                      case c_exp
                      by solve( !KU( ~x.23 ) @ #vk.11 )
                    qed
                  next
                    case OuterRatchetToSender
                    by solve( Receive( m.3 ) @ #b )
                  next
                    case ReceiverStart
                    solve( !KU( x.24^inv((~x.23*x.25)) ) @ #vk.6 )
                      case c_exp
                      by solve( !KU( ~x.23 ) @ #vk.11 )
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.3, ~ltk, prek ) ▶₃ #b )
                      case KeyGen
                      by solve( !PublicKeys( $B.3, ltpk, x.24^inv((~x.23*x.25)) ) ▶₄ #b )
                    qed
                  qed
                next
                  case ReceiverStart
                  solve( !KU( x.24^inv((~x.23*x.25)) ) @ #vk.5 )
                    case c_exp
                    by solve( !KU( ~x.23 ) @ #vk.10 )
                  qed
                qed
              next
                case split_case_6
                solve( Session( ~id.3, $A.2, 'R', drop.2, $B.2,
                                x.24^(x.25*inv(~x.23)), old_rk.2, old_ck.3
                       ) ▶₂ #vr.3 )
                  case OuterRatchetToReceiver_case_1
                  solve( !KU( x.24^(x.25*inv(~x.23)) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.29 ) @ #vk.8 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.30 ) @ #vk.10 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.29 ) @ #vk.8 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.30 ) @ #vk.10 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.30 ) @ #vk.8 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.31 ) @ #vk.10 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.30 ) @ #vk.8 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.31 ) @ #vk.10 )
                  next
                    case c_exp
                    by solve( !KU( ~x.23 ) @ #vk.11 )
                  qed
                next
                  case OuterRatchetToReceiver_case_2
                  solve( !KU( x.24^(x.25*inv(~x.23)) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.29 ) @ #vk.8 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.30 ) @ #vk.10 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.29 ) @ #vk.8 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.30 ) @ #vk.10 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.30 ) @ #vk.8 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.31 ) @ #vk.10 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.30 ) @ #vk.8 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.31 ) @ #vk.10 )
                  next
                    case c_exp
                    by solve( !KU( ~x.23 ) @ #vk.11 )
                  qed
                next
                  case OuterRatchetToReceiver_case_3
                  solve( !KU( x.24^(x.25*inv(~x.23)) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.29 ) @ #vk.8 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.30 ) @ #vk.10 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.29 ) @ #vk.8 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.30 ) @ #vk.10 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.30 ) @ #vk.8 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.31 ) @ #vk.10 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.30 ) @ #vk.8 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.31 ) @ #vk.10 )
                  next
                    case c_exp
                    by solve( !KU( ~x.23 ) @ #vk.11 )
                  qed
                next
                  case Receive
                  solve( NewDHSecrets( ~id.3, 'g'^~x.26, x.24^(x.25*inv(~x.23)),
                                       x.24^x.27, old_rk.2
                         ) @ #b )
                    case OuterRatchetToReceiver
                    solve( !KU( x.24^(x.25*inv(~x.23)) ) @ #vk.6 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.44 ) @ #vk.9 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.45 ) @ #vk.11 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.44 ) @ #vk.9 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.45 ) @ #vk.11 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.45 ) @ #vk.9 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.46 ) @ #vk.11 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.45 ) @ #vk.9 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.46 ) @ #vk.11 )
                    next
                      case c_exp
                      by solve( !KU( ~x.23 ) @ #vk.12 )
                    qed
                  next
                    case OuterRatchetToSender
                    by solve( Receive( m.3 ) @ #b )
                  next
                    case ReceiverStart
                    solve( !KU( x.24^(x.25*inv(~x.23)) ) @ #vk.6 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.50 ) @ #vk.9 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.51 ) @ #vk.11 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.50 ) @ #vk.9 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.51 ) @ #vk.11 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.51 ) @ #vk.9 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.52 ) @ #vk.11 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.51 ) @ #vk.9 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.52 ) @ #vk.11 )
                    next
                      case c_exp
                      by solve( !KU( ~x.23 ) @ #vk.12 )
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.3, ~ltk, prek ) ▶₃ #b )
                      case KeyGen
                      by solve( !PublicKeys( $B.3, ltpk, x.24^(x.25*inv(~x.23)) ) ▶₄ #b )
                    qed
                  qed
                next
                  case ReceiverStart
                  solve( !KU( x.24^(x.25*inv(~x.23)) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.29 ) @ #vk.8 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.30 ) @ #vk.10 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.29 ) @ #vk.8 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.30 ) @ #vk.10 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.30 ) @ #vk.8 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.31 ) @ #vk.10 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.30 ) @ #vk.8 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.31 ) @ #vk.10 )
                  next
                    case c_exp
                    by solve( !KU( ~x.23 ) @ #vk.11 )
                  qed
                qed
              next
                case split_case_7
                solve( Session( ~id.3, $A.2, 'R', drop.2, $B.2,
                                x.24^(x.25*inv((~x.23*x.26))), old_rk.2, old_ck.3
                       ) ▶₂ #vr.3 )
                  case OuterRatchetToReceiver_case_1
                  solve( !KU( x.24^(x.25*inv((~x.23*x.26))) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.30 ) @ #vk.9 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.31 ) @ #vk.11 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.30 ) @ #vk.9 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.31 ) @ #vk.11 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.31 ) @ #vk.9 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.32 ) @ #vk.11 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.31 ) @ #vk.9 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.32 ) @ #vk.11 )
                  next
                    case c_exp
                    by solve( !KU( ~x.23 ) @ #vk.12 )
                  qed
                next
                  case OuterRatchetToReceiver_case_2
                  solve( !KU( x.24^(x.25*inv((~x.23*x.26))) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.30 ) @ #vk.9 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.31 ) @ #vk.11 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.30 ) @ #vk.9 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.31 ) @ #vk.11 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.31 ) @ #vk.9 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.32 ) @ #vk.11 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.31 ) @ #vk.9 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.32 ) @ #vk.11 )
                  next
                    case c_exp
                    by solve( !KU( ~x.23 ) @ #vk.12 )
                  qed
                next
                  case OuterRatchetToReceiver_case_3
                  solve( !KU( x.24^(x.25*inv((~x.23*x.26))) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.30 ) @ #vk.9 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.31 ) @ #vk.11 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.30 ) @ #vk.9 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.31 ) @ #vk.11 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.31 ) @ #vk.9 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.32 ) @ #vk.11 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.31 ) @ #vk.9 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.32 ) @ #vk.11 )
                  next
                    case c_exp
                    by solve( !KU( ~x.23 ) @ #vk.12 )
                  qed
                next
                  case Receive
                  solve( NewDHSecrets( ~id.3, 'g'^~x.27,
                                       x.24^(x.25*inv((~x.23*x.26))), x.24^(x.25*x.28), old_rk.2
                         ) @ #b )
                    case OuterRatchetToReceiver
                    solve( !KU( x.24^(x.25*inv((~x.23*x.26))) ) @ #vk.6 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.47 ) @ #vk.10 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.48 ) @ #vk.12 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.47 ) @ #vk.10 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.48 ) @ #vk.12 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.48 ) @ #vk.10 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.49 ) @ #vk.12 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.48 ) @ #vk.10 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.49 ) @ #vk.12 )
                    next
                      case c_exp
                      by solve( !KU( ~x.23 ) @ #vk.13 )
                    qed
                  next
                    case OuterRatchetToSender
                    by solve( Receive( m.3 ) @ #b )
                  next
                    case ReceiverStart
                    solve( !KU( x.24^(x.25*inv((~x.23*x.26))) ) @ #vk.6 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.57 ) @ #vk.10 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.58 ) @ #vk.12 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.57 ) @ #vk.10 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.58 ) @ #vk.12 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.58 ) @ #vk.10 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.59 ) @ #vk.12 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.58 ) @ #vk.10 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.59 ) @ #vk.12 )
                    next
                      case c_exp
                      by solve( !KU( ~x.23 ) @ #vk.13 )
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.3, ~ltk, prek ) ▶₃ #b )
                      case KeyGen
                      by solve( !PublicKeys( $B.3, ltpk, x.24^(x.25*inv((~x.23*x.26)))
                                ) ▶₄ #b )
                    qed
                  qed
                next
                  case ReceiverStart
                  solve( !KU( x.24^(x.25*inv((~x.23*x.26))) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.30 ) @ #vk.9 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.31 ) @ #vk.11 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.30 ) @ #vk.9 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.31 ) @ #vk.11 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.31 ) @ #vk.9 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.32 ) @ #vk.11 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.31 ) @ #vk.9 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.32 ) @ #vk.11 )
                  next
                    case c_exp
                    by solve( !KU( ~x.23 ) @ #vk.12 )
                  qed
                qed
              qed
            next
              case SenderStart_case_1
              by solve( !KU( ~x.22 ) @ #vk.3 )
            next
              case SenderStart_case_2
              by solve( !KU( ~x.22 ) @ #vk.4 )
            next
              case c_exp
              by solve( !KU( ~x.16 ) @ #vk.5 )
            qed
          next
            case split_case_5
            solve( !KU( x.22^inv((~x.16*x.23)) ) @ #vk.1 )
              case c_exp
              by solve( !KU( ~x.16 ) @ #vk.6 )
            qed
          next
            case split_case_6
            solve( !KU( x.17^(x.18*inv(~x.16)) ) @ #vk.1 )
              case KeyGen_case_1
              by solve( !KU( ~x.19 ) @ #vk.4 )
            next
              case KeyGen_case_2
              by solve( !KU( ~x.20 ) @ #vk.6 )
            next
              case KeyGen_case_3
              by solve( !KU( ~x.19 ) @ #vk.4 )
            next
              case KeyGen_case_4
              by solve( !KU( ~x.20 ) @ #vk.6 )
            next
              case OuterRatchetToSender_case_1
              by solve( !KU( ~x.20 ) @ #vk.4 )
            next
              case OuterRatchetToSender_case_2
              by solve( !KU( ~x.21 ) @ #vk.6 )
            next
              case SenderStart_case_1
              by solve( !KU( ~x.20 ) @ #vk.4 )
            next
              case SenderStart_case_2
              by solve( !KU( ~x.21 ) @ #vk.6 )
            next
              case c_exp
              by solve( !KU( ~x.16 ) @ #vk.7 )
            qed
          next
            case split_case_7
            solve( !KU( x.17^(x.18*inv((~x.16*x.19))) ) @ #vk.1 )
              case KeyGen_case_1
              by solve( !KU( ~x.22 ) @ #vk.5 )
            next
              case KeyGen_case_2
              by solve( !KU( ~x.23 ) @ #vk.7 )
            next
              case KeyGen_case_3
              by solve( !KU( ~x.22 ) @ #vk.5 )
            next
              case KeyGen_case_4
              by solve( !KU( ~x.23 ) @ #vk.7 )
            next
              case OuterRatchetToSender_case_1
              by solve( !KU( ~x.23 ) @ #vk.5 )
            next
              case OuterRatchetToSender_case_2
              by solve( !KU( ~x.24 ) @ #vk.7 )
            next
              case SenderStart_case_1
              by solve( !KU( ~x.23 ) @ #vk.5 )
            next
              case SenderStart_case_2
              by solve( !KU( ~x.24 ) @ #vk.7 )
            next
              case c_exp
              by solve( !KU( ~x.16 ) @ #vk.8 )
            qed
          qed
        next
          case Send
          solve( NewDHSecrets( ~id.2, 'g'^~x.15, pc.1, z.4, rk.1 ) @ #b )
            case OuterRatchetToReceiver
            by solve( Send( m.2 ) @ #b )
          next
            case OuterRatchetToSender
            solve( Send( m.2 ) @ #b )
              case OuterRatchetToSender
              solve( splitEqs(0) )
                case split_case_1
                solve( !KU( pc.3^~x.17 ) @ #x )
                  case OuterRatchetToSender
                  by contradiction
                next
                  case c_exp
                  by solve( !KU( ~x.17 ) @ #vk.4 )
                qed
              next
                case split_case_2
                by contradiction
              next
                case split_case_3
                solve( !KU( z.6^inv(~x.17) ) @ #vk.1 )
                  case c_exp
                  by contradiction
                qed
              next
                case split_case_4
                solve( !KU( x.18^(~x.17*x.19) ) @ #x )
                  case KeyGen_case_1
                  by solve( !KU( ~x.20 ) @ #vk.3 )
                next
                  case KeyGen_case_2
                  by solve( !KU( ~x.20 ) @ #vk.4 )
                next
                  case KeyGen_case_3
                  by solve( !KU( ~x.20 ) @ #vk.3 )
                next
                  case KeyGen_case_4
                  by solve( !KU( ~x.20 ) @ #vk.4 )
                next
                  case OuterRatchetToSender_case_1
                  by solve( !KU( ~x.21 ) @ #vk.3 )
                next
                  case OuterRatchetToSender_case_2
                  by solve( !KU( ~x.21 ) @ #vk.4 )
                next
                  case OuterRatchetToSender_case_3
                  by solve( Session( ~id.3, $A.1, 'S', ~x.16, $B.1, pc.2,
                                     kdf(<'rk', old_rk.2, z.5>),
                                     kdf(<'rk', kdf(<'rk', old_rk.3, z.6>), 'g'^(~x.20*x.21)>)
                            ) ▶₁ #vr.1 )
                next
                  case SenderStart_case_1
                  by solve( Session( ~id.3, $A.1, 'S', ~x.16, $B.1, pc.2,
                                     kdf(<'rk', old_rk.2, z.5>),
                                     kdf(<'rk', kdf(<'rk', old_rk.1, z.3>), 'g'^(~x.20*~x.21)>)
                            ) ▶₁ #vr.1 )
                next
                  case SenderStart_case_2
                  by solve( Session( ~id.3, $A.1, 'S', ~x.16, $B.1, pc.2,
                                     kdf(<'rk', old_rk.2, z.5>),
                                     kdf(<'rk', kdf(<'rk', old_rk.1, z.3>), 'g'^(~x.20*~x.21*x.22)>)
                            ) ▶₁ #vr.1 )
                next
                  case c_exp
                  by solve( Session( ~id.3, $A.1, 'S', ~x.16, $B.1, pc.2,
                                     kdf(<'rk', old_rk.2, z.5>),
                                     kdf(<'rk', kdf(<'rk', old_rk.1, z.3>), x.18^(~x.17*x.19)>)
                            ) ▶₁ #vr.1 )
                qed
              next
                case split_case_5
                by solve( Session( ~id.3, $A.1, 'S', ~x.16, $B.1, pc.2,
                                   kdf(<'rk', old_rk.2, z.5>),
                                   kdf(<'rk', kdf(<'rk', old_rk.1, z.3>), x.18^inv(x.19)>)
                          ) ▶₁ #vr.1 )
              next
                case split_case_6
                by solve( Session( ~id.3, $A.1, 'S', ~x.16, $B.1, pc.2,
                                   kdf(<'rk', old_rk.2, z.5>),
                                   kdf(<'rk', kdf(<'rk', old_rk.1, z.3>), x.18^x.19>)
                          ) ▶₁ #vr.1 )
              next
                case split_case_7
                by solve( Session( ~id.3, $A.1, 'S', ~x.16, $B.1, pc.2,
                                   kdf(<'rk', old_rk.2, z.5>),
                                   kdf(<'rk', kdf(<'rk', old_rk.1, z.3>), x.18^(x.19*inv(x.20))>)
                          ) ▶₁ #vr.1 )
              qed
            qed
          next
            case ReceiverStart
            by solve( Session( ~id.3, $A.1, 'S', ~prek, $B.1, pc.2,
                               kdf(<'rk', kdf(<z.5, z.6, z.7>)>),
                               kdf(<'rk', kdf(<'rk', old_rk.1, z.3>), z>)
                      ) ▶₁ #vr.1 )
          next
            case SenderStart
            by solve( Session( ~id.3, $A.1, 'S', ~x.16, $B.1, prepk,
                               kdf(<'rk', kdf(<z.5, z.6, z.7>)>),
                               kdf(<'rk', kdf(<'rk', old_rk.1, z.3>), z>)
                      ) ▶₁ #vr.1 )
          qed
        next
          case c_senc
          solve( !KU( kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<'rk', old_rk.1, z.3>), z>)>)>)
                 ) @ #vk.4 )
            case c_kdf
            solve( !KU( kdf(<'ck', kdf(<'rk', kdf(<'rk', old_rk.1, z.3>), z>)>)
                   ) @ #vk.7 )
              case c_kdf
              solve( !KU( kdf(<'rk', kdf(<'rk', old_rk.1, z.3>), z>) ) @ #vk.10 )
                case c_kdf
                by contradiction
              qed
            qed
          qed
        qed
      next
        case Send
        solve( NewDHSecrets( ~id.1, 'g'^~x.1, old_pc, z.3, old_rk ) @ #b )
          case OuterRatchetToReceiver
          by solve( Send( m.1 ) @ #b )
        next
          case OuterRatchetToSender
          solve( Send( m.1 ) @ #b )
            case OuterRatchetToSender
            solve( !KU( senc(z.1,
                             kdf(<'mk', kdf(<'ck', kdf(<'rk', kdf(<'rk', old_rk.1, z.4>), z>)>)
                                 >))
                   ) @ #vk.2 )
              case OuterRatchetToSender
              solve( splitEqs(0) )
                case split_case_1
                solve( !KU( pc.3^~x.17 ) @ #x )
                  case OuterRatchetToSender
                  by contradiction
                next
                  case c_exp
                  by solve( !KU( ~x.17 ) @ #vk.4 )
                qed
              next
                case split_case_2
                by contradiction
              next
                case split_case_3
                solve( !KU( z.6^inv(~x.17) ) @ #vk.1 )
                  case c_exp
                  by contradiction
                qed
              next
                case split_case_4
                solve( !KU( x.18^(~x.17*x.19) ) @ #x )
                  case KeyGen_case_1
                  by solve( !KU( ~x.22 ) @ #vk.3 )
                next
                  case KeyGen_case_2
                  by solve( !KU( ~x.22 ) @ #vk.4 )
                next
                  case KeyGen_case_3
                  by solve( !KU( ~x.22 ) @ #vk.3 )
                next
                  case KeyGen_case_4
                  by solve( !KU( ~x.22 ) @ #vk.4 )
                next
                  case OuterRatchetToSender_case_1
                  by solve( !KU( ~x.23 ) @ #vk.3 )
                next
                  case OuterRatchetToSender_case_2
                  by solve( !KU( ~x.23 ) @ #vk.4 )
                next
                  case OuterRatchetToSender_case_3
                  solve( splitEqs(1) )
                    case split_case_1
                    solve( splitEqs(3) )
                      case split_case_1
                      by solve( !KU( ~x.25 ) @ #vk.3 )
                    next
                      case split_case_2
                      by solve( !KU( ~x.25 ) @ #vk.4 )
                    next
                      case split_case_3
                      solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                      'g'^(~x.26*inv((~x.25*x.27))),
                                      kdf(<'rk', old_rk.2, pc.4^~x.26>), old_ck.2
                             ) ▶₂ #vr.1 )
                        case Receive
                        by solve( NewDHSecrets( ~id.3, 'g'^~x.28,
                                                'g'^(~x.26*inv((~x.25*x.27))), 'g'^(~x.26*x.29),
                                                kdf(<'rk', old_rk.2, pc.4^~x.26>)
                                  ) @ #b.1 )
                      qed
                    next
                      case split_case_4
                      solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                      'g'^(x.26*~x.27*inv(~x.25)),
                                      kdf(<'rk', old_rk.2, pc.4^~x.27>), old_ck.2
                             ) ▶₂ #vr.1 )
                        case Receive
                        by solve( NewDHSecrets( ~id.3, 'g'^~x.28,
                                                'g'^(x.26*~x.27*inv(~x.25)), 'g'^(x.26*x.29),
                                                kdf(<'rk', old_rk.2, pc.4^~x.27>)
                                  ) @ #b.1 )
                      qed
                    next
                      case split_case_5
                      solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                      'g'^(~x.26*x.27*inv((~x.25*x.28))),
                                      kdf(<'rk', old_rk.2, pc.4^~x.26>), old_ck.2
                             ) ▶₂ #vr.1 )
                        case Receive
                        by solve( NewDHSecrets( ~id.3, 'g'^~x.29,
                                                'g'^(~x.26*x.27*inv((~x.25*x.28))),
                                                'g'^(x.30*x.31*x.32),
                                                kdf(<'rk', old_rk.2, pc.4^~x.26>)
                                  ) @ #b.1 )
                      qed
                    qed
                  next
                    case split_case_2
                    by contradiction
                  next
                    case split_case_3
                    solve( splitEqs(3) )
                      case split_case_1
                      by solve( !KU( ~x.27 ) @ #vk.3 )
                    next
                      case split_case_2
                      by solve( !KU( ~x.27 ) @ #vk.4 )
                    next
                      case split_case_3
                      solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                      'g'^(~x.28*inv((~x.27*x.29))),
                                      kdf(<'rk', old_rk.2, x.25^(x.26*~x.28)>), old_ck.2
                             ) ▶₂ #vr.1 )
                        case OuterRatchetToReceiver_case_1
                        solve( !KU( 'g'^(~x.28*inv((~x.27*x.29))) ) @ #vk.6 )
                          case OuterRatchetToSender
                          by solve( !KU( ~x.33 ) @ #vk.10 )
                        next
                          case c_exp
                          by solve( !KU( ~x.28 ) @ #vk.10 )
                        qed
                      next
                        case OuterRatchetToReceiver_case_2
                        solve( !KU( 'g'^(~x.28*inv((~x.27*x.29))) ) @ #vk.6 )
                          case OuterRatchetToSender
                          by solve( !KU( ~x.33 ) @ #vk.10 )
                        next
                          case c_exp
                          by solve( !KU( ~x.28 ) @ #vk.10 )
                        qed
                      next
                        case OuterRatchetToReceiver_case_3
                        solve( !KU( 'g'^(~x.28*inv((~x.27*x.29))) ) @ #vk.6 )
                          case OuterRatchetToSender
                          by solve( !KU( ~x.33 ) @ #vk.10 )
                        next
                          case c_exp
                          by solve( !KU( ~x.28 ) @ #vk.10 )
                        qed
                      next
                        case Receive
                        solve( NewDHSecrets( ~id.3, 'g'^~x.30,
                                             'g'^(~x.28*inv((~x.27*x.29))), 'g'^(~x.28*x.31),
                                             kdf(<'rk', old_rk.2, x.25^(x.26*~x.28)>)
                               ) @ #b.1 )
                          case OuterRatchetToReceiver
                          solve( !KU( 'g'^(~x.28*inv((~x.27*x.29))) ) @ #vk.7 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.53 ) @ #vk.11 )
                          next
                            case c_exp
                            by solve( !KU( ~x.28 ) @ #vk.11 )
                          qed
                        next
                          case OuterRatchetToSender
                          by solve( Receive( m.5 ) @ #b.1 )
                        qed
                      qed
                    next
                      case split_case_4
                      solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                      'g'^(x.28*~x.29*inv(~x.27)),
                                      kdf(<'rk', old_rk.2, x.25^(x.26*~x.29)>), old_ck.2
                             ) ▶₂ #vr.1 )
                        case OuterRatchetToReceiver_case_1
                        solve( !KU( 'g'^(x.28*~x.29*inv(~x.27)) ) @ #vk.5 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.32 ) @ #vk.8 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.32 ) @ #vk.8 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.32 ) @ #vk.8 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.32 ) @ #vk.8 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.34 ) @ #vk.10 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case OuterRatchetToSender_case_3
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case c_exp
                          by solve( !KU( ~x.29 ) @ #vk.10 )
                        qed
                      next
                        case OuterRatchetToReceiver_case_2
                        solve( !KU( 'g'^(x.28*~x.29*inv(~x.27)) ) @ #vk.5 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.32 ) @ #vk.8 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.32 ) @ #vk.8 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.32 ) @ #vk.8 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.32 ) @ #vk.8 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.34 ) @ #vk.10 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case OuterRatchetToSender_case_3
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case c_exp
                          by solve( !KU( ~x.29 ) @ #vk.10 )
                        qed
                      next
                        case OuterRatchetToReceiver_case_3
                        solve( !KU( 'g'^(x.28*~x.29*inv(~x.27)) ) @ #vk.5 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.32 ) @ #vk.8 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.32 ) @ #vk.8 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.32 ) @ #vk.8 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.32 ) @ #vk.8 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.34 ) @ #vk.10 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case OuterRatchetToSender_case_3
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case c_exp
                          by solve( !KU( ~x.29 ) @ #vk.10 )
                        qed
                      next
                        case Receive
                        solve( NewDHSecrets( ~id.3, 'g'^~x.30, 'g'^(x.28*~x.29*inv(~x.27)),
                                             'g'^(x.28*x.31),
                                             kdf(<'rk', old_rk.2, x.25^(x.26*~x.29)>)
                               ) @ #b.1 )
                          case OuterRatchetToReceiver_case_1
                          by contradiction
                        next
                          case OuterRatchetToReceiver_case_2
                          by solve( !KU( ~x.34 ) @ #vk.3 )
                        next
                          case OuterRatchetToReceiver_case_3
                          solve( !KU( 'g'^(x.42*~x.43*inv(~x.44)) ) @ #vk.6 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.45 ) @ #vk.9 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.45 ) @ #vk.9 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.45 ) @ #vk.9 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.45 ) @ #vk.9 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.50 ) @ #vk.14 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.46 ) @ #vk.9 )
                          next
                            case OuterRatchetToSender_case_3
                            by solve( !KU( ~x.46 ) @ #vk.9 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.46 ) @ #vk.9 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.46 ) @ #vk.9 )
                          next
                            case c_exp
                            by solve( !KU( ~x.43 ) @ #vk.11 )
                          qed
                        next
                          case OuterRatchetToReceiver_case_4
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.34 ) @ #vk.3 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( Receive( m.5 ) @ #b.1 )
                        next
                          case OuterRatchetToSender_case_3
                          by solve( !KU( ~x.33 ) @ #vk.5 )
                        qed
                      qed
                    next
                      case split_case_5
                      solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                      'g'^(~x.28*x.29*inv((~x.27*x.30))),
                                      kdf(<'rk', old_rk.2, x.25^(x.26*~x.28)>), old_ck.2
                             ) ▶₂ #vr.1 )
                        case OuterRatchetToReceiver_case_1
                        solve( !KU( 'g'^(~x.28*x.29*inv((~x.27*x.30))) ) @ #vk.8 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.35 ) @ #vk.11 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.36 ) @ #vk.25 )
                        next
                          case OuterRatchetToSender_case_3
                          by solve( !KU( ~x.35 ) @ #vk.11 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.35 ) @ #vk.11 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.35 ) @ #vk.11 )
                        next
                          case c_exp
                          by solve( !KU( ~x.28 ) @ #vk.12 )
                        qed
                      next
                        case OuterRatchetToReceiver_case_2
                        solve( !KU( 'g'^(~x.28*x.29*inv((~x.27*x.30))) ) @ #vk.8 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.35 ) @ #vk.11 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.36 ) @ #vk.25 )
                        next
                          case OuterRatchetToSender_case_3
                          by solve( !KU( ~x.35 ) @ #vk.11 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.35 ) @ #vk.11 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.35 ) @ #vk.11 )
                        next
                          case c_exp
                          by solve( !KU( ~x.28 ) @ #vk.12 )
                        qed
                      next
                        case OuterRatchetToReceiver_case_3
                        solve( !KU( 'g'^(~x.28*x.29*inv((~x.27*x.30))) ) @ #vk.8 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.35 ) @ #vk.11 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.36 ) @ #vk.25 )
                        next
                          case OuterRatchetToSender_case_3
                          by solve( !KU( ~x.35 ) @ #vk.11 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.35 ) @ #vk.11 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.35 ) @ #vk.11 )
                        next
                          case c_exp
                          by solve( !KU( ~x.28 ) @ #vk.12 )
                        qed
                      next
                        case Receive
                        solve( NewDHSecrets( ~id.3, 'g'^~x.31,
                                             'g'^(~x.28*x.29*inv((~x.27*x.30))),
                                             'g'^(x.32*x.33*x.34),
                                             kdf(<'rk', old_rk.2, x.25^(x.26*~x.28)>)
                               ) @ #b.1 )
                          case OuterRatchetToReceiver_case_1
                          solve( !KU( 'g'^(x.29*~x.36*inv((~x.27*x.30))) ) @ #vk.9 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.59 ) @ #vk.12 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.58 ) @ #vk.24 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.59 ) @ #vk.12 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.58 ) @ #vk.24 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.61 ) @ #vk.26 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.60 ) @ #vk.12 )
                          next
                            case OuterRatchetToSender_case_3
                            by solve( !KU( ~x.58 ) @ #vk.24 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.60 ) @ #vk.12 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.58 ) @ #vk.24 )
                          next
                            case c_exp
                            by solve( !KU( ~x.36 ) @ #vk.14 )
                          qed
                        next
                          case OuterRatchetToReceiver_case_2
                          solve( !KU( 'g'^(x.29*~x.36*inv((~x.27*x.30))) ) @ #vk.9 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.58 ) @ #vk.12 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.58 ) @ #vk.24 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.58 ) @ #vk.12 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.58 ) @ #vk.24 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.60 ) @ #vk.26 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.59 ) @ #vk.12 )
                          next
                            case OuterRatchetToSender_case_3
                            by solve( !KU( ~x.59 ) @ #vk.24 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.59 ) @ #vk.12 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.59 ) @ #vk.24 )
                          next
                            case c_exp
                            by solve( !KU( ~x.36 ) @ #vk.14 )
                          qed
                        next
                          case OuterRatchetToReceiver_case_3
                          solve( !KU( 'g'^(x.29*~x.44*inv((~x.42*x.43))) ) @ #vk.9 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.67 ) @ #vk.15 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.67 ) @ #vk.15 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.67 ) @ #vk.15 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.67 ) @ #vk.15 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.73 ) @ #vk.31 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.68 ) @ #vk.15 )
                          next
                            case OuterRatchetToSender_case_3
                            by solve( !KU( ~x.68 ) @ #vk.15 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.68 ) @ #vk.15 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.68 ) @ #vk.15 )
                          next
                            case c_exp
                            by solve( !KU( ~x.44 ) @ #vk.17 )
                          qed
                        next
                          case OuterRatchetToReceiver_case_4
                          by solve( !KU( ~x.46 ) @ #vk.15 )
                        next
                          case OuterRatchetToReceiver_case_5
                          by solve( !KU( ~x.36 ) @ #vk.15 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( Receive( m.5 ) @ #b.1 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( Receive( m.5 ) @ #b.1 )
                        next
                          case OuterRatchetToSender_case_3
                          by solve( Receive( m.5 ) @ #vr.3 )
                        next
                          case OuterRatchetToSender_case_4
                          by solve( !KU( ~x.46 ) @ #vk.12 )
                        next
                          case OuterRatchetToSender_case_5
                          by solve( !KU( ~x.36 ) @ #vk.12 )
                        qed
                      qed
                    qed
                  next
                    case split_case_4
                    solve( Session( ~id.4, $A.3, 'R', drop.2, $B.3, z.6^inv(~x.24),
                                    old_rk.2, old_ck.3
                           ) ▶₂ #vr.3 )
                      case OuterRatchetToReceiver_case_1
                      solve( !KU( z.6^inv(~x.24) ) @ #vk.5 )
                        case c_exp
                        by contradiction
                      qed
                    next
                      case OuterRatchetToReceiver_case_2
                      solve( !KU( z.6^inv(~x.24) ) @ #vk.5 )
                        case c_exp
                        by contradiction
                      qed
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( z.6^inv(~x.24) ) @ #vk.5 )
                        case c_exp
                        by contradiction
                      qed
                    next
                      case Receive
                      solve( NewDHSecrets( ~id.4, 'g'^~x.25, z.6^inv(~x.24), z.8,
                                           old_rk.2
                             ) @ #b.1 )
                        case OuterRatchetToReceiver
                        solve( !KU( z.6^inv(~x.24) ) @ #vk.6 )
                          case c_exp
                          by contradiction
                        qed
                      next
                        case OuterRatchetToSender
                        by solve( Receive( m.5 ) @ #b.1 )
                      next
                        case ReceiverStart
                        solve( !KU( z.6^inv(~x.24) ) @ #vk.6 )
                          case c_exp
                          by contradiction
                        qed
                      next
                        case SenderStart
                        by solve( Receive( m.5 ) @ #b.1 )
                      qed
                    next
                      case ReceiverStart
                      solve( !KU( z.6^inv(~x.24) ) @ #vk.5 )
                        case c_exp
                        by contradiction
                      qed
                    qed
                  next
                    case split_case_5
                    solve( Session( ~id.4, $A.3, 'R', drop.2, $B.3,
                                    x.25^inv((~x.24*x.26)), old_rk.2, old_ck.3
                           ) ▶₂ #vr.3 )
                      case OuterRatchetToReceiver_case_1
                      solve( !KU( x.25^inv((~x.24*x.26)) ) @ #vk.5 )
                        case c_exp
                        by solve( !KU( ~x.24 ) @ #vk.10 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_2
                      solve( !KU( x.25^inv((~x.24*x.26)) ) @ #vk.5 )
                        case c_exp
                        by solve( !KU( ~x.24 ) @ #vk.10 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( x.25^inv((~x.24*x.26)) ) @ #vk.5 )
                        case c_exp
                        by solve( !KU( ~x.24 ) @ #vk.10 )
                      qed
                    next
                      case Receive
                      solve( NewDHSecrets( ~id.4, 'g'^~x.27, x.25^inv((~x.24*x.26)),
                                           x.25^x.28, old_rk.2
                             ) @ #b.1 )
                        case OuterRatchetToReceiver
                        solve( !KU( x.25^inv((~x.24*x.26)) ) @ #vk.6 )
                          case c_exp
                          by solve( !KU( ~x.24 ) @ #vk.11 )
                        qed
                      next
                        case OuterRatchetToSender
                        by solve( Receive( m.5 ) @ #b.1 )
                      next
                        case ReceiverStart
                        solve( !KU( x.25^inv((~x.24*x.26)) ) @ #vk.6 )
                          case c_exp
                          by solve( !KU( ~x.24 ) @ #vk.11 )
                        qed
                      next
                        case SenderStart
                        solve( !SecretKeys( $A.4, ~ltk, prek ) ▶₃ #b.1 )
                          case KeyGen
                          by solve( !PublicKeys( $B.4, ltpk, x.25^inv((~x.24*x.26))
                                    ) ▶₄ #b.1 )
                        qed
                      qed
                    next
                      case ReceiverStart
                      solve( !KU( x.25^inv((~x.24*x.26)) ) @ #vk.5 )
                        case c_exp
                        by solve( !KU( ~x.24 ) @ #vk.10 )
                      qed
                    qed
                  next
                    case split_case_6
                    solve( Session( ~id.4, $A.3, 'S', ~x.24, $B.3,
                                    x.25^(x.26*inv(~x.24)), kdf(<'rk', old_rk.2, x.25^x.26>), ck
                           ) ▶₁ #vr )
                      case OuterRatchetToSender
                      solve( Session( ~id.4, $A.3, 'R', drop.3, $B.3,
                                      x.25^(x.26*inv(~x.24)), old_rk.2, old_ck.4
                             ) ▶₂ #vr.6 )
                        case OuterRatchetToReceiver_case_1
                        solve( !KU( x.25^(x.26*inv(~x.24)) ) @ #vk.5 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.30 ) @ #vk.8 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.31 ) @ #vk.10 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.30 ) @ #vk.8 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.31 ) @ #vk.10 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.31 ) @ #vk.8 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.32 ) @ #vk.10 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.31 ) @ #vk.8 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.32 ) @ #vk.10 )
                        next
                          case c_exp
                          by solve( !KU( ~x.24 ) @ #vk.11 )
                        qed
                      next
                        case OuterRatchetToReceiver_case_2
                        solve( !KU( x.25^(x.26*inv(~x.24)) ) @ #vk.5 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.30 ) @ #vk.8 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.31 ) @ #vk.10 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.30 ) @ #vk.8 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.31 ) @ #vk.10 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.31 ) @ #vk.8 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.32 ) @ #vk.10 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.31 ) @ #vk.8 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.32 ) @ #vk.10 )
                        next
                          case c_exp
                          by solve( !KU( ~x.24 ) @ #vk.11 )
                        qed
                      next
                        case OuterRatchetToReceiver_case_3
                        solve( !KU( x.25^(x.26*inv(~x.24)) ) @ #vk.5 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.30 ) @ #vk.8 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.31 ) @ #vk.10 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.30 ) @ #vk.8 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.31 ) @ #vk.10 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.31 ) @ #vk.8 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.32 ) @ #vk.10 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.31 ) @ #vk.8 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.32 ) @ #vk.10 )
                        next
                          case c_exp
                          by solve( !KU( ~x.24 ) @ #vk.11 )
                        qed
                      next
                        case Receive
                        solve( NewDHSecrets( ~id.4, 'g'^~x.27, x.25^(x.26*inv(~x.24)),
                                             x.25^x.28, old_rk.2
                               ) @ #b.1 )
                          case OuterRatchetToReceiver
                          solve( !KU( x.25^(x.26*inv(~x.24)) ) @ #vk.6 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.45 ) @ #vk.9 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.46 ) @ #vk.11 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.45 ) @ #vk.9 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.46 ) @ #vk.11 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.46 ) @ #vk.9 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.47 ) @ #vk.11 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.46 ) @ #vk.9 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.47 ) @ #vk.11 )
                          next
                            case c_exp
                            by solve( !KU( ~x.24 ) @ #vk.12 )
                          qed
                        next
                          case OuterRatchetToSender
                          by solve( Receive( m.6 ) @ #b.1 )
                        next
                          case ReceiverStart
                          solve( !KU( x.25^(x.26*inv(~x.24)) ) @ #vk.6 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.51 ) @ #vk.9 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.52 ) @ #vk.11 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.51 ) @ #vk.9 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.52 ) @ #vk.11 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.52 ) @ #vk.9 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.53 ) @ #vk.11 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.52 ) @ #vk.9 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.53 ) @ #vk.11 )
                          next
                            case c_exp
                            by solve( !KU( ~x.24 ) @ #vk.12 )
                          qed
                        next
                          case SenderStart
                          by solve( Receive( m.6 ) @ #b.1 )
                        qed
                      next
                        case ReceiverStart
                        solve( !KU( x.25^(x.26*inv(~x.24)) ) @ #vk.5 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.30 ) @ #vk.8 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.31 ) @ #vk.10 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.30 ) @ #vk.8 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.31 ) @ #vk.10 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.31 ) @ #vk.8 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.32 ) @ #vk.10 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.31 ) @ #vk.8 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.32 ) @ #vk.10 )
                        next
                          case c_exp
                          by solve( !KU( ~x.24 ) @ #vk.11 )
                        qed
                      qed
                    next
                      case Send
                      solve( NewDHSecrets( ~id.4, 'g'^~x.24, x.27^(x.28*inv(~x.24)),
                                           x.27^x.28, kdf(<'rk', old_rk.2, x.27^x.28>)
                             ) @ #b.1 )
                        case OuterRatchetToReceiver
                        solve( !KU( x.30^(x.31*inv(~x.29)) ) @ #vk.5 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.32 ) @ #vk.8 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.33 ) @ #vk.10 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.32 ) @ #vk.8 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.33 ) @ #vk.10 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.34 ) @ #vk.10 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.33 ) @ #vk.8 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.34 ) @ #vk.10 )
                        next
                          case c_exp
                          by solve( !KU( ~x.29 ) @ #vk.11 )
                        qed
                      next
                        case OuterRatchetToSender
                        solve( Session( ~id.5, $A.4, 'R', drop.2, $B.4,
                                        x.27^(x.28*inv(~x.29)), old_rk.3, old_ck.3
                               ) ▶₂ #vr.3 )
                          case OuterRatchetToReceiver_case_1
                          solve( !KU( x.27^(x.28*inv(~x.29)) ) @ #vk.5 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.33 ) @ #vk.8 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.34 ) @ #vk.10 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.33 ) @ #vk.8 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.34 ) @ #vk.10 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.34 ) @ #vk.8 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.35 ) @ #vk.10 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.34 ) @ #vk.8 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.35 ) @ #vk.10 )
                          next
                            case c_exp
                            by solve( !KU( ~x.29 ) @ #vk.11 )
                          qed
                        next
                          case OuterRatchetToReceiver_case_2
                          solve( !KU( x.27^(x.28*inv(~x.29)) ) @ #vk.5 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.33 ) @ #vk.8 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.34 ) @ #vk.10 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.33 ) @ #vk.8 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.34 ) @ #vk.10 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.34 ) @ #vk.8 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.35 ) @ #vk.10 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.34 ) @ #vk.8 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.35 ) @ #vk.10 )
                          next
                            case c_exp
                            by solve( !KU( ~x.29 ) @ #vk.11 )
                          qed
                        next
                          case OuterRatchetToReceiver_case_3
                          solve( !KU( x.27^(x.28*inv(~x.29)) ) @ #vk.5 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.33 ) @ #vk.8 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.34 ) @ #vk.10 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.33 ) @ #vk.8 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.34 ) @ #vk.10 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.34 ) @ #vk.8 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.35 ) @ #vk.10 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.34 ) @ #vk.8 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.35 ) @ #vk.10 )
                          next
                            case c_exp
                            by solve( !KU( ~x.29 ) @ #vk.11 )
                          qed
                        next
                          case Receive
                          solve( NewDHSecrets( ~id.5, 'g'^~x.30, x.27^(x.28*inv(~x.29)),
                                               x.27^x.31, old_rk.3
                                 ) @ #b.2 )
                            case OuterRatchetToReceiver
                            solve( !KU( x.27^(x.28*inv(~x.29)) ) @ #vk.6 )
                              case KeyGen_case_1
                              by solve( !KU( ~x.48 ) @ #vk.9 )
                            next
                              case KeyGen_case_2
                              by solve( !KU( ~x.49 ) @ #vk.11 )
                            next
                              case KeyGen_case_3
                              by solve( !KU( ~x.48 ) @ #vk.9 )
                            next
                              case KeyGen_case_4
                              by solve( !KU( ~x.49 ) @ #vk.11 )
                            next
                              case OuterRatchetToSender_case_1
                              by solve( !KU( ~x.49 ) @ #vk.9 )
                            next
                              case OuterRatchetToSender_case_2
                              by solve( !KU( ~x.50 ) @ #vk.11 )
                            next
                              case SenderStart_case_1
                              by solve( !KU( ~x.49 ) @ #vk.9 )
                            next
                              case SenderStart_case_2
                              by solve( !KU( ~x.50 ) @ #vk.11 )
                            next
                              case c_exp
                              by solve( !KU( ~x.29 ) @ #vk.12 )
                            qed
                          next
                            case OuterRatchetToSender
                            by solve( Receive( m.8 ) @ #b.2 )
                          next
                            case ReceiverStart
                            solve( !KU( x.27^(x.28*inv(~x.29)) ) @ #vk.6 )
                              case KeyGen_case_1
                              by solve( !KU( ~x.54 ) @ #vk.9 )
                            next
                              case KeyGen_case_2
                              by solve( !KU( ~x.55 ) @ #vk.11 )
                            next
                              case KeyGen_case_3
                              by solve( !KU( ~x.54 ) @ #vk.9 )
                            next
                              case KeyGen_case_4
                              by solve( !KU( ~x.55 ) @ #vk.11 )
                            next
                              case OuterRatchetToSender_case_1
                              by solve( !KU( ~x.55 ) @ #vk.9 )
                            next
                              case OuterRatchetToSender_case_2
                              by solve( !KU( ~x.56 ) @ #vk.11 )
                            next
                              case SenderStart_case_1
                              by solve( !KU( ~x.55 ) @ #vk.9 )
                            next
                              case SenderStart_case_2
                              by solve( !KU( ~x.56 ) @ #vk.11 )
                            next
                              case c_exp
                              by solve( !KU( ~x.29 ) @ #vk.12 )
                            qed
                          next
                            case SenderStart
                            by solve( Receive( m.8 ) @ #b.2 )
                          qed
                        next
                          case ReceiverStart
                          solve( !KU( x.27^(x.28*inv(~x.29)) ) @ #vk.5 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.33 ) @ #vk.8 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.34 ) @ #vk.10 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.33 ) @ #vk.8 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.34 ) @ #vk.10 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.34 ) @ #vk.8 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.35 ) @ #vk.10 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.34 ) @ #vk.8 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.35 ) @ #vk.10 )
                          next
                            case c_exp
                            by solve( !KU( ~x.29 ) @ #vk.11 )
                          qed
                        qed
                      qed
                    qed
                  next
                    case split_case_7
                    solve( Session( ~id.4, $A.3, 'R', drop.2, $B.3,
                                    x.25^(x.26*inv((~x.24*x.27))), old_rk.2, old_ck.3
                           ) ▶₂ #vr.3 )
                      case OuterRatchetToReceiver_case_1
                      solve( !KU( x.25^(x.26*inv((~x.24*x.27))) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.31 ) @ #vk.9 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.32 ) @ #vk.11 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.31 ) @ #vk.9 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.32 ) @ #vk.11 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.32 ) @ #vk.9 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.33 ) @ #vk.11 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.32 ) @ #vk.9 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.33 ) @ #vk.11 )
                      next
                        case c_exp
                        by solve( !KU( ~x.24 ) @ #vk.12 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_2
                      solve( !KU( x.25^(x.26*inv((~x.24*x.27))) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.31 ) @ #vk.9 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.32 ) @ #vk.11 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.31 ) @ #vk.9 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.32 ) @ #vk.11 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.32 ) @ #vk.9 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.33 ) @ #vk.11 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.32 ) @ #vk.9 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.33 ) @ #vk.11 )
                      next
                        case c_exp
                        by solve( !KU( ~x.24 ) @ #vk.12 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( x.25^(x.26*inv((~x.24*x.27))) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.31 ) @ #vk.9 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.32 ) @ #vk.11 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.31 ) @ #vk.9 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.32 ) @ #vk.11 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.32 ) @ #vk.9 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.33 ) @ #vk.11 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.32 ) @ #vk.9 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.33 ) @ #vk.11 )
                      next
                        case c_exp
                        by solve( !KU( ~x.24 ) @ #vk.12 )
                      qed
                    next
                      case Receive
                      solve( NewDHSecrets( ~id.4, 'g'^~x.28,
                                           x.25^(x.26*inv((~x.24*x.27))), x.25^(x.26*x.29), old_rk.2
                             ) @ #b.1 )
                        case OuterRatchetToReceiver
                        solve( !KU( x.25^(x.26*inv((~x.24*x.27))) ) @ #vk.6 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.48 ) @ #vk.10 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.49 ) @ #vk.12 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.48 ) @ #vk.10 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.49 ) @ #vk.12 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.49 ) @ #vk.10 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.50 ) @ #vk.12 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.49 ) @ #vk.10 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.50 ) @ #vk.12 )
                        next
                          case c_exp
                          by solve( !KU( ~x.24 ) @ #vk.13 )
                        qed
                      next
                        case OuterRatchetToSender
                        by solve( Receive( m.5 ) @ #b.1 )
                      next
                        case ReceiverStart
                        solve( !KU( x.25^(x.26*inv((~x.24*x.27))) ) @ #vk.6 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.58 ) @ #vk.10 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.59 ) @ #vk.12 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.58 ) @ #vk.10 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.59 ) @ #vk.12 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.59 ) @ #vk.10 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.60 ) @ #vk.12 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.59 ) @ #vk.10 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.60 ) @ #vk.12 )
                        next
                          case c_exp
                          by solve( !KU( ~x.24 ) @ #vk.13 )
                        qed
                      next
                        case SenderStart
                        solve( !SecretKeys( $A.4, ~ltk, prek ) ▶₃ #b.1 )
                          case KeyGen
                          by solve( !PublicKeys( $B.4, ltpk, x.25^(x.26*inv((~x.24*x.27)))
                                    ) ▶₄ #b.1 )
                        qed
                      qed
                    next
                      case ReceiverStart
                      solve( !KU( x.25^(x.26*inv((~x.24*x.27))) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.31 ) @ #vk.9 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.32 ) @ #vk.11 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.31 ) @ #vk.9 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.32 ) @ #vk.11 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.32 ) @ #vk.9 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.33 ) @ #vk.11 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.32 ) @ #vk.9 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.33 ) @ #vk.11 )
                      next
                        case c_exp
                        by solve( !KU( ~x.24 ) @ #vk.12 )
                      qed
                    qed
                  qed
                next
                  case SenderStart_case_1
                  by solve( !KU( ~x.23 ) @ #vk.3 )
                next
                  case SenderStart_case_2
                  by solve( !KU( ~x.23 ) @ #vk.4 )
                next
                  case c_exp
                  by solve( !KU( ~x.17 ) @ #vk.5 )
                qed
              next
                case split_case_5
                solve( !KU( x.23^inv((~x.17*x.24)) ) @ #vk.1 )
                  case c_exp
                  by solve( !KU( ~x.17 ) @ #vk.6 )
                qed
              next
                case split_case_6
                solve( !KU( x.18^(x.19*inv(~x.17)) ) @ #vk.1 )
                  case KeyGen_case_1
                  by solve( !KU( ~x.20 ) @ #vk.4 )
                next
                  case KeyGen_case_2
                  by solve( !KU( ~x.21 ) @ #vk.6 )
                next
                  case KeyGen_case_3
                  by solve( !KU( ~x.20 ) @ #vk.4 )
                next
                  case KeyGen_case_4
                  by solve( !KU( ~x.21 ) @ #vk.6 )
                next
                  case OuterRatchetToSender_case_1
                  by solve( !KU( ~x.21 ) @ #vk.4 )
                next
                  case OuterRatchetToSender_case_2
                  by solve( !KU( ~x.22 ) @ #vk.6 )
                next
                  case SenderStart_case_1
                  by solve( !KU( ~x.21 ) @ #vk.4 )
                next
                  case SenderStart_case_2
                  by solve( !KU( ~x.22 ) @ #vk.6 )
                next
                  case c_exp
                  by solve( !KU( ~x.17 ) @ #vk.7 )
                qed
              next
                case split_case_7
                solve( !KU( x.18^(x.19*inv((~x.17*x.20))) ) @ #vk.1 )
                  case KeyGen_case_1
                  by solve( !KU( ~x.23 ) @ #vk.5 )
                next
                  case KeyGen_case_2
                  by solve( !KU( ~x.24 ) @ #vk.7 )
                next
                  case KeyGen_case_3
                  by solve( !KU( ~x.23 ) @ #vk.5 )
                next
                  case KeyGen_case_4
                  by solve( !KU( ~x.24 ) @ #vk.7 )
                next
                  case OuterRatchetToSender_case_1
                  by solve( !KU( ~x.24 ) @ #vk.5 )
                next
                  case OuterRatchetToSender_case_2
                  by solve( !KU( ~x.25 ) @ #vk.7 )
                next
                  case SenderStart_case_1
                  by solve( !KU( ~x.24 ) @ #vk.5 )
                next
                  case SenderStart_case_2
                  by solve( !KU( ~x.25 ) @ #vk.7 )
                next
                  case c_exp
                  by solve( !KU( ~x.17 ) @ #vk.8 )
                qed
              qed
            next
              case Send
              solve( NewDHSecrets( ~id.3, 'g'^~x.16, pc.2, z.5, rk.1 ) @ #b.1 )
                case OuterRatchetToReceiver
                by solve( Send( m.4 ) @ #b.1 )
              next
                case OuterRatchetToSender
                solve( splitEqs(0) )
                  case split_case_1
                  solve( !KU( pc.4^~x.18 ) @ #x )
                    case OuterRatchetToSender
                    by contradiction /* from formulas */
                  next
                    case c_exp
                    by solve( !KU( ~x.18 ) @ #vk.4 )
                  qed
                next
                  case split_case_2
                  by contradiction /* from formulas */
                next
                  case split_case_3
                  solve( !KU( z.7^inv(~x.18) ) @ #vk.1 )
                    case c_exp
                    by contradiction /* node #t after last node #vk.3 */
                  qed
                next
                  case split_case_4
                  solve( !KU( x.19^(~x.18*x.20) ) @ #x )
                    case KeyGen_case_1
                    by solve( !KU( ~x.21 ) @ #vk.3 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.21 ) @ #vk.4 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.21 ) @ #vk.3 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.21 ) @ #vk.4 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.22 ) @ #vk.3 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.22 ) @ #vk.4 )
                  next
                    case OuterRatchetToSender_case_3
                    by solve( Session( ~id.4, $A.2, 'S', ~x.17, $B.2, pc.3,
                                       kdf(<'rk', old_rk.2, z.6>),
                                       kdf(<'rk', kdf(<'rk', old_rk.3, z.7>), 'g'^(~x.21*x.22)>)
                              ) ▶₁ #vr.1 )
                  next
                    case SenderStart_case_1
                    by solve( Session( ~id.4, $A.2, 'S', ~x.17, $B.2, pc.3,
                                       kdf(<'rk', old_rk.2, z.6>),
                                       kdf(<'rk', kdf(<'rk', old_rk.1, z.4>), 'g'^(~x.21*~x.22)>)
                              ) ▶₁ #vr.1 )
                  next
                    case SenderStart_case_2
                    by solve( Session( ~id.4, $A.2, 'S', ~x.17, $B.2, pc.3,
                                       kdf(<'rk', old_rk.2, z.6>),
                                       kdf(<'rk', kdf(<'rk', old_rk.1, z.4>), 'g'^(~x.21*~x.22*x.23)
                                           >)
                              ) ▶₁ #vr.1 )
                  next
                    case c_exp
                    by solve( Session( ~id.4, $A.2, 'S', ~x.17, $B.2, pc.3,
                                       kdf(<'rk', old_rk.2, z.6>),
                                       kdf(<'rk', kdf(<'rk', old_rk.1, z.4>), x.19^(~x.18*x.20)>)
                              ) ▶₁ #vr.1 )
                  qed
                next
                  case split_case_5
                  by solve( Session( ~id.4, $A.2, 'S', ~x.17, $B.2, pc.3,
                                     kdf(<'rk', old_rk.2, z.6>),
                                     kdf(<'rk', kdf(<'rk', old_rk.1, z.4>), x.19^inv(x.20)>)
                            ) ▶₁ #vr.1 )
                next
                  case split_case_6
                  by solve( Session( ~id.4, $A.2, 'S', ~x.17, $B.2, pc.3,
                                     kdf(<'rk', old_rk.2, z.6>),
                                     kdf(<'rk', kdf(<'rk', old_rk.1, z.4>), x.19^x.20>)
                            ) ▶₁ #vr.1 )
                next
                  case split_case_7
                  by solve( Session( ~id.4, $A.2, 'S', ~x.17, $B.2, pc.3,
                                     kdf(<'rk', old_rk.2, z.6>),
                                     kdf(<'rk', kdf(<'rk', old_rk.1, z.4>), x.19^(x.20*inv(x.21))>)
                            ) ▶₁ #vr.1 )
                qed
              next
                case ReceiverStart
                by solve( Session( ~id.4, $A.2, 'S', ~prek, $B.2, pc.3,
                                   kdf(<'rk', kdf(<z.6, z.7, z.8>)>),
                                   kdf(<'rk', kdf(<'rk', old_rk.1, z.4>), z>)
                          ) ▶₁ #vr.1 )
              next
                case SenderStart
                by solve( Session( ~id.4, $A.2, 'S', ~x.17, $B.2, prepk,
                                   kdf(<'rk', kdf(<z.6, z.7, z.8>)>),
                                   kdf(<'rk', kdf(<'rk', old_rk.1, z.4>), z>)
                          ) ▶₁ #vr.1 )
              qed
            next
              case c_senc
              solve( !KU( kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<'rk', old_rk.1, z.4>), z>)>)>)
                     ) @ #vk.4 )
                case c_kdf
                solve( !KU( kdf(<'ck', kdf(<'rk', kdf(<'rk', old_rk.1, z.4>), z>)>)
                       ) @ #vk.7 )
                  case c_kdf
                  solve( !KU( kdf(<'rk', kdf(<'rk', old_rk.1, z.4>), z>) ) @ #vk.10 )
                    case c_kdf
                    by contradiction /* node #t after last node #vk.15 */
                  qed
                qed
              qed
            qed
          qed
        next
          case ReceiverStart
          by solve( Send( m.1 ) @ #b )
        next
          case SenderStart
          solve( Send( m.1 ) @ #b )
            case SenderStart
            solve( !SecretKeys( $A.1, ~ltk, prek ) ▶₃ #b )
              case KeyGen
              solve( !PublicKeys( $B.1, ltpk, prepk ) ▶₄ #b )
                case KeyGen
                solve( !KU( senc(z.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.16), 
                                                          'g'^(~prek.3*~x.16)>)
                                                    >), 
                                                z>)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case OuterRatchetToSender
                  solve( splitEqs(0) )
                    case split_case_1
                    solve( !KU( pc.2^~x.18 ) @ #x )
                      case SenderStart
                      by contradiction /* from formulas */
                    next
                      case c_exp
                      by solve( !KU( ~x.18 ) @ #vk.4 )
                    qed
                  next
                    case split_case_2
                    by contradiction /* from formulas */
                  next
                    case split_case_3
                    solve( !KU( z.8^inv(~x.18) ) @ #vk.1 )
                      case c_exp
                      by contradiction /* node #t after last node #vk.3 */
                    qed
                  next
                    case split_case_4
                    solve( !KU( x.19^(~x.18*x.20) ) @ #x )
                      case KeyGen_case_1
                      by solve( !KU( ~x.23 ) @ #vk.3 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.23 ) @ #vk.4 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.23 ) @ #vk.3 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.23 ) @ #vk.4 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.24 ) @ #vk.3 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.24 ) @ #vk.4 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.24 ) @ #vk.3 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.24 ) @ #vk.4 )
                    next
                      case SenderStart_case_3
                      solve( !KU( 'g'^x.24 ) @ #vk.1 )
                        case KeyGen_case_1
                        by solve( !KU( ~ltk.6 ) @ #vk.3 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~ltk.6 ) @ #vk.5 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~prek.6 ) @ #vk.3 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~prek.6 ) @ #vk.5 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.25 ) @ #vk.3 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.25 ) @ #vk.5 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.25 ) @ #vk.3 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.25 ) @ #vk.5 )
                      next
                        case c_exp
                        solve( splitEqs(3) )
                          case split_case_1
                          by solve( !KU( ~x.25 ) @ #vk.5 )
                        next
                          case split_case_2
                          by solve( !KU( ~x.25 ) @ #vk.6 )
                        next
                          case split_case_3
                          solve( Session( ~id.4, $A, 'S', ~x.26, $B, 'g'^~prek.4,
                                          kdf(<'rk', 
                                               kdf(<'g'^(~ltk.4*~prek.4), 'g'^(~ltk.5*~x.26), 
                                                    'g'^(~prek.4*~x.26)>)
                                              >),
                                          ck
                                 ) ▶₁ #vr )
                            case Send
                            solve( NewDHSecrets( ~id.4, 'g'^~x.28, 'g'^~prek.6,
                                                 'g'^(~prek.6*~x.28),
                                                 kdf(<'rk', 
                                                      kdf(<'g'^(~ltk.4*~prek.6), 
                                                           'g'^(~ltk.5*~x.28), 'g'^(~prek.6*~x.28)>)
                                                     >)
                                   ) @ #b.1 )
                              case SenderStart
                              solve( Send( m.6 ) @ #vr.5 )
                                case SenderStart
                                solve( Session( ~id.3, $A.2, 'R', drop, $B.2,
                                                'g'^(~x.29*inv((~x.25*x.27))),
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~prek.6*~ltk.7), 'g'^(~ltk.8*~x.29), 
                                                          'g'^(~prek.6*~x.29)>)
                                                    >),
                                                old_ck.1
                                       ) ▶₂ #vr.3 )
                                  case Receive
                                  by solve( NewDHSecrets( ~id.3, 'g'^~x.30,
                                                          'g'^(~x.29*inv((~x.25*x.27))),
                                                          'g'^(~x.29*x.31),
                                                          kdf(<'rk', 
                                                               kdf(<'g'^(~prek.6*~ltk.7), 
                                                                    'g'^(~ltk.8*~x.29), 
                                                                    'g'^(~prek.6*~x.29)>)
                                                              >)
                                            ) @ #b.2 )
                                qed
                              qed
                            qed
                          next
                            case SenderStart
                            solve( Session( ~id.3, $A.2, 'R', drop, $B.2,
                                            'g'^(~x.26*inv((~x.25*x.27))),
                                            kdf(<'rk', 
                                                 kdf(<'g'^(~prek.4*~ltk.6), 'g'^(~ltk.7*~x.26), 
                                                      'g'^(~prek.4*~x.26)>)
                                                >),
                                            old_ck.1
                                   ) ▶₂ #vr.3 )
                              case Receive
                              by solve( NewDHSecrets( ~id.3, 'g'^~x.28,
                                                      'g'^(~x.26*inv((~x.25*x.27))),
                                                      'g'^(~x.26*x.29),
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~prek.4*~ltk.6), 
                                                                'g'^(~ltk.7*~x.26), 
                                                                'g'^(~prek.4*~x.26)>)
                                                          >)
                                        ) @ #b.1 )
                            qed
                          qed
                        next
                          case split_case_4
                          solve( Session( ~id.4, $A, 'S', ~x.26, $B, 'g'^~prek.4,
                                          kdf(<'rk', 
                                               kdf(<'g'^(~ltk.4*~prek.4), 'g'^(~ltk.5*~x.26), 
                                                    'g'^(~prek.4*~x.26)>)
                                              >),
                                          ck
                                 ) ▶₁ #vr )
                            case Send
                            solve( NewDHSecrets( ~id.4, 'g'^~x.28, 'g'^~prek.6,
                                                 'g'^(~prek.6*~x.28),
                                                 kdf(<'rk', 
                                                      kdf(<'g'^(~ltk.4*~prek.6), 
                                                           'g'^(~ltk.5*~x.28), 'g'^(~prek.6*~x.28)>)
                                                     >)
                                   ) @ #b.1 )
                              case SenderStart
                              solve( Send( m.6 ) @ #vr.5 )
                                case SenderStart
                                solve( Session( ~id.3, $A.2, 'R', drop, $B.2,
                                                'g'^(x.27*~x.29*inv(~x.25)),
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~prek.6*~ltk.7), 'g'^(~ltk.8*~x.29), 
                                                          'g'^(~prek.6*~x.29)>)
                                                    >),
                                                old_ck.1
                                       ) ▶₂ #vr.3 )
                                  case Receive
                                  by solve( NewDHSecrets( ~id.3, 'g'^~x.30,
                                                          'g'^(x.27*~x.29*inv(~x.25)),
                                                          'g'^(x.27*x.31),
                                                          kdf(<'rk', 
                                                               kdf(<'g'^(~prek.6*~ltk.7), 
                                                                    'g'^(~ltk.8*~x.29), 
                                                                    'g'^(~prek.6*~x.29)>)
                                                              >)
                                            ) @ #b.2 )
                                qed
                              qed
                            qed
                          next
                            case SenderStart
                            solve( Session( ~id.3, $A.2, 'R', drop, $B.2,
                                            'g'^(~x.26*x.27*inv(~x.25)),
                                            kdf(<'rk', 
                                                 kdf(<'g'^(~prek.4*~ltk.6), 'g'^(~ltk.7*~x.26), 
                                                      'g'^(~prek.4*~x.26)>)
                                                >),
                                            old_ck.1
                                   ) ▶₂ #vr.3 )
                              case Receive
                              by solve( NewDHSecrets( ~id.3, 'g'^~x.28,
                                                      'g'^(~x.26*x.27*inv(~x.25)), 'g'^(x.29*x.30),
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~prek.4*~ltk.6), 
                                                                'g'^(~ltk.7*~x.26), 
                                                                'g'^(~prek.4*~x.26)>)
                                                          >)
                                        ) @ #b.1 )
                            qed
                          qed
                        next
                          case split_case_5
                          solve( Session( ~id.4, $A, 'S', ~x.26, $B, 'g'^~prek.4,
                                          kdf(<'rk', 
                                               kdf(<'g'^(~ltk.4*~prek.4), 'g'^(~ltk.5*~x.26), 
                                                    'g'^(~prek.4*~x.26)>)
                                              >),
                                          ck
                                 ) ▶₁ #vr )
                            case Send
                            solve( NewDHSecrets( ~id.4, 'g'^~x.29, 'g'^~prek.6,
                                                 'g'^(~prek.6*~x.29),
                                                 kdf(<'rk', 
                                                      kdf(<'g'^(~ltk.4*~prek.6), 
                                                           'g'^(~ltk.5*~x.29), 'g'^(~prek.6*~x.29)>)
                                                     >)
                                   ) @ #b.1 )
                              case SenderStart
                              solve( Send( m.6 ) @ #vr.5 )
                                case SenderStart
                                solve( Session( ~id.3, $A.2, 'R', drop, $B.2,
                                                'g'^(x.27*~x.30*inv((~x.25*x.28))),
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~prek.6*~ltk.7), 'g'^(~ltk.8*~x.30), 
                                                          'g'^(~prek.6*~x.30)>)
                                                    >),
                                                old_ck.1
                                       ) ▶₂ #vr.3 )
                                  case Receive
                                  by solve( NewDHSecrets( ~id.3, 'g'^~x.31,
                                                          'g'^(x.27*~x.30*inv((~x.25*x.28))),
                                                          'g'^(x.27*~x.30*x.32),
                                                          kdf(<'rk', 
                                                               kdf(<'g'^(~prek.6*~ltk.7), 
                                                                    'g'^(~ltk.8*~x.30), 
                                                                    'g'^(~prek.6*~x.30)>)
                                                              >)
                                            ) @ #b.2 )
                                qed
                              qed
                            qed
                          next
                            case SenderStart
                            solve( Session( ~id.3, $A.2, 'R', drop, $B.2,
                                            'g'^(~x.26*x.27*inv((~x.25*x.28))),
                                            kdf(<'rk', 
                                                 kdf(<'g'^(~prek.4*~ltk.6), 'g'^(~ltk.7*~x.26), 
                                                      'g'^(~prek.4*~x.26)>)
                                                >),
                                            old_ck.1
                                   ) ▶₂ #vr.3 )
                              case Receive
                              by solve( NewDHSecrets( ~id.3, 'g'^~x.29,
                                                      'g'^(~x.26*x.27*inv((~x.25*x.28))),
                                                      'g'^(x.30*x.31*x.32),
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~prek.4*~ltk.6), 
                                                                'g'^(~ltk.7*~x.26), 
                                                                'g'^(~prek.4*~x.26)>)
                                                          >)
                                        ) @ #b.1 )
                            qed
                          qed
                        qed
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~x.18 ) @ #vk.5 )
                    qed
                  next
                    case split_case_5
                    solve( !KU( x.24^inv((~x.18*x.25)) ) @ #vk.1 )
                      case c_exp
                      by solve( !KU( ~x.18 ) @ #vk.6 )
                    qed
                  next
                    case split_case_6
                    solve( !KU( x.19^(x.20*inv(~x.18)) ) @ #vk.1 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.21 ) @ #vk.4 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.22 ) @ #vk.6 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.21 ) @ #vk.4 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.22 ) @ #vk.6 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.22 ) @ #vk.4 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.23 ) @ #vk.6 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.22 ) @ #vk.4 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.23 ) @ #vk.6 )
                    next
                      case c_exp
                      by solve( !KU( ~x.18 ) @ #vk.7 )
                    qed
                  next
                    case split_case_7
                    solve( !KU( x.19^(x.20*inv((~x.18*x.21))) ) @ #vk.1 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.24 ) @ #vk.5 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.25 ) @ #vk.7 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.24 ) @ #vk.5 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.25 ) @ #vk.7 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.25 ) @ #vk.5 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.26 ) @ #vk.7 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.25 ) @ #vk.5 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.26 ) @ #vk.7 )
                    next
                      case c_exp
                      by solve( !KU( ~x.18 ) @ #vk.8 )
                    qed
                  qed
                next
                  case Send
                  solve( NewDHSecrets( ~id.3, 'g'^~x.17, pc.1, z.7, rk.1 ) @ #b.1 )
                    case OuterRatchetToReceiver
                    by solve( Send( m.4 ) @ #b.1 )
                  next
                    case OuterRatchetToSender
                    solve( Send( m.4 ) @ #b.1 )
                      case OuterRatchetToSender
                      by solve( Session( ~id.4, $A.2, 'S', ~x.18, $B.2, pc.2,
                                         kdf(<'rk', old_rk.1, z.8>),
                                         kdf(<'rk', 
                                              kdf(<'rk', 
                                                   kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.16), 
                                                        'g'^(~prek.3*~x.16)>)
                                                  >), 
                                              z>)
                                ) ▶₁ #vr.3 )
                    qed
                  next
                    case ReceiverStart
                    by solve( Session( ~id.4, $A.2, 'S', ~prek.4, $B.2, pc.2,
                                       kdf(<'rk', kdf(<z.8, z.9, z.10>)>),
                                       kdf(<'rk', 
                                            kdf(<'rk', 
                                                 kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.16), 
                                                      'g'^(~prek.3*~x.16)>)
                                                >), 
                                            z>)
                              ) ▶₁ #vr.3 )
                  next
                    case SenderStart
                    by solve( Session( ~id.4, $A.2, 'S', ~x.18, $B.2, prepk.1,
                                       kdf(<'rk', kdf(<z.8, z.9, z.10>)>),
                                       kdf(<'rk', 
                                            kdf(<'rk', 
                                                 kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.16), 
                                                      'g'^(~prek.3*~x.16)>)
                                                >), 
                                            z>)
                              ) ▶₁ #vr.3 )
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.16), 
                                                       'g'^(~prek.3*~x.16)>)
                                                 >), 
                                             z>)
                                       >)
                                  >)
                         ) @ #vk.4 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'rk', 
                                               kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.16), 
                                                    'g'^(~prek.3*~x.16)>)
                                              >), 
                                          z>)
                                    >)
                           ) @ #vk.7 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'rk', 
                                            kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.16), 
                                                 'g'^(~prek.3*~x.16)>)
                                           >), 
                                       z>)
                             ) @ #vk.10 )
                        case c_kdf
                        by contradiction /* node #t after last node #vk.15 */
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case SenderStart
        solve( !KU( senc(z.1,
                         kdf(<'mk', 
                              kdf(<'ck', 
                                   kdf(<'rk', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk*~prek.1), 'g'^(~ltk.1*~x.1), 
                                                  'g'^(~prek.1*~x.1)>)
                                            >), 
                                        z>)
                                  >)
                             >))
               ) @ #vk.2 )
          case OuterRatchetToSender
          solve( Session( ~id.2, $A.1, 'R', drop, $B.1, pc.1,
                          kdf(<'rk', 
                               kdf(<'g'^(~ltk*~prek.1), 'g'^(~ltk.1*~x.1), 'g'^(~prek.1*~x.1)>)>),
                          old_ck.1
                 ) ▶₂ #vr.3 )
            case Receive
            solve( NewDHSecrets( ~id.2, 'g'^~x.16, pc.1, z.4,
                                 kdf(<'rk', 
                                      kdf(<'g'^(~ltk*~prek.1), 'g'^(~ltk.1*~x.1), 'g'^(~prek.1*~x.1)
                                          >)
                                     >)
                   ) @ #b )
              case ReceiverStart
              solve( !SecretKeys( $A.2, ~ltk.2, ~prek.2 ) ▶₁ #b )
                case KeyGen
                solve( !PublicKeys( $B.2, 'g'^x.18, prepk ) ▶₂ #b )
                  case KeyGen
                  solve( splitEqs(0) )
                    case split_case_1
                    solve( !KU( 'g'^(~x.54*x.56) ) @ #x )
                      case KeyGen_case_1
                      by solve( !KU( ~x.57 ) @ #vk.7 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.57 ) @ #vk.7 )
                    next
                      case OuterRatchetToSender
                      by solve( !KU( ~x.58 ) @ #vk.7 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.58 ) @ #vk.7 )
                    next
                      case SenderStart_case_2
                      solve( Receive( m.2 ) @ #b )
                        case ReceiverStart
                        solve( splitEqs(1) )
                          case split
                          by solve( !KU( ~x.59 ) @ #vk.7 )
                        qed
                      qed
                    next
                      case c_exp
                      by solve( !KU( ~x.54 ) @ #vk.9 )
                    qed
                  next
                    case split_case_2
                    solve( !KU( 'g'^(x.56*inv(~x.54)) ) @ #vk.1 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.58 ) @ #vk.10 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.58 ) @ #vk.10 )
                    next
                      case OuterRatchetToSender
                      by solve( !KU( ~x.59 ) @ #vk.10 )
                    next
                      case SenderStart
                      by solve( !KU( ~x.59 ) @ #vk.10 )
                    next
                      case c_exp
                      by solve( !KU( ~x.54 ) @ #vk.11 )
                    qed
                  next
                    case split_case_3
                    solve( !KU( 'g'^(x.56*inv((~x.54*x.57))) ) @ #vk.1 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.58 ) @ #vk.9 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.58 ) @ #vk.9 )
                    next
                      case OuterRatchetToSender
                      by solve( !KU( ~x.59 ) @ #vk.9 )
                    next
                      case SenderStart
                      by solve( !KU( ~x.59 ) @ #vk.9 )
                    next
                      case c_exp
                      by solve( !KU( ~x.54 ) @ #vk.12 )
                    qed
                  qed
                qed
              qed
            next
              case SenderStart
              by solve( Receive( m.2 ) @ #b )
            qed
          next
            case ReceiverStart
            solve( !KU( 'g'^(~x.17*~x.21) ) @ #x )
              case OuterRatchetToSender
              by solve( !KU( ~x.23 ) @ #vk.6 )
            next
              case SenderStart
              by solve( !KU( ~x.23 ) @ #vk.6 )
            next
              case c_exp
              by solve( !KU( ~x.17 ) @ #vk.8 )
            qed
          qed
        next
          case Send
          solve( NewDHSecrets( ~id.2, 'g'^~x.15, pc.1, z.3, rk.1 ) @ #b )
            case OuterRatchetToReceiver
            by solve( Send( m.2 ) @ #b )
          next
            case OuterRatchetToSender
            solve( Send( m.2 ) @ #b )
              case OuterRatchetToSender
              by solve( Session( ~id.3, $A.1, 'S', ~x.16, $B.1, pc.2,
                                 kdf(<'rk', old_rk.1, z.4>),
                                 kdf(<'rk', 
                                      kdf(<'rk', 
                                           kdf(<'g'^(~ltk*~prek.1), 'g'^(~ltk.1*~x.1), 
                                                'g'^(~prek.1*~x.1)>)
                                          >), 
                                      z>)
                        ) ▶₁ #vr.3 )
            qed
          next
            case ReceiverStart
            by solve( Session( ~id.3, $A.1, 'S', ~prek.2, $B.1, pc.2,
                               kdf(<'rk', kdf(<z.4, z.5, z.6>)>),
                               kdf(<'rk', 
                                    kdf(<'rk', 
                                         kdf(<'g'^(~ltk*~prek.1), 'g'^(~ltk.1*~x.1), 
                                              'g'^(~prek.1*~x.1)>)
                                        >), 
                                    z>)
                      ) ▶₁ #vr.3 )
          next
            case SenderStart
            by solve( Session( ~id.3, $A.1, 'S', ~x.16, $B.1, prepk,
                               kdf(<'rk', kdf(<z.4, z.5, z.6>)>),
                               kdf(<'rk', 
                                    kdf(<'rk', 
                                         kdf(<'g'^(~ltk*~prek.1), 'g'^(~ltk.1*~x.1), 
                                              'g'^(~prek.1*~x.1)>)
                                        >), 
                                    z>)
                      ) ▶₁ #vr.3 )
          qed
        next
          case c_senc
          solve( !KU( kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk*~prek.1), 'g'^(~ltk.1*~x.1), 
                                               'g'^(~prek.1*~x.1)>)
                                         >), 
                                     z>)
                               >)
                          >)
                 ) @ #vk.4 )
            case c_kdf
            solve( !KU( kdf(<'ck', 
                             kdf(<'rk', 
                                  kdf(<'rk', 
                                       kdf(<'g'^(~ltk*~prek.1), 'g'^(~ltk.1*~x.1), 
                                            'g'^(~prek.1*~x.1)>)
                                      >), 
                                  z>)
                            >)
                   ) @ #vk.7 )
              case c_kdf
              solve( !KU( kdf(<'rk', 
                               kdf(<'rk', 
                                    kdf(<'g'^(~ltk*~prek.1), 'g'^(~ltk.1*~x.1), 'g'^(~prek.1*~x.1)>)
                                   >), 
                               z>)
                     ) @ #vk.10 )
                case c_kdf
                by contradiction /* node #t after last node #vk.15 */
              qed
            qed
          qed
        qed
      qed
    next
      case OuterRatchetToSender
      solve( Session( ~id.1, $A, 'R', drop, $B, pc, old_rk, old_ck
             ) ▶₂ #t )
        case OuterRatchetToReceiver_case_1
        solve( !KU( senc(x.2,
                         kdf(<'mk', 
                              kdf(<'ck', 
                                   kdf(<'rk', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.3), 
                                                  'g'^(~prek*~x.3)>)
                                            >), 
                                        z.1>)
                                  >)
                             >))
               ) @ #vk.2 )
          case OuterRatchetToSender
          solve( splitEqs(0) )
            case split_case_1
            solve( !KU( pc.3^~x.5 ) @ #x )
              case OuterRatchetToSender
              by contradiction /* from formulas */
            next
              case c_exp
              by solve( !KU( ~x.5 ) @ #vk.4 )
            qed
          next
            case split_case_2
            by contradiction /* from formulas */
          next
            case split_case_3
            solve( !KU( x.6^(~x.5*x.7) ) @ #x )
              case KeyGen_case_1
              by solve( !KU( ~x.8 ) @ #vk.3 )
            next
              case KeyGen_case_2
              by solve( !KU( ~x.8 ) @ #vk.4 )
            next
              case KeyGen_case_3
              by solve( !KU( ~x.8 ) @ #vk.3 )
            next
              case KeyGen_case_4
              by solve( !KU( ~x.8 ) @ #vk.4 )
            next
              case OuterRatchetToSender_case_1
              by solve( !KU( ~x.9 ) @ #vk.3 )
            next
              case OuterRatchetToSender_case_2
              by solve( !KU( ~x.9 ) @ #vk.4 )
            next
              case OuterRatchetToSender_case_3
              solve( !KU( 'g'^x.9 ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~ltk.3 ) @ #vk.3 )
              next
                case KeyGen_case_2
                by solve( !KU( ~ltk.2 ) @ #vk.5 )
              next
                case KeyGen_case_3
                by solve( !KU( ~prek.3 ) @ #vk.3 )
              next
                case KeyGen_case_4
                by solve( !KU( ~prek.2 ) @ #vk.5 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.12 ) @ #vk.3 )
              next
                case OuterRatchetToSender_case_2
                by solve( !KU( ~x.10 ) @ #vk.5 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.12 ) @ #vk.3 )
              next
                case SenderStart_case_2
                by solve( !KU( ~x.10 ) @ #vk.5 )
              next
                case c_exp
                solve( splitEqs(1) )
                  case split_case_1
                  by contradiction /* cyclic */
                next
                  case split_case_2
                  by solve( !KU( ~x.10 ) @ #vk.8 )
                next
                  case split_case_3
                  by solve( !KU( ~x.10 ) @ #vk.7 )
                next
                  case split_case_4
                  solve( splitEqs(2) )
                    case split_case_1
                    by solve( !KU( ~x.14 ) @ #vk.5 )
                  next
                    case split_case_2
                    by solve( !KU( ~x.14 ) @ #vk.6 )
                  next
                    case split_case_3
                    solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                    'g'^(~x.15*x.16*inv(~x.14)),
                                    kdf(<'rk', 
                                         kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.15), 
                                              'g'^(~prek*~x.15)>)
                                        >),
                                    old_ck.1
                           ) ▶₂ #vr.4 )
                      case Receive
                      by solve( NewDHSecrets( ~id.2, 'g'^~x.17,
                                              'g'^(~x.15*x.16*inv(~x.14)), 'g'^(x.18*x.19),
                                              kdf(<'rk', 
                                                   kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.15), 
                                                        'g'^(~prek*~x.15)>)
                                                  >)
                                ) @ #b )
                    qed
                  next
                    case split_case_4
                    solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                    'g'^(~x.15*inv((~x.14*x.16))),
                                    kdf(<'rk', 
                                         kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.15), 
                                              'g'^(~prek*~x.15)>)
                                        >),
                                    old_ck.1
                           ) ▶₂ #vr.4 )
                      case Receive
                      by solve( NewDHSecrets( ~id.2, 'g'^~x.17,
                                              'g'^(~x.15*inv((~x.14*x.16))), 'g'^(~x.15*x.18),
                                              kdf(<'rk', 
                                                   kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.15), 
                                                        'g'^(~prek*~x.15)>)
                                                  >)
                                ) @ #b )
                    qed
                  next
                    case split_case_5
                    solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                    'g'^(~x.15*x.16*inv((~x.14*x.17))),
                                    kdf(<'rk', 
                                         kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.15), 
                                              'g'^(~prek*~x.15)>)
                                        >),
                                    old_ck.1
                           ) ▶₂ #vr.4 )
                      case Receive
                      by solve( NewDHSecrets( ~id.2, 'g'^~x.18,
                                              'g'^(~x.15*x.16*inv((~x.14*x.17))),
                                              'g'^(x.19*x.20*x.21),
                                              kdf(<'rk', 
                                                   kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.15), 
                                                        'g'^(~prek*~x.15)>)
                                                  >)
                                ) @ #b )
                    qed
                  qed
                next
                  case split_case_5
                  by solve( !KU( ~x.10 ) @ #vk.9 )
                qed
              qed
            next
              case SenderStart_case_1
              by solve( !KU( ~x.9 ) @ #vk.3 )
            next
              case SenderStart_case_2
              by solve( !KU( ~x.9 ) @ #vk.4 )
            next
              case c_exp
              by solve( !KU( ~x.5 ) @ #vk.5 )
            qed
          next
            case split_case_4
            solve( !KU( z.2^inv(~x.5) ) @ #vk.1 )
              case c_exp
              by contradiction /* node #t after last node #vk.3 */
            qed
          next
            case split_case_5
            solve( !KU( x.6^inv((~x.5*x.7)) ) @ #vk.1 )
              case c_exp
              by solve( !KU( ~x.5 ) @ #vk.6 )
            qed
          next
            case split_case_6
            solve( !KU( x.6^(x.7*inv(~x.5)) ) @ #vk.1 )
              case KeyGen_case_1
              by solve( !KU( ~x.10 ) @ #vk.4 )
            next
              case KeyGen_case_2
              by solve( !KU( ~x.11 ) @ #vk.6 )
            next
              case KeyGen_case_3
              by solve( !KU( ~x.10 ) @ #vk.4 )
            next
              case KeyGen_case_4
              by solve( !KU( ~x.11 ) @ #vk.6 )
            next
              case OuterRatchetToSender_case_1
              by solve( !KU( ~x.11 ) @ #vk.4 )
            next
              case OuterRatchetToSender_case_2
              by solve( !KU( ~x.12 ) @ #vk.6 )
            next
              case SenderStart_case_1
              by solve( !KU( ~x.11 ) @ #vk.4 )
            next
              case SenderStart_case_2
              by solve( !KU( ~x.12 ) @ #vk.6 )
            next
              case c_exp
              by solve( !KU( ~x.5 ) @ #vk.7 )
            qed
          next
            case split_case_7
            solve( !KU( x.6^(x.7*inv((~x.5*x.8))) ) @ #vk.1 )
              case KeyGen_case_1
              by solve( !KU( ~x.15 ) @ #vk.5 )
            next
              case KeyGen_case_2
              by solve( !KU( ~x.16 ) @ #vk.7 )
            next
              case KeyGen_case_3
              by solve( !KU( ~x.15 ) @ #vk.5 )
            next
              case KeyGen_case_4
              by solve( !KU( ~x.16 ) @ #vk.7 )
            next
              case OuterRatchetToSender_case_1
              by solve( !KU( ~x.16 ) @ #vk.5 )
            next
              case OuterRatchetToSender_case_2
              by solve( !KU( ~x.17 ) @ #vk.7 )
            next
              case SenderStart_case_1
              by solve( !KU( ~x.16 ) @ #vk.5 )
            next
              case SenderStart_case_2
              by solve( !KU( ~x.17 ) @ #vk.7 )
            next
              case c_exp
              by solve( !KU( ~x.5 ) @ #vk.8 )
            qed
          qed
        next
          case Send
          solve( NewDHSecrets( ~id.2, 'g'^~x.4, pc.1, z.2, rk.1 ) @ #b )
            case OuterRatchetToReceiver
            by solve( Send( m.3 ) @ #b )
          next
            case OuterRatchetToSender
            solve( Send( m.3 ) @ #b )
              case OuterRatchetToSender
              by solve( Session( ~id.3, $A.1, 'S', ~x.5, $B.1, pc.2,
                                 kdf(<'rk', old_rk.1, z.3>),
                                 kdf(<'rk', 
                                      kdf(<'rk', 
                                           kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.3), 
                                                'g'^(~prek*~x.3)>)
                                          >), 
                                      z.1>)
                        ) ▶₁ #vr.4 )
            qed
          next
            case ReceiverStart
            by solve( Send( m.3 ) @ #b )
          next
            case SenderStart
            by solve( Session( ~id.3, $A.1, 'S', ~x.5, $B.1, prepk,
                               kdf(<'rk', kdf(<z.3, z.4, z.5>)>),
                               kdf(<'rk', 
                                    kdf(<'rk', 
                                         kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.3), 'g'^(~prek*~x.3)
                                             >)
                                        >), 
                                    z.1>)
                      ) ▶₁ #vr.4 )
          qed
        next
          case c_senc
          solve( !KU( kdf(<'mk', 
                           kdf(<'ck', 
                                kdf(<'rk', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.3), 'g'^(~prek*~x.3)
                                              >)
                                         >), 
                                     z.1>)
                               >)
                          >)
                 ) @ #vk.4 )
            case c_kdf
            solve( !KU( kdf(<'ck', 
                             kdf(<'rk', 
                                  kdf(<'rk', 
                                       kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.3), 'g'^(~prek*~x.3)>)
                                      >), 
                                  z.1>)
                            >)
                   ) @ #vk.7 )
              case c_kdf
              solve( !KU( kdf(<'rk', 
                               kdf(<'rk', 
                                    kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.3), 'g'^(~prek*~x.3)>)>), 
                               z.1>)
                     ) @ #vk.10 )
                case c_kdf
                by contradiction /* node #t after last node #x */
              qed
            qed
          qed
        qed
      next
        case OuterRatchetToReceiver_case_2
        solve( !KU( senc(x.2,
                         kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.1, z.1>)>)>))
               ) @ #vk.2 )
          case OuterRatchetToSender
          solve( NewDHSecrets( ~id.1, 'g'^~x.3, old_pc, z.2, old_rk.1
                 ) @ #b )
            case OuterRatchetToReceiver
            by solve( Send( m.2 ) @ #b )
          next
            case OuterRatchetToSender
            solve( Send( m.2 ) @ #b )
              case OuterRatchetToSender
              solve( splitEqs(0) )
                case split_case_1
                solve( !KU( pc.4^~x.6 ) @ #x )
                  case OuterRatchetToSender
                  by contradiction /* from formulas */
                next
                  case c_exp
                  by solve( !KU( ~x.6 ) @ #vk.4 )
                qed
              next
                case split_case_2
                by contradiction /* from formulas */
              next
                case split_case_3
                solve( !KU( x.7^(~x.6*x.8) ) @ #x )
                  case KeyGen_case_1
                  by solve( !KU( ~x.9 ) @ #vk.3 )
                next
                  case KeyGen_case_2
                  by solve( !KU( ~x.9 ) @ #vk.4 )
                next
                  case KeyGen_case_3
                  by solve( !KU( ~x.9 ) @ #vk.3 )
                next
                  case KeyGen_case_4
                  by solve( !KU( ~x.9 ) @ #vk.4 )
                next
                  case OuterRatchetToSender_case_1
                  by solve( !KU( ~x.10 ) @ #vk.3 )
                next
                  case OuterRatchetToSender_case_2
                  by solve( !KU( ~x.10 ) @ #vk.4 )
                next
                  case OuterRatchetToSender_case_3
                  solve( splitEqs(1) )
                    case split_case_1
                    solve( splitEqs(2) )
                      case split_case_1
                      by solve( !KU( ~x.12 ) @ #vk.4 )
                    next
                      case split_case_2
                      by solve( !KU( ~x.12 ) @ #vk.6 )
                    next
                      case split_case_3
                      by solve( !KU( ~x.12 ) @ #vk.5 )
                    next
                      case split_case_4
                      solve( splitEqs(3) )
                        case split_case_1
                        by solve( !KU( ~x.16 ) @ #vk.3 )
                      next
                        case split_case_2
                        by solve( !KU( ~x.16 ) @ #vk.4 )
                      next
                        case split_case_3
                        solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                        'g'^(x.17*~x.18*inv(~x.16)),
                                        kdf(<'rk', old_rk.2, pc.4^~x.18>), old_ck.1
                               ) ▶₂ #vr.2 )
                          case Receive
                          by solve( NewDHSecrets( ~id.2, 'g'^~x.19,
                                                  'g'^(x.17*~x.18*inv(~x.16)), 'g'^(x.17*x.20),
                                                  kdf(<'rk', old_rk.2, pc.4^~x.18>)
                                    ) @ #b.1 )
                        qed
                      next
                        case split_case_4
                        solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                        'g'^(~x.17*inv((~x.16*x.18))),
                                        kdf(<'rk', old_rk.2, pc.4^~x.17>), old_ck.1
                               ) ▶₂ #vr.2 )
                          case Receive
                          by solve( NewDHSecrets( ~id.2, 'g'^~x.19,
                                                  'g'^(~x.17*inv((~x.16*x.18))), 'g'^(~x.17*x.20),
                                                  kdf(<'rk', old_rk.2, pc.4^~x.17>)
                                    ) @ #b.1 )
                        qed
                      next
                        case split_case_5
                        solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                        'g'^(~x.17*x.18*inv((~x.16*x.19))),
                                        kdf(<'rk', old_rk.2, pc.4^~x.17>), old_ck.1
                               ) ▶₂ #vr.2 )
                          case Receive
                          by solve( NewDHSecrets( ~id.2, 'g'^~x.20,
                                                  'g'^(~x.17*x.18*inv((~x.16*x.19))),
                                                  'g'^(x.21*x.22*x.23),
                                                  kdf(<'rk', old_rk.2, pc.4^~x.17>)
                                    ) @ #b.1 )
                        qed
                      qed
                    next
                      case split_case_5
                      by solve( !KU( ~x.12 ) @ #vk.7 )
                    qed
                  next
                    case split_case_2
                    by contradiction /* from formulas */
                  next
                    case split_case_3
                    solve( splitEqs(2) )
                      case split_case_1
                      by solve( !KU( ~x.14 ) @ #vk.4 )
                    next
                      case split_case_2
                      by solve( !KU( ~x.14 ) @ #vk.6 )
                    next
                      case split_case_3
                      by solve( !KU( ~x.14 ) @ #vk.5 )
                    next
                      case split_case_4
                      solve( splitEqs(3) )
                        case split_case_1
                        by solve( !KU( ~x.18 ) @ #vk.3 )
                      next
                        case split_case_2
                        by solve( !KU( ~x.18 ) @ #vk.4 )
                      next
                        case split_case_3
                        solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                        'g'^(x.19*~x.20*inv(~x.18)),
                                        kdf(<'rk', old_rk.2, x.12^(x.13*~x.20)>), old_ck.1
                               ) ▶₂ #vr.2 )
                          case OuterRatchetToReceiver_case_1
                          solve( !KU( 'g'^(x.19*~x.20*inv(~x.18)) ) @ #vk.5 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.23 ) @ #vk.8 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.23 ) @ #vk.8 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.23 ) @ #vk.8 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.23 ) @ #vk.8 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.25 ) @ #vk.10 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.24 ) @ #vk.8 )
                          next
                            case OuterRatchetToSender_case_3
                            by solve( !KU( ~x.24 ) @ #vk.8 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.24 ) @ #vk.8 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.24 ) @ #vk.8 )
                          next
                            case c_exp
                            by solve( !KU( ~x.20 ) @ #vk.10 )
                          qed
                        next
                          case OuterRatchetToReceiver_case_2
                          solve( !KU( 'g'^(x.19*~x.20*inv(~x.18)) ) @ #vk.5 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.23 ) @ #vk.8 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.23 ) @ #vk.8 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.23 ) @ #vk.8 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.23 ) @ #vk.8 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.25 ) @ #vk.10 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.24 ) @ #vk.8 )
                          next
                            case OuterRatchetToSender_case_3
                            by solve( !KU( ~x.24 ) @ #vk.8 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.24 ) @ #vk.8 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.24 ) @ #vk.8 )
                          next
                            case c_exp
                            by solve( !KU( ~x.20 ) @ #vk.10 )
                          qed
                        next
                          case OuterRatchetToReceiver_case_3
                          solve( !KU( 'g'^(x.19*~x.20*inv(~x.18)) ) @ #vk.5 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.23 ) @ #vk.8 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.23 ) @ #vk.8 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.23 ) @ #vk.8 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.23 ) @ #vk.8 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.25 ) @ #vk.10 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.24 ) @ #vk.8 )
                          next
                            case OuterRatchetToSender_case_3
                            by solve( !KU( ~x.24 ) @ #vk.8 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.24 ) @ #vk.8 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.24 ) @ #vk.8 )
                          next
                            case c_exp
                            by solve( !KU( ~x.20 ) @ #vk.10 )
                          qed
                        next
                          case Receive
                          solve( NewDHSecrets( ~id.2, 'g'^~x.21, 'g'^(x.19*~x.20*inv(~x.18)),
                                               'g'^(x.19*x.22),
                                               kdf(<'rk', old_rk.2, x.12^(x.13*~x.20)>)
                                 ) @ #b.1 )
                            case OuterRatchetToReceiver_case_1
                            by contradiction /* cyclic */
                          next
                            case OuterRatchetToReceiver_case_2
                            by solve( !KU( ~x.25 ) @ #vk.3 )
                          next
                            case OuterRatchetToReceiver_case_3
                            solve( !KU( 'g'^(x.33*~x.34*inv(~x.35)) ) @ #vk.6 )
                              case KeyGen_case_1
                              by solve( !KU( ~x.36 ) @ #vk.9 )
                            next
                              case KeyGen_case_2
                              by solve( !KU( ~x.36 ) @ #vk.9 )
                            next
                              case KeyGen_case_3
                              by solve( !KU( ~x.36 ) @ #vk.9 )
                            next
                              case KeyGen_case_4
                              by solve( !KU( ~x.36 ) @ #vk.9 )
                            next
                              case OuterRatchetToSender_case_1
                              by solve( !KU( ~x.38 ) @ #vk.11 )
                            next
                              case OuterRatchetToSender_case_2
                              by solve( !KU( ~x.37 ) @ #vk.9 )
                            next
                              case OuterRatchetToSender_case_3
                              by solve( !KU( ~x.37 ) @ #vk.9 )
                            next
                              case SenderStart_case_1
                              by solve( !KU( ~x.37 ) @ #vk.9 )
                            next
                              case SenderStart_case_2
                              by solve( !KU( ~x.37 ) @ #vk.9 )
                            next
                              case c_exp
                              by solve( !KU( ~x.34 ) @ #vk.11 )
                            qed
                          next
                            case OuterRatchetToReceiver_case_4
                            by solve( !KU( ~x.24 ) @ #vk.8 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.25 ) @ #vk.3 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( Receive( m.6 ) @ #b.1 )
                          next
                            case OuterRatchetToSender_case_3
                            by solve( !KU( ~x.24 ) @ #vk.5 )
                          qed
                        qed
                      next
                        case split_case_4
                        solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                        'g'^(~x.19*inv((~x.18*x.20))),
                                        kdf(<'rk', old_rk.2, x.12^(x.13*~x.19)>), old_ck.1
                               ) ▶₂ #vr.2 )
                          case OuterRatchetToReceiver_case_1
                          solve( !KU( 'g'^(~x.19*inv((~x.18*x.20))) ) @ #vk.6 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.24 ) @ #vk.10 )
                          next
                            case c_exp
                            by solve( !KU( ~x.19 ) @ #vk.10 )
                          qed
                        next
                          case OuterRatchetToReceiver_case_2
                          solve( !KU( 'g'^(~x.19*inv((~x.18*x.20))) ) @ #vk.6 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.24 ) @ #vk.10 )
                          next
                            case c_exp
                            by solve( !KU( ~x.19 ) @ #vk.10 )
                          qed
                        next
                          case OuterRatchetToReceiver_case_3
                          solve( !KU( 'g'^(~x.19*inv((~x.18*x.20))) ) @ #vk.6 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.24 ) @ #vk.10 )
                          next
                            case c_exp
                            by solve( !KU( ~x.19 ) @ #vk.10 )
                          qed
                        next
                          case Receive
                          solve( NewDHSecrets( ~id.2, 'g'^~x.21,
                                               'g'^(~x.19*inv((~x.18*x.20))), 'g'^(~x.19*x.22),
                                               kdf(<'rk', old_rk.2, x.12^(x.13*~x.19)>)
                                 ) @ #b.1 )
                            case OuterRatchetToReceiver
                            solve( !KU( 'g'^(~x.19*inv((~x.18*x.20))) ) @ #vk.7 )
                              case OuterRatchetToSender
                              by solve( !KU( ~x.44 ) @ #vk.11 )
                            next
                              case c_exp
                              by solve( !KU( ~x.19 ) @ #vk.11 )
                            qed
                          next
                            case OuterRatchetToSender
                            by solve( Receive( m.6 ) @ #b.1 )
                          qed
                        qed
                      next
                        case split_case_5
                        solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                        'g'^(~x.19*x.20*inv((~x.18*x.21))),
                                        kdf(<'rk', old_rk.2, x.12^(x.13*~x.19)>), old_ck.1
                               ) ▶₂ #vr.2 )
                          case OuterRatchetToReceiver_case_1
                          solve( !KU( 'g'^(~x.19*x.20*inv((~x.18*x.21))) ) @ #vk.8 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.25 ) @ #vk.11 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.25 ) @ #vk.11 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.25 ) @ #vk.11 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.25 ) @ #vk.11 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.26 ) @ #vk.11 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.27 ) @ #vk.14 )
                          next
                            case OuterRatchetToSender_case_3
                            by solve( !KU( ~x.26 ) @ #vk.11 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.26 ) @ #vk.11 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.26 ) @ #vk.11 )
                          next
                            case c_exp
                            by solve( !KU( ~x.19 ) @ #vk.12 )
                          qed
                        next
                          case OuterRatchetToReceiver_case_2
                          solve( !KU( 'g'^(~x.19*x.20*inv((~x.18*x.21))) ) @ #vk.8 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.25 ) @ #vk.11 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.25 ) @ #vk.11 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.25 ) @ #vk.11 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.25 ) @ #vk.11 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.26 ) @ #vk.11 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.27 ) @ #vk.14 )
                          next
                            case OuterRatchetToSender_case_3
                            by solve( !KU( ~x.26 ) @ #vk.11 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.26 ) @ #vk.11 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.26 ) @ #vk.11 )
                          next
                            case c_exp
                            by solve( !KU( ~x.19 ) @ #vk.12 )
                          qed
                        next
                          case OuterRatchetToReceiver_case_3
                          solve( !KU( 'g'^(~x.19*x.20*inv((~x.18*x.21))) ) @ #vk.8 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.25 ) @ #vk.11 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.25 ) @ #vk.11 )
                          next
                            case KeyGen_case_3
                            by solve( !KU( ~x.25 ) @ #vk.11 )
                          next
                            case KeyGen_case_4
                            by solve( !KU( ~x.25 ) @ #vk.11 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( !KU( ~x.26 ) @ #vk.11 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( !KU( ~x.27 ) @ #vk.14 )
                          next
                            case OuterRatchetToSender_case_3
                            by solve( !KU( ~x.26 ) @ #vk.11 )
                          next
                            case SenderStart_case_1
                            by solve( !KU( ~x.26 ) @ #vk.11 )
                          next
                            case SenderStart_case_2
                            by solve( !KU( ~x.26 ) @ #vk.11 )
                          next
                            case c_exp
                            by solve( !KU( ~x.19 ) @ #vk.12 )
                          qed
                        next
                          case Receive
                          solve( NewDHSecrets( ~id.2, 'g'^~x.22,
                                               'g'^(~x.19*x.20*inv((~x.18*x.21))),
                                               'g'^(x.23*x.24*x.25),
                                               kdf(<'rk', old_rk.2, x.12^(x.13*~x.19)>)
                                 ) @ #b.1 )
                            case OuterRatchetToReceiver_case_1
                            solve( !KU( 'g'^(x.20*~x.27*inv((~x.18*x.21))) ) @ #vk.9 )
                              case KeyGen_case_1
                              by solve( !KU( ~x.50 ) @ #vk.12 )
                            next
                              case KeyGen_case_2
                              by solve( !KU( ~x.49 ) @ #vk.24 )
                            next
                              case KeyGen_case_3
                              by solve( !KU( ~x.50 ) @ #vk.12 )
                            next
                              case KeyGen_case_4
                              by solve( !KU( ~x.49 ) @ #vk.24 )
                            next
                              case OuterRatchetToSender_case_1
                              by solve( !KU( ~x.52 ) @ #vk.15 )
                            next
                              case OuterRatchetToSender_case_2
                              by solve( !KU( ~x.51 ) @ #vk.12 )
                            next
                              case OuterRatchetToSender_case_3
                              by solve( !KU( ~x.49 ) @ #vk.24 )
                            next
                              case SenderStart_case_1
                              by solve( !KU( ~x.51 ) @ #vk.12 )
                            next
                              case SenderStart_case_2
                              by solve( !KU( ~x.49 ) @ #vk.24 )
                            next
                              case c_exp
                              by solve( !KU( ~x.27 ) @ #vk.14 )
                            qed
                          next
                            case OuterRatchetToReceiver_case_2
                            solve( !KU( 'g'^(x.20*~x.27*inv((~x.18*x.21))) ) @ #vk.9 )
                              case KeyGen_case_1
                              by solve( !KU( ~x.49 ) @ #vk.12 )
                            next
                              case KeyGen_case_2
                              by solve( !KU( ~x.49 ) @ #vk.24 )
                            next
                              case KeyGen_case_3
                              by solve( !KU( ~x.49 ) @ #vk.12 )
                            next
                              case KeyGen_case_4
                              by solve( !KU( ~x.49 ) @ #vk.24 )
                            next
                              case OuterRatchetToSender_case_1
                              by solve( !KU( ~x.51 ) @ #vk.15 )
                            next
                              case OuterRatchetToSender_case_2
                              by solve( !KU( ~x.50 ) @ #vk.12 )
                            next
                              case OuterRatchetToSender_case_3
                              by solve( !KU( ~x.50 ) @ #vk.24 )
                            next
                              case SenderStart_case_1
                              by solve( !KU( ~x.50 ) @ #vk.12 )
                            next
                              case SenderStart_case_2
                              by solve( !KU( ~x.50 ) @ #vk.24 )
                            next
                              case c_exp
                              by solve( !KU( ~x.27 ) @ #vk.14 )
                            qed
                          next
                            case OuterRatchetToReceiver_case_3
                            solve( !KU( 'g'^(x.20*~x.35*inv((~x.33*x.34))) ) @ #vk.9 )
                              case KeyGen_case_1
                              by solve( !KU( ~x.58 ) @ #vk.15 )
                            next
                              case KeyGen_case_2
                              by solve( !KU( ~x.58 ) @ #vk.15 )
                            next
                              case KeyGen_case_3
                              by solve( !KU( ~x.58 ) @ #vk.15 )
                            next
                              case KeyGen_case_4
                              by solve( !KU( ~x.58 ) @ #vk.15 )
                            next
                              case OuterRatchetToSender_case_1
                              by solve( !KU( ~x.60 ) @ #vk.18 )
                            next
                              case OuterRatchetToSender_case_2
                              by solve( !KU( ~x.59 ) @ #vk.15 )
                            next
                              case OuterRatchetToSender_case_3
                              by solve( !KU( ~x.59 ) @ #vk.15 )
                            next
                              case SenderStart_case_1
                              by solve( !KU( ~x.59 ) @ #vk.15 )
                            next
                              case SenderStart_case_2
                              by solve( !KU( ~x.59 ) @ #vk.15 )
                            next
                              case c_exp
                              by solve( !KU( ~x.35 ) @ #vk.17 )
                            qed
                          next
                            case OuterRatchetToReceiver_case_4
                            by solve( !KU( ~x.37 ) @ #vk.15 )
                          next
                            case OuterRatchetToReceiver_case_5
                            by solve( !KU( ~x.27 ) @ #vk.15 )
                          next
                            case OuterRatchetToSender_case_1
                            by solve( Receive( m.6 ) @ #b.1 )
                          next
                            case OuterRatchetToSender_case_2
                            by solve( Receive( m.6 ) @ #b.1 )
                          next
                            case OuterRatchetToSender_case_3
                            by solve( Receive( m.6 ) @ #b.1 )
                          next
                            case OuterRatchetToSender_case_4
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case OuterRatchetToSender_case_5
                            by solve( !KU( ~x.27 ) @ #vk.12 )
                          qed
                        qed
                      qed
                    next
                      case split_case_5
                      by solve( !KU( ~x.14 ) @ #vk.7 )
                    qed
                  next
                    case split_case_4
                    solve( Session( ~id.4, $A.3, 'R', drop.2, $B.3, z.5^inv(~x.11),
                                    old_rk.2, old_ck.2
                           ) ▶₂ #b )
                      case OuterRatchetToReceiver_case_1
                      solve( !KU( z.5^inv(~x.11) ) @ #vk.5 )
                        case c_exp
                        by contradiction /* cyclic */
                      qed
                    next
                      case OuterRatchetToReceiver_case_2
                      solve( !KU( z.5^inv(~x.11) ) @ #vk.5 )
                        case c_exp
                        by contradiction /* cyclic */
                      qed
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( z.5^inv(~x.11) ) @ #vk.5 )
                        case c_exp
                        by contradiction /* cyclic */
                      qed
                    next
                      case Receive
                      solve( NewDHSecrets( ~id.4, 'g'^~x.12, z.5^inv(~x.11), z.7,
                                           old_rk.2
                             ) @ #b.1 )
                        case OuterRatchetToReceiver
                        solve( !KU( z.5^inv(~x.11) ) @ #vk.6 )
                          case c_exp
                          by contradiction /* cyclic */
                        qed
                      next
                        case OuterRatchetToSender
                        by solve( Receive( m.6 ) @ #b.1 )
                      next
                        case ReceiverStart
                        solve( !KU( z.5^inv(~x.11) ) @ #vk.6 )
                          case c_exp
                          by contradiction /* cyclic */
                        qed
                      next
                        case SenderStart
                        by solve( Receive( m.6 ) @ #b.1 )
                      qed
                    next
                      case ReceiverStart
                      solve( !KU( z.5^inv(~x.11) ) @ #vk.5 )
                        case c_exp
                        by contradiction /* cyclic */
                      qed
                    qed
                  next
                    case split_case_5
                    solve( Session( ~id.4, $A.3, 'R', drop.2, $B.3,
                                    x.12^inv((~x.11*x.13)), old_rk.2, old_ck.2
                           ) ▶₂ #b )
                      case OuterRatchetToReceiver_case_1
                      solve( !KU( x.12^inv((~x.11*x.13)) ) @ #vk.5 )
                        case c_exp
                        by solve( !KU( ~x.11 ) @ #vk.10 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_2
                      solve( !KU( x.12^inv((~x.11*x.13)) ) @ #vk.5 )
                        case c_exp
                        by solve( !KU( ~x.11 ) @ #vk.10 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( x.12^inv((~x.11*x.13)) ) @ #vk.5 )
                        case c_exp
                        by solve( !KU( ~x.11 ) @ #vk.10 )
                      qed
                    next
                      case Receive
                      solve( NewDHSecrets( ~id.4, 'g'^~x.14, x.12^inv((~x.11*x.13)),
                                           x.12^x.15, old_rk.2
                             ) @ #b.1 )
                        case OuterRatchetToReceiver
                        solve( !KU( x.12^inv((~x.11*x.13)) ) @ #vk.6 )
                          case c_exp
                          by solve( !KU( ~x.11 ) @ #vk.11 )
                        qed
                      next
                        case OuterRatchetToSender
                        by solve( Receive( m.6 ) @ #b.1 )
                      next
                        case ReceiverStart
                        solve( !KU( x.12^inv((~x.11*x.13)) ) @ #vk.6 )
                          case c_exp
                          by solve( !KU( ~x.11 ) @ #vk.11 )
                        qed
                      next
                        case SenderStart
                        solve( !SecretKeys( $A.4, ~ltk, prek ) ▶₃ #b.1 )
                          case KeyGen
                          by solve( !PublicKeys( $B.4, ltpk, x.12^inv((~x.11*x.13))
                                    ) ▶₄ #b.1 )
                        qed
                      qed
                    next
                      case ReceiverStart
                      solve( !KU( x.12^inv((~x.11*x.13)) ) @ #vk.5 )
                        case c_exp
                        by solve( !KU( ~x.11 ) @ #vk.10 )
                      qed
                    qed
                  next
                    case split_case_6
                    solve( Session( ~id.4, $A.3, 'R', drop.2, $B.3,
                                    x.12^(x.13*inv(~x.11)), old_rk.2, old_ck.2
                           ) ▶₂ #b )
                      case OuterRatchetToReceiver_case_1
                      solve( !KU( x.12^(x.13*inv(~x.11)) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.17 ) @ #vk.8 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.18 ) @ #vk.10 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.17 ) @ #vk.8 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.18 ) @ #vk.10 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.18 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.19 ) @ #vk.10 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.18 ) @ #vk.8 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.19 ) @ #vk.10 )
                      next
                        case c_exp
                        by solve( !KU( ~x.11 ) @ #vk.11 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_2
                      solve( !KU( x.12^(x.13*inv(~x.11)) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.17 ) @ #vk.8 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.18 ) @ #vk.10 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.17 ) @ #vk.8 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.18 ) @ #vk.10 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.18 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.19 ) @ #vk.10 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.18 ) @ #vk.8 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.19 ) @ #vk.10 )
                      next
                        case c_exp
                        by solve( !KU( ~x.11 ) @ #vk.11 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( x.12^(x.13*inv(~x.11)) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.17 ) @ #vk.8 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.18 ) @ #vk.10 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.17 ) @ #vk.8 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.18 ) @ #vk.10 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.18 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.19 ) @ #vk.10 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.18 ) @ #vk.8 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.19 ) @ #vk.10 )
                      next
                        case c_exp
                        by solve( !KU( ~x.11 ) @ #vk.11 )
                      qed
                    next
                      case Receive
                      solve( NewDHSecrets( ~id.4, 'g'^~x.14, x.12^(x.13*inv(~x.11)),
                                           x.12^x.15, old_rk.2
                             ) @ #b.1 )
                        case OuterRatchetToReceiver
                        solve( !KU( x.12^(x.13*inv(~x.11)) ) @ #vk.6 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.32 ) @ #vk.9 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.33 ) @ #vk.11 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.32 ) @ #vk.9 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.33 ) @ #vk.11 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.33 ) @ #vk.9 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.33 ) @ #vk.9 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case c_exp
                          by solve( !KU( ~x.11 ) @ #vk.12 )
                        qed
                      next
                        case OuterRatchetToSender
                        by solve( Receive( m.6 ) @ #b.1 )
                      next
                        case ReceiverStart
                        solve( !KU( x.12^(x.13*inv(~x.11)) ) @ #vk.6 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.38 ) @ #vk.9 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.39 ) @ #vk.11 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.38 ) @ #vk.9 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.39 ) @ #vk.11 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.39 ) @ #vk.9 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.40 ) @ #vk.11 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.39 ) @ #vk.9 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.40 ) @ #vk.11 )
                        next
                          case c_exp
                          by solve( !KU( ~x.11 ) @ #vk.12 )
                        qed
                      next
                        case SenderStart
                        solve( !SecretKeys( $A.4, ~ltk, prek ) ▶₃ #b.1 )
                          case KeyGen
                          by solve( !PublicKeys( $B.4, ltpk, x.12^(x.13*inv(~x.11))
                                    ) ▶₄ #b.1 )
                        qed
                      qed
                    next
                      case ReceiverStart
                      solve( !KU( x.12^(x.13*inv(~x.11)) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.17 ) @ #vk.8 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.18 ) @ #vk.10 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.17 ) @ #vk.8 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.18 ) @ #vk.10 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.18 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.19 ) @ #vk.10 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.18 ) @ #vk.8 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.19 ) @ #vk.10 )
                      next
                        case c_exp
                        by solve( !KU( ~x.11 ) @ #vk.11 )
                      qed
                    qed
                  next
                    case split_case_7
                    solve( Session( ~id.4, $A.3, 'R', drop.2, $B.3,
                                    x.12^(x.13*inv((~x.11*x.14))), old_rk.2, old_ck.2
                           ) ▶₂ #b )
                      case OuterRatchetToReceiver_case_1
                      solve( !KU( x.12^(x.13*inv((~x.11*x.14))) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.19 ) @ #vk.11 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.19 ) @ #vk.11 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.19 ) @ #vk.9 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.20 ) @ #vk.11 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.19 ) @ #vk.9 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.20 ) @ #vk.11 )
                      next
                        case c_exp
                        by solve( !KU( ~x.11 ) @ #vk.12 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_2
                      solve( !KU( x.12^(x.13*inv((~x.11*x.14))) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.19 ) @ #vk.11 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.19 ) @ #vk.11 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.19 ) @ #vk.9 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.20 ) @ #vk.11 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.19 ) @ #vk.9 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.20 ) @ #vk.11 )
                      next
                        case c_exp
                        by solve( !KU( ~x.11 ) @ #vk.12 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( x.12^(x.13*inv((~x.11*x.14))) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.19 ) @ #vk.11 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.19 ) @ #vk.11 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.19 ) @ #vk.9 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.20 ) @ #vk.11 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.19 ) @ #vk.9 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.20 ) @ #vk.11 )
                      next
                        case c_exp
                        by solve( !KU( ~x.11 ) @ #vk.12 )
                      qed
                    next
                      case Receive
                      solve( NewDHSecrets( ~id.4, 'g'^~x.15,
                                           x.12^(x.13*inv((~x.11*x.14))), x.12^(x.13*x.16), old_rk.2
                             ) @ #b.1 )
                        case OuterRatchetToReceiver
                        solve( !KU( x.12^(x.13*inv((~x.11*x.14))) ) @ #vk.6 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.35 ) @ #vk.10 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.36 ) @ #vk.12 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.35 ) @ #vk.10 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.36 ) @ #vk.12 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.36 ) @ #vk.10 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.37 ) @ #vk.12 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.36 ) @ #vk.10 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.37 ) @ #vk.12 )
                        next
                          case c_exp
                          by solve( !KU( ~x.11 ) @ #vk.13 )
                        qed
                      next
                        case OuterRatchetToSender
                        by solve( Receive( m.6 ) @ #b.1 )
                      next
                        case ReceiverStart
                        solve( !KU( x.12^(x.13*inv((~x.11*x.14))) ) @ #vk.6 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.45 ) @ #vk.10 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.46 ) @ #vk.12 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.45 ) @ #vk.10 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.46 ) @ #vk.12 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.46 ) @ #vk.10 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.47 ) @ #vk.12 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.46 ) @ #vk.10 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.47 ) @ #vk.12 )
                        next
                          case c_exp
                          by solve( !KU( ~x.11 ) @ #vk.13 )
                        qed
                      next
                        case SenderStart
                        solve( !SecretKeys( $A.4, ~ltk, prek ) ▶₃ #b.1 )
                          case KeyGen
                          by solve( !PublicKeys( $B.4, ltpk, x.12^(x.13*inv((~x.11*x.14)))
                                    ) ▶₄ #b.1 )
                        qed
                      qed
                    next
                      case ReceiverStart
                      solve( !KU( x.12^(x.13*inv((~x.11*x.14))) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.19 ) @ #vk.11 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.19 ) @ #vk.11 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.19 ) @ #vk.9 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.20 ) @ #vk.11 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.19 ) @ #vk.9 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.20 ) @ #vk.11 )
                      next
                        case c_exp
                        by solve( !KU( ~x.11 ) @ #vk.12 )
                      qed
                    qed
                  qed
                next
                  case SenderStart_case_1
                  by solve( !KU( ~x.10 ) @ #vk.3 )
                next
                  case SenderStart_case_2
                  by solve( !KU( ~x.10 ) @ #vk.4 )
                next
                  case c_exp
                  by solve( !KU( ~x.6 ) @ #vk.5 )
                qed
              next
                case split_case_4
                solve( !KU( z.4^inv(~x.6) ) @ #vk.1 )
                  case c_exp
                  by contradiction /* node #t after last node #vk.3 */
                qed
              next
                case split_case_5
                solve( !KU( x.7^inv((~x.6*x.8)) ) @ #vk.1 )
                  case c_exp
                  by solve( !KU( ~x.6 ) @ #vk.6 )
                qed
              next
                case split_case_6
                solve( !KU( x.7^(x.8*inv(~x.6)) ) @ #vk.1 )
                  case KeyGen_case_1
                  by solve( !KU( ~x.11 ) @ #vk.4 )
                next
                  case KeyGen_case_2
                  by solve( !KU( ~x.12 ) @ #vk.6 )
                next
                  case KeyGen_case_3
                  by solve( !KU( ~x.11 ) @ #vk.4 )
                next
                  case KeyGen_case_4
                  by solve( !KU( ~x.12 ) @ #vk.6 )
                next
                  case OuterRatchetToSender_case_1
                  by solve( !KU( ~x.12 ) @ #vk.4 )
                next
                  case OuterRatchetToSender_case_2
                  by solve( !KU( ~x.13 ) @ #vk.6 )
                next
                  case SenderStart_case_1
                  by solve( !KU( ~x.12 ) @ #vk.4 )
                next
                  case SenderStart_case_2
                  by solve( !KU( ~x.13 ) @ #vk.6 )
                next
                  case c_exp
                  by solve( !KU( ~x.6 ) @ #vk.7 )
                qed
              next
                case split_case_7
                solve( !KU( x.7^(x.8*inv((~x.6*x.9))) ) @ #vk.1 )
                  case KeyGen_case_1
                  by solve( !KU( ~x.16 ) @ #vk.5 )
                next
                  case KeyGen_case_2
                  by solve( !KU( ~x.17 ) @ #vk.7 )
                next
                  case KeyGen_case_3
                  by solve( !KU( ~x.16 ) @ #vk.5 )
                next
                  case KeyGen_case_4
                  by solve( !KU( ~x.17 ) @ #vk.7 )
                next
                  case OuterRatchetToSender_case_1
                  by solve( !KU( ~x.17 ) @ #vk.5 )
                next
                  case OuterRatchetToSender_case_2
                  by solve( !KU( ~x.18 ) @ #vk.7 )
                next
                  case SenderStart_case_1
                  by solve( !KU( ~x.17 ) @ #vk.5 )
                next
                  case SenderStart_case_2
                  by solve( !KU( ~x.18 ) @ #vk.7 )
                next
                  case c_exp
                  by solve( !KU( ~x.6 ) @ #vk.8 )
                qed
              qed
            qed
          next
            case ReceiverStart
            by solve( Send( m.2 ) @ #b )
          next
            case SenderStart
            solve( !SecretKeys( $A.2, ~ltk, prek ) ▶₃ #b )
              case KeyGen
              solve( !PublicKeys( $B.2, ltpk, prepk ) ▶₄ #b )
                case KeyGen
                solve( Send( m.2 ) @ #b )
                  case SenderStart
                  solve( splitEqs(0) )
                    case split_case_1
                    solve( !KU( pc.3^~x.7 ) @ #x )
                      case OuterRatchetToSender
                      by contradiction /* from formulas */
                    next
                      case c_exp
                      by solve( !KU( ~x.7 ) @ #vk.4 )
                    qed
                  next
                    case split_case_2
                    by contradiction /* from formulas */
                  next
                    case split_case_3
                    solve( !KU( x.8^(~x.7*x.9) ) @ #x )
                      case KeyGen_case_1
                      by solve( !KU( ~x.10 ) @ #vk.3 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.10 ) @ #vk.4 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.10 ) @ #vk.3 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.10 ) @ #vk.4 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.11 ) @ #vk.3 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.11 ) @ #vk.4 )
                    next
                      case OuterRatchetToSender_case_3
                      solve( !KU( 'g'^x.11 ) @ #vk.1 )
                        case KeyGen_case_1
                        by solve( !KU( ~ltk.5 ) @ #vk.3 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~ltk.4 ) @ #vk.5 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~prek.5 ) @ #vk.3 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~prek.4 ) @ #vk.5 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.14 ) @ #vk.3 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.12 ) @ #vk.5 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.14 ) @ #vk.3 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.12 ) @ #vk.5 )
                      next
                        case c_exp
                        solve( splitEqs(2) )
                          case split_case_1
                          by contradiction /* cyclic */
                        next
                          case split_case_2
                          by solve( !KU( ~x.12 ) @ #vk.8 )
                        next
                          case split_case_3
                          by solve( !KU( ~x.12 ) @ #vk.7 )
                        next
                          case split_case_4
                          solve( splitEqs(3) )
                            case split_case_1
                            by solve( !KU( ~x.16 ) @ #vk.5 )
                          next
                            case split_case_2
                            by solve( !KU( ~x.16 ) @ #vk.6 )
                          next
                            case split_case_3
                            solve( Session( ~id.4, $A.3, 'S', ~x.17, $B.3, 'g'^~prek.3,
                                            kdf(<'rk', 
                                                 kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.17), 
                                                      'g'^(~prek.3*~x.17)>)
                                                >),
                                            ck
                                   ) ▶₁ #vr.1 )
                              case Send
                              solve( NewDHSecrets( ~id.4, 'g'^~x.19, 'g'^~prek.4,
                                                   'g'^(~prek.4*~x.19),
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.2*~prek.4), 
                                                             'g'^(~ltk.3*~x.19), 'g'^(~prek.4*~x.19)
                                                            >)
                                                       >)
                                     ) @ #b.1 )
                                case SenderStart
                                solve( Send( m.7 ) @ #b.1 )
                                  case SenderStart
                                  solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                                  'g'^(x.18*~x.20*inv(~x.16)),
                                                  kdf(<'rk', 
                                                       kdf(<'g'^(~prek.4*~ltk.5), 
                                                            'g'^(~ltk.6*~x.20), 'g'^(~prek.4*~x.20)
                                                           >)
                                                      >),
                                                  old_ck.1
                                         ) ▶₂ #vr.2 )
                                    case Receive
                                    by solve( NewDHSecrets( ~id.2, 'g'^~x.21,
                                                            'g'^(x.18*~x.20*inv(~x.16)),
                                                            'g'^(x.18*x.22),
                                                            kdf(<'rk', 
                                                                 kdf(<'g'^(~prek.4*~ltk.5), 
                                                                      'g'^(~ltk.6*~x.20), 
                                                                      'g'^(~prek.4*~x.20)>)
                                                                >)
                                              ) @ #b.2 )
                                  qed
                                qed
                              qed
                            next
                              case SenderStart
                              solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                              'g'^(~x.17*x.18*inv(~x.16)),
                                              kdf(<'rk', 
                                                   kdf(<'g'^(~prek.3*~ltk.4), 'g'^(~ltk.5*~x.17), 
                                                        'g'^(~prek.3*~x.17)>)
                                                  >),
                                              old_ck.1
                                     ) ▶₂ #vr.2 )
                                case Receive
                                by solve( NewDHSecrets( ~id.2, 'g'^~x.19,
                                                        'g'^(~x.17*x.18*inv(~x.16)),
                                                        'g'^(x.20*x.21),
                                                        kdf(<'rk', 
                                                             kdf(<'g'^(~prek.3*~ltk.4), 
                                                                  'g'^(~ltk.5*~x.17), 
                                                                  'g'^(~prek.3*~x.17)>)
                                                            >)
                                          ) @ #b.1 )
                              qed
                            qed
                          next
                            case split_case_4
                            solve( Session( ~id.4, $A.3, 'S', ~x.17, $B.3, 'g'^~prek.3,
                                            kdf(<'rk', 
                                                 kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.17), 
                                                      'g'^(~prek.3*~x.17)>)
                                                >),
                                            ck
                                   ) ▶₁ #vr.1 )
                              case Send
                              solve( NewDHSecrets( ~id.4, 'g'^~x.19, 'g'^~prek.4,
                                                   'g'^(~prek.4*~x.19),
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.2*~prek.4), 
                                                             'g'^(~ltk.3*~x.19), 'g'^(~prek.4*~x.19)
                                                            >)
                                                       >)
                                     ) @ #b.1 )
                                case SenderStart
                                solve( Send( m.7 ) @ #b.1 )
                                  case SenderStart
                                  solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                                  'g'^(~x.20*inv((~x.16*x.18))),
                                                  kdf(<'rk', 
                                                       kdf(<'g'^(~prek.4*~ltk.5), 
                                                            'g'^(~ltk.6*~x.20), 'g'^(~prek.4*~x.20)
                                                           >)
                                                      >),
                                                  old_ck.1
                                         ) ▶₂ #vr.2 )
                                    case Receive
                                    by solve( NewDHSecrets( ~id.2, 'g'^~x.21,
                                                            'g'^(~x.20*inv((~x.16*x.18))),
                                                            'g'^(~x.20*x.22),
                                                            kdf(<'rk', 
                                                                 kdf(<'g'^(~prek.4*~ltk.5), 
                                                                      'g'^(~ltk.6*~x.20), 
                                                                      'g'^(~prek.4*~x.20)>)
                                                                >)
                                              ) @ #b.2 )
                                  qed
                                qed
                              qed
                            next
                              case SenderStart
                              solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                              'g'^(~x.17*inv((~x.16*x.18))),
                                              kdf(<'rk', 
                                                   kdf(<'g'^(~prek.3*~ltk.4), 'g'^(~ltk.5*~x.17), 
                                                        'g'^(~prek.3*~x.17)>)
                                                  >),
                                              old_ck.1
                                     ) ▶₂ #vr.2 )
                                case Receive
                                by solve( NewDHSecrets( ~id.2, 'g'^~x.19,
                                                        'g'^(~x.17*inv((~x.16*x.18))),
                                                        'g'^(~x.17*x.20),
                                                        kdf(<'rk', 
                                                             kdf(<'g'^(~prek.3*~ltk.4), 
                                                                  'g'^(~ltk.5*~x.17), 
                                                                  'g'^(~prek.3*~x.17)>)
                                                            >)
                                          ) @ #b.1 )
                              qed
                            qed
                          next
                            case split_case_5
                            solve( Session( ~id.4, $A.3, 'S', ~x.17, $B.3, 'g'^~prek.3,
                                            kdf(<'rk', 
                                                 kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.17), 
                                                      'g'^(~prek.3*~x.17)>)
                                                >),
                                            ck
                                   ) ▶₁ #vr.1 )
                              case Send
                              solve( NewDHSecrets( ~id.4, 'g'^~x.20, 'g'^~prek.4,
                                                   'g'^(~prek.4*~x.20),
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.2*~prek.4), 
                                                             'g'^(~ltk.3*~x.20), 'g'^(~prek.4*~x.20)
                                                            >)
                                                       >)
                                     ) @ #b.1 )
                                case SenderStart
                                solve( Send( m.7 ) @ #b.1 )
                                  case SenderStart
                                  solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                                  'g'^(x.18*~x.21*inv((~x.16*x.19))),
                                                  kdf(<'rk', 
                                                       kdf(<'g'^(~prek.4*~ltk.5), 
                                                            'g'^(~ltk.6*~x.21), 'g'^(~prek.4*~x.21)
                                                           >)
                                                      >),
                                                  old_ck.1
                                         ) ▶₂ #vr.2 )
                                    case Receive
                                    by solve( NewDHSecrets( ~id.2, 'g'^~x.22,
                                                            'g'^(x.18*~x.21*inv((~x.16*x.19))),
                                                            'g'^(x.18*~x.21*x.23),
                                                            kdf(<'rk', 
                                                                 kdf(<'g'^(~prek.4*~ltk.5), 
                                                                      'g'^(~ltk.6*~x.21), 
                                                                      'g'^(~prek.4*~x.21)>)
                                                                >)
                                              ) @ #b.2 )
                                  qed
                                qed
                              qed
                            next
                              case SenderStart
                              solve( Session( ~id.2, $A.1, 'R', drop.1, $B.1,
                                              'g'^(~x.17*x.18*inv((~x.16*x.19))),
                                              kdf(<'rk', 
                                                   kdf(<'g'^(~prek.3*~ltk.4), 'g'^(~ltk.5*~x.17), 
                                                        'g'^(~prek.3*~x.17)>)
                                                  >),
                                              old_ck.1
                                     ) ▶₂ #vr.2 )
                                case Receive
                                by solve( NewDHSecrets( ~id.2, 'g'^~x.20,
                                                        'g'^(~x.17*x.18*inv((~x.16*x.19))),
                                                        'g'^(x.21*x.22*x.23),
                                                        kdf(<'rk', 
                                                             kdf(<'g'^(~prek.3*~ltk.4), 
                                                                  'g'^(~ltk.5*~x.17), 
                                                                  'g'^(~prek.3*~x.17)>)
                                                            >)
                                          ) @ #b.1 )
                              qed
                            qed
                          qed
                        next
                          case split_case_5
                          by solve( !KU( ~x.12 ) @ #vk.9 )
                        qed
                      qed
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.11 ) @ #vk.3 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.11 ) @ #vk.4 )
                    next
                      case c_exp
                      by solve( !KU( ~x.7 ) @ #vk.5 )
                    qed
                  next
                    case split_case_4
                    solve( !KU( z.6^inv(~x.7) ) @ #vk.1 )
                      case c_exp
                      by contradiction /* node #t after last node #vk.3 */
                    qed
                  next
                    case split_case_5
                    solve( !KU( x.8^inv((~x.7*x.9)) ) @ #vk.1 )
                      case c_exp
                      by solve( !KU( ~x.7 ) @ #vk.6 )
                    qed
                  next
                    case split_case_6
                    solve( !KU( x.8^(x.9*inv(~x.7)) ) @ #vk.1 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.12 ) @ #vk.4 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.13 ) @ #vk.6 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.12 ) @ #vk.4 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.13 ) @ #vk.6 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.13 ) @ #vk.4 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.14 ) @ #vk.6 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.13 ) @ #vk.4 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.14 ) @ #vk.6 )
                    next
                      case c_exp
                      by solve( !KU( ~x.7 ) @ #vk.7 )
                    qed
                  next
                    case split_case_7
                    solve( !KU( x.8^(x.9*inv((~x.7*x.10))) ) @ #vk.1 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.17 ) @ #vk.5 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.18 ) @ #vk.7 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.17 ) @ #vk.5 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.18 ) @ #vk.7 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.18 ) @ #vk.5 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.19 ) @ #vk.7 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.18 ) @ #vk.5 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.19 ) @ #vk.7 )
                    next
                      case c_exp
                      by solve( !KU( ~x.7 ) @ #vk.8 )
                    qed
                  qed
                qed
              qed
            qed
          qed
        next
          case Send
          solve( NewDHSecrets( ~id.1, 'g'^~x.3, old_pc, z.2, old_rk.1
                 ) @ #b )
            case OuterRatchetToReceiver
            by solve( Send( m.2 ) @ #b )
          next
            case OuterRatchetToSender
            solve( NewDHSecrets( ~id.2, 'g'^~x.4, pc.1, z.3, rk.1 ) @ #b.1 )
              case OuterRatchetToReceiver
              solve( Send( m.2 ) @ #b )
                case OuterRatchetToSender
                by solve( Send( m.4 ) @ #b.1 )
              qed
            next
              case OuterRatchetToSender
              solve( Send( m.2 ) @ #b )
                case OuterRatchetToSender
                solve( Send( m.4 ) @ #b.1 )
                  case OuterRatchetToSender
                  by solve( Session( ~id.4, $A.1, 'S', ~x.6, $B.1, pc.3,
                                     kdf(<'rk', old_rk.3, z.5>),
                                     kdf(<'rk', kdf(<'rk', old_rk.2, z.4>), z.1>)
                            ) ▶₁ #vr.2 )
                qed
              qed
            next
              case ReceiverStart
              solve( !SecretKeys( $A.3, ~ltk, ~prek ) ▶₁ #b.1 )
                case KeyGen
                solve( !PublicKeys( $B.3, ltpk, prepk ) ▶₂ #b.1 )
                  case KeyGen
                  solve( Send( m.2 ) @ #b )
                    case OuterRatchetToSender
                    by solve( Send( m.4 ) @ #b.1 )
                  qed
                qed
              qed
            next
              case SenderStart
              solve( !SecretKeys( $A.3, ~ltk, prek ) ▶₃ #b.1 )
                case KeyGen
                solve( !PublicKeys( $B.3, ltpk, prepk ) ▶₄ #b.1 )
                  case KeyGen
                  solve( Send( m.2 ) @ #b )
                    case OuterRatchetToSender
                    solve( Send( m.4 ) @ #b.1 )
                      case SenderStart
                      by solve( Session( ~id.4, $A.1, 'S', ~x.7, $B.1, 'g'^~prek.3,
                                         kdf(<'rk', 
                                              kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.7), 
                                                   'g'^(~prek.3*~x.7)>)
                                             >),
                                         kdf(<'rk', kdf(<'rk', old_rk.2, z.4>), z.1>)
                                ) ▶₁ #vr.2 )
                    qed
                  qed
                qed
              qed
            qed
          next
            case ReceiverStart
            solve( !SecretKeys( $A.2, ~ltk, ~prek ) ▶₁ #b )
              case KeyGen
              solve( !PublicKeys( $B.2, ltpk, prepk ) ▶₂ #b )
                case KeyGen
                by solve( Send( m.2 ) @ #b )
              qed
            qed
          next
            case SenderStart
            solve( !SecretKeys( $A.2, ~ltk, prek ) ▶₃ #b )
              case KeyGen
              solve( !PublicKeys( $B.2, ltpk, prepk ) ▶₄ #b )
                case KeyGen
                solve( Send( m.2 ) @ #b )
                  case SenderStart
                  by solve( Session( ~id.2, $A.1, 'S', ~x.4, $B.1, pc.1, rk.1,
                                     kdf(<'rk', 
                                          kdf(<'rk', 
                                               kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.6), 
                                                    'g'^(~prek.3*~x.6)>)
                                              >), 
                                          z.1>)
                            ) ▶₁ #vr.2 )
                qed
              qed
            qed
          qed
        next
          case c_senc
          solve( NewDHSecrets( ~id.1, 'g'^~x.3, old_pc, z.2, old_rk.1
                 ) @ #b )
            case OuterRatchetToReceiver
            by solve( Send( m.2 ) @ #b )
          next
            case OuterRatchetToSender
            solve( Send( m.2 ) @ #b )
              case OuterRatchetToSender
              solve( !KU( kdf(<'mk', 
                               kdf(<'ck', kdf(<'rk', kdf(<'rk', old_rk.2, z.3>), z.1>)>)>)
                     ) @ #vk.4 )
                case c_kdf
                solve( !KU( kdf(<'ck', kdf(<'rk', kdf(<'rk', old_rk.2, z.3>), z.1>)
                                >)
                       ) @ #vk.7 )
                  case c_kdf
                  solve( !KU( kdf(<'rk', kdf(<'rk', old_rk.2, z.3>), z.1>)
                         ) @ #vk.10 )
                    case c_kdf
                    by contradiction /* node #t after last node #x */
                  qed
                qed
              qed
            qed
          next
            case ReceiverStart
            by solve( Send( m.2 ) @ #b )
          next
            case SenderStart
            solve( Send( m.2 ) @ #b )
              case SenderStart
              solve( !SecretKeys( $A.1, ~ltk, prek ) ▶₃ #b )
                case KeyGen
                solve( !PublicKeys( $B.1, ltpk, prepk ) ▶₄ #b )
                  case KeyGen
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.5), 
                                                       'g'^(~prek.3*~x.5)>)
                                                 >), 
                                             z.1>)
                                       >)
                                  >)
                         ) @ #vk.4 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'rk', 
                                               kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.5), 
                                                    'g'^(~prek.3*~x.5)>)
                                              >), 
                                          z.1>)
                                    >)
                           ) @ #vk.7 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'rk', 
                                            kdf(<'g'^(~ltk.2*~prek.3), 'g'^(~ltk.3*~x.5), 
                                                 'g'^(~prek.3*~x.5)>)
                                           >), 
                                       z.1>)
                             ) @ #vk.10 )
                        case c_kdf
                        by contradiction /* node #t after last node #x */
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case OuterRatchetToReceiver_case_3
        solve( !KU( senc(x.2,
                         kdf(<'mk', 
                              kdf(<'ck', kdf(<'rk', kdf(<'rk', old_rk.1, z.1>), z.2>)>)>))
               ) @ #vk.2 )
          case OuterRatchetToSender
          solve( splitEqs(0) )
            case split_case_1
            solve( !KU( pc.3^~x.5 ) @ #x )
              case OuterRatchetToSender
              by contradiction /* from formulas */
            next
              case c_exp
              by solve( !KU( ~x.5 ) @ #vk.4 )
            qed
          next
            case split_case_2
            by contradiction /* from formulas */
          next
            case split_case_3
            solve( !KU( x.6^(~x.5*x.7) ) @ #x )
              case KeyGen_case_1
              by solve( !KU( ~x.8 ) @ #vk.3 )
            next
              case KeyGen_case_2
              by solve( !KU( ~x.8 ) @ #vk.4 )
            next
              case KeyGen_case_3
              by solve( !KU( ~x.8 ) @ #vk.3 )
            next
              case KeyGen_case_4
              by solve( !KU( ~x.8 ) @ #vk.4 )
            next
              case OuterRatchetToSender_case_1
              by solve( !KU( ~x.9 ) @ #vk.3 )
            next
              case OuterRatchetToSender_case_2
              by solve( !KU( ~x.9 ) @ #vk.4 )
            next
              case OuterRatchetToSender_case_3
              solve( splitEqs(1) )
                case split_case_1
                solve( splitEqs(2) )
                  case split_case_1
                  by solve( !KU( ~x.11 ) @ #vk.4 )
                next
                  case split_case_2
                  by solve( !KU( ~x.11 ) @ #vk.6 )
                next
                  case split_case_3
                  by solve( !KU( ~x.11 ) @ #vk.5 )
                next
                  case split_case_4
                  solve( splitEqs(3) )
                    case split_case_1
                    by solve( !KU( ~x.15 ) @ #vk.3 )
                  next
                    case split_case_2
                    by solve( !KU( ~x.15 ) @ #vk.4 )
                  next
                    case split_case_3
                    solve( Session( ~id.2, $A.1, 'R', drop.2, $B.1,
                                    'g'^(x.16*~x.17*inv(~x.15)),
                                    kdf(<'rk', old_rk.1, old_pc.1^~x.17>), old_ck.2
                           ) ▶₂ #vr.2 )
                      case Receive
                      by solve( NewDHSecrets( ~id.2, 'g'^~x.18,
                                              'g'^(x.16*~x.17*inv(~x.15)), 'g'^(x.16*x.19),
                                              kdf(<'rk', old_rk.1, old_pc.1^~x.17>)
                                ) @ #b )
                    qed
                  next
                    case split_case_4
                    solve( Session( ~id.2, $A.1, 'R', drop.2, $B.1,
                                    'g'^(~x.16*inv((~x.15*x.17))),
                                    kdf(<'rk', old_rk.1, old_pc.1^~x.16>), old_ck.2
                           ) ▶₂ #vr.2 )
                      case Receive
                      by solve( NewDHSecrets( ~id.2, 'g'^~x.18,
                                              'g'^(~x.16*inv((~x.15*x.17))), 'g'^(~x.16*x.19),
                                              kdf(<'rk', old_rk.1, old_pc.1^~x.16>)
                                ) @ #b )
                    qed
                  next
                    case split_case_5
                    solve( Session( ~id.2, $A.1, 'R', drop.2, $B.1,
                                    'g'^(~x.16*x.17*inv((~x.15*x.18))),
                                    kdf(<'rk', old_rk.1, old_pc.1^~x.16>), old_ck.2
                           ) ▶₂ #vr.2 )
                      case Receive
                      by solve( NewDHSecrets( ~id.2, 'g'^~x.19,
                                              'g'^(~x.16*x.17*inv((~x.15*x.18))),
                                              'g'^(x.20*x.21*x.22),
                                              kdf(<'rk', old_rk.1, old_pc.1^~x.16>)
                                ) @ #b )
                    qed
                  qed
                next
                  case split_case_5
                  by solve( !KU( ~x.11 ) @ #vk.7 )
                qed
              next
                case split_case_2
                by contradiction /* from formulas */
              next
                case split_case_3
                solve( splitEqs(2) )
                  case split_case_1
                  by solve( !KU( ~x.13 ) @ #vk.4 )
                next
                  case split_case_2
                  by solve( !KU( ~x.13 ) @ #vk.6 )
                next
                  case split_case_3
                  by solve( !KU( ~x.13 ) @ #vk.5 )
                next
                  case split_case_4
                  solve( splitEqs(3) )
                    case split_case_1
                    by solve( !KU( ~x.17 ) @ #vk.3 )
                  next
                    case split_case_2
                    by solve( !KU( ~x.17 ) @ #vk.4 )
                  next
                    case split_case_3
                    solve( Session( ~id.2, $A.1, 'R', drop.2, $B.1,
                                    'g'^(x.18*~x.19*inv(~x.17)),
                                    kdf(<'rk', old_rk.1, x.11^(x.12*~x.19)>), old_ck.2
                           ) ▶₂ #vr.2 )
                      case OuterRatchetToReceiver_case_1
                      solve( !KU( 'g'^(x.18*~x.19*inv(~x.17)) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.22 ) @ #vk.8 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.22 ) @ #vk.8 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.22 ) @ #vk.8 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.22 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.24 ) @ #vk.10 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.23 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_3
                        by solve( !KU( ~x.23 ) @ #vk.8 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.23 ) @ #vk.8 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.23 ) @ #vk.8 )
                      next
                        case c_exp
                        by solve( !KU( ~x.19 ) @ #vk.10 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_2
                      solve( !KU( 'g'^(x.18*~x.19*inv(~x.17)) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.22 ) @ #vk.8 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.22 ) @ #vk.8 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.22 ) @ #vk.8 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.22 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.24 ) @ #vk.10 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.23 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_3
                        by solve( !KU( ~x.23 ) @ #vk.8 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.23 ) @ #vk.8 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.23 ) @ #vk.8 )
                      next
                        case c_exp
                        by solve( !KU( ~x.19 ) @ #vk.10 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( 'g'^(x.18*~x.19*inv(~x.17)) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.22 ) @ #vk.8 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.22 ) @ #vk.8 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.22 ) @ #vk.8 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.22 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.24 ) @ #vk.10 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.23 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_3
                        by solve( !KU( ~x.23 ) @ #vk.8 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.23 ) @ #vk.8 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.23 ) @ #vk.8 )
                      next
                        case c_exp
                        by solve( !KU( ~x.19 ) @ #vk.10 )
                      qed
                    next
                      case Receive
                      solve( NewDHSecrets( ~id.2, 'g'^~x.20, 'g'^(x.18*~x.19*inv(~x.17)),
                                           'g'^(x.18*x.21), kdf(<'rk', old_rk.1, x.11^(x.12*~x.19)>)
                             ) @ #b )
                        case OuterRatchetToReceiver_case_1
                        by contradiction /* cyclic */
                      next
                        case OuterRatchetToReceiver_case_2
                        by solve( !KU( ~x.24 ) @ #vk.3 )
                      next
                        case OuterRatchetToReceiver_case_3
                        solve( !KU( 'g'^(x.32*~x.33*inv(~x.34)) ) @ #vk.6 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.35 ) @ #vk.9 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.35 ) @ #vk.9 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.35 ) @ #vk.9 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.35 ) @ #vk.9 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.37 ) @ #vk.11 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.36 ) @ #vk.9 )
                        next
                          case OuterRatchetToSender_case_3
                          by solve( !KU( ~x.36 ) @ #vk.9 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.36 ) @ #vk.9 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.36 ) @ #vk.9 )
                        next
                          case c_exp
                          by solve( !KU( ~x.33 ) @ #vk.11 )
                        qed
                      next
                        case OuterRatchetToReceiver_case_4
                        by solve( !KU( ~x.23 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.24 ) @ #vk.3 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( Receive( m.4 ) @ #b )
                      next
                        case OuterRatchetToSender_case_3
                        by solve( !KU( ~x.23 ) @ #vk.5 )
                      qed
                    qed
                  next
                    case split_case_4
                    solve( Session( ~id.2, $A.1, 'R', drop.2, $B.1,
                                    'g'^(~x.18*inv((~x.17*x.19))),
                                    kdf(<'rk', old_rk.1, x.11^(x.12*~x.18)>), old_ck.2
                           ) ▶₂ #vr.2 )
                      case OuterRatchetToReceiver_case_1
                      solve( !KU( 'g'^(~x.18*inv((~x.17*x.19))) ) @ #vk.6 )
                        case OuterRatchetToSender
                        by solve( !KU( ~x.23 ) @ #vk.10 )
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.10 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_2
                      solve( !KU( 'g'^(~x.18*inv((~x.17*x.19))) ) @ #vk.6 )
                        case OuterRatchetToSender
                        by solve( !KU( ~x.23 ) @ #vk.10 )
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.10 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( 'g'^(~x.18*inv((~x.17*x.19))) ) @ #vk.6 )
                        case OuterRatchetToSender
                        by solve( !KU( ~x.23 ) @ #vk.10 )
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.10 )
                      qed
                    next
                      case Receive
                      solve( NewDHSecrets( ~id.2, 'g'^~x.20,
                                           'g'^(~x.18*inv((~x.17*x.19))), 'g'^(~x.18*x.21),
                                           kdf(<'rk', old_rk.1, x.11^(x.12*~x.18)>)
                             ) @ #b )
                        case OuterRatchetToReceiver
                        solve( !KU( 'g'^(~x.18*inv((~x.17*x.19))) ) @ #vk.7 )
                          case OuterRatchetToSender
                          by solve( !KU( ~x.43 ) @ #vk.11 )
                        next
                          case c_exp
                          by solve( !KU( ~x.18 ) @ #vk.11 )
                        qed
                      next
                        case OuterRatchetToSender
                        by solve( Receive( m.4 ) @ #b )
                      qed
                    qed
                  next
                    case split_case_5
                    solve( Session( ~id.2, $A.1, 'R', drop.2, $B.1,
                                    'g'^(~x.18*x.19*inv((~x.17*x.20))),
                                    kdf(<'rk', old_rk.1, x.11^(x.12*~x.18)>), old_ck.2
                           ) ▶₂ #vr.2 )
                      case OuterRatchetToReceiver_case_1
                      solve( !KU( 'g'^(~x.18*x.19*inv((~x.17*x.20))) ) @ #vk.8 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.24 ) @ #vk.11 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.24 ) @ #vk.11 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.24 ) @ #vk.11 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.24 ) @ #vk.11 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.25 ) @ #vk.11 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.26 ) @ #vk.14 )
                      next
                        case OuterRatchetToSender_case_3
                        by solve( !KU( ~x.25 ) @ #vk.11 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.25 ) @ #vk.11 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.25 ) @ #vk.11 )
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.12 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_2
                      solve( !KU( 'g'^(~x.18*x.19*inv((~x.17*x.20))) ) @ #vk.8 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.24 ) @ #vk.11 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.24 ) @ #vk.11 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.24 ) @ #vk.11 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.24 ) @ #vk.11 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.25 ) @ #vk.11 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.26 ) @ #vk.14 )
                      next
                        case OuterRatchetToSender_case_3
                        by solve( !KU( ~x.25 ) @ #vk.11 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.25 ) @ #vk.11 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.25 ) @ #vk.11 )
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.12 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( 'g'^(~x.18*x.19*inv((~x.17*x.20))) ) @ #vk.8 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.24 ) @ #vk.11 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.24 ) @ #vk.11 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.24 ) @ #vk.11 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.24 ) @ #vk.11 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.25 ) @ #vk.11 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.26 ) @ #vk.14 )
                      next
                        case OuterRatchetToSender_case_3
                        by solve( !KU( ~x.25 ) @ #vk.11 )
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.25 ) @ #vk.11 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.25 ) @ #vk.11 )
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.12 )
                      qed
                    next
                      case Receive
                      solve( NewDHSecrets( ~id.2, 'g'^~x.21,
                                           'g'^(~x.18*x.19*inv((~x.17*x.20))), 'g'^(x.22*x.23*x.24),
                                           kdf(<'rk', old_rk.1, x.11^(x.12*~x.18)>)
                             ) @ #b )
                        case OuterRatchetToReceiver_case_1
                        solve( !KU( 'g'^(x.19*~x.26*inv((~x.17*x.20))) ) @ #vk.9 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.49 ) @ #vk.12 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.48 ) @ #vk.24 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.49 ) @ #vk.12 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.48 ) @ #vk.24 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.51 ) @ #vk.15 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.50 ) @ #vk.12 )
                        next
                          case OuterRatchetToSender_case_3
                          by solve( !KU( ~x.48 ) @ #vk.24 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.50 ) @ #vk.12 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.48 ) @ #vk.24 )
                        next
                          case c_exp
                          by solve( !KU( ~x.26 ) @ #vk.14 )
                        qed
                      next
                        case OuterRatchetToReceiver_case_2
                        solve( !KU( 'g'^(x.19*~x.26*inv((~x.17*x.20))) ) @ #vk.9 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.48 ) @ #vk.12 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.48 ) @ #vk.24 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.48 ) @ #vk.12 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.48 ) @ #vk.24 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.50 ) @ #vk.15 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.49 ) @ #vk.12 )
                        next
                          case OuterRatchetToSender_case_3
                          by solve( !KU( ~x.49 ) @ #vk.24 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.49 ) @ #vk.12 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.49 ) @ #vk.24 )
                        next
                          case c_exp
                          by solve( !KU( ~x.26 ) @ #vk.14 )
                        qed
                      next
                        case OuterRatchetToReceiver_case_3
                        solve( !KU( 'g'^(x.19*~x.34*inv((~x.32*x.33))) ) @ #vk.9 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.57 ) @ #vk.15 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.57 ) @ #vk.15 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.57 ) @ #vk.15 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.57 ) @ #vk.15 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.59 ) @ #vk.18 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.58 ) @ #vk.15 )
                        next
                          case OuterRatchetToSender_case_3
                          by solve( !KU( ~x.58 ) @ #vk.15 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.58 ) @ #vk.15 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.58 ) @ #vk.15 )
                        next
                          case c_exp
                          by solve( !KU( ~x.34 ) @ #vk.17 )
                        qed
                      next
                        case OuterRatchetToReceiver_case_4
                        by solve( !KU( ~x.36 ) @ #vk.15 )
                      next
                        case OuterRatchetToReceiver_case_5
                        by solve( !KU( ~x.26 ) @ #vk.15 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( Receive( m.4 ) @ #b )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( Receive( m.4 ) @ #b )
                      next
                        case OuterRatchetToSender_case_3
                        by contradiction /* cyclic */
                      next
                        case OuterRatchetToSender_case_4
                        by solve( !KU( ~x.36 ) @ #vk.12 )
                      next
                        case OuterRatchetToSender_case_5
                        by solve( !KU( ~x.26 ) @ #vk.12 )
                      qed
                    qed
                  qed
                next
                  case split_case_5
                  by solve( !KU( ~x.13 ) @ #vk.7 )
                qed
              next
                case split_case_4
                solve( splitEqs(2) )
                  case split_case_1
                  by solve( !KU( ~x.11 ) @ #vk.4 )
                next
                  case split_case_2
                  by solve( !KU( ~x.11 ) @ #vk.6 )
                next
                  case split_case_3
                  by solve( !KU( ~x.11 ) @ #vk.5 )
                next
                  case split_case_4
                  solve( !KU( 'g'^x.11 ) @ #vk.1 )
                    case KeyGen_case_1
                    by solve( !KU( ~ltk ) @ #vk.3 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~ltk ) @ #vk.5 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~prek ) @ #vk.3 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~prek ) @ #vk.5 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.15 ) @ #vk.3 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.15 ) @ #vk.5 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.15 ) @ #vk.3 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.15 ) @ #vk.5 )
                  next
                    case c_exp
                    solve( splitEqs(3) )
                      case split_case_1
                      by solve( !KU( ~x.15 ) @ #vk.5 )
                    next
                      case split_case_2
                      by solve( !KU( ~x.15 ) @ #vk.6 )
                    next
                      case split_case_3
                      solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2, z.4^inv(~x.17),
                                      old_rk.1, old_ck.1
                             ) ▶₂ #vr.1 )
                        case OuterRatchetToReceiver_case_1
                        solve( !KU( z.4^inv(~x.17) ) @ #vk.7 )
                          case c_exp
                          by contradiction /* cyclic */
                        qed
                      next
                        case OuterRatchetToReceiver_case_2
                        solve( !KU( z.4^inv(~x.17) ) @ #vk.7 )
                          case c_exp
                          by contradiction /* cyclic */
                        qed
                      next
                        case OuterRatchetToReceiver_case_3
                        solve( !KU( z.4^inv(~x.17) ) @ #vk.7 )
                          case c_exp
                          by contradiction /* cyclic */
                        qed
                      next
                        case Receive
                        solve( NewDHSecrets( ~id.3, 'g'^~x.18, z.4^inv(~x.17), z.6,
                                             old_rk.1
                               ) @ #b )
                          case OuterRatchetToReceiver
                          solve( !KU( z.4^inv(~x.17) ) @ #vk.8 )
                            case c_exp
                            by contradiction /* cyclic */
                          qed
                        next
                          case OuterRatchetToSender
                          by solve( Receive( m.4 ) @ #b )
                        next
                          case ReceiverStart
                          solve( !KU( z.4^inv(~x.17) ) @ #vk.8 )
                            case c_exp
                            by contradiction /* cyclic */
                          qed
                        next
                          case SenderStart
                          solve( !SecretKeys( $A.3, ~ltk, prek ) ▶₃ #b )
                            case KeyGen
                            by solve( !PublicKeys( $B.3, ltpk, z.4^inv(~x.17) ) ▶₄ #b )
                          qed
                        qed
                      next
                        case ReceiverStart
                        solve( !KU( z.4^inv(~x.17) ) @ #vk.7 )
                          case c_exp
                          by contradiction /* cyclic */
                        qed
                      qed
                    next
                      case split_case_4
                      solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2, z.4^inv(~x.16),
                                      old_rk.1, old_ck.1
                             ) ▶₂ #vr.1 )
                        case OuterRatchetToReceiver_case_1
                        solve( !KU( z.4^inv(~x.16) ) @ #vk.8 )
                          case c_exp
                          by contradiction /* cyclic */
                        qed
                      next
                        case OuterRatchetToReceiver_case_2
                        solve( !KU( z.4^inv(~x.16) ) @ #vk.8 )
                          case c_exp
                          by contradiction /* cyclic */
                        qed
                      next
                        case OuterRatchetToReceiver_case_3
                        solve( !KU( z.4^inv(~x.16) ) @ #vk.8 )
                          case c_exp
                          by contradiction /* cyclic */
                        qed
                      next
                        case Receive
                        solve( NewDHSecrets( ~id.3, 'g'^~x.18, z.4^inv(~x.16), z.6,
                                             old_rk.1
                               ) @ #b )
                          case OuterRatchetToReceiver
                          solve( !KU( z.4^inv(~x.16) ) @ #vk.9 )
                            case c_exp
                            by contradiction /* cyclic */
                          qed
                        next
                          case OuterRatchetToSender
                          by solve( Receive( m.4 ) @ #b )
                        next
                          case ReceiverStart
                          solve( !KU( z.4^inv(~x.16) ) @ #vk.9 )
                            case c_exp
                            by contradiction /* cyclic */
                          qed
                        next
                          case SenderStart
                          solve( !SecretKeys( $A.3, ~ltk, prek ) ▶₃ #b )
                            case KeyGen
                            by solve( !PublicKeys( $B.3, ltpk, z.4^inv(~x.16) ) ▶₄ #b )
                          qed
                        qed
                      next
                        case ReceiverStart
                        solve( !KU( z.4^inv(~x.16) ) @ #vk.8 )
                          case c_exp
                          by contradiction /* cyclic */
                        qed
                      qed
                    next
                      case split_case_5
                      solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2, z.4^inv(~x.16),
                                      old_rk.1, old_ck.1
                             ) ▶₂ #vr.1 )
                        case OuterRatchetToReceiver_case_1
                        solve( !KU( z.4^inv(~x.16) ) @ #vk.10 )
                          case c_exp
                          by contradiction /* cyclic */
                        qed
                      next
                        case OuterRatchetToReceiver_case_2
                        solve( !KU( z.4^inv(~x.16) ) @ #vk.10 )
                          case c_exp
                          by contradiction /* cyclic */
                        qed
                      next
                        case OuterRatchetToReceiver_case_3
                        solve( !KU( z.4^inv(~x.16) ) @ #vk.10 )
                          case c_exp
                          by contradiction /* cyclic */
                        qed
                      next
                        case Receive
                        solve( NewDHSecrets( ~id.3, 'g'^~x.19, z.4^inv(~x.16), z.6,
                                             old_rk.1
                               ) @ #b )
                          case OuterRatchetToReceiver
                          solve( !KU( z.4^inv(~x.16) ) @ #vk.11 )
                            case c_exp
                            by contradiction /* cyclic */
                          qed
                        next
                          case OuterRatchetToSender
                          by solve( Receive( m.4 ) @ #b )
                        next
                          case ReceiverStart
                          solve( !KU( z.4^inv(~x.16) ) @ #vk.11 )
                            case c_exp
                            by contradiction /* cyclic */
                          qed
                        next
                          case SenderStart
                          solve( !SecretKeys( $A.3, ~ltk, prek ) ▶₃ #b )
                            case KeyGen
                            by solve( !PublicKeys( $B.3, ltpk, z.4^inv(~x.16) ) ▶₄ #b )
                          qed
                        qed
                      next
                        case ReceiverStart
                        solve( !KU( z.4^inv(~x.16) ) @ #vk.10 )
                          case c_exp
                          by contradiction /* cyclic */
                        qed
                      qed
                    qed
                  qed
                next
                  case split_case_5
                  by solve( !KU( ~x.11 ) @ #vk.7 )
                qed
              next
                case split_case_5
                solve( Session( ~id.2, $A.1, 'R', drop.2, $B.1, pc.1,
                                kdf(<'rk', old_rk.1, x.11^inv(x.12)>), old_ck.2
                       ) ▶₂ #vr.2 )
                  case OuterRatchetToReceiver_case_1
                  solve( !KU( 'g'^inv((x.14*~x.15)) ) @ #vk.5 )
                    case c_exp
                    by solve( !KU( ~x.15 ) @ #vk.11 )
                  qed
                next
                  case OuterRatchetToReceiver_case_2
                  solve( !KU( 'g'^inv((x.14*~x.15)) ) @ #vk.5 )
                    case c_exp
                    solve( !KU( ~x.15 ) @ #vk.11 )
                      case OuterRatchetToSender
                      solve( NewDHSecrets( ~id.2, 'g'^~x.15, old_pc.1, z.4, old_rk.1
                             ) @ #b )
                        case OuterRatchetToReceiver
                        solve( Session( ~id.5, $A.1, 'S', ~x.20, $B.1, old_pc.2, old_rk.4,
                                        old_ck.5
                               ) ▶₁ #b )
                          case Send
                          by solve( Send( m.5 ) @ #b )
                        qed
                      next
                        case ReceiverStart
                        by solve( !SecretKeys( $A.4, ~ltk, ~prek ) ▶₁ #b )
                      qed
                    next
                      case Send
                      solve( NewDHSecrets( ~id.2, 'g'^~x.15, old_pc.1, z.4, old_rk.1
                             ) @ #b )
                        case OuterRatchetToReceiver
                        solve( Session( ~id.5, $A.1, 'S', ~x.20, $B.1, old_pc.2, old_rk.3,
                                        old_ck.4
                               ) ▶₁ #b )
                          case Send
                          by solve( Send( m.5 ) @ #b )
                        qed
                      next
                        case ReceiverStart
                        by solve( !SecretKeys( $A.4, ~ltk, ~prek ) ▶₁ #b )
                      qed
                    next
                      case SenderStart
                      by contradiction /* cyclic */
                    next
                      case fresh
                      solve( NewDHSecrets( ~id.2, 'g'^~x.15, old_pc.1, z.4, old_rk.1
                             ) @ #b )
                        case OuterRatchetToReceiver
                        solve( Session( ~id.4, $A.1, 'S', ~x.19, $B.1, old_pc.2, old_rk.3,
                                        old_ck.4
                               ) ▶₁ #b )
                          case Send
                          by solve( Send( m.5 ) @ #b )
                        qed
                      next
                        case ReceiverStart
                        by solve( !SecretKeys( $A.3, ~ltk, ~prek ) ▶₁ #b )
                      qed
                    qed
                  qed
                next
                  case OuterRatchetToReceiver_case_3
                  solve( !KU( 'g'^inv((x.14*~x.15)) ) @ #vk.5 )
                    case c_exp
                    by solve( !KU( ~x.15 ) @ #vk.11 )
                  qed
                next
                  case Receive
                  solve( NewDHSecrets( ~id.2, 'g'^~x.13, pc.1, z.5,
                                       kdf(<'rk', old_rk.1, x.11^inv(x.12)>)
                         ) @ #b )
                    case OuterRatchetToReceiver
                    solve( !KU( 'g'^inv((~x.17*x.20)) ) @ #vk.6 )
                      case c_exp
                      solve( !KU( ~x.17 ) @ #vk.11 )
                        case OuterRatchetToSender
                        solve( Session( ~id.4, $A.1, 'S', ~x.17, $B.1, old_pc.1, old_rk.4,
                                        old_ck.4
                               ) ▶₁ #b )
                          case Send
                          solve( Receive( m.4 ) @ #b )
                            case OuterRatchetToReceiver
                            solve( NewDHSecrets( ~id.4, 'g'^~x.17, old_pc.1, z.11, old_rk.4
                                   ) @ #b.1 )
                              case OuterRatchetToReceiver
                              solve( Session( ~id.6, $A.5, 'S', ~x.22, $B.5, old_pc.2, old_rk.6,
                                              old_ck.6
                                     ) ▶₁ #b.1 )
                                case Send
                                by solve( Send( m.6 ) @ #b.1 )
                              qed
                            next
                              case ReceiverStart
                              by solve( !SecretKeys( $A.5, ~ltk, ~prek ) ▶₁ #b.1 )
                            qed
                          qed
                        qed
                      next
                        case Send
                        solve( Session( ~id.4, $A.1, 'S', ~x.17, $B.1, old_pc.1, old_rk.4,
                                        old_ck.4
                               ) ▶₁ #b )
                          case Send
                          solve( Receive( m.4 ) @ #b )
                            case OuterRatchetToReceiver
                            solve( NewDHSecrets( ~id.5, 'g'^~x.21, pc.4, z.10, rk.1 ) @ #b.1 )
                              case OuterRatchetToReceiver
                              solve( Session( ~id.6, $A.4, 'S', ~x.22, $B.4, old_pc.2, old_rk.5,
                                              old_ck.5
                                     ) ▶₁ #b.1 )
                                case OuterRatchetToSender
                                by solve( Send( m.5 ) @ #b.1 )
                              next
                                case Send
                                by solve( Send( m.5 ) @ #b.1 )
                              next
                                case SenderStart
                                solve( !KU( senc(z.13,
                                                 kdf(<'mk', 
                                                      kdf(<'ck', 
                                                           kdf(<'rk', 
                                                                kdf(<'rk', 
                                                                     kdf(<'g'^(~ltk*~prek.1), 
                                                                          'g'^(~ltk.1*~x.22), 
                                                                          'g'^(~prek.1*~x.22)>)
                                                                    >), 
                                                                z.12>)
                                                          >)
                                                     >))
                                       ) @ #vk.16 )
                                  case OuterRatchetToSender
                                  by solve( Send( m.5 ) @ #b.1 )
                                next
                                  case Send
                                  by solve( Send( m.5 ) @ #b.1 )
                                next
                                  case c_senc
                                  solve( !KU( kdf(<'mk', 
                                                   kdf(<'ck', 
                                                        kdf(<'rk', 
                                                             kdf(<'rk', 
                                                                  kdf(<'g'^(~ltk*~prek.1), 
                                                                       'g'^(~ltk.1*~x.22), 
                                                                       'g'^(~prek.1*~x.22)>)
                                                                 >), 
                                                             z.12>)
                                                       >)
                                                  >)
                                         ) @ #vk.18 )
                                    case c_kdf
                                    solve( !KU( kdf(<'ck', 
                                                     kdf(<'rk', 
                                                          kdf(<'rk', 
                                                               kdf(<'g'^(~ltk*~prek.1), 
                                                                    'g'^(~ltk.1*~x.22), 
                                                                    'g'^(~prek.1*~x.22)>)
                                                              >), 
                                                          z.12>)
                                                    >)
                                           ) @ #vk.21 )
                                      case c_kdf
                                      solve( !KU( kdf(<'rk', 
                                                       kdf(<'rk', 
                                                            kdf(<'g'^(~ltk*~prek.1), 
                                                                 'g'^(~ltk.1*~x.22), 
                                                                 'g'^(~prek.1*~x.22)>)
                                                           >), 
                                                       z.12>)
                                             ) @ #vk.24 )
                                        case c_kdf
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case OuterRatchetToSender
                              solve( Send( m.5 ) @ #b.1 )
                                case OuterRatchetToSender
                                solve( NewDHSecrets( ~id.4, 'g'^~x.17, old_pc.1, z.11, old_rk.4
                                       ) @ #b.2 )
                                  case OuterRatchetToReceiver
                                  solve( Session( ~id.7, $A.6, 'S', ~x.23, $B.6, old_pc.2, old_rk.6,
                                                  old_ck.6
                                         ) ▶₁ #b.2 )
                                    case Send
                                    by solve( Send( m.7 ) @ #b.2 )
                                  qed
                                next
                                  case ReceiverStart
                                  by solve( !SecretKeys( $A.6, ~ltk, ~prek ) ▶₁ #b.2 )
                                qed
                              qed
                            next
                              case ReceiverStart
                              solve( !SecretKeys( $A.5, ~ltk, ~prek ) ▶₁ #b.1 )
                                case KeyGen
                                solve( !PublicKeys( $B.5, ltpk, prepk ) ▶₂ #b.1 )
                                  case KeyGen
                                  by solve( Send( m.5 ) @ #b.1 )
                                qed
                              qed
                            next
                              case SenderStart
                              solve( !SecretKeys( $A.5, ~ltk, prek ) ▶₃ #b.1 )
                                case KeyGen
                                solve( !PublicKeys( $B.5, ltpk, prepk ) ▶₄ #b.1 )
                                  case KeyGen
                                  solve( Send( m.5 ) @ #b.1 )
                                    case SenderStart
                                    solve( NewDHSecrets( ~id.4, 'g'^~x.17, old_pc.1, z.11, old_rk.4
                                           ) @ #b.2 )
                                      case OuterRatchetToReceiver
                                      solve( Session( ~id.7, $A.6, 'S', ~x.24, $B.6, old_pc.2,
                                                      old_rk.5, old_ck.5
                                             ) ▶₁ #b.2 )
                                        case Send
                                        by solve( Send( m.7 ) @ #b.2 )
                                      qed
                                    next
                                      case ReceiverStart
                                      by solve( !SecretKeys( $A.6, ~ltk.4, ~prek.4 ) ▶₁ #b.2 )
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case SenderStart
                        by contradiction /* cyclic */
                      next
                        case fresh
                        solve( Session( ~id.4, $A.1, 'S', ~x.17, $B.1, old_pc.1, old_rk.4,
                                        old_ck.4
                               ) ▶₁ #b )
                          case Send
                          solve( Receive( m.4 ) @ #b )
                            case OuterRatchetToReceiver
                            solve( NewDHSecrets( ~id.4, 'g'^~x.17, old_pc.1, z.10, old_rk.4
                                   ) @ #b.1 )
                              case OuterRatchetToReceiver
                              solve( Session( ~id.5, $A.4, 'S', ~x.21, $B.4, old_pc.2, old_rk.5,
                                              old_ck.5
                                     ) ▶₁ #b.1 )
                                case Send
                                by solve( Send( m.6 ) @ #b.1 )
                              qed
                            next
                              case ReceiverStart
                              by solve( !SecretKeys( $A.4, ~ltk, ~prek ) ▶₁ #b.1 )
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    by solve( Receive( m.4 ) @ #b )
                  qed
                qed
              next
                case split_case_6
                solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                x.11^(x.12*inv(~x.10)), old_rk.1, old_ck.1
                       ) ▶₂ #vr.1 )
                  case OuterRatchetToReceiver_case_1
                  solve( !KU( x.11^(x.12*inv(~x.10)) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.16 ) @ #vk.8 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.17 ) @ #vk.10 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.16 ) @ #vk.8 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.17 ) @ #vk.10 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.17 ) @ #vk.8 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.18 ) @ #vk.10 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.17 ) @ #vk.8 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.18 ) @ #vk.10 )
                  next
                    case c_exp
                    by solve( !KU( ~x.10 ) @ #vk.11 )
                  qed
                next
                  case OuterRatchetToReceiver_case_2
                  solve( !KU( x.11^(x.12*inv(~x.10)) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.16 ) @ #vk.8 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.17 ) @ #vk.10 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.16 ) @ #vk.8 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.17 ) @ #vk.10 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.17 ) @ #vk.8 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.18 ) @ #vk.10 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.17 ) @ #vk.8 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.18 ) @ #vk.10 )
                  next
                    case c_exp
                    by solve( !KU( ~x.10 ) @ #vk.11 )
                  qed
                next
                  case OuterRatchetToReceiver_case_3
                  solve( !KU( x.11^(x.12*inv(~x.10)) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.16 ) @ #vk.8 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.17 ) @ #vk.10 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.16 ) @ #vk.8 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.17 ) @ #vk.10 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.17 ) @ #vk.8 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.18 ) @ #vk.10 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.17 ) @ #vk.8 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.18 ) @ #vk.10 )
                  next
                    case c_exp
                    by solve( !KU( ~x.10 ) @ #vk.11 )
                  qed
                next
                  case Receive
                  solve( NewDHSecrets( ~id.3, 'g'^~x.13, x.11^(x.12*inv(~x.10)),
                                       x.11^x.14, old_rk.1
                         ) @ #b )
                    case OuterRatchetToReceiver
                    solve( !KU( x.11^(x.12*inv(~x.10)) ) @ #vk.6 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.31 ) @ #vk.9 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.32 ) @ #vk.11 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.31 ) @ #vk.9 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.32 ) @ #vk.11 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.32 ) @ #vk.9 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.33 ) @ #vk.11 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.32 ) @ #vk.9 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.33 ) @ #vk.11 )
                    next
                      case c_exp
                      by solve( !KU( ~x.10 ) @ #vk.12 )
                    qed
                  next
                    case OuterRatchetToSender
                    by solve( Receive( m.4 ) @ #b )
                  next
                    case ReceiverStart
                    solve( !KU( x.11^(x.12*inv(~x.10)) ) @ #vk.6 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.37 ) @ #vk.9 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.38 ) @ #vk.11 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.37 ) @ #vk.9 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.38 ) @ #vk.11 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.38 ) @ #vk.9 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.39 ) @ #vk.11 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.38 ) @ #vk.9 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.39 ) @ #vk.11 )
                    next
                      case c_exp
                      by solve( !KU( ~x.10 ) @ #vk.12 )
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.3, ~ltk, prek ) ▶₃ #b )
                      case KeyGen
                      by solve( !PublicKeys( $B.3, ltpk, x.11^(x.12*inv(~x.10)) ) ▶₄ #b )
                    qed
                  qed
                next
                  case ReceiverStart
                  solve( !KU( x.11^(x.12*inv(~x.10)) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.16 ) @ #vk.8 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.17 ) @ #vk.10 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.16 ) @ #vk.8 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.17 ) @ #vk.10 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.17 ) @ #vk.8 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.18 ) @ #vk.10 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.17 ) @ #vk.8 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.18 ) @ #vk.10 )
                  next
                    case c_exp
                    by solve( !KU( ~x.10 ) @ #vk.11 )
                  qed
                qed
              next
                case split_case_7
                solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                x.11^(x.12*inv((~x.10*x.13))), old_rk.1, old_ck.1
                       ) ▶₂ #vr.1 )
                  case OuterRatchetToReceiver_case_1
                  solve( !KU( x.11^(x.12*inv((~x.10*x.13))) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.17 ) @ #vk.9 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.18 ) @ #vk.11 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.17 ) @ #vk.9 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.18 ) @ #vk.11 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.18 ) @ #vk.9 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.19 ) @ #vk.11 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.18 ) @ #vk.9 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.19 ) @ #vk.11 )
                  next
                    case c_exp
                    by solve( !KU( ~x.10 ) @ #vk.12 )
                  qed
                next
                  case OuterRatchetToReceiver_case_2
                  solve( !KU( x.11^(x.12*inv((~x.10*x.13))) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.17 ) @ #vk.9 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.18 ) @ #vk.11 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.17 ) @ #vk.9 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.18 ) @ #vk.11 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.18 ) @ #vk.9 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.19 ) @ #vk.11 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.18 ) @ #vk.9 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.19 ) @ #vk.11 )
                  next
                    case c_exp
                    by solve( !KU( ~x.10 ) @ #vk.12 )
                  qed
                next
                  case OuterRatchetToReceiver_case_3
                  solve( !KU( x.11^(x.12*inv((~x.10*x.13))) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.17 ) @ #vk.9 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.18 ) @ #vk.11 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.17 ) @ #vk.9 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.18 ) @ #vk.11 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.18 ) @ #vk.9 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.19 ) @ #vk.11 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.18 ) @ #vk.9 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.19 ) @ #vk.11 )
                  next
                    case c_exp
                    by solve( !KU( ~x.10 ) @ #vk.12 )
                  qed
                next
                  case Receive
                  solve( NewDHSecrets( ~id.3, 'g'^~x.14,
                                       x.11^(x.12*inv((~x.10*x.13))), x.11^(x.12*x.15), old_rk.1
                         ) @ #b )
                    case OuterRatchetToReceiver
                    solve( !KU( x.11^(x.12*inv((~x.10*x.13))) ) @ #vk.6 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.34 ) @ #vk.10 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.35 ) @ #vk.12 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.34 ) @ #vk.10 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.35 ) @ #vk.12 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.35 ) @ #vk.10 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.36 ) @ #vk.12 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.35 ) @ #vk.10 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.36 ) @ #vk.12 )
                    next
                      case c_exp
                      by solve( !KU( ~x.10 ) @ #vk.13 )
                    qed
                  next
                    case OuterRatchetToSender
                    by solve( Receive( m.4 ) @ #b )
                  next
                    case ReceiverStart
                    solve( !KU( x.11^(x.12*inv((~x.10*x.13))) ) @ #vk.6 )
                      case KeyGen_case_1
                      by solve( !KU( ~x.44 ) @ #vk.10 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.45 ) @ #vk.12 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.44 ) @ #vk.10 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.45 ) @ #vk.12 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.45 ) @ #vk.10 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.46 ) @ #vk.12 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.45 ) @ #vk.10 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.46 ) @ #vk.12 )
                    next
                      case c_exp
                      by solve( !KU( ~x.10 ) @ #vk.13 )
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.3, ~ltk, prek ) ▶₃ #b )
                      case KeyGen
                      by solve( !PublicKeys( $B.3, ltpk, x.11^(x.12*inv((~x.10*x.13)))
                                ) ▶₄ #b )
                    qed
                  qed
                next
                  case ReceiverStart
                  solve( !KU( x.11^(x.12*inv((~x.10*x.13))) ) @ #vk.5 )
                    case KeyGen_case_1
                    by solve( !KU( ~x.17 ) @ #vk.9 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.18 ) @ #vk.11 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.17 ) @ #vk.9 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.18 ) @ #vk.11 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.18 ) @ #vk.9 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.19 ) @ #vk.11 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.18 ) @ #vk.9 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.19 ) @ #vk.11 )
                  next
                    case c_exp
                    by solve( !KU( ~x.10 ) @ #vk.12 )
                  qed
                qed
              qed
            next
              case SenderStart_case_1
              by solve( !KU( ~x.9 ) @ #vk.3 )
            next
              case SenderStart_case_2
              by solve( !KU( ~x.9 ) @ #vk.4 )
            next
              case c_exp
              by solve( !KU( ~x.5 ) @ #vk.5 )
            qed
          next
            case split_case_4
            solve( !KU( z.3^inv(~x.5) ) @ #vk.1 )
              case c_exp
              by contradiction /* node #t after last node #vk.3 */
            qed
          next
            case split_case_5
            solve( !KU( x.6^inv((~x.5*x.7)) ) @ #vk.1 )
              case c_exp
              by solve( !KU( ~x.5 ) @ #vk.6 )
            qed
          next
            case split_case_6
            solve( !KU( x.6^(x.7*inv(~x.5)) ) @ #vk.1 )
              case KeyGen_case_1
              by solve( !KU( ~x.10 ) @ #vk.4 )
            next
              case KeyGen_case_2
              by solve( !KU( ~x.11 ) @ #vk.6 )
            next
              case KeyGen_case_3
              by solve( !KU( ~x.10 ) @ #vk.4 )
            next
              case KeyGen_case_4
              by solve( !KU( ~x.11 ) @ #vk.6 )
            next
              case OuterRatchetToSender_case_1
              by solve( !KU( ~x.11 ) @ #vk.4 )
            next
              case OuterRatchetToSender_case_2
              by solve( !KU( ~x.12 ) @ #vk.6 )
            next
              case SenderStart_case_1
              by solve( !KU( ~x.11 ) @ #vk.4 )
            next
              case SenderStart_case_2
              by solve( !KU( ~x.12 ) @ #vk.6 )
            next
              case c_exp
              by solve( !KU( ~x.5 ) @ #vk.7 )
            qed
          next
            case split_case_7
            solve( !KU( x.6^(x.7*inv((~x.5*x.8))) ) @ #vk.1 )
              case KeyGen_case_1
              by solve( !KU( ~x.15 ) @ #vk.5 )
            next
              case KeyGen_case_2
              by solve( !KU( ~x.16 ) @ #vk.7 )
            next
              case KeyGen_case_3
              by solve( !KU( ~x.15 ) @ #vk.5 )
            next
              case KeyGen_case_4
              by solve( !KU( ~x.16 ) @ #vk.7 )
            next
              case OuterRatchetToSender_case_1
              by solve( !KU( ~x.16 ) @ #vk.5 )
            next
              case OuterRatchetToSender_case_2
              by solve( !KU( ~x.17 ) @ #vk.7 )
            next
              case SenderStart_case_1
              by solve( !KU( ~x.16 ) @ #vk.5 )
            next
              case SenderStart_case_2
              by solve( !KU( ~x.17 ) @ #vk.7 )
            next
              case c_exp
              by solve( !KU( ~x.5 ) @ #vk.8 )
            qed
          qed
        next
          case Send
          by solve( Session( ~id.2, $A.1, 'S', ~x.4, $B.1, pc.1, rk.1,
                             kdf(<'rk', kdf(<'rk', old_rk.1, z.1>), z.2>)
                    ) ▶₁ #vr.2 )
        next
          case c_senc
          solve( !KU( kdf(<'mk', 
                           kdf(<'ck', kdf(<'rk', kdf(<'rk', old_rk.1, z.1>), z.2>)>)>)
                 ) @ #vk.4 )
            case c_kdf
            solve( !KU( kdf(<'ck', kdf(<'rk', kdf(<'rk', old_rk.1, z.1>), z.2>)
                            >)
                   ) @ #vk.7 )
              case c_kdf
              solve( !KU( kdf(<'rk', kdf(<'rk', old_rk.1, z.1>), z.2>)
                     ) @ #vk.10 )
                case c_kdf
                by contradiction /* node #t after last node #x */
              qed
            qed
          qed
        qed
      next
        case Receive
        solve( NewDHSecrets( ~id.1, 'g'^~x.2, pc, z.2, old_rk ) @ #b )
          case OuterRatchetToReceiver
          solve( Receive( m.1 ) @ #b )
            case OuterRatchetToReceiver
            solve( !KU( senc(x.4,
                             kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.1, z.3>)>)>))
                   ) @ #vk.3 )
              case OuterRatchetToSender
              solve( splitEqs(0) )
                case split_case_1
                solve( !KU( z.6^inv(~x.18) ) @ #vk.2 )
                  case c_exp
                  by contradiction /* node #b after last node #vk.4 */
                qed
              next
                case split_case_2
                by contradiction /* from formulas */
              next
                case split_case_3
                solve( !KU( pc.4^~x.18 ) @ #x )
                  case OuterRatchetToSender
                  by contradiction /* from formulas */
                next
                  case c_exp
                  by solve( !KU( ~x.18 ) @ #vk.5 )
                qed
              next
                case split_case_4
                solve( splitEqs(1) )
                  case split_case_1
                  solve( !KU( z.7^(~x.18*inv(~x.21)) ) @ #x )
                    case OuterRatchetToSender
                    solve( !KU( ~x.24 ) @ #vk.5 )
                      case OuterRatchetToSender
                      solve( !KU( 'g'^inv(~x.24) ) @ #vk.2 )
                        case c_exp
                        by contradiction /* cyclic */
                      qed
                    next
                      case Send
                      solve( !KU( 'g'^inv(~x.24) ) @ #vk.2 )
                        case c_exp
                        by contradiction /* cyclic */
                      qed
                    next
                      case SenderStart
                      by contradiction /* cyclic */
                    next
                      case fresh
                      solve( !KU( 'g'^inv(~x.24) ) @ #vk.2 )
                        case c_exp
                        by contradiction /* cyclic */
                      qed
                    qed
                  next
                    case c_exp
                    by contradiction /* cyclic */
                  qed
                next
                  case split_case_2
                  solve( splitEqs(3) )
                    case split_case_1
                    solve( !KU( x.22^(~x.18*~x.26) ) @ #x )
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.29 ) @ #vk.4 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.29 ) @ #vk.4 )
                    next
                      case c_exp
                      by solve( !KU( ~x.18 ) @ #vk.6 )
                    qed
                  next
                    case split_case_2
                    solve( !KU( x.22^(~x.18*x.27) ) @ #x )
                      case KeyGen_case_1
                      by solve( !KU( ~x.28 ) @ #vk.4 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.28 ) @ #vk.5 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.28 ) @ #vk.4 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.28 ) @ #vk.5 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.29 ) @ #vk.4 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.29 ) @ #vk.5 )
                    next
                      case OuterRatchetToSender_case_3
                      solve( Session( ~id.4, $A.3, 'S', ~x.26, $B.3, old_pc, old_rk.1,
                                      old_ck.1
                             ) ▶₁ #b )
                        case Send
                        solve( NewDHSecrets( ~id.4, 'g'^~x.26, old_pc, z.7, old_rk.1
                               ) @ #b.1 )
                          case OuterRatchetToReceiver
                          solve( Session( ~id.5, $A.4, 'S', ~x.30, $B.4, old_pc.1, old_rk.3,
                                          old_ck.4
                                 ) ▶₁ #b.1 )
                            case Send
                            by solve( Send( m.5 ) @ #b.1 )
                          qed
                        next
                          case ReceiverStart
                          by solve( !SecretKeys( $A.4, ~ltk, ~prek ) ▶₁ #b.1 )
                        qed
                      qed
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.29 ) @ #vk.4 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.29 ) @ #vk.5 )
                    next
                      case c_exp
                      by solve( !KU( ~x.18 ) @ #vk.6 )
                    qed
                  next
                    case split_case_3
                    solve( !KU( x.22^(~x.18*~x.26*x.28) ) @ #x )
                      case KeyGen_case_1
                      by solve( !KU( ~x.29 ) @ #vk.5 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~x.29 ) @ #vk.5 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~x.29 ) @ #vk.5 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~x.29 ) @ #vk.5 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.30 ) @ #vk.5 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.30 ) @ #vk.5 )
                    next
                      case OuterRatchetToSender_case_3
                      by solve( !KU( ~x.30 ) @ #vk.5 )
                    next
                      case OuterRatchetToSender_case_4
                      by solve( !KU( ~x.30 ) @ #vk.5 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.30 ) @ #vk.5 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.30 ) @ #vk.5 )
                    next
                      case c_exp
                      by solve( !KU( ~x.18 ) @ #vk.6 )
                    qed
                  next
                    case split_case_4
                    solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                    x.22^(~x.27*inv((~x.26*x.28))), old_rk.1, old_ck.2
                           ) ▶₂ #vr.1 )
                      case OuterRatchetToReceiver_case_1
                      solve( !KU( x.22^(~x.27*inv((~x.26*x.28))) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.32 ) @ #vk.9 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.32 ) @ #vk.9 )
                      next
                        case OuterRatchetToSender
                        by solve( !KU( ~x.33 ) @ #vk.9 )
                      next
                        case SenderStart
                        by solve( !KU( ~x.33 ) @ #vk.9 )
                      next
                        case c_exp
                        solve( !KU( ~x.27 ) @ #vk.9 )
                          case OuterRatchetToSender
                          by solve( !KU( ~x.26 ) @ #vk.12 )
                        next
                          case Send
                          by solve( !KU( ~x.26 ) @ #vk.12 )
                        next
                          case SenderStart
                          by contradiction /* node #b after last node #x */
                        next
                          case fresh
                          by solve( !KU( ~x.26 ) @ #vk.12 )
                        qed
                      qed
                    next
                      case OuterRatchetToReceiver_case_2
                      solve( !KU( x.22^(~x.27*inv((~x.26*x.28))) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.32 ) @ #vk.9 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.32 ) @ #vk.9 )
                      next
                        case OuterRatchetToSender
                        by solve( !KU( ~x.33 ) @ #vk.9 )
                      next
                        case SenderStart
                        by solve( !KU( ~x.33 ) @ #vk.9 )
                      next
                        case c_exp
                        solve( !KU( ~x.27 ) @ #vk.9 )
                          case OuterRatchetToSender
                          by solve( !KU( ~x.26 ) @ #vk.12 )
                        next
                          case Send
                          by solve( !KU( ~x.26 ) @ #vk.12 )
                        next
                          case SenderStart
                          by contradiction /* node #b after last node #x */
                        next
                          case fresh
                          by solve( !KU( ~x.26 ) @ #vk.12 )
                        qed
                      qed
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( x.22^(~x.27*inv((~x.26*x.28))) ) @ #vk.5 )
                        case KeyGen_case_1
                        by solve( !KU( ~x.32 ) @ #vk.9 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.32 ) @ #vk.9 )
                      next
                        case OuterRatchetToSender
                        by solve( !KU( ~x.33 ) @ #vk.9 )
                      next
                        case SenderStart
                        by solve( !KU( ~x.33 ) @ #vk.9 )
                      next
                        case c_exp
                        solve( !KU( ~x.27 ) @ #vk.9 )
                          case OuterRatchetToSender
                          by solve( !KU( ~x.26 ) @ #vk.12 )
                        next
                          case Send
                          by solve( !KU( ~x.26 ) @ #vk.12 )
                        next
                          case SenderStart
                          by contradiction /* node #b after last node #x */
                        next
                          case fresh
                          by solve( !KU( ~x.26 ) @ #vk.12 )
                        qed
                      qed
                    next
                      case Receive
                      solve( NewDHSecrets( ~id.3, 'g'^~x.29,
                                           x.22^(~x.27*inv((~x.26*x.28))), x.22^(~x.27*x.30),
                                           old_rk.1
                             ) @ #b.1 )
                        case OuterRatchetToReceiver
                        solve( !KU( x.22^(~x.27*inv((~x.26*x.28))) ) @ #vk.6 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.50 ) @ #vk.10 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.50 ) @ #vk.10 )
                        next
                          case OuterRatchetToSender
                          by solve( !KU( ~x.51 ) @ #vk.10 )
                        next
                          case SenderStart
                          by solve( !KU( ~x.51 ) @ #vk.10 )
                        next
                          case c_exp
                          solve( !KU( ~x.27 ) @ #vk.10 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          next
                            case Send
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          next
                            case SenderStart
                            by contradiction /* node #b after last node #x */
                          next
                            case fresh
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          qed
                        qed
                      next
                        case OuterRatchetToSender
                        solve( Session( ~id.4, $A.2, 'R', ~x.31, $B.2,
                                        x.22^(~x.27*inv((~x.26*x.28))),
                                        kdf(<'rk', old_rk.2, x.22^(~x.27*x.30)>), ck.1
                               ) ▶₁ #vr.3 )
                          case OuterRatchetToReceiver
                          solve( !KU( x.22^(~x.18*inv(x.28)) ) @ #x )
                            case OuterRatchetToSender
                            solve( !KU( 'g'^(~x.27*inv((~x.26*x.34))) ) @ #vk.6 )
                              case KeyGen_case_1
                              by solve( !KU( ~x.35 ) @ #vk.12 )
                            next
                              case KeyGen_case_2
                              by solve( !KU( ~x.35 ) @ #vk.12 )
                            next
                              case OuterRatchetToSender
                              by solve( !KU( ~x.36 ) @ #vk.12 )
                            next
                              case SenderStart
                              by solve( !KU( ~x.36 ) @ #vk.12 )
                            next
                              case c_exp
                              solve( !KU( ~x.27 ) @ #vk.12 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.26 ) @ #vk.15 )
                              next
                                case Send
                                by solve( !KU( ~x.26 ) @ #vk.15 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.26 ) @ #vk.15 )
                              qed
                            qed
                          next
                            case c_exp
                            by solve( !KU( ~x.18 ) @ #vk.10 )
                          qed
                        next
                          case Receive
                          solve( !KU( x.22^(~x.18*inv(x.28)) ) @ #x )
                            case OuterRatchetToSender
                            solve( Session( ~id.5, $A.4, 'S', ~x.27, $B.4, old_pc,
                                            kdf(<'rk', old_rk.2, 'g'^(~x.27*x.30)>), old_ck.1
                                   ) ▶₁ #b )
                              case OuterRatchetToSender
                              by solve( Receive( m.3 ) @ #b.1 )
                            next
                              case Send
                              by solve( Receive( m.3 ) @ #b.1 )
                            qed
                          next
                            case c_exp
                            by solve( !KU( ~x.18 ) @ #vk.8 )
                          qed
                        qed
                      next
                        case ReceiverStart
                        solve( !KU( x.22^(~x.18*inv(x.28)) ) @ #x )
                          case OuterRatchetToSender
                          solve( !KU( 'g'^(~x.27*inv((~x.26*x.63))) ) @ #vk.6 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.64 ) @ #vk.12 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.64 ) @ #vk.12 )
                          next
                            case OuterRatchetToSender
                            by solve( !KU( ~x.65 ) @ #vk.12 )
                          next
                            case SenderStart
                            by solve( !KU( ~x.65 ) @ #vk.12 )
                          next
                            case c_exp
                            solve( !KU( ~x.27 ) @ #vk.12 )
                              case OuterRatchetToSender
                              by solve( !KU( ~x.26 ) @ #vk.15 )
                            next
                              case Send
                              by solve( !KU( ~x.26 ) @ #vk.15 )
                            next
                              case SenderStart
                              by contradiction /* cyclic */
                            next
                              case fresh
                              by solve( !KU( ~x.26 ) @ #vk.15 )
                            qed
                          qed
                        next
                          case c_exp
                          by solve( !KU( ~x.18 ) @ #vk.10 )
                        qed
                      next
                        case SenderStart
                        solve( !KU( x.22^(~x.18*inv(x.28)) ) @ #x )
                          case OuterRatchetToSender
                          solve( Session( ~id.5, $A.4, 'S', ~x.27, $B.4, old_pc,
                                          kdf(<'rk', kdf(<'g'^(x.35*~x.36), z.8, 'g'^(~x.27*x.30)>)
                                              >),
                                          old_ck.1
                                 ) ▶₁ #b )
                            case Send
                            solve( !SecretKeys( $A.3, ~ltk, prek ) ▶₃ #b.1 )
                              case KeyGen
                              by solve( !PublicKeys( $B.3, ltpk, 'g'^(~x.27*inv((~x.26*x.38)))
                                        ) ▶₄ #b.1 )
                            qed
                          qed
                        next
                          case c_exp
                          by solve( !KU( ~x.18 ) @ #vk.7 )
                        qed
                      qed
                    next
                      case ReceiverStart
                      solve( !KU( x.22^(~x.18*inv(x.28)) ) @ #x )
                        case OuterRatchetToSender
                        solve( !KU( 'g'^(~x.27*inv((~x.26*x.33))) ) @ #vk.5 )
                          case KeyGen_case_1
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.34 ) @ #vk.11 )
                        next
                          case OuterRatchetToSender
                          by solve( !KU( ~x.35 ) @ #vk.11 )
                        next
                          case SenderStart
                          by solve( !KU( ~x.35 ) @ #vk.11 )
                        next
                          case c_exp
                          solve( !KU( ~x.27 ) @ #vk.11 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.26 ) @ #vk.14 )
                          next
                            case Send
                            by solve( !KU( ~x.26 ) @ #vk.14 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.26 ) @ #vk.14 )
                          qed
                        qed
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      qed
                    qed
                  next
                    case split_case_5
                    solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                    x.22^(~x.27*x.28*inv(~x.26)), old_rk.1, old_ck.2
                           ) ▶₂ #vr.1 )
                      case OuterRatchetToReceiver_case_1
                      solve( !KU( x.22^(~x.18*x.28) ) @ #x )
                        case KeyGen_case_1
                        by solve( !KU( ~x.33 ) @ #vk.7 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.33 ) @ #vk.8 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.33 ) @ #vk.7 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.33 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.34 ) @ #vk.7 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.34 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_3
                        solve( !KU( 'g'^(~x.27*x.34*inv(~x.26)) ) @ #vk.5 )
                          case KeyGen_case_1
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          qed
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.36 ) @ #vk.11 )
                        next
                          case KeyGen_case_3
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          qed
                        next
                          case KeyGen_case_4
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          qed
                        next
                          case KeyGen_case_5
                          by solve( !KU( ~x.36 ) @ #vk.11 )
                        next
                          case KeyGen_case_6
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          qed
                        next
                          case OuterRatchetToSender_case_1
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          qed
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.37 ) @ #vk.11 )
                        next
                          case OuterRatchetToSender_case_3
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          qed
                        next
                          case SenderStart_case_1
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          qed
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.37 ) @ #vk.11 )
                        next
                          case SenderStart_case_3
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          qed
                        next
                          case c_exp
                          solve( !KU( ~x.27 ) @ #vk.10 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          next
                            case Send
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          qed
                        qed
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.34 ) @ #vk.7 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.34 ) @ #vk.8 )
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_2
                      solve( !KU( x.22^(~x.18*x.28) ) @ #x )
                        case KeyGen_case_1
                        by solve( !KU( ~x.33 ) @ #vk.7 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.33 ) @ #vk.8 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.33 ) @ #vk.7 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.33 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.34 ) @ #vk.7 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.34 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_3
                        solve( !KU( 'g'^(~x.27*x.34*inv(~x.26)) ) @ #vk.5 )
                          case KeyGen_case_1
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          qed
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.36 ) @ #vk.11 )
                        next
                          case KeyGen_case_3
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          qed
                        next
                          case KeyGen_case_4
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          qed
                        next
                          case KeyGen_case_5
                          by solve( !KU( ~x.36 ) @ #vk.11 )
                        next
                          case KeyGen_case_6
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          qed
                        next
                          case OuterRatchetToSender_case_1
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          qed
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.37 ) @ #vk.11 )
                        next
                          case OuterRatchetToSender_case_3
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          qed
                        next
                          case SenderStart_case_1
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          qed
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.37 ) @ #vk.11 )
                        next
                          case SenderStart_case_3
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          qed
                        next
                          case c_exp
                          solve( !KU( ~x.27 ) @ #vk.10 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          next
                            case Send
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          qed
                        qed
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.34 ) @ #vk.7 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.34 ) @ #vk.8 )
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( x.22^(~x.18*x.28) ) @ #x )
                        case KeyGen_case_1
                        by solve( !KU( ~x.33 ) @ #vk.7 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.33 ) @ #vk.8 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.33 ) @ #vk.7 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.33 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.34 ) @ #vk.7 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.34 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_3
                        solve( !KU( 'g'^(~x.27*x.34*inv(~x.26)) ) @ #vk.5 )
                          case KeyGen_case_1
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          qed
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.36 ) @ #vk.11 )
                        next
                          case KeyGen_case_3
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          qed
                        next
                          case KeyGen_case_4
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          qed
                        next
                          case KeyGen_case_5
                          by solve( !KU( ~x.36 ) @ #vk.11 )
                        next
                          case KeyGen_case_6
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          qed
                        next
                          case OuterRatchetToSender_case_1
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          qed
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.37 ) @ #vk.11 )
                        next
                          case OuterRatchetToSender_case_3
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          qed
                        next
                          case SenderStart_case_1
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          qed
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.37 ) @ #vk.11 )
                        next
                          case SenderStart_case_3
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          qed
                        next
                          case c_exp
                          solve( !KU( ~x.27 ) @ #vk.10 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          next
                            case Send
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          qed
                        qed
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.34 ) @ #vk.7 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.34 ) @ #vk.8 )
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      qed
                    next
                      case Receive
                      solve( !KU( x.22^(~x.18*x.28) ) @ #x )
                        case KeyGen_case_1
                        by solve( !KU( ~x.32 ) @ #vk.5 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.32 ) @ #vk.6 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.32 ) @ #vk.5 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.32 ) @ #vk.6 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.33 ) @ #vk.5 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.33 ) @ #vk.6 )
                      next
                        case OuterRatchetToSender_case_3
                        solve( Session( ~id.4, $A.3, 'S', ~x.27, $B.3, old_pc, old_rk.1,
                                        old_ck.1
                               ) ▶₁ #b )
                          case OuterRatchetToSender
                          solve( NewDHSecrets( ~id.3, 'g'^~x.29, 'g'^(~x.27*x.33*inv(~x.26)),
                                               'g'^(x.30*x.31), kdf(<'rk', old_rk.3, z.8>)
                                 ) @ #b.1 )
                            case OuterRatchetToReceiver
                            solve( !KU( 'g'^(~x.27*x.33*inv(~x.26)) ) @ #vk.7 )
                              case KeyGen_case_1
                              by solve( !KU( ~x.54 ) @ #vk.10 )
                            next
                              case KeyGen_case_2
                              by solve( !KU( ~x.54 ) @ #vk.10 )
                            next
                              case KeyGen_case_3
                              by solve( !KU( ~x.54 ) @ #vk.10 )
                            next
                              case KeyGen_case_4
                              by solve( !KU( ~x.54 ) @ #vk.10 )
                            next
                              case OuterRatchetToSender_case_1
                              by solve( !KU( ~x.55 ) @ #vk.10 )
                            next
                              case OuterRatchetToSender_case_2
                              by solve( !KU( ~x.56 ) @ #vk.12 )
                            next
                              case OuterRatchetToSender_case_3
                              by solve( !KU( ~x.55 ) @ #vk.10 )
                            next
                              case SenderStart_case_1
                              by solve( !KU( ~x.55 ) @ #vk.10 )
                            next
                              case SenderStart_case_2
                              by solve( !KU( ~x.55 ) @ #vk.10 )
                            next
                              case c_exp
                              by solve( !KU( ~x.27 ) @ #vk.11 )
                            qed
                          next
                            case OuterRatchetToSender
                            by solve( Receive( m.3 ) @ #b.1 )
                          qed
                        next
                          case Send
                          solve( NewDHSecrets( ~id.3, 'g'^~x.29, 'g'^(~x.27*x.33*inv(~x.26)),
                                               'g'^(x.30*x.31), old_rk.1
                                 ) @ #b.1 )
                            case OuterRatchetToReceiver
                            solve( !KU( 'g'^(~x.27*x.33*inv(~x.26)) ) @ #vk.7 )
                              case KeyGen_case_1
                              solve( !KU( ~x.52 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.53 ) @ #vk.12 )
                              next
                                case Send
                                by solve( !KU( ~x.53 ) @ #vk.12 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.53 ) @ #vk.12 )
                              qed
                            next
                              case KeyGen_case_2
                              by solve( !KU( ~x.53 ) @ #vk.12 )
                            next
                              case KeyGen_case_3
                              solve( !KU( ~x.52 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.54 ) @ #vk.13 )
                              next
                                case Send
                                by solve( !KU( ~x.54 ) @ #vk.13 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.54 ) @ #vk.13 )
                              qed
                            next
                              case KeyGen_case_4
                              solve( !KU( ~x.52 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.53 ) @ #vk.12 )
                              next
                                case Send
                                by solve( !KU( ~x.53 ) @ #vk.12 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.53 ) @ #vk.12 )
                              qed
                            next
                              case KeyGen_case_5
                              by solve( !KU( ~x.53 ) @ #vk.12 )
                            next
                              case KeyGen_case_6
                              solve( !KU( ~x.52 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.54 ) @ #vk.13 )
                              next
                                case Send
                                by solve( !KU( ~x.54 ) @ #vk.13 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.54 ) @ #vk.13 )
                              qed
                            next
                              case OuterRatchetToSender_case_1
                              solve( !KU( ~x.53 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.54 ) @ #vk.12 )
                              next
                                case Send
                                by solve( !KU( ~x.54 ) @ #vk.12 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.54 ) @ #vk.12 )
                              qed
                            next
                              case OuterRatchetToSender_case_2
                              by solve( !KU( ~x.54 ) @ #vk.12 )
                            next
                              case OuterRatchetToSender_case_3
                              solve( !KU( ~x.53 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.55 ) @ #vk.13 )
                              next
                                case Send
                                by solve( !KU( ~x.55 ) @ #vk.13 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.55 ) @ #vk.13 )
                              qed
                            next
                              case SenderStart_case_1
                              solve( !KU( ~x.53 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.54 ) @ #vk.12 )
                              next
                                case Send
                                by solve( !KU( ~x.54 ) @ #vk.12 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.54 ) @ #vk.12 )
                              qed
                            next
                              case SenderStart_case_2
                              by solve( !KU( ~x.54 ) @ #vk.12 )
                            next
                              case SenderStart_case_3
                              solve( !KU( ~x.53 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.55 ) @ #vk.13 )
                              next
                                case Send
                                by solve( !KU( ~x.55 ) @ #vk.13 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.55 ) @ #vk.13 )
                              qed
                            next
                              case c_exp
                              solve( !KU( ~x.27 ) @ #vk.11 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.26 ) @ #vk.14 )
                              next
                                case Send
                                by solve( !KU( ~x.26 ) @ #vk.14 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.26 ) @ #vk.14 )
                              qed
                            qed
                          next
                            case OuterRatchetToSender
                            by solve( Receive( m.3 ) @ #b.1 )
                          next
                            case ReceiverStart
                            solve( !KU( 'g'^(~x.27*x.33*inv(~x.26)) ) @ #vk.7 )
                              case KeyGen_case_1
                              solve( !KU( ~x.62 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.63 ) @ #vk.12 )
                              next
                                case Send
                                by solve( !KU( ~x.63 ) @ #vk.12 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.63 ) @ #vk.12 )
                              qed
                            next
                              case KeyGen_case_2
                              by solve( !KU( ~x.63 ) @ #vk.12 )
                            next
                              case KeyGen_case_3
                              solve( !KU( ~x.62 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.64 ) @ #vk.13 )
                              next
                                case Send
                                by solve( !KU( ~x.64 ) @ #vk.13 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.64 ) @ #vk.13 )
                              qed
                            next
                              case KeyGen_case_4
                              solve( !KU( ~x.62 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.63 ) @ #vk.12 )
                              next
                                case Send
                                by solve( !KU( ~x.63 ) @ #vk.12 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.63 ) @ #vk.12 )
                              qed
                            next
                              case KeyGen_case_5
                              by solve( !KU( ~x.63 ) @ #vk.12 )
                            next
                              case KeyGen_case_6
                              solve( !KU( ~x.62 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.64 ) @ #vk.13 )
                              next
                                case Send
                                by solve( !KU( ~x.64 ) @ #vk.13 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.64 ) @ #vk.13 )
                              qed
                            next
                              case OuterRatchetToSender_case_1
                              solve( !KU( ~x.63 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.64 ) @ #vk.12 )
                              next
                                case Send
                                by solve( !KU( ~x.64 ) @ #vk.12 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.64 ) @ #vk.12 )
                              qed
                            next
                              case OuterRatchetToSender_case_2
                              by solve( !KU( ~x.64 ) @ #vk.12 )
                            next
                              case OuterRatchetToSender_case_3
                              solve( !KU( ~x.63 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.65 ) @ #vk.13 )
                              next
                                case Send
                                by solve( !KU( ~x.65 ) @ #vk.13 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.65 ) @ #vk.13 )
                              qed
                            next
                              case SenderStart_case_1
                              solve( !KU( ~x.63 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.64 ) @ #vk.12 )
                              next
                                case Send
                                by solve( !KU( ~x.64 ) @ #vk.12 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.64 ) @ #vk.12 )
                              qed
                            next
                              case SenderStart_case_2
                              by solve( !KU( ~x.64 ) @ #vk.12 )
                            next
                              case SenderStart_case_3
                              solve( !KU( ~x.63 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.65 ) @ #vk.13 )
                              next
                                case Send
                                by solve( !KU( ~x.65 ) @ #vk.13 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.65 ) @ #vk.13 )
                              qed
                            next
                              case c_exp
                              solve( !KU( ~x.27 ) @ #vk.11 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.26 ) @ #vk.14 )
                              next
                                case Send
                                by solve( !KU( ~x.26 ) @ #vk.14 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.26 ) @ #vk.14 )
                              qed
                            qed
                          next
                            case SenderStart
                            solve( !SecretKeys( $A.4, ~ltk, prek ) ▶₃ #b.1 )
                              case KeyGen
                              by solve( !PublicKeys( $B.4, ltpk, 'g'^(~x.27*x.33*inv(~x.26))
                                        ) ▶₄ #b.1 )
                            qed
                          qed
                        next
                          case SenderStart
                          by solve( NewDHSecrets( ~id.3, 'g'^~x.29,
                                                  'g'^(~x.27*x.33*inv(~x.26)), 'g'^(x.30*x.31),
                                                  kdf(<'rk', 
                                                       kdf(<'g'^(~ltk*~prek.1), 'g'^(~ltk.1*~x.27), 
                                                            'g'^(~prek.1*~x.27)>)
                                                      >)
                                    ) @ #b.1 )
                        qed
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.33 ) @ #vk.5 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.33 ) @ #vk.6 )
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.7 )
                      qed
                    next
                      case ReceiverStart
                      solve( !KU( x.22^(~x.18*x.28) ) @ #x )
                        case KeyGen_case_1
                        by solve( !KU( ~x.33 ) @ #vk.7 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.33 ) @ #vk.8 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.33 ) @ #vk.7 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.33 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.34 ) @ #vk.7 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.34 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_3
                        solve( !KU( 'g'^(~x.27*x.34*inv(~x.26)) ) @ #vk.5 )
                          case KeyGen_case_1
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          qed
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.36 ) @ #vk.11 )
                        next
                          case KeyGen_case_3
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          qed
                        next
                          case KeyGen_case_4
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.36 ) @ #vk.11 )
                          qed
                        next
                          case KeyGen_case_5
                          by solve( !KU( ~x.36 ) @ #vk.11 )
                        next
                          case KeyGen_case_6
                          solve( !KU( ~x.35 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.12 )
                          qed
                        next
                          case OuterRatchetToSender_case_1
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          qed
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.37 ) @ #vk.11 )
                        next
                          case OuterRatchetToSender_case_3
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          qed
                        next
                          case SenderStart_case_1
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case Send
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.37 ) @ #vk.11 )
                          qed
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.37 ) @ #vk.11 )
                        next
                          case SenderStart_case_3
                          solve( !KU( ~x.36 ) @ #vk.9 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case Send
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.38 ) @ #vk.12 )
                          qed
                        next
                          case c_exp
                          solve( !KU( ~x.27 ) @ #vk.10 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          next
                            case Send
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.26 ) @ #vk.13 )
                          qed
                        qed
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.34 ) @ #vk.7 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.34 ) @ #vk.8 )
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      qed
                    qed
                  next
                    case split_case_6
                    solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                    x.22^(~x.27*x.28*inv((~x.26*x.29))), old_rk.1, old_ck.2
                           ) ▶₂ #vr.1 )
                      case OuterRatchetToReceiver_case_1
                      solve( !KU( x.22^(~x.18*x.28*inv(x.29)) ) @ #x )
                        case KeyGen_case_1
                        by solve( !KU( ~x.35 ) @ #vk.8 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.35 ) @ #vk.8 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.35 ) @ #vk.8 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.35 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.36 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.36 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_3
                        solve( !KU( 'g'^(~x.27*x.36*inv((~x.26*x.37))) ) @ #vk.5 )
                          case KeyGen_case_1
                          solve( !KU( ~x.38 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          next
                            case Send
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          qed
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.39 ) @ #vk.15 )
                        next
                          case KeyGen_case_3
                          solve( !KU( ~x.38 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          next
                            case Send
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          qed
                        next
                          case KeyGen_case_4
                          solve( !KU( ~x.38 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          next
                            case Send
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          qed
                        next
                          case KeyGen_case_5
                          by solve( !KU( ~x.39 ) @ #vk.15 )
                        next
                          case KeyGen_case_6
                          solve( !KU( ~x.38 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          next
                            case Send
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          qed
                        next
                          case OuterRatchetToSender_case_1
                          solve( !KU( ~x.39 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          next
                            case Send
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          qed
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.40 ) @ #vk.15 )
                        next
                          case OuterRatchetToSender_case_3
                          solve( !KU( ~x.39 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          next
                            case Send
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          qed
                        next
                          case SenderStart_case_1
                          solve( !KU( ~x.39 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          next
                            case Send
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          qed
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.40 ) @ #vk.15 )
                        next
                          case SenderStart_case_3
                          solve( !KU( ~x.39 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          next
                            case Send
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          qed
                        next
                          case c_exp
                          solve( !KU( ~x.27 ) @ #vk.13 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.26 ) @ #vk.17 )
                          next
                            case Send
                            by solve( !KU( ~x.26 ) @ #vk.17 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.26 ) @ #vk.17 )
                          qed
                        qed
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.36 ) @ #vk.8 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.36 ) @ #vk.8 )
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_2
                      solve( !KU( x.22^(~x.18*x.28*inv(x.29)) ) @ #x )
                        case KeyGen_case_1
                        by solve( !KU( ~x.35 ) @ #vk.8 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.35 ) @ #vk.8 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.35 ) @ #vk.8 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.35 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.36 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.36 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_3
                        solve( !KU( 'g'^(~x.27*x.36*inv((~x.26*x.37))) ) @ #vk.5 )
                          case KeyGen_case_1
                          solve( !KU( ~x.38 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          next
                            case Send
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          qed
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.39 ) @ #vk.15 )
                        next
                          case KeyGen_case_3
                          solve( !KU( ~x.38 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          next
                            case Send
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          qed
                        next
                          case KeyGen_case_4
                          solve( !KU( ~x.38 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          next
                            case Send
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          qed
                        next
                          case KeyGen_case_5
                          by solve( !KU( ~x.39 ) @ #vk.15 )
                        next
                          case KeyGen_case_6
                          solve( !KU( ~x.38 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          next
                            case Send
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          qed
                        next
                          case OuterRatchetToSender_case_1
                          solve( !KU( ~x.39 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          next
                            case Send
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          qed
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.40 ) @ #vk.15 )
                        next
                          case OuterRatchetToSender_case_3
                          solve( !KU( ~x.39 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          next
                            case Send
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          qed
                        next
                          case SenderStart_case_1
                          solve( !KU( ~x.39 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          next
                            case Send
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          qed
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.40 ) @ #vk.15 )
                        next
                          case SenderStart_case_3
                          solve( !KU( ~x.39 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          next
                            case Send
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          qed
                        next
                          case c_exp
                          solve( !KU( ~x.27 ) @ #vk.13 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.26 ) @ #vk.17 )
                          next
                            case Send
                            by solve( !KU( ~x.26 ) @ #vk.17 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.26 ) @ #vk.17 )
                          qed
                        qed
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.36 ) @ #vk.8 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.36 ) @ #vk.8 )
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      qed
                    next
                      case OuterRatchetToReceiver_case_3
                      solve( !KU( x.22^(~x.18*x.28*inv(x.29)) ) @ #x )
                        case KeyGen_case_1
                        by solve( !KU( ~x.35 ) @ #vk.8 )
                      next
                        case KeyGen_case_2
                        by solve( !KU( ~x.35 ) @ #vk.8 )
                      next
                        case KeyGen_case_3
                        by solve( !KU( ~x.35 ) @ #vk.8 )
                      next
                        case KeyGen_case_4
                        by solve( !KU( ~x.35 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_1
                        by solve( !KU( ~x.36 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_2
                        by solve( !KU( ~x.36 ) @ #vk.8 )
                      next
                        case OuterRatchetToSender_case_3
                        solve( !KU( 'g'^(~x.27*x.36*inv((~x.26*x.37))) ) @ #vk.5 )
                          case KeyGen_case_1
                          solve( !KU( ~x.38 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          next
                            case Send
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          qed
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.39 ) @ #vk.15 )
                        next
                          case KeyGen_case_3
                          solve( !KU( ~x.38 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          next
                            case Send
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          qed
                        next
                          case KeyGen_case_4
                          solve( !KU( ~x.38 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          next
                            case Send
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.39 ) @ #vk.15 )
                          qed
                        next
                          case KeyGen_case_5
                          by solve( !KU( ~x.39 ) @ #vk.15 )
                        next
                          case KeyGen_case_6
                          solve( !KU( ~x.38 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          next
                            case Send
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.40 ) @ #vk.16 )
                          qed
                        next
                          case OuterRatchetToSender_case_1
                          solve( !KU( ~x.39 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          next
                            case Send
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          qed
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.40 ) @ #vk.15 )
                        next
                          case OuterRatchetToSender_case_3
                          solve( !KU( ~x.39 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          next
                            case Send
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          qed
                        next
                          case SenderStart_case_1
                          solve( !KU( ~x.39 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          next
                            case Send
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.40 ) @ #vk.15 )
                          qed
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.40 ) @ #vk.15 )
                        next
                          case SenderStart_case_3
                          solve( !KU( ~x.39 ) @ #vk.12 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          next
                            case Send
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.41 ) @ #vk.16 )
                          qed
                        next
                          case c_exp
                          solve( !KU( ~x.27 ) @ #vk.13 )
                            case OuterRatchetToSender
                            by solve( !KU( ~x.26 ) @ #vk.17 )
                          next
                            case Send
                            by solve( !KU( ~x.26 ) @ #vk.17 )
                          next
                            case SenderStart
                            by contradiction /* cyclic */
                          next
                            case fresh
                            by solve( !KU( ~x.26 ) @ #vk.17 )
                          qed
                        qed
                      next
                        case SenderStart_case_1
                        by solve( !KU( ~x.36 ) @ #vk.8 )
                      next
                        case SenderStart_case_2
                        by solve( !KU( ~x.36 ) @ #vk.8 )
                      next
                        case c_exp
                        by solve( !KU( ~x.18 ) @ #vk.9 )
                      qed
                    next
                      case Receive
                      solve( Session( ~id.2, $A, 'R', ~x.27, $B, x.22^(x.28*inv(x.29)),
                                      kdf(<'rk', old_rk.1, x.22^(~x.27*x.28*inv(x.29))>), ck
                             ) ▶₁ #vr )
                        case OuterRatchetToReceiver_case_1
                        solve( !KU( x.22^(~x.18*x.28*inv(x.29)) ) @ #x )
                          case KeyGen_case_1
                          by solve( !KU( ~x.35 ) @ #vk.9 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~x.35 ) @ #vk.9 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~x.35 ) @ #vk.9 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~x.35 ) @ #vk.9 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.36 ) @ #vk.9 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.36 ) @ #vk.9 )
                        next
                          case OuterRatchetToSender_case_3
                          solve( !KU( senc(z.1,
                                           kdf(<'mk', 
                                                kdf(<'ck', 
                                                     kdf(<'ck', 
                                                          kdf(<'rk', 
                                                               kdf(<'rk', 
                                                                    kdf(<'g'^(~ltk*~prek), 
                                                                         'g'^(~ltk.1*~x.27), 
                                                                         'g'^(~prek*~x.27)>)
                                                                   >), 
                                                               'g'^(~x.27*x.36*inv(x.37))>)
                                                         >)
                                                    >)
                                               >))
                                 ) @ #vk )
                            case Send
                            solve( !KU( senc(x.34,
                                             kdf(<'mk', 
                                                  kdf(<'ck', 
                                                       kdf(<'rk', 
                                                            kdf(<'rk', 
                                                                 kdf(<'g'^(~ltk*~prek), 
                                                                      'g'^(~ltk.1*~x.27), 
                                                                      'g'^(~prek*~x.27)>)
                                                                >), 
                                                            'g'^(~x.27*x.36*inv(x.37))>)
                                                      >)
                                                 >))
                                   ) @ #vk.7 )
                              case OuterRatchetToSender
                              solve( Session( ~id.4, $A.3, 'S', ~x.27, $B.3, old_pc,
                                              kdf(<'rk', 
                                                   kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.27), 
                                                        'g'^(~prek*~x.27)>)
                                                  >),
                                              old_ck.1
                                     ) ▶₁ #b )
                                case Send
                                by contradiction /* non-injective facts (#vr.5,#vr.14,#vr.4) */
                              next
                                case SenderStart
                                by solve( NewDHSecrets( ~id.6, 'g'^~x.30,
                                                        'g'^(~x.42*x.43*inv((x.44*~x.45))),
                                                        'g'^(x.31*x.32*x.33),
                                                        kdf(<'rk', 
                                                             kdf(<'g'^(~ltk.2*~prek.3), 
                                                                  'g'^(~ltk.3*~x.42), 
                                                                  'g'^(~prek.3*~x.42)>)
                                                            >)
                                          ) @ #b.1 )
                              qed
                            next
                              case Send
                              solve( Session( ~id.4, $A.3, 'S', ~x.27, $B.3, old_pc,
                                              kdf(<'rk', 
                                                   kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.27), 
                                                        'g'^(~prek*~x.27)>)
                                                  >),
                                              old_ck.1
                                     ) ▶₁ #b )
                                case Send
                                by contradiction /* non-injective facts (#vr.5,#vr.13,#vr.4) */
                              qed
                            next
                              case c_senc
                              solve( !KU( kdf(<'mk', 
                                               kdf(<'ck', 
                                                    kdf(<'rk', 
                                                         kdf(<'rk', 
                                                              kdf(<'g'^(~ltk*~prek), 
                                                                   'g'^(~ltk.1*~x.27), 
                                                                   'g'^(~prek*~x.27)>)
                                                             >), 
                                                         'g'^(~x.27*x.36*inv(x.37))>)
                                                   >)
                                              >)
                                     ) @ #vk.13 )
                                case c_kdf
                                solve( !KU( kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk*~prek), 
                                                                'g'^(~ltk.1*~x.27), 
                                                                'g'^(~prek*~x.27)>)
                                                          >), 
                                                      'g'^(~x.27*x.36*inv(x.37))>)
                                                >)
                                       ) @ #vk.16 )
                                  case c_kdf
                                  solve( !KU( kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.27), 
                                                             'g'^(~prek*~x.27)>)
                                                       >), 
                                                   'g'^(~x.27*x.36*inv(x.37))>)
                                         ) @ #vk.19 )
                                    case c_kdf
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case c_senc
                            solve( !KU( kdf(<'mk', 
                                             kdf(<'ck', 
                                                  kdf(<'ck', 
                                                       kdf(<'rk', 
                                                            kdf(<'rk', 
                                                                 kdf(<'g'^(~ltk*~prek), 
                                                                      'g'^(~ltk.1*~x.27), 
                                                                      'g'^(~prek*~x.27)>)
                                                                >), 
                                                            'g'^(~x.27*x.36*inv(x.37))>)
                                                      >)
                                                 >)
                                            >)
                                   ) @ #vk.13 )
                              case c_kdf
                              solve( !KU( kdf(<'ck', 
                                               kdf(<'ck', 
                                                    kdf(<'rk', 
                                                         kdf(<'rk', 
                                                              kdf(<'g'^(~ltk*~prek), 
                                                                   'g'^(~ltk.1*~x.27), 
                                                                   'g'^(~prek*~x.27)>)
                                                             >), 
                                                         'g'^(~x.27*x.36*inv(x.37))>)
                                                   >)
                                              >)
                                     ) @ #vk.16 )
                                case c_kdf
                                solve( !KU( kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk*~prek), 
                                                                'g'^(~ltk.1*~x.27), 
                                                                'g'^(~prek*~x.27)>)
                                                          >), 
                                                      'g'^(~x.27*x.36*inv(x.37))>)
                                                >)
                                       ) @ #vk.19 )
                                  case c_kdf
                                  solve( !KU( kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.27), 
                                                             'g'^(~prek*~x.27)>)
                                                       >), 
                                                   'g'^(~x.27*x.36*inv(x.37))>)
                                         ) @ #vk.22 )
                                    case c_kdf
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.36 ) @ #vk.9 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.36 ) @ #vk.9 )
                        next
                          case c_exp
                          by solve( !KU( ~x.18 ) @ #vk.10 )
                        qed
                      next
                        case OuterRatchetToReceiver_case_2
                        by sorry /* removed */
                      next
                        case OuterRatchetToReceiver_case_3
                        by sorry
                      next
                        case Receive
                        by sorry
                      qed
                    next
                      case ReceiverStart
                      by sorry
                    qed
                  qed
                next
                  case split_case_3
                  by sorry
                next
                  case split_case_4
                  by sorry
                next
                  case split_case_5
                  by sorry
                qed
              next
                case split_case_5
                by sorry
              next
                case split_case_6
                by sorry
              next
                case split_case_7
                by sorry
              qed
            next
              case Send
              by sorry
            next
              case c_senc
              by sorry
            qed
          qed
        next
          case OuterRatchetToSender
          by solve( Receive( m.1 ) @ #b )
        next
          case ReceiverStart
          by sorry
        next
          case SenderStart
          by solve( Receive( m.1 ) @ #b )
        qed
      next
        case ReceiverStart
        by sorry
      qed
    next
      case Receive
      by sorry
    next
      case ReceiverStart
      solve( !SecretKeys( $A, ~ltk, ~prek ) ▶₁ #t )
        case KeyGen
        solve( !PublicKeys( $B, ltpk, prepk ) ▶₂ #t )
          case KeyGen
          solve( splitEqs(0) )
            case split_case_01
            solve( !KU( pc.1^~prek.2 ) @ #x )
              case KeyGen
              by contradiction /* from formulas */
            next
              case c_exp
              by solve( !KU( ~prek.2 ) @ #vk.4 )
            qed
          next
            case split_case_02
            solve( !KU( z.5^(~prek.2*inv(~ltk.2)) ) @ #x )
              case KeyGen
              by solve( !KU( ~ltk.3 ) @ #vk.4 )
            next
              case c_exp
              by solve( !KU( ~prek.2 ) @ #vk.5 )
            qed
          next
            case split_case_03
            solve( !KU( z.5^inv(~prek.2) ) @ #vk.1 )
              case c_exp
              by contradiction /* node #t after last node #vk.3 */
            qed
          next
            case split_case_04
            solve( !KU( x.22^inv(~ltk.2) ) @ #x )
              case c_exp
              by solve( !KU( ~ltk.2 ) @ #vk.5 )
            qed
          next
            case split_case_05
            solve( !KU( x.22^(~prek.2*x.23) ) @ #x )
              case KeyGen_case_1
              by solve( !KU( ~prek.4 ) @ #vk.3 )
            next
              case KeyGen_case_2
              by solve( !KU( ~prek.4 ) @ #vk.4 )
            next
              case KeyGen_case_3
              by solve( !KU( ~prek.4 ) @ #vk.3 )
            next
              case KeyGen_case_4
              by solve( !KU( ~prek.4 ) @ #vk.4 )
            next
              case KeyGen_case_5
              solve( !KU( senc(x.1,
                               kdf(<'mk', 
                                    kdf(<'ck', 
                                         kdf(<'rk', 
                                              kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.3*x.24), 
                                                   'g'^(~prek.3*x.24)>)
                                             >)
                                        >)
                                   >))
                     ) @ #vk.2 )
                case Send
                solve( NewDHSecrets( ~id.2, 'g'^~x.25, pc.1, z.5, rk.1 ) @ #b )
                  case OuterRatchetToReceiver
                  solve( Session( ~id.3, $A.2, 'S', ~x.26, $B.1, old_pc, old_rk,
                                  old_ck
                         ) ▶₁ #b )
                    case OuterRatchetToSender
                    by solve( Send( m.1 ) @ #b )
                  next
                    case Send
                    by solve( Send( m.1 ) @ #b )
                  next
                    case SenderStart
                    solve( !KU( senc(z.7,
                                     kdf(<'mk', 
                                          kdf(<'ck', 
                                               kdf(<'rk', 
                                                    kdf(<'rk', 
                                                         kdf(<'g'^(~ltk.4*~prek.5), 
                                                              'g'^(~ltk.5*~x.26), 
                                                              'g'^(~prek.5*~x.26)>)
                                                        >), 
                                                    z.6>)
                                              >)
                                         >))
                           ) @ #vk.6 )
                      case OuterRatchetToSender
                      by solve( Send( m.1 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.1 ) @ #b )
                    next
                      case c_senc
                      solve( !KU( kdf(<'mk', 
                                       kdf(<'ck', 
                                            kdf(<'rk', 
                                                 kdf(<'rk', 
                                                      kdf(<'g'^(~ltk.4*~prek.5), 
                                                           'g'^(~ltk.5*~x.26), 'g'^(~prek.5*~x.26)>)
                                                     >), 
                                                 z.6>)
                                           >)
                                      >)
                             ) @ #vk.8 )
                        case c_kdf
                        solve( !KU( kdf(<'ck', 
                                         kdf(<'rk', 
                                              kdf(<'rk', 
                                                   kdf(<'g'^(~ltk.4*~prek.5), 'g'^(~ltk.5*~x.26), 
                                                        'g'^(~prek.5*~x.26)>)
                                                  >), 
                                              z.6>)
                                        >)
                               ) @ #vk.11 )
                          case c_kdf
                          solve( !KU( kdf(<'rk', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.4*~prek.5), 'g'^(~ltk.5*~x.26), 
                                                     'g'^(~prek.5*~x.26)>)
                                               >), 
                                           z.6>)
                                 ) @ #vk.14 )
                            case c_kdf
                            by contradiction /* node #b after last node #x */
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case OuterRatchetToSender
                  solve( Send( m.1 ) @ #b )
                    case OuterRatchetToSender
                    solve( !KU( 'g'^x.24 ) @ #vk.1 )
                      case KeyGen_case_1
                      by solve( !KU( ~ltk.4 ) @ #vk.3 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~ltk.4 ) @ #vk.5 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~prek.4 ) @ #vk.3 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~prek.4 ) @ #vk.5 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.27 ) @ #vk.3 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.27 ) @ #vk.5 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.27 ) @ #vk.3 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.27 ) @ #vk.5 )
                    next
                      case c_exp
                      solve( splitEqs(2) )
                        case split_case_1
                        by solve( Session( ~id.3, $A.2, 'S', ~x.27, $B.1, pc.3,
                                           kdf(<'rk', old_rk, pc.3^~x.27>),
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.3*x.24), 
                                                     'g'^(~prek.3*x.24)>)
                                               >)
                                  ) ▶₁ #vr.4 )
                      next
                        case split_case_2
                        by contradiction /* from formulas */
                      next
                        case split_case_3
                        by solve( Session( ~id.3, $A.2, 'S', ~x.27, $B.1, x.28^x.29,
                                           kdf(<'rk', old_rk, x.28^(~x.27*x.29)>),
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.3*x.24), 
                                                     'g'^(~prek.3*x.24)>)
                                               >)
                                  ) ▶₁ #vr.4 )
                      next
                        case split_case_4
                        by solve( Session( ~id.3, $A.2, 'S', ~x.27, $B.1, z.7^inv(~x.27),
                                           kdf(<'rk', old_rk, z.7>),
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.3*x.24), 
                                                     'g'^(~prek.3*x.24)>)
                                               >)
                                  ) ▶₁ #vr.4 )
                      next
                        case split_case_5
                        by solve( Session( ~id.3, $A.2, 'S', ~x.27, $B.1,
                                           x.28^inv((~x.27*x.29)),
                                           kdf(<'rk', old_rk, x.28^inv(x.29)>),
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.3*x.24), 
                                                     'g'^(~prek.3*x.24)>)
                                               >)
                                  ) ▶₁ #vr.4 )
                      next
                        case split_case_6
                        by solve( Session( ~id.3, $A.2, 'S', ~x.27, $B.1,
                                           x.28^(x.29*inv(~x.27)), kdf(<'rk', old_rk, x.28^x.29>),
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.3*x.24), 
                                                     'g'^(~prek.3*x.24)>)
                                               >)
                                  ) ▶₁ #vr.4 )
                      next
                        case split_case_7
                        by solve( Session( ~id.3, $A.2, 'S', ~x.27, $B.1,
                                           x.28^(x.29*inv((~x.27*x.30))),
                                           kdf(<'rk', old_rk, x.28^(x.29*inv(x.30))>),
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.3*x.24), 
                                                     'g'^(~prek.3*x.24)>)
                                               >)
                                  ) ▶₁ #vr.4 )
                      qed
                    qed
                  qed
                next
                  case ReceiverStart
                  solve( !SecretKeys( $A.3, ~ltk.4, ~prek.4 ) ▶₁ #b )
                    case KeyGen
                    solve( !PublicKeys( $B.2, ltpk.1, prepk.1 ) ▶₂ #b )
                      case KeyGen
                      by solve( Send( m.1 ) @ #b )
                    qed
                  qed
                next
                  case SenderStart
                  solve( !SecretKeys( $A.3, ~ltk.4, prek.4 ) ▶₃ #b )
                    case KeyGen
                    solve( !PublicKeys( $B.2, ltpk.1, prepk.1 ) ▶₄ #b )
                      case KeyGen
                      solve( Send( m.1 ) @ #b )
                        case SenderStart
                        solve( !KU( 'g'^x.24 ) @ #vk.1 )
                          case KeyGen_case_1
                          by solve( !KU( ~ltk.8 ) @ #vk.3 )
                        next
                          case KeyGen_case_2
                          by solve( !KU( ~ltk.8 ) @ #vk.5 )
                        next
                          case KeyGen_case_3
                          by solve( !KU( ~prek.8 ) @ #vk.3 )
                        next
                          case KeyGen_case_4
                          by solve( !KU( ~prek.8 ) @ #vk.5 )
                        next
                          case OuterRatchetToSender_case_1
                          by solve( !KU( ~x.28 ) @ #vk.3 )
                        next
                          case OuterRatchetToSender_case_2
                          by solve( !KU( ~x.28 ) @ #vk.5 )
                        next
                          case SenderStart_case_1
                          by solve( !KU( ~x.28 ) @ #vk.3 )
                        next
                          case SenderStart_case_2
                          by solve( !KU( ~x.28 ) @ #vk.5 )
                        next
                          case c_exp
                          by solve( Session( ~id.3, $A.2, 'S', ~x.27, $B.1, 'g'^~prek.7,
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.6*~prek.7), 'g'^(~ltk.7*~x.27), 
                                                       'g'^(~prek.7*~x.27)>)
                                                 >),
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.3*x.24), 
                                                       'g'^(~prek.3*x.24)>)
                                                 >)
                                    ) ▶₁ #vr.4 )
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case SenderStart
                by solve( !KU( ~x.25 ) @ #vk.3 )
              next
                case c_senc
                solve( !KU( kdf(<'mk', 
                                 kdf(<'ck', 
                                      kdf(<'rk', 
                                           kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.3*x.24), 
                                                'g'^(~prek.3*x.24)>)
                                          >)
                                     >)
                                >)
                       ) @ #vk.5 )
                  case c_kdf
                  solve( !KU( kdf(<'ck', 
                                   kdf(<'rk', 
                                        kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.3*x.24), 
                                             'g'^(~prek.3*x.24)>)
                                       >)
                                  >)
                         ) @ #vk.8 )
                    case c_kdf
                    solve( !KU( kdf(<'rk', 
                                     kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.3*x.24), 
                                          'g'^(~prek.3*x.24)>)
                                    >)
                           ) @ #vk.11 )
                      case c_kdf
                      solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.3*x.24), 
                                       'g'^(~prek.3*x.24)>)
                             ) @ #vk.14 )
                        case c_kdf
                        by contradiction /* node #t after last node #x */
                      qed
                    qed
                  qed
                qed
              qed
            next
              case OuterRatchetToSender_case_1
              solve( !KU( senc(x.1,
                               kdf(<'mk', 
                                    kdf(<'ck', 
                                         kdf(<'rk', 
                                              kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.2*~x.24), 
                                                   'g'^(~prek.3*~x.24)>)
                                             >)
                                        >)
                                   >))
                     ) @ #vk.2 )
                case Send
                solve( !KU( 'g'^~x.24 ) @ #vk.1 )
                  case OuterRatchetToSender
                  solve( NewDHSecrets( ~id.3, 'g'^~x.25, pc.2, z.6, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.2, 'S', ~x.26, $B.2, old_pc, old_rk.2,
                                    old_ck.2
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.2 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.2 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.9,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.3*~prek.5), 
                                                                'g'^(~ltk.4*~x.26), 
                                                                'g'^(~prek.5*~x.26)>)
                                                          >), 
                                                      z.8>)
                                                >)
                                           >))
                             ) @ #vk.6 )
                        case OuterRatchetToSender
                        by solve( Send( m.2 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.2 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.3*~prek.5), 
                                                             'g'^(~ltk.4*~x.26), 'g'^(~prek.5*~x.26)
                                                            >)
                                                       >), 
                                                   z.8>)
                                             >)
                                        >)
                               ) @ #vk.8 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.3*~prek.5), 'g'^(~ltk.4*~x.26), 
                                                          'g'^(~prek.5*~x.26)>)
                                                    >), 
                                                z.8>)
                                          >)
                                 ) @ #vk.11 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.3*~prek.5), 'g'^(~ltk.4*~x.26), 
                                                       'g'^(~prek.5*~x.26)>)
                                                 >), 
                                             z.8>)
                                   ) @ #vk.14 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.2 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.3 ) @ #vk.3 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.3, ~prek.4 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.2 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.3, prek.4 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.2 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.3 ) @ #vk.3 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~x.24 ) @ #vk.5 )
                qed
              next
                case c_senc
                solve( !KU( kdf(<'mk', 
                                 kdf(<'ck', 
                                      kdf(<'rk', 
                                           kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.2*~x.24), 
                                                'g'^(~prek.3*~x.24)>)
                                          >)
                                     >)
                                >)
                       ) @ #vk.5 )
                  case c_kdf
                  solve( !KU( kdf(<'ck', 
                                   kdf(<'rk', 
                                        kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.2*~x.24), 
                                             'g'^(~prek.3*~x.24)>)
                                       >)
                                  >)
                         ) @ #vk.8 )
                    case c_kdf
                    solve( !KU( kdf(<'rk', 
                                     kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.2*~x.24), 
                                          'g'^(~prek.3*~x.24)>)
                                    >)
                           ) @ #vk.11 )
                      case c_kdf
                      solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.2*~x.24), 
                                       'g'^(~prek.3*~x.24)>)
                             ) @ #vk.14 )
                        case c_kdf
                        by contradiction /* node #t after last node #x */
                      qed
                    qed
                  qed
                qed
              qed
            next
              case OuterRatchetToSender_case_2
              solve( !KU( 'g'^(~x.24*x.25) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~x.26 ) @ #vk.6 )
              next
                case KeyGen_case_2
                by solve( !KU( ~x.26 ) @ #vk.7 )
              next
                case KeyGen_case_3
                by solve( !KU( ~x.26 ) @ #vk.6 )
              next
                case KeyGen_case_4
                by solve( !KU( ~x.26 ) @ #vk.7 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.27 ) @ #vk.6 )
              next
                case OuterRatchetToSender_case_2
                by solve( !KU( ~x.27 ) @ #vk.7 )
              next
                case OuterRatchetToSender_case_3
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.2*~x.26*x.27), 
                                                     'g'^(~prek.3*~x.26*x.27)>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.28, pc.3, z.7, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.29, $B.3, old_pc, old_rk.2,
                                    old_ck.2
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.9,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.3*~prek.5), 
                                                                'g'^(~ltk.4*~x.29), 
                                                                'g'^(~prek.5*~x.29)>)
                                                          >), 
                                                      z.8>)
                                                >)
                                           >))
                             ) @ #vk.11 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.3*~prek.5), 
                                                             'g'^(~ltk.4*~x.29), 'g'^(~prek.5*~x.29)
                                                            >)
                                                       >), 
                                                   z.8>)
                                             >)
                                        >)
                               ) @ #vk.13 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.3*~prek.5), 'g'^(~ltk.4*~x.29), 
                                                          'g'^(~prek.5*~x.29)>)
                                                    >), 
                                                z.8>)
                                          >)
                                 ) @ #vk.16 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.3*~prek.5), 'g'^(~ltk.4*~x.29), 
                                                       'g'^(~prek.5*~x.29)>)
                                                 >), 
                                             z.8>)
                                   ) @ #vk.19 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.3 ) @ #vk.7 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.3, ~prek.4 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.3, prek.4 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.3 ) @ #vk.7 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.2*~x.26*x.27), 
                                                  'g'^(~prek.3*~x.26*x.27)>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.10 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.2*~x.26*x.27), 
                                               'g'^(~prek.3*~x.26*x.27)>)
                                         >)
                                    >)
                           ) @ #vk.13 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.2*~x.26*x.27), 
                                            'g'^(~prek.3*~x.26*x.27)>)
                                      >)
                             ) @ #vk.16 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.2*~x.26*x.27), 
                                         'g'^(~prek.3*~x.26*x.27)>)
                               ) @ #vk.19 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case SenderStart_case_1
                by solve( !KU( ~x.27 ) @ #vk.6 )
              next
                case SenderStart_case_2
                by solve( !KU( ~x.27 ) @ #vk.7 )
              next
                case c_exp
                by solve( !KU( ~x.24 ) @ #vk.8 )
              qed
            next
              case SenderStart_case_1
              solve( !KU( senc(x.1,
                               kdf(<'mk', 
                                    kdf(<'ck', 
                                         kdf(<'rk', 
                                              kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~ltk.2*~x.24), 
                                                   'g'^(~prek.5*~x.24)>)
                                             >)
                                        >)
                                   >))
                     ) @ #vk.2 )
                case Send
                solve( !KU( 'g'^~x.24 ) @ #vk.1 )
                  case SenderStart
                  solve( NewDHSecrets( ~id.3, 'g'^~x.25, pc.1, z.5, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.2, 'S', ~x.26, $B.2, old_pc, old_rk,
                                    old_ck
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.2 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.2 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.7,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.9*~prek.10), 
                                                                'g'^(~ltk.10*~x.26), 
                                                                'g'^(~prek.10*~x.26)>)
                                                          >), 
                                                      z.6>)
                                                >)
                                           >))
                             ) @ #vk.6 )
                        case OuterRatchetToSender
                        by solve( Send( m.2 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.2 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.9*~prek.10), 
                                                             'g'^(~ltk.10*~x.26), 
                                                             'g'^(~prek.10*~x.26)>)
                                                       >), 
                                                   z.6>)
                                             >)
                                        >)
                               ) @ #vk.8 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.9*~prek.10), 
                                                          'g'^(~ltk.10*~x.26), 'g'^(~prek.10*~x.26)
                                                         >)
                                                    >), 
                                                z.6>)
                                          >)
                                 ) @ #vk.11 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.9*~prek.10), 'g'^(~ltk.10*~x.26), 
                                                       'g'^(~prek.10*~x.26)>)
                                                 >), 
                                             z.6>)
                                   ) @ #vk.14 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.2 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.5 ) @ #vk.3 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.9, ~prek.9 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.2 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.9, prek.9 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.2 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.5 ) @ #vk.3 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~x.24 ) @ #vk.5 )
                qed
              next
                case SenderStart
                solve( !KU( 'g'^~x.25 ) @ #vk.1 )
                  case SenderStart
                  by solve( !KU( ~prek.10 ) @ #vk.3 )
                next
                  case c_exp
                  by solve( !KU( ~x.25 ) @ #vk.5 )
                qed
              next
                case c_senc
                solve( !KU( kdf(<'mk', 
                                 kdf(<'ck', 
                                      kdf(<'rk', 
                                           kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~ltk.2*~x.24), 
                                                'g'^(~prek.5*~x.24)>)
                                          >)
                                     >)
                                >)
                       ) @ #vk.5 )
                  case c_kdf
                  solve( !KU( kdf(<'ck', 
                                   kdf(<'rk', 
                                        kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~ltk.2*~x.24), 
                                             'g'^(~prek.5*~x.24)>)
                                       >)
                                  >)
                         ) @ #vk.8 )
                    case c_kdf
                    solve( !KU( kdf(<'rk', 
                                     kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~ltk.2*~x.24), 
                                          'g'^(~prek.5*~x.24)>)
                                    >)
                           ) @ #vk.11 )
                      case c_kdf
                      solve( !KU( kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~ltk.2*~x.24), 
                                       'g'^(~prek.5*~x.24)>)
                             ) @ #vk.14 )
                        case c_kdf
                        by contradiction /* node #t after last node #x */
                      qed
                    qed
                  qed
                qed
              qed
            next
              case SenderStart_case_2
              solve( !KU( 'g'^(~x.24*x.25) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~x.26 ) @ #vk.6 )
              next
                case KeyGen_case_2
                by solve( !KU( ~x.26 ) @ #vk.7 )
              next
                case KeyGen_case_3
                by solve( !KU( ~x.26 ) @ #vk.6 )
              next
                case KeyGen_case_4
                by solve( !KU( ~x.26 ) @ #vk.7 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.27 ) @ #vk.6 )
              next
                case OuterRatchetToSender_case_2
                by solve( !KU( ~x.27 ) @ #vk.7 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.27 ) @ #vk.6 )
              next
                case SenderStart_case_2
                by solve( !KU( ~x.27 ) @ #vk.7 )
              next
                case SenderStart_case_3
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~ltk.2*~x.26*x.27), 
                                                     'g'^(~prek.5*~x.26*x.27)>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.28, pc.1, z.5, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.29, $B.3, old_pc, old_rk,
                                    old_ck
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.7,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.9*~prek.10), 
                                                                'g'^(~ltk.10*~x.29), 
                                                                'g'^(~prek.10*~x.29)>)
                                                          >), 
                                                      z.6>)
                                                >)
                                           >))
                             ) @ #vk.11 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.9*~prek.10), 
                                                             'g'^(~ltk.10*~x.29), 
                                                             'g'^(~prek.10*~x.29)>)
                                                       >), 
                                                   z.6>)
                                             >)
                                        >)
                               ) @ #vk.13 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.9*~prek.10), 
                                                          'g'^(~ltk.10*~x.29), 'g'^(~prek.10*~x.29)
                                                         >)
                                                    >), 
                                                z.6>)
                                          >)
                                 ) @ #vk.16 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.9*~prek.10), 'g'^(~ltk.10*~x.29), 
                                                       'g'^(~prek.10*~x.29)>)
                                                 >), 
                                             z.6>)
                                   ) @ #vk.19 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.5 ) @ #vk.7 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.9, ~prek.9 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.9, prek.9 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.5 ) @ #vk.7 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~ltk.2*~x.26*x.27), 
                                                  'g'^(~prek.5*~x.26*x.27)>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.10 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~ltk.2*~x.26*x.27), 
                                               'g'^(~prek.5*~x.26*x.27)>)
                                         >)
                                    >)
                           ) @ #vk.13 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~ltk.2*~x.26*x.27), 
                                            'g'^(~prek.5*~x.26*x.27)>)
                                      >)
                             ) @ #vk.16 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~ltk.2*~x.26*x.27), 
                                         'g'^(~prek.5*~x.26*x.27)>)
                               ) @ #vk.19 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~x.24 ) @ #vk.8 )
              qed
            next
              case c_exp
              by solve( !KU( ~prek.2 ) @ #vk.5 )
            qed
          next
            case split_case_06
            solve( !KU( x.22^inv((~ltk.2*x.23)) ) @ #x )
              case c_exp
              by solve( !KU( ~ltk.2 ) @ #vk.6 )
            qed
          next
            case split_case_07
            solve( !KU( x.22^(~prek.2*inv((~ltk.2*x.23))) ) @ #x )
              case KeyGen
              by solve( !KU( ~ltk.3 ) @ #vk.7 )
            next
              case c_exp
              by solve( !KU( ~prek.2 ) @ #vk.5 )
            qed
          next
            case split_case_08
            solve( !KU( x.22^inv((~prek.2*x.23)) ) @ #vk.1 )
              case c_exp
              by solve( !KU( ~prek.2 ) @ #vk.6 )
            qed
          next
            case split_case_09
            solve( !KU( x.22^(~prek.2*x.23*inv(~ltk.2)) ) @ #x )
              case KeyGen_case_1
              by solve( !KU( ~prek.4 ) @ #vk.4 )
            next
              case KeyGen_case_2
              by solve( !KU( ~prek.4 ) @ #vk.4 )
            next
              case KeyGen_case_3
              by solve( !KU( ~prek.4 ) @ #vk.4 )
            next
              case KeyGen_case_4
              by solve( !KU( ~ltk.3 ) @ #vk.9 )
            next
              case KeyGen_case_5
              by solve( !KU( ~prek.4 ) @ #vk.4 )
            next
              case OuterRatchetToSender_case_1
              solve( !KU( 'g'^(~x.24*inv(~ltk.3)) ) @ #vk.1 )
                case OuterRatchetToSender
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 'g'^~x.25, 
                                                     'g'^(~prek.3*~x.25*inv(~ltk.4))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.26, pc.3, z.7, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.27, $B.3, old_pc, old_rk.2,
                                    old_ck.2
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.9,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.5*~prek.5), 
                                                                'g'^(~ltk.6*~x.27), 
                                                                'g'^(~prek.5*~x.27)>)
                                                          >), 
                                                      z.8>)
                                                >)
                                           >))
                             ) @ #vk.14 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.5*~prek.5), 
                                                             'g'^(~ltk.6*~x.27), 'g'^(~prek.5*~x.27)
                                                            >)
                                                       >), 
                                                   z.8>)
                                             >)
                                        >)
                               ) @ #vk.16 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.27), 
                                                          'g'^(~prek.5*~x.27)>)
                                                    >), 
                                                z.8>)
                                          >)
                                 ) @ #vk.19 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.27), 
                                                       'g'^(~prek.5*~x.27)>)
                                                 >), 
                                             z.8>)
                                   ) @ #vk.22 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.3 ) @ #vk.9 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.5, ~prek.4 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.5, prek.4 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.3 ) @ #vk.9 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.3), 'g'^~x.25, 
                                                  'g'^(~prek.3*~x.25*inv(~ltk.4))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.13 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.3), 'g'^~x.25, 
                                               'g'^(~prek.3*~x.25*inv(~ltk.4))>)
                                         >)
                                    >)
                           ) @ #vk.16 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.3), 'g'^~x.25, 
                                            'g'^(~prek.3*~x.25*inv(~ltk.4))>)
                                      >)
                             ) @ #vk.19 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 'g'^~x.25, 
                                         'g'^(~prek.3*~x.25*inv(~ltk.4))>)
                               ) @ #vk.22 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~x.24 ) @ #vk.9 )
              qed
            next
              case OuterRatchetToSender_case_2
              solve( !KU( 'g'^(~x.24*x.25*inv(~ltk.3)) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~x.26 ) @ #vk.9 )
              next
                case KeyGen_case_2
                by solve( !KU( ~x.26 ) @ #vk.9 )
              next
                case KeyGen_case_3
                by solve( !KU( ~x.26 ) @ #vk.9 )
              next
                case KeyGen_case_4
                by solve( !KU( ~x.26 ) @ #vk.9 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.27 ) @ #vk.9 )
              next
                case OuterRatchetToSender_case_2
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.26*x.27), 
                                                     'g'^(~prek.3*~x.26*x.27*inv(~ltk.4))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.28, pc.3, z.7, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.29, $B.3, old_pc, old_rk.2,
                                    old_ck.2
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.9,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.5*~prek.5), 
                                                                'g'^(~ltk.6*~x.29), 
                                                                'g'^(~prek.5*~x.29)>)
                                                          >), 
                                                      z.8>)
                                                >)
                                           >))
                             ) @ #vk.18 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.5*~prek.5), 
                                                             'g'^(~ltk.6*~x.29), 'g'^(~prek.5*~x.29)
                                                            >)
                                                       >), 
                                                   z.8>)
                                             >)
                                        >)
                               ) @ #vk.20 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.29), 
                                                          'g'^(~prek.5*~x.29)>)
                                                    >), 
                                                z.8>)
                                          >)
                                 ) @ #vk.23 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.29), 
                                                       'g'^(~prek.5*~x.29)>)
                                                 >), 
                                             z.8>)
                                   ) @ #vk.26 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.3 ) @ #vk.12 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.5, ~prek.4 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.5, prek.4 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.3 ) @ #vk.12 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.26*x.27), 
                                                  'g'^(~prek.3*~x.26*x.27*inv(~ltk.4))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.17 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.26*x.27), 
                                               'g'^(~prek.3*~x.26*x.27*inv(~ltk.4))>)
                                         >)
                                    >)
                           ) @ #vk.20 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.26*x.27), 
                                            'g'^(~prek.3*~x.26*x.27*inv(~ltk.4))>)
                                      >)
                             ) @ #vk.23 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.26*x.27), 
                                         'g'^(~prek.3*~x.26*x.27*inv(~ltk.4))>)
                               ) @ #vk.26 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case OuterRatchetToSender_case_3
                by solve( !KU( ~x.27 ) @ #vk.9 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.27 ) @ #vk.9 )
              next
                case SenderStart_case_2
                by solve( !KU( ~x.27 ) @ #vk.9 )
              next
                case c_exp
                by solve( !KU( ~x.24 ) @ #vk.10 )
              qed
            next
              case SenderStart_case_1
              solve( !KU( 'g'^(~x.24*inv(~ltk.5)) ) @ #vk.1 )
                case SenderStart
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.5), 'g'^~x.25, 
                                                     'g'^(~prek.5*~x.25*inv(~ltk.8))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.26, pc.1, z.5, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.27, $B.3, old_pc, old_rk,
                                    old_ck
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.7,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~prek.10*~ltk.11), 
                                                                'g'^(~ltk.12*~x.27), 
                                                                'g'^(~prek.10*~x.27)>)
                                                          >), 
                                                      z.6>)
                                                >)
                                           >))
                             ) @ #vk.14 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~prek.10*~ltk.11), 
                                                             'g'^(~ltk.12*~x.27), 
                                                             'g'^(~prek.10*~x.27)>)
                                                       >), 
                                                   z.6>)
                                             >)
                                        >)
                               ) @ #vk.16 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~prek.10*~ltk.11), 
                                                          'g'^(~ltk.12*~x.27), 'g'^(~prek.10*~x.27)
                                                         >)
                                                    >), 
                                                z.6>)
                                          >)
                                 ) @ #vk.19 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~prek.10*~ltk.11), 'g'^(~ltk.12*~x.27), 
                                                       'g'^(~prek.10*~x.27)>)
                                                 >), 
                                             z.6>)
                                   ) @ #vk.22 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.5 ) @ #vk.9 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.11, ~prek.9 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.11, prek.9 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.5 ) @ #vk.9 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.5), 'g'^~x.25, 
                                                  'g'^(~prek.5*~x.25*inv(~ltk.8))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.13 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.5), 'g'^~x.25, 
                                               'g'^(~prek.5*~x.25*inv(~ltk.8))>)
                                         >)
                                    >)
                           ) @ #vk.16 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.5), 'g'^~x.25, 
                                            'g'^(~prek.5*~x.25*inv(~ltk.8))>)
                                      >)
                             ) @ #vk.19 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.5), 'g'^~x.25, 
                                         'g'^(~prek.5*~x.25*inv(~ltk.8))>)
                               ) @ #vk.22 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~x.24 ) @ #vk.9 )
              qed
            next
              case SenderStart_case_2
              solve( !KU( 'g'^(~x.24*x.25*inv(~ltk.5)) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~x.26 ) @ #vk.9 )
              next
                case KeyGen_case_2
                by solve( !KU( ~x.26 ) @ #vk.9 )
              next
                case KeyGen_case_3
                by solve( !KU( ~x.26 ) @ #vk.9 )
              next
                case KeyGen_case_4
                by solve( !KU( ~x.26 ) @ #vk.9 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.27 ) @ #vk.9 )
              next
                case OuterRatchetToSender_case_2
                by solve( !KU( ~x.27 ) @ #vk.9 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.27 ) @ #vk.9 )
              next
                case SenderStart_case_2
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~x.26*x.27), 
                                                     'g'^(~prek.5*~x.26*x.27*inv(~ltk.8))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.28, pc.1, z.5, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.29, $B.3, old_pc, old_rk,
                                    old_ck
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.7,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~prek.10*~ltk.11), 
                                                                'g'^(~ltk.12*~x.29), 
                                                                'g'^(~prek.10*~x.29)>)
                                                          >), 
                                                      z.6>)
                                                >)
                                           >))
                             ) @ #vk.18 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~prek.10*~ltk.11), 
                                                             'g'^(~ltk.12*~x.29), 
                                                             'g'^(~prek.10*~x.29)>)
                                                       >), 
                                                   z.6>)
                                             >)
                                        >)
                               ) @ #vk.20 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~prek.10*~ltk.11), 
                                                          'g'^(~ltk.12*~x.29), 'g'^(~prek.10*~x.29)
                                                         >)
                                                    >), 
                                                z.6>)
                                          >)
                                 ) @ #vk.23 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~prek.10*~ltk.11), 'g'^(~ltk.12*~x.29), 
                                                       'g'^(~prek.10*~x.29)>)
                                                 >), 
                                             z.6>)
                                   ) @ #vk.26 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.5 ) @ #vk.12 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.11, ~prek.9 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.11, prek.9 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.5 ) @ #vk.12 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~x.26*x.27), 
                                                  'g'^(~prek.5*~x.26*x.27*inv(~ltk.8))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.17 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~x.26*x.27), 
                                               'g'^(~prek.5*~x.26*x.27*inv(~ltk.8))>)
                                         >)
                                    >)
                           ) @ #vk.20 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~x.26*x.27), 
                                            'g'^(~prek.5*~x.26*x.27*inv(~ltk.8))>)
                                      >)
                             ) @ #vk.23 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~x.26*x.27), 
                                         'g'^(~prek.5*~x.26*x.27*inv(~ltk.8))>)
                               ) @ #vk.26 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case SenderStart_case_3
                by solve( !KU( ~x.27 ) @ #vk.9 )
              next
                case c_exp
                by solve( !KU( ~x.24 ) @ #vk.10 )
              qed
            next
              case c_exp
              by solve( !KU( ~prek.2 ) @ #vk.5 )
            qed
          next
            case split_case_10
            solve( !KU( x.22^(x.23*inv(~prek.2)) ) @ #vk.1 )
              case KeyGen_case_1
              by solve( !KU( ~prek.4 ) @ #vk.4 )
            next
              case KeyGen_case_2
              by solve( !KU( ~prek.4 ) @ #vk.6 )
            next
              case KeyGen_case_3
              by solve( !KU( ~prek.4 ) @ #vk.4 )
            next
              case KeyGen_case_4
              by solve( !KU( ~prek.4 ) @ #vk.6 )
            next
              case OuterRatchetToSender_case_1
              solve( !KU( senc(x.1,
                               kdf(<'mk', 
                                    kdf(<'ck', 
                                         kdf(<'rk', 
                                              kdf(<'g'^(~ltk.1*~prek.3), 
                                                   'g'^(~ltk.2*~x.24*inv(~prek.3)), 'g'^~x.24>)
                                             >)
                                        >)
                                   >))
                     ) @ #vk.2 )
                case Send
                solve( !KU( 'g'^~x.24 ) @ #x )
                  case OuterRatchetToSender
                  solve( NewDHSecrets( ~id.3, 'g'^~x.25, pc.2, z.6, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.2, 'S', ~x.26, $B.2, old_pc, old_rk.2,
                                    old_ck.2
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.2 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.2 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.9,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.3*~prek.5), 
                                                                'g'^(~ltk.4*~x.26), 
                                                                'g'^(~prek.5*~x.26)>)
                                                          >), 
                                                      z.8>)
                                                >)
                                           >))
                             ) @ #vk.7 )
                        case OuterRatchetToSender
                        by solve( Send( m.2 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.2 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.3*~prek.5), 
                                                             'g'^(~ltk.4*~x.26), 'g'^(~prek.5*~x.26)
                                                            >)
                                                       >), 
                                                   z.8>)
                                             >)
                                        >)
                               ) @ #vk.9 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.3*~prek.5), 'g'^(~ltk.4*~x.26), 
                                                          'g'^(~prek.5*~x.26)>)
                                                    >), 
                                                z.8>)
                                          >)
                                 ) @ #vk.12 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.3*~prek.5), 'g'^(~ltk.4*~x.26), 
                                                       'g'^(~prek.5*~x.26)>)
                                                 >), 
                                             z.8>)
                                   ) @ #vk.15 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.2 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.3 ) @ #vk.4 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.3, ~prek.4 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.2 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.3, prek.4 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.2 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.3 ) @ #vk.4 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~x.24 ) @ #vk.6 )
                qed
              next
                case c_senc
                solve( !KU( kdf(<'mk', 
                                 kdf(<'ck', 
                                      kdf(<'rk', 
                                           kdf(<'g'^(~ltk.1*~prek.3), 
                                                'g'^(~ltk.2*~x.24*inv(~prek.3)), 'g'^~x.24>)
                                          >)
                                     >)
                                >)
                       ) @ #vk.6 )
                  case c_kdf
                  solve( !KU( kdf(<'ck', 
                                   kdf(<'rk', 
                                        kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.2*~x.24*inv(~prek.3)), 
                                             'g'^~x.24>)
                                       >)
                                  >)
                         ) @ #vk.9 )
                    case c_kdf
                    solve( !KU( kdf(<'rk', 
                                     kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~ltk.2*~x.24*inv(~prek.3)), 
                                          'g'^~x.24>)
                                    >)
                           ) @ #vk.12 )
                      case c_kdf
                      solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 
                                       'g'^(~ltk.2*~x.24*inv(~prek.3)), 'g'^~x.24>)
                             ) @ #vk.15 )
                        case c_kdf
                        by contradiction /* node #t after last node #vk.20 */
                      qed
                    qed
                  qed
                qed
              qed
            next
              case OuterRatchetToSender_case_2
              solve( !KU( 'g'^(~x.24*x.25) ) @ #x )
                case KeyGen_case_1
                by solve( !KU( ~x.26 ) @ #vk.7 )
              next
                case KeyGen_case_2
                by solve( !KU( ~x.26 ) @ #vk.8 )
              next
                case KeyGen_case_3
                by solve( !KU( ~x.26 ) @ #vk.7 )
              next
                case KeyGen_case_4
                by solve( !KU( ~x.26 ) @ #vk.8 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.27 ) @ #vk.7 )
              next
                case OuterRatchetToSender_case_2
                by solve( !KU( ~x.27 ) @ #vk.8 )
              next
                case OuterRatchetToSender_case_3
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 
                                                     'g'^(~ltk.2*~x.26*x.27*inv(~prek.3)), 
                                                     'g'^(~x.26*x.27)>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.28, pc.3, z.7, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.29, $B.3, old_pc, old_rk.2,
                                    old_ck.2
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.9,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.3*~prek.5), 
                                                                'g'^(~ltk.4*~x.29), 
                                                                'g'^(~prek.5*~x.29)>)
                                                          >), 
                                                      z.8>)
                                                >)
                                           >))
                             ) @ #vk.13 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.3*~prek.5), 
                                                             'g'^(~ltk.4*~x.29), 'g'^(~prek.5*~x.29)
                                                            >)
                                                       >), 
                                                   z.8>)
                                             >)
                                        >)
                               ) @ #vk.15 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.3*~prek.5), 'g'^(~ltk.4*~x.29), 
                                                          'g'^(~prek.5*~x.29)>)
                                                    >), 
                                                z.8>)
                                          >)
                                 ) @ #vk.18 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.3*~prek.5), 'g'^(~ltk.4*~x.29), 
                                                       'g'^(~prek.5*~x.29)>)
                                                 >), 
                                             z.8>)
                                   ) @ #vk.21 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.3 ) @ #vk.10 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.3, ~prek.4 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.3, prek.4 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.3 ) @ #vk.10 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.3), 
                                                  'g'^(~ltk.2*~x.26*x.27*inv(~prek.3)), 
                                                  'g'^(~x.26*x.27)>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.12 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.3), 
                                               'g'^(~ltk.2*~x.26*x.27*inv(~prek.3)), 
                                               'g'^(~x.26*x.27)>)
                                         >)
                                    >)
                           ) @ #vk.15 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.3), 
                                            'g'^(~ltk.2*~x.26*x.27*inv(~prek.3)), 'g'^(~x.26*x.27)>)
                                      >)
                             ) @ #vk.18 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 
                                         'g'^(~ltk.2*~x.26*x.27*inv(~prek.3)), 'g'^(~x.26*x.27)>)
                               ) @ #vk.21 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case SenderStart_case_1
                by solve( !KU( ~x.27 ) @ #vk.7 )
              next
                case SenderStart_case_2
                by solve( !KU( ~x.27 ) @ #vk.8 )
              next
                case c_exp
                by solve( !KU( ~x.24 ) @ #vk.9 )
              qed
            next
              case SenderStart_case_1
              solve( !KU( senc(x.1,
                               kdf(<'mk', 
                                    kdf(<'ck', 
                                         kdf(<'rk', 
                                              kdf(<'g'^(~ltk.1*~prek.5), 
                                                   'g'^(~ltk.2*~x.24*inv(~prek.5)), 'g'^~x.24>)
                                             >)
                                        >)
                                   >))
                     ) @ #vk.2 )
                case Send
                solve( !KU( 'g'^~x.24 ) @ #x )
                  case SenderStart
                  solve( NewDHSecrets( ~id.3, 'g'^~x.25, pc.1, z.5, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.2, 'S', ~x.26, $B.2, old_pc, old_rk,
                                    old_ck
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.2 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.2 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.7,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.9*~prek.10), 
                                                                'g'^(~ltk.10*~x.26), 
                                                                'g'^(~prek.10*~x.26)>)
                                                          >), 
                                                      z.6>)
                                                >)
                                           >))
                             ) @ #vk.7 )
                        case OuterRatchetToSender
                        by solve( Send( m.2 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.2 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.9*~prek.10), 
                                                             'g'^(~ltk.10*~x.26), 
                                                             'g'^(~prek.10*~x.26)>)
                                                       >), 
                                                   z.6>)
                                             >)
                                        >)
                               ) @ #vk.9 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.9*~prek.10), 
                                                          'g'^(~ltk.10*~x.26), 'g'^(~prek.10*~x.26)
                                                         >)
                                                    >), 
                                                z.6>)
                                          >)
                                 ) @ #vk.12 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.9*~prek.10), 'g'^(~ltk.10*~x.26), 
                                                       'g'^(~prek.10*~x.26)>)
                                                 >), 
                                             z.6>)
                                   ) @ #vk.15 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.2 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.5 ) @ #vk.4 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.9, ~prek.9 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.2 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.9, prek.9 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.2 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.5 ) @ #vk.4 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_exp
                  by solve( !KU( ~x.24 ) @ #vk.6 )
                qed
              next
                case c_senc
                solve( !KU( kdf(<'mk', 
                                 kdf(<'ck', 
                                      kdf(<'rk', 
                                           kdf(<'g'^(~ltk.1*~prek.5), 
                                                'g'^(~ltk.2*~x.24*inv(~prek.5)), 'g'^~x.24>)
                                          >)
                                     >)
                                >)
                       ) @ #vk.6 )
                  case c_kdf
                  solve( !KU( kdf(<'ck', 
                                   kdf(<'rk', 
                                        kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~ltk.2*~x.24*inv(~prek.5)), 
                                             'g'^~x.24>)
                                       >)
                                  >)
                         ) @ #vk.9 )
                    case c_kdf
                    solve( !KU( kdf(<'rk', 
                                     kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~ltk.2*~x.24*inv(~prek.5)), 
                                          'g'^~x.24>)
                                    >)
                           ) @ #vk.12 )
                      case c_kdf
                      solve( !KU( kdf(<'g'^(~ltk.1*~prek.5), 
                                       'g'^(~ltk.2*~x.24*inv(~prek.5)), 'g'^~x.24>)
                             ) @ #vk.15 )
                        case c_kdf
                        by contradiction /* node #t after last node #vk.20 */
                      qed
                    qed
                  qed
                qed
              qed
            next
              case SenderStart_case_2
              solve( !KU( 'g'^(~x.24*x.25) ) @ #x )
                case KeyGen_case_1
                by solve( !KU( ~x.26 ) @ #vk.7 )
              next
                case KeyGen_case_2
                by solve( !KU( ~x.26 ) @ #vk.8 )
              next
                case KeyGen_case_3
                by solve( !KU( ~x.26 ) @ #vk.7 )
              next
                case KeyGen_case_4
                by solve( !KU( ~x.26 ) @ #vk.8 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.27 ) @ #vk.7 )
              next
                case OuterRatchetToSender_case_2
                by solve( !KU( ~x.27 ) @ #vk.8 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.27 ) @ #vk.7 )
              next
                case SenderStart_case_2
                by solve( !KU( ~x.27 ) @ #vk.8 )
              next
                case SenderStart_case_3
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.5), 
                                                     'g'^(~ltk.2*~x.26*x.27*inv(~prek.5)), 
                                                     'g'^(~x.26*x.27)>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.28, pc.1, z.5, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.29, $B.3, old_pc, old_rk,
                                    old_ck
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.7,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.9*~prek.10), 
                                                                'g'^(~ltk.10*~x.29), 
                                                                'g'^(~prek.10*~x.29)>)
                                                          >), 
                                                      z.6>)
                                                >)
                                           >))
                             ) @ #vk.13 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.9*~prek.10), 
                                                             'g'^(~ltk.10*~x.29), 
                                                             'g'^(~prek.10*~x.29)>)
                                                       >), 
                                                   z.6>)
                                             >)
                                        >)
                               ) @ #vk.15 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.9*~prek.10), 
                                                          'g'^(~ltk.10*~x.29), 'g'^(~prek.10*~x.29)
                                                         >)
                                                    >), 
                                                z.6>)
                                          >)
                                 ) @ #vk.18 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.9*~prek.10), 'g'^(~ltk.10*~x.29), 
                                                       'g'^(~prek.10*~x.29)>)
                                                 >), 
                                             z.6>)
                                   ) @ #vk.21 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.5 ) @ #vk.10 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.9, ~prek.9 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.9, prek.9 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.5 ) @ #vk.10 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.5), 
                                                  'g'^(~ltk.2*~x.26*x.27*inv(~prek.5)), 
                                                  'g'^(~x.26*x.27)>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.12 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.5), 
                                               'g'^(~ltk.2*~x.26*x.27*inv(~prek.5)), 
                                               'g'^(~x.26*x.27)>)
                                         >)
                                    >)
                           ) @ #vk.15 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.5), 
                                            'g'^(~ltk.2*~x.26*x.27*inv(~prek.5)), 'g'^(~x.26*x.27)>)
                                      >)
                             ) @ #vk.18 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.5), 
                                         'g'^(~ltk.2*~x.26*x.27*inv(~prek.5)), 'g'^(~x.26*x.27)>)
                               ) @ #vk.21 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~x.24 ) @ #vk.9 )
              qed
            next
              case c_exp
              by solve( !KU( ~prek.2 ) @ #vk.7 )
            qed
          next
            case split_case_11
            solve( !KU( x.22^(x.23*inv(~ltk.2)) ) @ #x )
              case KeyGen_case_1
              by solve( !KU( ~ltk.4 ) @ #vk.4 )
            next
              case KeyGen_case_2
              by solve( !KU( ~ltk.4 ) @ #vk.6 )
            next
              case KeyGen_case_3
              by solve( !KU( ~ltk.4 ) @ #vk.4 )
            next
              case KeyGen_case_4
              by solve( !KU( ~ltk.4 ) @ #vk.6 )
            next
              case OuterRatchetToSender_case_1
              solve( !KU( 'g'^(~x.24*inv((~prek.2*~ltk.3))) ) @ #vk.1 )
                case OuterRatchetToSender
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 
                                                     'g'^(~x.25*inv(~prek.3)), 
                                                     'g'^(~x.25*inv(~ltk.4))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.26, pc.3, z.7, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.27, $B.3, old_pc, old_rk.2,
                                    old_ck.2
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.9,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.5*~prek.5), 
                                                                'g'^(~ltk.6*~x.27), 
                                                                'g'^(~prek.5*~x.27)>)
                                                          >), 
                                                      z.8>)
                                                >)
                                           >))
                             ) @ #vk.11 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.5*~prek.5), 
                                                             'g'^(~ltk.6*~x.27), 'g'^(~prek.5*~x.27)
                                                            >)
                                                       >), 
                                                   z.8>)
                                             >)
                                        >)
                               ) @ #vk.13 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.27), 
                                                          'g'^(~prek.5*~x.27)>)
                                                    >), 
                                                z.8>)
                                          >)
                                 ) @ #vk.16 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.27), 
                                                       'g'^(~prek.5*~x.27)>)
                                                 >), 
                                             z.8>)
                                   ) @ #vk.19 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~ltk.4 ) @ #vk.8 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.5, ~prek.4 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.5, prek.4 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~ltk.4 ) @ #vk.8 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.25*inv(~prek.3)), 
                                                  'g'^(~x.25*inv(~ltk.4))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.10 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.25*inv(~prek.3)), 
                                               'g'^(~x.25*inv(~ltk.4))>)
                                         >)
                                    >)
                           ) @ #vk.13 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.25*inv(~prek.3)), 
                                            'g'^(~x.25*inv(~ltk.4))>)
                                      >)
                             ) @ #vk.16 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.25*inv(~prek.3)), 
                                         'g'^(~x.25*inv(~ltk.4))>)
                               ) @ #vk.19 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~x.24 ) @ #vk.7 )
              qed
            next
              case OuterRatchetToSender_case_2
              solve( !KU( 'g'^(~x.24*x.25*inv((~prek.2*~ltk.3))) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~x.26 ) @ #vk.8 )
              next
                case KeyGen_case_2
                by solve( !KU( ~x.26 ) @ #vk.8 )
              next
                case KeyGen_case_3
                by solve( !KU( ~x.26 ) @ #vk.8 )
              next
                case KeyGen_case_4
                by solve( !KU( ~x.26 ) @ #vk.8 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.27 ) @ #vk.8 )
              next
                case OuterRatchetToSender_case_2
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 
                                                     'g'^(~x.26*x.27*inv(~prek.3)), 
                                                     'g'^(~x.26*x.27*inv(~ltk.4))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.28, pc.3, z.7, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.29, $B.3, old_pc, old_rk.2,
                                    old_ck.2
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.9,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.5*~prek.5), 
                                                                'g'^(~ltk.6*~x.29), 
                                                                'g'^(~prek.5*~x.29)>)
                                                          >), 
                                                      z.8>)
                                                >)
                                           >))
                             ) @ #vk.18 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.5*~prek.5), 
                                                             'g'^(~ltk.6*~x.29), 'g'^(~prek.5*~x.29)
                                                            >)
                                                       >), 
                                                   z.8>)
                                             >)
                                        >)
                               ) @ #vk.20 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.29), 
                                                          'g'^(~prek.5*~x.29)>)
                                                    >), 
                                                z.8>)
                                          >)
                                 ) @ #vk.23 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.29), 
                                                       'g'^(~prek.5*~x.29)>)
                                                 >), 
                                             z.8>)
                                   ) @ #vk.26 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~ltk.4 ) @ #vk.15 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.5, ~prek.4 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.5, prek.4 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~ltk.4 ) @ #vk.15 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.3), 
                                                  'g'^(~x.26*x.27*inv(~prek.3)), 
                                                  'g'^(~x.26*x.27*inv(~ltk.4))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.17 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.26*x.27*inv(~prek.3)), 
                                               'g'^(~x.26*x.27*inv(~ltk.4))>)
                                         >)
                                    >)
                           ) @ #vk.20 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.26*x.27*inv(~prek.3)), 
                                            'g'^(~x.26*x.27*inv(~ltk.4))>)
                                      >)
                             ) @ #vk.23 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 
                                         'g'^(~x.26*x.27*inv(~prek.3)), 'g'^(~x.26*x.27*inv(~ltk.4))
                                        >)
                               ) @ #vk.26 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case OuterRatchetToSender_case_3
                by solve( !KU( ~x.27 ) @ #vk.8 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.27 ) @ #vk.8 )
              next
                case SenderStart_case_2
                by solve( !KU( ~x.27 ) @ #vk.8 )
              next
                case c_exp
                by solve( !KU( ~x.24 ) @ #vk.9 )
              qed
            next
              case SenderStart_case_1
              solve( !KU( 'g'^(~x.24*inv((~prek.2*~ltk.5))) ) @ #vk.1 )
                case SenderStart
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.7), 
                                                     'g'^(~x.25*inv(~prek.7)), 
                                                     'g'^(~x.25*inv(~ltk.8))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.26, pc.1, z.5, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.27, $B.3, old_pc, old_rk,
                                    old_ck
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.7,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~prek.10*~ltk.11), 
                                                                'g'^(~ltk.12*~x.27), 
                                                                'g'^(~prek.10*~x.27)>)
                                                          >), 
                                                      z.6>)
                                                >)
                                           >))
                             ) @ #vk.11 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~prek.10*~ltk.11), 
                                                             'g'^(~ltk.12*~x.27), 
                                                             'g'^(~prek.10*~x.27)>)
                                                       >), 
                                                   z.6>)
                                             >)
                                        >)
                               ) @ #vk.13 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~prek.10*~ltk.11), 
                                                          'g'^(~ltk.12*~x.27), 'g'^(~prek.10*~x.27)
                                                         >)
                                                    >), 
                                                z.6>)
                                          >)
                                 ) @ #vk.16 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~prek.10*~ltk.11), 'g'^(~ltk.12*~x.27), 
                                                       'g'^(~prek.10*~x.27)>)
                                                 >), 
                                             z.6>)
                                   ) @ #vk.19 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~ltk.8 ) @ #vk.8 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.11, ~prek.9 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.11, prek.9 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~ltk.8 ) @ #vk.8 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.7), 'g'^(~x.25*inv(~prek.7)), 
                                                  'g'^(~x.25*inv(~ltk.8))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.10 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.7), 'g'^(~x.25*inv(~prek.7)), 
                                               'g'^(~x.25*inv(~ltk.8))>)
                                         >)
                                    >)
                           ) @ #vk.13 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.7), 'g'^(~x.25*inv(~prek.7)), 
                                            'g'^(~x.25*inv(~ltk.8))>)
                                      >)
                             ) @ #vk.16 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.7), 'g'^(~x.25*inv(~prek.7)), 
                                         'g'^(~x.25*inv(~ltk.8))>)
                               ) @ #vk.19 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~x.24 ) @ #vk.7 )
              qed
            next
              case SenderStart_case_2
              solve( !KU( 'g'^(~x.24*x.25*inv((~prek.2*~ltk.5))) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~x.26 ) @ #vk.8 )
              next
                case KeyGen_case_2
                by solve( !KU( ~x.26 ) @ #vk.8 )
              next
                case KeyGen_case_3
                by solve( !KU( ~x.26 ) @ #vk.8 )
              next
                case KeyGen_case_4
                by solve( !KU( ~x.26 ) @ #vk.8 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.27 ) @ #vk.8 )
              next
                case OuterRatchetToSender_case_2
                by solve( !KU( ~x.27 ) @ #vk.8 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.27 ) @ #vk.8 )
              next
                case SenderStart_case_2
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.7), 
                                                     'g'^(~x.26*x.27*inv(~prek.7)), 
                                                     'g'^(~x.26*x.27*inv(~ltk.8))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.28, pc.1, z.5, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.29, $B.3, old_pc, old_rk,
                                    old_ck
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.7,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~prek.10*~ltk.11), 
                                                                'g'^(~ltk.12*~x.29), 
                                                                'g'^(~prek.10*~x.29)>)
                                                          >), 
                                                      z.6>)
                                                >)
                                           >))
                             ) @ #vk.18 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~prek.10*~ltk.11), 
                                                             'g'^(~ltk.12*~x.29), 
                                                             'g'^(~prek.10*~x.29)>)
                                                       >), 
                                                   z.6>)
                                             >)
                                        >)
                               ) @ #vk.20 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~prek.10*~ltk.11), 
                                                          'g'^(~ltk.12*~x.29), 'g'^(~prek.10*~x.29)
                                                         >)
                                                    >), 
                                                z.6>)
                                          >)
                                 ) @ #vk.23 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~prek.10*~ltk.11), 'g'^(~ltk.12*~x.29), 
                                                       'g'^(~prek.10*~x.29)>)
                                                 >), 
                                             z.6>)
                                   ) @ #vk.26 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~ltk.8 ) @ #vk.15 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.11, ~prek.9 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.11, prek.9 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~ltk.8 ) @ #vk.15 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.7), 
                                                  'g'^(~x.26*x.27*inv(~prek.7)), 
                                                  'g'^(~x.26*x.27*inv(~ltk.8))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.17 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.7), 'g'^(~x.26*x.27*inv(~prek.7)), 
                                               'g'^(~x.26*x.27*inv(~ltk.8))>)
                                         >)
                                    >)
                           ) @ #vk.20 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.7), 'g'^(~x.26*x.27*inv(~prek.7)), 
                                            'g'^(~x.26*x.27*inv(~ltk.8))>)
                                      >)
                             ) @ #vk.23 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.7), 
                                         'g'^(~x.26*x.27*inv(~prek.7)), 'g'^(~x.26*x.27*inv(~ltk.8))
                                        >)
                               ) @ #vk.26 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case SenderStart_case_3
                by solve( !KU( ~x.27 ) @ #vk.8 )
              next
                case c_exp
                by solve( !KU( ~x.24 ) @ #vk.9 )
              qed
            next
              case c_exp
              by solve( !KU( ~ltk.2 ) @ #vk.7 )
            qed
          next
            case split_case_12
            solve( !KU( x.22^(x.23*inv((~ltk.2*x.24))) ) @ #x )
              case KeyGen_case_1
              by solve( !KU( ~ltk.4 ) @ #vk.5 )
            next
              case KeyGen_case_2
              by solve( !KU( ~ltk.4 ) @ #vk.7 )
            next
              case KeyGen_case_3
              by solve( !KU( ~ltk.4 ) @ #vk.5 )
            next
              case KeyGen_case_4
              by solve( !KU( ~ltk.4 ) @ #vk.7 )
            next
              case OuterRatchetToSender_case_1
              solve( !KU( 'g'^(~x.25*inv((~prek.2*~ltk.3*x.26))) ) @ #vk.1 )
                case OuterRatchetToSender
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 
                                                     'g'^(~x.27*inv((~prek.3*x.28))), 
                                                     'g'^(~x.27*inv((~ltk.4*x.28)))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.29, pc.3, z.7, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.30, $B.3, old_pc, old_rk.2,
                                    old_ck.2
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.9,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.5*~prek.5), 
                                                                'g'^(~ltk.6*~x.30), 
                                                                'g'^(~prek.5*~x.30)>)
                                                          >), 
                                                      z.8>)
                                                >)
                                           >))
                             ) @ #vk.16 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.5*~prek.5), 
                                                             'g'^(~ltk.6*~x.30), 'g'^(~prek.5*~x.30)
                                                            >)
                                                       >), 
                                                   z.8>)
                                             >)
                                        >)
                               ) @ #vk.18 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.30), 
                                                          'g'^(~prek.5*~x.30)>)
                                                    >), 
                                                z.8>)
                                          >)
                                 ) @ #vk.21 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.30), 
                                                       'g'^(~prek.5*~x.30)>)
                                                 >), 
                                             z.8>)
                                   ) @ #vk.24 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~ltk.4 ) @ #vk.12 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.5, ~prek.4 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.5, prek.4 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~ltk.4 ) @ #vk.12 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.3), 
                                                  'g'^(~x.27*inv((~prek.3*x.28))), 
                                                  'g'^(~x.27*inv((~ltk.4*x.28)))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.15 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.3), 
                                               'g'^(~x.27*inv((~prek.3*x.28))), 
                                               'g'^(~x.27*inv((~ltk.4*x.28)))>)
                                         >)
                                    >)
                           ) @ #vk.18 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.27*inv((~prek.3*x.28))), 
                                            'g'^(~x.27*inv((~ltk.4*x.28)))>)
                                      >)
                             ) @ #vk.21 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 
                                         'g'^(~x.27*inv((~prek.3*x.28))), 
                                         'g'^(~x.27*inv((~ltk.4*x.28)))>)
                               ) @ #vk.24 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~x.25 ) @ #vk.9 )
              qed
            next
              case OuterRatchetToSender_case_2
              solve( !KU( 'g'^(~x.25*x.26*inv((~prek.2*~ltk.3*x.27))) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~x.28 ) @ #vk.10 )
              next
                case KeyGen_case_2
                by solve( !KU( ~x.28 ) @ #vk.10 )
              next
                case KeyGen_case_3
                by solve( !KU( ~x.28 ) @ #vk.10 )
              next
                case KeyGen_case_4
                by solve( !KU( ~x.28 ) @ #vk.10 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.29 ) @ #vk.10 )
              next
                case OuterRatchetToSender_case_2
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 
                                                     'g'^(~x.28*x.29*inv((~prek.3*x.30))), 
                                                     'g'^(~x.28*x.29*inv((~ltk.4*x.30)))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.31, pc.3, z.7, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.32, $B.3, old_pc, old_rk.2,
                                    old_ck.2
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.9,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.5*~prek.5), 
                                                                'g'^(~ltk.6*~x.32), 
                                                                'g'^(~prek.5*~x.32)>)
                                                          >), 
                                                      z.8>)
                                                >)
                                           >))
                             ) @ #vk.25 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.5*~prek.5), 
                                                             'g'^(~ltk.6*~x.32), 'g'^(~prek.5*~x.32)
                                                            >)
                                                       >), 
                                                   z.8>)
                                             >)
                                        >)
                               ) @ #vk.27 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.32), 
                                                          'g'^(~prek.5*~x.32)>)
                                                    >), 
                                                z.8>)
                                          >)
                                 ) @ #vk.30 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.32), 
                                                       'g'^(~prek.5*~x.32)>)
                                                 >), 
                                             z.8>)
                                   ) @ #vk.33 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~ltk.4 ) @ #vk.21 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.5, ~prek.4 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.5, prek.4 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~ltk.4 ) @ #vk.21 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.3), 
                                                  'g'^(~x.28*x.29*inv((~prek.3*x.30))), 
                                                  'g'^(~x.28*x.29*inv((~ltk.4*x.30)))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.24 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.3), 
                                               'g'^(~x.28*x.29*inv((~prek.3*x.30))), 
                                               'g'^(~x.28*x.29*inv((~ltk.4*x.30)))>)
                                         >)
                                    >)
                           ) @ #vk.27 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.3), 
                                            'g'^(~x.28*x.29*inv((~prek.3*x.30))), 
                                            'g'^(~x.28*x.29*inv((~ltk.4*x.30)))>)
                                      >)
                             ) @ #vk.30 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 
                                         'g'^(~x.28*x.29*inv((~prek.3*x.30))), 
                                         'g'^(~x.28*x.29*inv((~ltk.4*x.30)))>)
                               ) @ #vk.33 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case OuterRatchetToSender_case_3
                by solve( !KU( ~x.29 ) @ #vk.10 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.29 ) @ #vk.10 )
              next
                case SenderStart_case_2
                by solve( !KU( ~x.29 ) @ #vk.10 )
              next
                case c_exp
                by solve( !KU( ~x.25 ) @ #vk.11 )
              qed
            next
              case SenderStart_case_1
              solve( !KU( 'g'^(~x.25*inv((~prek.2*~ltk.5*x.26))) ) @ #vk.1 )
                case SenderStart
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.7), 
                                                     'g'^(~x.27*inv((~prek.7*x.28))), 
                                                     'g'^(~x.27*inv((~ltk.8*x.28)))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.29, pc.1, z.5, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.30, $B.3, old_pc, old_rk,
                                    old_ck
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.7,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~prek.10*~ltk.11), 
                                                                'g'^(~ltk.12*~x.30), 
                                                                'g'^(~prek.10*~x.30)>)
                                                          >), 
                                                      z.6>)
                                                >)
                                           >))
                             ) @ #vk.16 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~prek.10*~ltk.11), 
                                                             'g'^(~ltk.12*~x.30), 
                                                             'g'^(~prek.10*~x.30)>)
                                                       >), 
                                                   z.6>)
                                             >)
                                        >)
                               ) @ #vk.18 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~prek.10*~ltk.11), 
                                                          'g'^(~ltk.12*~x.30), 'g'^(~prek.10*~x.30)
                                                         >)
                                                    >), 
                                                z.6>)
                                          >)
                                 ) @ #vk.21 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~prek.10*~ltk.11), 'g'^(~ltk.12*~x.30), 
                                                       'g'^(~prek.10*~x.30)>)
                                                 >), 
                                             z.6>)
                                   ) @ #vk.24 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~ltk.8 ) @ #vk.12 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.11, ~prek.9 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.11, prek.9 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~ltk.8 ) @ #vk.12 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.7), 
                                                  'g'^(~x.27*inv((~prek.7*x.28))), 
                                                  'g'^(~x.27*inv((~ltk.8*x.28)))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.15 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.7), 
                                               'g'^(~x.27*inv((~prek.7*x.28))), 
                                               'g'^(~x.27*inv((~ltk.8*x.28)))>)
                                         >)
                                    >)
                           ) @ #vk.18 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.7), 'g'^(~x.27*inv((~prek.7*x.28))), 
                                            'g'^(~x.27*inv((~ltk.8*x.28)))>)
                                      >)
                             ) @ #vk.21 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.7), 
                                         'g'^(~x.27*inv((~prek.7*x.28))), 
                                         'g'^(~x.27*inv((~ltk.8*x.28)))>)
                               ) @ #vk.24 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~x.25 ) @ #vk.9 )
              qed
            next
              case SenderStart_case_2
              solve( !KU( 'g'^(~x.25*x.26*inv((~prek.2*~ltk.5*x.27))) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~x.28 ) @ #vk.10 )
              next
                case KeyGen_case_2
                by solve( !KU( ~x.28 ) @ #vk.10 )
              next
                case KeyGen_case_3
                by solve( !KU( ~x.28 ) @ #vk.10 )
              next
                case KeyGen_case_4
                by solve( !KU( ~x.28 ) @ #vk.10 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.29 ) @ #vk.10 )
              next
                case OuterRatchetToSender_case_2
                by solve( !KU( ~x.29 ) @ #vk.10 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.29 ) @ #vk.10 )
              next
                case SenderStart_case_2
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.7), 
                                                     'g'^(~x.28*x.29*inv((~prek.7*x.30))), 
                                                     'g'^(~x.28*x.29*inv((~ltk.8*x.30)))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.31, pc.1, z.5, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.32, $B.3, old_pc, old_rk,
                                    old_ck
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.7,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~prek.10*~ltk.11), 
                                                                'g'^(~ltk.12*~x.32), 
                                                                'g'^(~prek.10*~x.32)>)
                                                          >), 
                                                      z.6>)
                                                >)
                                           >))
                             ) @ #vk.25 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~prek.10*~ltk.11), 
                                                             'g'^(~ltk.12*~x.32), 
                                                             'g'^(~prek.10*~x.32)>)
                                                       >), 
                                                   z.6>)
                                             >)
                                        >)
                               ) @ #vk.27 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~prek.10*~ltk.11), 
                                                          'g'^(~ltk.12*~x.32), 'g'^(~prek.10*~x.32)
                                                         >)
                                                    >), 
                                                z.6>)
                                          >)
                                 ) @ #vk.30 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~prek.10*~ltk.11), 'g'^(~ltk.12*~x.32), 
                                                       'g'^(~prek.10*~x.32)>)
                                                 >), 
                                             z.6>)
                                   ) @ #vk.33 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~ltk.8 ) @ #vk.21 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.11, ~prek.9 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.11, prek.9 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~ltk.8 ) @ #vk.21 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.7), 
                                                  'g'^(~x.28*x.29*inv((~prek.7*x.30))), 
                                                  'g'^(~x.28*x.29*inv((~ltk.8*x.30)))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.24 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.7), 
                                               'g'^(~x.28*x.29*inv((~prek.7*x.30))), 
                                               'g'^(~x.28*x.29*inv((~ltk.8*x.30)))>)
                                         >)
                                    >)
                           ) @ #vk.27 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.7), 
                                            'g'^(~x.28*x.29*inv((~prek.7*x.30))), 
                                            'g'^(~x.28*x.29*inv((~ltk.8*x.30)))>)
                                      >)
                             ) @ #vk.30 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.7), 
                                         'g'^(~x.28*x.29*inv((~prek.7*x.30))), 
                                         'g'^(~x.28*x.29*inv((~ltk.8*x.30)))>)
                               ) @ #vk.33 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case SenderStart_case_3
                by solve( !KU( ~x.29 ) @ #vk.10 )
              next
                case c_exp
                by solve( !KU( ~x.25 ) @ #vk.11 )
              qed
            next
              case c_exp
              by solve( !KU( ~ltk.2 ) @ #vk.8 )
            qed
          next
            case split_case_13
            solve( !KU( x.22^(~prek.2*x.23*inv((~ltk.2*x.24))) ) @ #x )
              case KeyGen_case_1
              by solve( !KU( ~prek.4 ) @ #vk.4 )
            next
              case KeyGen_case_2
              by solve( !KU( ~prek.4 ) @ #vk.4 )
            next
              case KeyGen_case_3
              by solve( !KU( ~prek.4 ) @ #vk.4 )
            next
              case KeyGen_case_4
              by solve( !KU( ~ltk.3 ) @ #vk.14 )
            next
              case KeyGen_case_5
              by solve( !KU( ~prek.4 ) @ #vk.4 )
            next
              case OuterRatchetToSender_case_1
              solve( !KU( 'g'^(~x.25*inv((~ltk.3*x.26))) ) @ #vk.1 )
                case OuterRatchetToSender
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.27*inv(x.28)), 
                                                     'g'^(~prek.3*~x.27*inv((~ltk.4*x.28)))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.29, pc.3, z.7, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.30, $B.3, old_pc, old_rk.2,
                                    old_ck.2
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.9,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.5*~prek.5), 
                                                                'g'^(~ltk.6*~x.30), 
                                                                'g'^(~prek.5*~x.30)>)
                                                          >), 
                                                      z.8>)
                                                >)
                                           >))
                             ) @ #vk.22 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.5*~prek.5), 
                                                             'g'^(~ltk.6*~x.30), 'g'^(~prek.5*~x.30)
                                                            >)
                                                       >), 
                                                   z.8>)
                                             >)
                                        >)
                               ) @ #vk.24 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.30), 
                                                          'g'^(~prek.5*~x.30)>)
                                                    >), 
                                                z.8>)
                                          >)
                                 ) @ #vk.27 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.30), 
                                                       'g'^(~prek.5*~x.30)>)
                                                 >), 
                                             z.8>)
                                   ) @ #vk.30 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.3 ) @ #vk.13 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.5, ~prek.4 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.5, prek.4 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.3 ) @ #vk.13 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.27*inv(x.28)), 
                                                  'g'^(~prek.3*~x.27*inv((~ltk.4*x.28)))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.21 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.27*inv(x.28)), 
                                               'g'^(~prek.3*~x.27*inv((~ltk.4*x.28)))>)
                                         >)
                                    >)
                           ) @ #vk.24 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.27*inv(x.28)), 
                                            'g'^(~prek.3*~x.27*inv((~ltk.4*x.28)))>)
                                      >)
                             ) @ #vk.27 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.27*inv(x.28)), 
                                         'g'^(~prek.3*~x.27*inv((~ltk.4*x.28)))>)
                               ) @ #vk.30 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~x.25 ) @ #vk.11 )
              qed
            next
              case OuterRatchetToSender_case_2
              solve( !KU( 'g'^(~x.25*x.26*inv((~ltk.3*x.27))) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~x.28 ) @ #vk.11 )
              next
                case KeyGen_case_2
                by solve( !KU( ~x.28 ) @ #vk.11 )
              next
                case KeyGen_case_3
                by solve( !KU( ~x.28 ) @ #vk.11 )
              next
                case KeyGen_case_4
                by solve( !KU( ~x.28 ) @ #vk.11 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.29 ) @ #vk.11 )
              next
                case OuterRatchetToSender_case_2
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 
                                                     'g'^(~x.28*x.29*inv(x.30)), 
                                                     'g'^(~prek.3*~x.28*x.29*inv((~ltk.4*x.30)))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.31, pc.3, z.7, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.32, $B.3, old_pc, old_rk.2,
                                    old_ck.2
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.9,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.5*~prek.5), 
                                                                'g'^(~ltk.6*~x.32), 
                                                                'g'^(~prek.5*~x.32)>)
                                                          >), 
                                                      z.8>)
                                                >)
                                           >))
                             ) @ #vk.26 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.5*~prek.5), 
                                                             'g'^(~ltk.6*~x.32), 'g'^(~prek.5*~x.32)
                                                            >)
                                                       >), 
                                                   z.8>)
                                             >)
                                        >)
                               ) @ #vk.28 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.32), 
                                                          'g'^(~prek.5*~x.32)>)
                                                    >), 
                                                z.8>)
                                          >)
                                 ) @ #vk.31 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.5*~prek.5), 'g'^(~ltk.6*~x.32), 
                                                       'g'^(~prek.5*~x.32)>)
                                                 >), 
                                             z.8>)
                                   ) @ #vk.34 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.3 ) @ #vk.16 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.5, ~prek.4 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.5, prek.4 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.3 ) @ #vk.16 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.28*x.29*inv(x.30)), 
                                                  'g'^(~prek.3*~x.28*x.29*inv((~ltk.4*x.30)))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.25 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.28*x.29*inv(x.30)), 
                                               'g'^(~prek.3*~x.28*x.29*inv((~ltk.4*x.30)))>)
                                         >)
                                    >)
                           ) @ #vk.28 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.28*x.29*inv(x.30)), 
                                            'g'^(~prek.3*~x.28*x.29*inv((~ltk.4*x.30)))>)
                                      >)
                             ) @ #vk.31 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 'g'^(~x.28*x.29*inv(x.30)), 
                                         'g'^(~prek.3*~x.28*x.29*inv((~ltk.4*x.30)))>)
                               ) @ #vk.34 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case OuterRatchetToSender_case_3
                by solve( !KU( ~x.29 ) @ #vk.11 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.29 ) @ #vk.11 )
              next
                case SenderStart_case_2
                by solve( !KU( ~x.29 ) @ #vk.11 )
              next
                case c_exp
                by solve( !KU( ~x.25 ) @ #vk.12 )
              qed
            next
              case SenderStart_case_1
              solve( !KU( 'g'^(~x.25*inv((~ltk.5*x.26))) ) @ #vk.1 )
                case SenderStart
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~x.27*inv(x.28)), 
                                                     'g'^(~prek.5*~x.27*inv((~ltk.8*x.28)))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.29, pc.1, z.5, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.30, $B.3, old_pc, old_rk,
                                    old_ck
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.7,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~prek.10*~ltk.11), 
                                                                'g'^(~ltk.12*~x.30), 
                                                                'g'^(~prek.10*~x.30)>)
                                                          >), 
                                                      z.6>)
                                                >)
                                           >))
                             ) @ #vk.22 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~prek.10*~ltk.11), 
                                                             'g'^(~ltk.12*~x.30), 
                                                             'g'^(~prek.10*~x.30)>)
                                                       >), 
                                                   z.6>)
                                             >)
                                        >)
                               ) @ #vk.24 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~prek.10*~ltk.11), 
                                                          'g'^(~ltk.12*~x.30), 'g'^(~prek.10*~x.30)
                                                         >)
                                                    >), 
                                                z.6>)
                                          >)
                                 ) @ #vk.27 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~prek.10*~ltk.11), 'g'^(~ltk.12*~x.30), 
                                                       'g'^(~prek.10*~x.30)>)
                                                 >), 
                                             z.6>)
                                   ) @ #vk.30 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.5 ) @ #vk.13 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.11, ~prek.9 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.11, prek.9 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.5 ) @ #vk.13 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~x.27*inv(x.28)), 
                                                  'g'^(~prek.5*~x.27*inv((~ltk.8*x.28)))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.21 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~x.27*inv(x.28)), 
                                               'g'^(~prek.5*~x.27*inv((~ltk.8*x.28)))>)
                                         >)
                                    >)
                           ) @ #vk.24 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~x.27*inv(x.28)), 
                                            'g'^(~prek.5*~x.27*inv((~ltk.8*x.28)))>)
                                      >)
                             ) @ #vk.27 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~x.27*inv(x.28)), 
                                         'g'^(~prek.5*~x.27*inv((~ltk.8*x.28)))>)
                               ) @ #vk.30 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~x.25 ) @ #vk.11 )
              qed
            next
              case SenderStart_case_2
              solve( !KU( 'g'^(~x.25*x.26*inv((~ltk.5*x.27))) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~x.28 ) @ #vk.11 )
              next
                case KeyGen_case_2
                by solve( !KU( ~x.28 ) @ #vk.11 )
              next
                case KeyGen_case_3
                by solve( !KU( ~x.28 ) @ #vk.11 )
              next
                case KeyGen_case_4
                by solve( !KU( ~x.28 ) @ #vk.11 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.29 ) @ #vk.11 )
              next
                case OuterRatchetToSender_case_2
                by solve( !KU( ~x.29 ) @ #vk.11 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.29 ) @ #vk.11 )
              next
                case SenderStart_case_2
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.5), 
                                                     'g'^(~x.28*x.29*inv(x.30)), 
                                                     'g'^(~prek.5*~x.28*x.29*inv((~ltk.8*x.30)))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.31, pc.1, z.5, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.32, $B.3, old_pc, old_rk,
                                    old_ck
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.7,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~prek.10*~ltk.11), 
                                                                'g'^(~ltk.12*~x.32), 
                                                                'g'^(~prek.10*~x.32)>)
                                                          >), 
                                                      z.6>)
                                                >)
                                           >))
                             ) @ #vk.26 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~prek.10*~ltk.11), 
                                                             'g'^(~ltk.12*~x.32), 
                                                             'g'^(~prek.10*~x.32)>)
                                                       >), 
                                                   z.6>)
                                             >)
                                        >)
                               ) @ #vk.28 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~prek.10*~ltk.11), 
                                                          'g'^(~ltk.12*~x.32), 'g'^(~prek.10*~x.32)
                                                         >)
                                                    >), 
                                                z.6>)
                                          >)
                                 ) @ #vk.31 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~prek.10*~ltk.11), 'g'^(~ltk.12*~x.32), 
                                                       'g'^(~prek.10*~x.32)>)
                                                 >), 
                                             z.6>)
                                   ) @ #vk.34 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.5 ) @ #vk.16 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.11, ~prek.9 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.11, prek.9 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.5 ) @ #vk.16 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~x.28*x.29*inv(x.30)), 
                                                  'g'^(~prek.5*~x.28*x.29*inv((~ltk.8*x.30)))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.25 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~x.28*x.29*inv(x.30)), 
                                               'g'^(~prek.5*~x.28*x.29*inv((~ltk.8*x.30)))>)
                                         >)
                                    >)
                           ) @ #vk.28 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~x.28*x.29*inv(x.30)), 
                                            'g'^(~prek.5*~x.28*x.29*inv((~ltk.8*x.30)))>)
                                      >)
                             ) @ #vk.31 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.5), 'g'^(~x.28*x.29*inv(x.30)), 
                                         'g'^(~prek.5*~x.28*x.29*inv((~ltk.8*x.30)))>)
                               ) @ #vk.34 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case SenderStart_case_3
                by solve( !KU( ~x.29 ) @ #vk.11 )
              next
                case c_exp
                by solve( !KU( ~x.25 ) @ #vk.12 )
              qed
            next
              case c_exp
              by solve( !KU( ~prek.2 ) @ #vk.5 )
            qed
          next
            case split_case_14
            solve( !KU( x.22^(x.23*inv(x.24)) ) @ #x )
              case KeyGen_case_1
              solve( !KU( 'g'^(~ltk.3*inv((~prek.2*x.25))) ) @ #vk.1 )
                case KeyGen
                by solve( !KU( ~prek.5 ) @ #vk.7 )
              next
                case c_exp
                by solve( !KU( ~ltk.3 ) @ #vk.7 )
              qed
            next
              case KeyGen_case_2
              solve( !KU( 'g'^(~ltk.3*x.25*inv((~prek.2*x.26))) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~ltk.5 ) @ #vk.8 )
              next
                case KeyGen_case_2
                by solve( !KU( ~prek.5 ) @ #vk.11 )
              next
                case KeyGen_case_3
                by solve( !KU( ~ltk.5 ) @ #vk.8 )
              next
                case KeyGen_case_4
                by solve( !KU( ~ltk.5 ) @ #vk.8 )
              next
                case KeyGen_case_5
                by solve( !KU( ~ltk.5 ) @ #vk.8 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.27 ) @ #vk.13 )
              next
                case OuterRatchetToSender_case_2
                by solve( !KU( ~x.27 ) @ #vk.18 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.27 ) @ #vk.13 )
              next
                case SenderStart_case_2
                by solve( !KU( ~x.27 ) @ #vk.18 )
              next
                case c_exp
                by solve( !KU( ~ltk.3 ) @ #vk.9 )
              qed
            next
              case KeyGen_case_3
              solve( !KU( 'g'^(~prek.3*inv((~prek.2*x.25))) ) @ #vk.1 )
                case KeyGen
                by solve( !KU( ~prek.5 ) @ #vk.7 )
              next
                case c_exp
                by solve( !KU( ~prek.3 ) @ #vk.7 )
              qed
            next
              case KeyGen_case_4
              solve( !KU( 'g'^(~prek.3*x.25*inv((~prek.2*x.26))) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~prek.5 ) @ #vk.8 )
              next
                case KeyGen_case_2
                by solve( !KU( ~prek.5 ) @ #vk.8 )
              next
                case KeyGen_case_3
                by solve( !KU( ~prek.5 ) @ #vk.8 )
              next
                case KeyGen_case_4
                by solve( !KU( ~prek.5 ) @ #vk.11 )
              next
                case KeyGen_case_5
                by solve( !KU( ~prek.5 ) @ #vk.8 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.27 ) @ #vk.13 )
              next
                case OuterRatchetToSender_case_2
                by solve( !KU( ~x.27 ) @ #vk.18 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.27 ) @ #vk.13 )
              next
                case SenderStart_case_2
                by solve( !KU( ~x.27 ) @ #vk.18 )
              next
                case c_exp
                by solve( !KU( ~prek.3 ) @ #vk.9 )
              qed
            next
              case OuterRatchetToSender_case_1
              solve( !KU( 'g'^(~x.25*inv((~prek.2*x.26))) ) @ #vk.1 )
                case OuterRatchetToSender
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 
                                                     'g'^(~ltk.2*~x.27*inv((~prek.3*x.28))), 
                                                     'g'^(~x.27*inv(x.28))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.29, pc.3, z.7, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.30, $B.3, old_pc, old_rk.2,
                                    old_ck.2
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.9,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.3*~prek.5), 
                                                                'g'^(~ltk.4*~x.30), 
                                                                'g'^(~prek.5*~x.30)>)
                                                          >), 
                                                      z.8>)
                                                >)
                                           >))
                             ) @ #vk.11 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.3*~prek.5), 
                                                             'g'^(~ltk.4*~x.30), 'g'^(~prek.5*~x.30)
                                                            >)
                                                       >), 
                                                   z.8>)
                                             >)
                                        >)
                               ) @ #vk.13 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.3*~prek.5), 'g'^(~ltk.4*~x.30), 
                                                          'g'^(~prek.5*~x.30)>)
                                                    >), 
                                                z.8>)
                                          >)
                                 ) @ #vk.16 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.3*~prek.5), 'g'^(~ltk.4*~x.30), 
                                                       'g'^(~prek.5*~x.30)>)
                                                 >), 
                                             z.8>)
                                   ) @ #vk.19 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.3 ) @ #vk.7 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.3, ~prek.4 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.3, prek.4 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.3 ) @ #vk.7 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.3), 
                                                  'g'^(~ltk.2*~x.27*inv((~prek.3*x.28))), 
                                                  'g'^(~x.27*inv(x.28))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.10 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.3), 
                                               'g'^(~ltk.2*~x.27*inv((~prek.3*x.28))), 
                                               'g'^(~x.27*inv(x.28))>)
                                         >)
                                    >)
                           ) @ #vk.13 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.3), 
                                            'g'^(~ltk.2*~x.27*inv((~prek.3*x.28))), 
                                            'g'^(~x.27*inv(x.28))>)
                                      >)
                             ) @ #vk.16 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 
                                         'g'^(~ltk.2*~x.27*inv((~prek.3*x.28))), 
                                         'g'^(~x.27*inv(x.28))>)
                               ) @ #vk.19 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~x.25 ) @ #vk.7 )
              qed
            next
              case OuterRatchetToSender_case_2
              solve( !KU( 'g'^(~x.25*x.26*inv((~prek.2*x.27))) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~x.28 ) @ #vk.8 )
              next
                case KeyGen_case_2
                by solve( !KU( ~x.28 ) @ #vk.8 )
              next
                case KeyGen_case_3
                by solve( !KU( ~x.28 ) @ #vk.8 )
              next
                case KeyGen_case_4
                by solve( !KU( ~x.28 ) @ #vk.8 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.29 ) @ #vk.8 )
              next
                case OuterRatchetToSender_case_2
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.3), 
                                                     'g'^(~ltk.2*~x.28*x.29*inv((~prek.3*x.30))), 
                                                     'g'^(~x.28*x.29*inv(x.30))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.31, pc.3, z.7, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.32, $B.3, old_pc, old_rk.2,
                                    old_ck.2
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.9,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.3*~prek.5), 
                                                                'g'^(~ltk.4*~x.32), 
                                                                'g'^(~prek.5*~x.32)>)
                                                          >), 
                                                      z.8>)
                                                >)
                                           >))
                             ) @ #vk.18 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.3*~prek.5), 
                                                             'g'^(~ltk.4*~x.32), 'g'^(~prek.5*~x.32)
                                                            >)
                                                       >), 
                                                   z.8>)
                                             >)
                                        >)
                               ) @ #vk.20 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.3*~prek.5), 'g'^(~ltk.4*~x.32), 
                                                          'g'^(~prek.5*~x.32)>)
                                                    >), 
                                                z.8>)
                                          >)
                                 ) @ #vk.23 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.3*~prek.5), 'g'^(~ltk.4*~x.32), 
                                                       'g'^(~prek.5*~x.32)>)
                                                 >), 
                                             z.8>)
                                   ) @ #vk.26 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.3 ) @ #vk.11 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.3, ~prek.4 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.3, prek.4 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.3 ) @ #vk.11 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.3), 
                                                  'g'^(~ltk.2*~x.28*x.29*inv((~prek.3*x.30))), 
                                                  'g'^(~x.28*x.29*inv(x.30))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.17 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.3), 
                                               'g'^(~ltk.2*~x.28*x.29*inv((~prek.3*x.30))), 
                                               'g'^(~x.28*x.29*inv(x.30))>)
                                         >)
                                    >)
                           ) @ #vk.20 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.3), 
                                            'g'^(~ltk.2*~x.28*x.29*inv((~prek.3*x.30))), 
                                            'g'^(~x.28*x.29*inv(x.30))>)
                                      >)
                             ) @ #vk.23 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.3), 
                                         'g'^(~ltk.2*~x.28*x.29*inv((~prek.3*x.30))), 
                                         'g'^(~x.28*x.29*inv(x.30))>)
                               ) @ #vk.26 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case OuterRatchetToSender_case_3
                by solve( !KU( ~x.29 ) @ #vk.8 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.29 ) @ #vk.8 )
              next
                case SenderStart_case_2
                by solve( !KU( ~x.29 ) @ #vk.8 )
              next
                case c_exp
                by solve( !KU( ~x.25 ) @ #vk.9 )
              qed
            next
              case SenderStart_case_1
              solve( !KU( 'g'^(~x.25*inv((~prek.2*x.26))) ) @ #vk.1 )
                case SenderStart
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.7), 
                                                     'g'^(~ltk.2*~x.27*inv((~prek.7*x.28))), 
                                                     'g'^(~x.27*inv(x.28))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.29, pc.1, z.5, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.30, $B.3, old_pc, old_rk,
                                    old_ck
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.7,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.9*~prek.10), 
                                                                'g'^(~ltk.10*~x.30), 
                                                                'g'^(~prek.10*~x.30)>)
                                                          >), 
                                                      z.6>)
                                                >)
                                           >))
                             ) @ #vk.11 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.9*~prek.10), 
                                                             'g'^(~ltk.10*~x.30), 
                                                             'g'^(~prek.10*~x.30)>)
                                                       >), 
                                                   z.6>)
                                             >)
                                        >)
                               ) @ #vk.13 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.9*~prek.10), 
                                                          'g'^(~ltk.10*~x.30), 'g'^(~prek.10*~x.30)
                                                         >)
                                                    >), 
                                                z.6>)
                                          >)
                                 ) @ #vk.16 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.9*~prek.10), 'g'^(~ltk.10*~x.30), 
                                                       'g'^(~prek.10*~x.30)>)
                                                 >), 
                                             z.6>)
                                   ) @ #vk.19 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.7 ) @ #vk.7 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.9, ~prek.9 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.9, prek.9 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.7 ) @ #vk.7 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.7), 
                                                  'g'^(~ltk.2*~x.27*inv((~prek.7*x.28))), 
                                                  'g'^(~x.27*inv(x.28))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.10 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.7), 
                                               'g'^(~ltk.2*~x.27*inv((~prek.7*x.28))), 
                                               'g'^(~x.27*inv(x.28))>)
                                         >)
                                    >)
                           ) @ #vk.13 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.7), 
                                            'g'^(~ltk.2*~x.27*inv((~prek.7*x.28))), 
                                            'g'^(~x.27*inv(x.28))>)
                                      >)
                             ) @ #vk.16 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.7), 
                                         'g'^(~ltk.2*~x.27*inv((~prek.7*x.28))), 
                                         'g'^(~x.27*inv(x.28))>)
                               ) @ #vk.19 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case c_exp
                by solve( !KU( ~x.25 ) @ #vk.7 )
              qed
            next
              case SenderStart_case_2
              solve( !KU( 'g'^(~x.25*x.26*inv((~prek.2*x.27))) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~x.28 ) @ #vk.8 )
              next
                case KeyGen_case_2
                by solve( !KU( ~x.28 ) @ #vk.8 )
              next
                case KeyGen_case_3
                by solve( !KU( ~x.28 ) @ #vk.8 )
              next
                case KeyGen_case_4
                by solve( !KU( ~x.28 ) @ #vk.8 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.29 ) @ #vk.8 )
              next
                case OuterRatchetToSender_case_2
                by solve( !KU( ~x.29 ) @ #vk.8 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.29 ) @ #vk.8 )
              next
                case SenderStart_case_2
                solve( !KU( senc(x.1,
                                 kdf(<'mk', 
                                      kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'g'^(~ltk.1*~prek.7), 
                                                     'g'^(~ltk.2*~x.28*x.29*inv((~prek.7*x.30))), 
                                                     'g'^(~x.28*x.29*inv(x.30))>)
                                               >)
                                          >)
                                     >))
                       ) @ #vk.2 )
                  case Send
                  solve( NewDHSecrets( ~id.4, 'g'^~x.31, pc.1, z.5, rk.1 ) @ #b )
                    case OuterRatchetToReceiver
                    solve( Session( ~id.5, $A.3, 'S', ~x.32, $B.3, old_pc, old_rk,
                                    old_ck
                           ) ▶₁ #b )
                      case OuterRatchetToSender
                      by solve( Send( m.3 ) @ #b )
                    next
                      case Send
                      by solve( Send( m.3 ) @ #b )
                    next
                      case SenderStart
                      solve( !KU( senc(z.7,
                                       kdf(<'mk', 
                                            kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(~ltk.9*~prek.10), 
                                                                'g'^(~ltk.10*~x.32), 
                                                                'g'^(~prek.10*~x.32)>)
                                                          >), 
                                                      z.6>)
                                                >)
                                           >))
                             ) @ #vk.18 )
                        case OuterRatchetToSender
                        by solve( Send( m.3 ) @ #b )
                      next
                        case Send
                        by solve( Send( m.3 ) @ #b )
                      next
                        case c_senc
                        solve( !KU( kdf(<'mk', 
                                         kdf(<'ck', 
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.9*~prek.10), 
                                                             'g'^(~ltk.10*~x.32), 
                                                             'g'^(~prek.10*~x.32)>)
                                                       >), 
                                                   z.6>)
                                             >)
                                        >)
                               ) @ #vk.20 )
                          case c_kdf
                          solve( !KU( kdf(<'ck', 
                                           kdf(<'rk', 
                                                kdf(<'rk', 
                                                     kdf(<'g'^(~ltk.9*~prek.10), 
                                                          'g'^(~ltk.10*~x.32), 'g'^(~prek.10*~x.32)
                                                         >)
                                                    >), 
                                                z.6>)
                                          >)
                                 ) @ #vk.23 )
                            case c_kdf
                            solve( !KU( kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'g'^(~ltk.9*~prek.10), 'g'^(~ltk.10*~x.32), 
                                                       'g'^(~prek.10*~x.32)>)
                                                 >), 
                                             z.6>)
                                   ) @ #vk.26 )
                              case c_kdf
                              by contradiction /* node #b after last node #x */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case OuterRatchetToSender
                    solve( Send( m.3 ) @ #b )
                      case OuterRatchetToSender
                      by solve( !KU( ~prek.7 ) @ #vk.11 )
                    qed
                  next
                    case ReceiverStart
                    solve( !SecretKeys( $A.4, ~ltk.9, ~prek.9 ) ▶₁ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₂ #b )
                        case KeyGen
                        by solve( Send( m.3 ) @ #b )
                      qed
                    qed
                  next
                    case SenderStart
                    solve( !SecretKeys( $A.4, ~ltk.9, prek.9 ) ▶₃ #b )
                      case KeyGen
                      solve( !PublicKeys( $B.4, ltpk.1, prepk.1 ) ▶₄ #b )
                        case KeyGen
                        solve( Send( m.3 ) @ #b )
                          case SenderStart
                          by solve( !KU( ~prek.7 ) @ #vk.11 )
                        qed
                      qed
                    qed
                  qed
                next
                  case c_senc
                  solve( !KU( kdf(<'mk', 
                                   kdf(<'ck', 
                                        kdf(<'rk', 
                                             kdf(<'g'^(~ltk.1*~prek.7), 
                                                  'g'^(~ltk.2*~x.28*x.29*inv((~prek.7*x.30))), 
                                                  'g'^(~x.28*x.29*inv(x.30))>)
                                            >)
                                       >)
                                  >)
                         ) @ #vk.17 )
                    case c_kdf
                    solve( !KU( kdf(<'ck', 
                                     kdf(<'rk', 
                                          kdf(<'g'^(~ltk.1*~prek.7), 
                                               'g'^(~ltk.2*~x.28*x.29*inv((~prek.7*x.30))), 
                                               'g'^(~x.28*x.29*inv(x.30))>)
                                         >)
                                    >)
                           ) @ #vk.20 )
                      case c_kdf
                      solve( !KU( kdf(<'rk', 
                                       kdf(<'g'^(~ltk.1*~prek.7), 
                                            'g'^(~ltk.2*~x.28*x.29*inv((~prek.7*x.30))), 
                                            'g'^(~x.28*x.29*inv(x.30))>)
                                      >)
                             ) @ #vk.23 )
                        case c_kdf
                        solve( !KU( kdf(<'g'^(~ltk.1*~prek.7), 
                                         'g'^(~ltk.2*~x.28*x.29*inv((~prek.7*x.30))), 
                                         'g'^(~x.28*x.29*inv(x.30))>)
                               ) @ #vk.26 )
                          case c_kdf
                          by contradiction /* node #t after last node #x */
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case SenderStart_case_3
                by solve( !KU( ~x.29 ) @ #vk.8 )
              next
                case c_exp
                by solve( !KU( ~x.25 ) @ #vk.9 )
              qed
            next
              case c_exp
              solve( !KU( x.22^(x.23*inv((~prek.2*x.24))) ) @ #vk.1 )
                case KeyGen_case_1
                by solve( !KU( ~prek.4 ) @ #vk.10 )
              next
                case KeyGen_case_2
                by solve( !KU( ~prek.4 ) @ #vk.12 )
              next
                case KeyGen_case_3
                by solve( !KU( ~prek.4 ) @ #vk.10 )
              next
                case KeyGen_case_4
                by solve( !KU( ~prek.4 ) @ #vk.12 )
              next
                case OuterRatchetToSender_case_1
                by solve( !KU( ~x.25 ) @ #vk.12 )
              next
                case OuterRatchetToSender_case_2
                by solve( !KU( ~x.25 ) @ #vk.18 )
              next
                case SenderStart_case_1
                by solve( !KU( ~x.25 ) @ #vk.12 )
              next
                case SenderStart_case_2
                by solve( !KU( ~x.25 ) @ #vk.18 )
              next
                case c_exp
                by solve( !KU( ~prek.2 ) @ #vk.13 )
              qed
            qed
          next
            case split_case_15
            by contradiction /* from formulas */
          qed
        qed
      qed
    next
      case Send
      solve( NewDHSecrets( ~id.1, 'g'^~x.1, pc, z, rk.1 ) @ #b )
        case OuterRatchetToReceiver
        by solve( Send( m.1 ) @ #b )
      next
        case OuterRatchetToSender
        solve( Send( m.1 ) @ #b )
          case OuterRatchetToSender
          solve( Session( ~id.2, $A, 'R', drop, $B, pc.1, old_rk, old_ck
                 ) ▶₂ #b )
            case OuterRatchetToReceiver_case_1
            solve( !KU( senc(x.3,
                             kdf(<'mk', 
                                  kdf(<'ck', 
                                       kdf(<'rk', 
                                            kdf(<'rk', 
                                                 kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.4), 
                                                      'g'^(~prek*~x.4)>)
                                                >), 
                                            z.2>)
                                      >)
                                 >))
                   ) @ #vk.2 )
              case OuterRatchetToSender
              solve( splitEqs(0) )
                case split_case_1
                solve( !KU( pc.4^~x.6 ) @ #x )
                  case OuterRatchetToSender
                  by contradiction /* from formulas */
                next
                  case c_exp
                  by solve( !KU( ~x.6 ) @ #vk.4 )
                qed
              next
                case split_case_2
                by contradiction /* from formulas */
              next
                case split_case_3
                solve( splitEqs(2) )
                  case split_case_1
                  solve( !KU( z.4^(~x.6*inv(~x.9)) ) @ #x )
                    case OuterRatchetToSender
                    by solve( !KU( ~x.12 ) @ #vk.4 )
                  next
                    case c_exp
                    by contradiction /* cyclic */
                  qed
                next
                  case split_case_2
                  solve( !KU( x.10^(~x.6*x.11*inv(~x.9)) ) @ #x )
                    case KeyGen_case_1
                    by solve( !KU( ~x.12 ) @ #vk.4 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.12 ) @ #vk.4 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.12 ) @ #vk.4 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.12 ) @ #vk.4 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.13 ) @ #vk.4 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.13 ) @ #vk.4 )
                  next
                    case OuterRatchetToSender_case_3
                    by solve( !KU( ~x.14 ) @ #vk.6 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.13 ) @ #vk.4 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.13 ) @ #vk.4 )
                  next
                    case c_exp
                    by solve( !KU( ~x.6 ) @ #vk.5 )
                  qed
                next
                  case split_case_3
                  solve( !KU( x.15^(~x.6*inv((~x.9*x.16))) ) @ #x )
                    case OuterRatchetToSender
                    by solve( !KU( ~x.18 ) @ #vk.5 )
                  next
                    case c_exp
                    by solve( !KU( ~x.6 ) @ #vk.5 )
                  qed
                next
                  case split_case_4
                  solve( !KU( x.10^(~x.6*x.11) ) @ #x )
                    case KeyGen_case_1
                    by solve( !KU( ~x.14 ) @ #vk.3 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.14 ) @ #vk.4 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.14 ) @ #vk.3 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.14 ) @ #vk.4 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.15 ) @ #vk.3 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.15 ) @ #vk.4 )
                  next
                    case OuterRatchetToSender_case_3
                    solve( !KU( 'g'^x.15 ) @ #vk.1 )
                      case KeyGen_case_1
                      by solve( !KU( ~ltk.2 ) @ #vk.3 )
                    next
                      case KeyGen_case_2
                      by solve( !KU( ~ltk.2 ) @ #vk.5 )
                    next
                      case KeyGen_case_3
                      by solve( !KU( ~prek.2 ) @ #vk.3 )
                    next
                      case KeyGen_case_4
                      by solve( !KU( ~prek.2 ) @ #vk.5 )
                    next
                      case OuterRatchetToSender_case_1
                      by solve( !KU( ~x.16 ) @ #vk.3 )
                    next
                      case OuterRatchetToSender_case_2
                      by solve( !KU( ~x.16 ) @ #vk.5 )
                    next
                      case SenderStart_case_1
                      by solve( !KU( ~x.16 ) @ #vk.3 )
                    next
                      case SenderStart_case_2
                      by solve( !KU( ~x.16 ) @ #vk.5 )
                    next
                      case c_exp
                      solve( splitEqs(3) )
                        case split_case_1
                        by solve( !KU( ~x.16 ) @ #vk.5 )
                      next
                        case split_case_2
                        by solve( !KU( ~x.16 ) @ #vk.6 )
                      next
                        case split_case_3
                        solve( Session( ~id.4, $A.3, 'S', ~x.14, $B.3, 'g'^inv(x.18),
                                        kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'rk', 
                                                       kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.17), 
                                                            'g'^(~prek*~x.17)>)
                                                      >), 
                                                  'g'^(~x.17*inv(x.18))>), 
                                             'g'^(~x.14*inv(x.18))>),
                                        ck
                               ) ▶₁ #t )
                          case OuterRatchetToSender
                          solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                          'g'^(~x.17*inv((~x.16*x.18))),
                                          kdf(<'rk', 
                                               kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.17), 
                                                    'g'^(~prek*~x.17)>)
                                              >),
                                          old_ck.1
                                 ) ▶₂ #vr.4 )
                            case Receive
                            by solve( NewDHSecrets( ~id.3, 'g'^~x.19,
                                                    'g'^(~x.17*inv((~x.16*x.18))), 'g'^(~x.17*x.20),
                                                    kdf(<'rk', 
                                                         kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.17), 
                                                              'g'^(~prek*~x.17)>)
                                                        >)
                                      ) @ #b.1 )
                          qed
                        next
                          case Send
                          solve( NewDHSecrets( ~id.4, 'g'^~x.19, 'g'^inv(x.20),
                                               'g'^(~x.19*inv(x.20)),
                                               kdf(<'rk', 
                                                    kdf(<'rk', 
                                                         kdf(<'rk', 
                                                              kdf(<'g'^(~ltk*~prek), 
                                                                   'g'^(~ltk.1*~x.17), 
                                                                   'g'^(~prek*~x.17)>)
                                                             >), 
                                                         'g'^(~x.17*inv(x.20))>), 
                                                    'g'^(~x.19*inv(x.20))>)
                                 ) @ #b.1 )
                            case OuterRatchetToReceiver
                            solve( !KU( senc(z.7,
                                             kdf(<'mk', 
                                                  kdf(<'ck', 
                                                       kdf(<'rk', 
                                                            kdf(<'rk', 
                                                                 kdf(<'rk', 
                                                                      kdf(<'g'^(~ltk.2*~prek.2), 
                                                                           'g'^(~ltk.3*~x.22), 
                                                                           'g'^(~prek.2*~x.22)>)
                                                                     >), 
                                                                 'g'^(~x.22*inv(x.23))>), 
                                                            'g'^(~x.24*inv(x.23))>)
                                                      >)
                                                 >))
                                   ) @ #vk.9 )
                              case OuterRatchetToSender
                              solve( Session( ~id.5, $A.4, 'S', ~x.24, $B.4, old_pc,
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.2*~prek.2), 
                                                             'g'^(~ltk.3*~x.22), 'g'^(~prek.2*~x.22)
                                                            >)
                                                       >), 
                                                   'g'^(~x.22*inv(x.23))>),
                                              old_ck.3
                                     ) ▶₁ #b.1 )
                                case Send
                                by solve( Send( m.7 ) @ #b.1 )
                              qed
                            next
                              case Send
                              solve( Session( ~id.5, $A.4, 'S', ~x.24, $B.4, old_pc,
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.2*~prek.2), 
                                                             'g'^(~ltk.3*~x.22), 'g'^(~prek.2*~x.22)
                                                            >)
                                                       >), 
                                                   'g'^(~x.22*inv(x.23))>),
                                              old_ck.3
                                     ) ▶₁ #b.1 )
                                case Send
                                by solve( Send( m.7 ) @ #b.1 )
                              qed
                            next
                              case c_senc
                              solve( !KU( kdf(<'mk', 
                                               kdf(<'ck', 
                                                    kdf(<'rk', 
                                                         kdf(<'rk', 
                                                              kdf(<'rk', 
                                                                   kdf(<'g'^(~ltk.2*~prek.2), 
                                                                        'g'^(~ltk.3*~x.22), 
                                                                        'g'^(~prek.2*~x.22)>)
                                                                  >), 
                                                              'g'^(~x.22*inv(x.23))>), 
                                                         'g'^(~x.24*inv(x.23))>)
                                                   >)
                                              >)
                                     ) @ #vk.11 )
                                case c_kdf
                                solve( !KU( kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'rk', 
                                                                kdf(<'g'^(~ltk.2*~prek.2), 
                                                                     'g'^(~ltk.3*~x.22), 
                                                                     'g'^(~prek.2*~x.22)>)
                                                               >), 
                                                           'g'^(~x.22*inv(x.23))>), 
                                                      'g'^(~x.24*inv(x.23))>)
                                                >)
                                       ) @ #vk.14 )
                                  case c_kdf
                                  solve( !KU( kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'rk', 
                                                             kdf(<'g'^(~ltk.2*~prek.2), 
                                                                  'g'^(~ltk.3*~x.22), 
                                                                  'g'^(~prek.2*~x.22)>)
                                                            >), 
                                                        'g'^(~x.22*inv(x.23))>), 
                                                   'g'^(~x.24*inv(x.23))>)
                                         ) @ #vk.17 )
                                    case c_kdf
                                    by contradiction /* node #t after last node #x */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case OuterRatchetToSender
                            solve( Send( m.7 ) @ #vr.6 )
                              case OuterRatchetToSender
                              solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                              'g'^(~x.17*inv((~x.16*x.20))),
                                              kdf(<'rk', 
                                                   kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.17), 
                                                        'g'^(~prek*~x.17)>)
                                                  >),
                                              old_ck.1
                                     ) ▶₂ #vr.4 )
                                case Receive
                                by solve( NewDHSecrets( ~id.3, 'g'^~x.22,
                                                        'g'^(~x.17*inv((~x.16*x.20))),
                                                        'g'^(~x.17*x.23),
                                                        kdf(<'rk', 
                                                             kdf(<'g'^(~ltk*~prek), 
                                                                  'g'^(~ltk.1*~x.17), 
                                                                  'g'^(~prek*~x.17)>)
                                                            >)
                                          ) @ #b.2 )
                              qed
                            qed
                          qed
                        qed
                      next
                        case split_case_4
                        solve( Session( ~id.4, $A.3, 'S', ~x.14, $B.3, 'g'^x.18,
                                        kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'rk', 
                                                       kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.17), 
                                                            'g'^(~prek*~x.17)>)
                                                      >), 
                                                  'g'^(~x.17*x.18)>), 
                                             'g'^(~x.14*x.18)>),
                                        ck
                               ) ▶₁ #t )
                          case OuterRatchetToSender
                          solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                          'g'^(~x.17*x.18*inv(~x.16)),
                                          kdf(<'rk', 
                                               kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.17), 
                                                    'g'^(~prek*~x.17)>)
                                              >),
                                          old_ck.1
                                 ) ▶₂ #vr.4 )
                            case Receive
                            by solve( NewDHSecrets( ~id.3, 'g'^~x.19,
                                                    'g'^(~x.17*x.18*inv(~x.16)), 'g'^(x.20*x.21),
                                                    kdf(<'rk', 
                                                         kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.17), 
                                                              'g'^(~prek*~x.17)>)
                                                        >)
                                      ) @ #b.1 )
                          qed
                        next
                          case Send
                          solve( NewDHSecrets( ~id.4, 'g'^~x.19, 'g'^x.20, 'g'^(~x.19*x.20),
                                               kdf(<'rk', 
                                                    kdf(<'rk', 
                                                         kdf(<'rk', 
                                                              kdf(<'g'^(~ltk*~prek), 
                                                                   'g'^(~ltk.1*~x.17), 
                                                                   'g'^(~prek*~x.17)>)
                                                             >), 
                                                         'g'^(~x.17*x.20)>), 
                                                    'g'^(~x.19*x.20)>)
                                 ) @ #b.1 )
                            case OuterRatchetToReceiver
                            solve( !KU( senc(z.7,
                                             kdf(<'mk', 
                                                  kdf(<'ck', 
                                                       kdf(<'rk', 
                                                            kdf(<'rk', 
                                                                 kdf(<'rk', 
                                                                      kdf(<'g'^(~ltk.2*~prek.2), 
                                                                           'g'^(~ltk.3*~x.22), 
                                                                           'g'^(~prek.2*~x.22)>)
                                                                     >), 
                                                                 'g'^(~x.22*x.23)>), 
                                                            'g'^(x.23*~x.24)>)
                                                      >)
                                                 >))
                                   ) @ #vk.8 )
                              case OuterRatchetToSender
                              solve( Session( ~id.5, $A.4, 'S', ~x.24, $B.4, old_pc,
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.2*~prek.2), 
                                                             'g'^(~ltk.3*~x.22), 'g'^(~prek.2*~x.22)
                                                            >)
                                                       >), 
                                                   'g'^(~x.22*x.23)>),
                                              old_ck.3
                                     ) ▶₁ #b.1 )
                                case Send
                                by solve( Send( m.7 ) @ #b.1 )
                              qed
                            next
                              case Send
                              solve( Session( ~id.5, $A.4, 'S', ~x.24, $B.4, old_pc,
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.2*~prek.2), 
                                                             'g'^(~ltk.3*~x.22), 'g'^(~prek.2*~x.22)
                                                            >)
                                                       >), 
                                                   'g'^(~x.22*x.23)>),
                                              old_ck.3
                                     ) ▶₁ #b.1 )
                                case Send
                                by solve( Send( m.7 ) @ #b.1 )
                              qed
                            next
                              case c_senc
                              solve( !KU( kdf(<'mk', 
                                               kdf(<'ck', 
                                                    kdf(<'rk', 
                                                         kdf(<'rk', 
                                                              kdf(<'rk', 
                                                                   kdf(<'g'^(~ltk.2*~prek.2), 
                                                                        'g'^(~ltk.3*~x.22), 
                                                                        'g'^(~prek.2*~x.22)>)
                                                                  >), 
                                                              'g'^(~x.22*x.23)>), 
                                                         'g'^(x.23*~x.24)>)
                                                   >)
                                              >)
                                     ) @ #vk.10 )
                                case c_kdf
                                solve( !KU( kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'rk', 
                                                                kdf(<'g'^(~ltk.2*~prek.2), 
                                                                     'g'^(~ltk.3*~x.22), 
                                                                     'g'^(~prek.2*~x.22)>)
                                                               >), 
                                                           'g'^(~x.22*x.23)>), 
                                                      'g'^(x.23*~x.24)>)
                                                >)
                                       ) @ #vk.13 )
                                  case c_kdf
                                  solve( !KU( kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'rk', 
                                                             kdf(<'g'^(~ltk.2*~prek.2), 
                                                                  'g'^(~ltk.3*~x.22), 
                                                                  'g'^(~prek.2*~x.22)>)
                                                            >), 
                                                        'g'^(~x.22*x.23)>), 
                                                   'g'^(x.23*~x.24)>)
                                         ) @ #vk.16 )
                                    case c_kdf
                                    by contradiction /* node #t after last node #x */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case OuterRatchetToSender
                            solve( Send( m.7 ) @ #vr.6 )
                              case OuterRatchetToSender
                              solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                              'g'^(~x.17*x.20*inv(~x.16)),
                                              kdf(<'rk', 
                                                   kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.17), 
                                                        'g'^(~prek*~x.17)>)
                                                  >),
                                              old_ck.1
                                     ) ▶₂ #vr.4 )
                                case Receive
                                by solve( NewDHSecrets( ~id.3, 'g'^~x.22,
                                                        'g'^(~x.17*x.20*inv(~x.16)),
                                                        'g'^(x.23*x.24),
                                                        kdf(<'rk', 
                                                             kdf(<'g'^(~ltk*~prek), 
                                                                  'g'^(~ltk.1*~x.17), 
                                                                  'g'^(~prek*~x.17)>)
                                                            >)
                                          ) @ #b.2 )
                              qed
                            qed
                          qed
                        qed
                      next
                        case split_case_5
                        solve( Session( ~id.4, $A.3, 'S', ~x.14, $B.3,
                                        'g'^(x.18*inv(x.19)),
                                        kdf(<'rk', 
                                             kdf(<'rk', 
                                                  kdf(<'rk', 
                                                       kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.17), 
                                                            'g'^(~prek*~x.17)>)
                                                      >), 
                                                  'g'^(~x.17*x.18*inv(x.19))>), 
                                             'g'^(~x.14*x.18*inv(x.19))>),
                                        ck
                               ) ▶₁ #t )
                          case OuterRatchetToSender
                          solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                          'g'^(~x.17*x.18*inv((~x.16*x.19))),
                                          kdf(<'rk', 
                                               kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.17), 
                                                    'g'^(~prek*~x.17)>)
                                              >),
                                          old_ck.1
                                 ) ▶₂ #vr.4 )
                            case Receive
                            by solve( NewDHSecrets( ~id.3, 'g'^~x.20,
                                                    'g'^(~x.17*x.18*inv((~x.16*x.19))),
                                                    'g'^(x.21*x.22*x.23),
                                                    kdf(<'rk', 
                                                         kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.17), 
                                                              'g'^(~prek*~x.17)>)
                                                        >)
                                      ) @ #b.1 )
                          qed
                        next
                          case Send
                          solve( NewDHSecrets( ~id.4, 'g'^~x.20, 'g'^(x.21*inv(x.22)),
                                               'g'^(~x.20*x.21*inv(x.22)),
                                               kdf(<'rk', 
                                                    kdf(<'rk', 
                                                         kdf(<'rk', 
                                                              kdf(<'g'^(~ltk*~prek), 
                                                                   'g'^(~ltk.1*~x.17), 
                                                                   'g'^(~prek*~x.17)>)
                                                             >), 
                                                         'g'^(~x.17*x.21*inv(x.22))>), 
                                                    'g'^(~x.20*x.21*inv(x.22))>)
                                 ) @ #b.1 )
                            case OuterRatchetToReceiver
                            solve( !KU( senc(z.7,
                                             kdf(<'mk', 
                                                  kdf(<'ck', 
                                                       kdf(<'rk', 
                                                            kdf(<'rk', 
                                                                 kdf(<'rk', 
                                                                      kdf(<'g'^(~ltk.2*~prek.2), 
                                                                           'g'^(~ltk.3*~x.24), 
                                                                           'g'^(~prek.2*~x.24)>)
                                                                     >), 
                                                                 'g'^(~x.24*x.25*inv(x.26))>), 
                                                            'g'^(x.25*~x.27*inv(x.26))>)
                                                      >)
                                                 >))
                                   ) @ #vk.14 )
                              case OuterRatchetToSender
                              solve( Session( ~id.5, $A.4, 'S', ~x.27, $B.4, old_pc,
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.2*~prek.2), 
                                                             'g'^(~ltk.3*~x.24), 'g'^(~prek.2*~x.24)
                                                            >)
                                                       >), 
                                                   'g'^(~x.24*x.25*inv(x.26))>),
                                              old_ck.3
                                     ) ▶₁ #b.1 )
                                case Send
                                by solve( Send( m.7 ) @ #b.1 )
                              qed
                            next
                              case Send
                              solve( Session( ~id.5, $A.4, 'S', ~x.27, $B.4, old_pc,
                                              kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'g'^(~ltk.2*~prek.2), 
                                                             'g'^(~ltk.3*~x.24), 'g'^(~prek.2*~x.24)
                                                            >)
                                                       >), 
                                                   'g'^(~x.24*x.25*inv(x.26))>),
                                              old_ck.3
                                     ) ▶₁ #b.1 )
                                case Send
                                by solve( Send( m.7 ) @ #b.1 )
                              qed
                            next
                              case c_senc
                              solve( !KU( kdf(<'mk', 
                                               kdf(<'ck', 
                                                    kdf(<'rk', 
                                                         kdf(<'rk', 
                                                              kdf(<'rk', 
                                                                   kdf(<'g'^(~ltk.2*~prek.2), 
                                                                        'g'^(~ltk.3*~x.24), 
                                                                        'g'^(~prek.2*~x.24)>)
                                                                  >), 
                                                              'g'^(~x.24*x.25*inv(x.26))>), 
                                                         'g'^(x.25*~x.27*inv(x.26))>)
                                                   >)
                                              >)
                                     ) @ #vk.19 )
                                case c_kdf
                                solve( !KU( kdf(<'ck', 
                                                 kdf(<'rk', 
                                                      kdf(<'rk', 
                                                           kdf(<'rk', 
                                                                kdf(<'g'^(~ltk.2*~prek.2), 
                                                                     'g'^(~ltk.3*~x.24), 
                                                                     'g'^(~prek.2*~x.24)>)
                                                               >), 
                                                           'g'^(~x.24*x.25*inv(x.26))>), 
                                                      'g'^(x.25*~x.27*inv(x.26))>)
                                                >)
                                       ) @ #vk.22 )
                                  case c_kdf
                                  solve( !KU( kdf(<'rk', 
                                                   kdf(<'rk', 
                                                        kdf(<'rk', 
                                                             kdf(<'g'^(~ltk.2*~prek.2), 
                                                                  'g'^(~ltk.3*~x.24), 
                                                                  'g'^(~prek.2*~x.24)>)
                                                            >), 
                                                        'g'^(~x.24*x.25*inv(x.26))>), 
                                                   'g'^(x.25*~x.27*inv(x.26))>)
                                         ) @ #vk.25 )
                                    case c_kdf
                                    by contradiction /* node #t after last node #x */
                                  qed
                                qed
                              qed
                            qed
                          next
                            case OuterRatchetToSender
                            solve( Send( m.7 ) @ #vr.6 )
                              case OuterRatchetToSender
                              solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                              'g'^(~x.17*x.21*inv((~x.16*x.22))),
                                              kdf(<'rk', 
                                                   kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.17), 
                                                        'g'^(~prek*~x.17)>)
                                                  >),
                                              old_ck.1
                                     ) ▶₂ #vr.4 )
                                case Receive
                                by solve( NewDHSecrets( ~id.3, 'g'^~x.24,
                                                        'g'^(~x.17*x.21*inv((~x.16*x.22))),
                                                        'g'^(x.25*x.26*x.27),
                                                        kdf(<'rk', 
                                                             kdf(<'g'^(~ltk*~prek), 
                                                                  'g'^(~ltk.1*~x.17), 
                                                                  'g'^(~prek*~x.17)>)
                                                            >)
                                          ) @ #b.2 )
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.15 ) @ #vk.3 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.15 ) @ #vk.4 )
                  next
                    case c_exp
                    by solve( !KU( ~x.6 ) @ #vk.5 )
                  qed
                next
                  case split_case_5
                  solve( !KU( x.10^(~x.6*x.11*inv((~x.9*x.12))) ) @ #x )
                    case KeyGen_case_1
                    by solve( !KU( ~x.15 ) @ #vk.4 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.15 ) @ #vk.4 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.15 ) @ #vk.4 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.15 ) @ #vk.4 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.16 ) @ #vk.4 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.16 ) @ #vk.4 )
                  next
                    case OuterRatchetToSender_case_3
                    by solve( !KU( ~x.17 ) @ #vk.7 )
                  next
                    case SenderStart_case_1
                    by solve( !KU( ~x.16 ) @ #vk.4 )
                  next
                    case SenderStart_case_2
                    by solve( !KU( ~x.16 ) @ #vk.4 )
                  next
                    case c_exp
                    by solve( !KU( ~x.6 ) @ #vk.5 )
                  qed
                qed
              next
                case split_case_4
                solve( !KU( z.3^inv(~x.6) ) @ #vk.1 )
                  case c_exp
                  by contradiction /* node #b after last node #vk.3 */
                qed
              next
                case split_case_5
                solve( !KU( x.7^inv((~x.6*x.8)) ) @ #vk.1 )
                  case c_exp
                  by solve( !KU( ~x.6 ) @ #vk.6 )
                qed
              next
                case split_case_6
                solve( !KU( x.7^(x.8*inv(~x.6)) ) @ #vk.1 )
                  case KeyGen_case_1
                  by solve( !KU( ~x.11 ) @ #vk.4 )
                next
                  case KeyGen_case_2
                  by solve( !KU( ~x.12 ) @ #vk.6 )
                next
                  case KeyGen_case_3
                  by solve( !KU( ~x.11 ) @ #vk.4 )
                next
                  case KeyGen_case_4
                  by solve( !KU( ~x.12 ) @ #vk.6 )
                next
                  case OuterRatchetToSender_case_1
                  by solve( !KU( ~x.12 ) @ #vk.4 )
                next
                  case OuterRatchetToSender_case_2
                  by solve( !KU( ~x.13 ) @ #vk.6 )
                next
                  case SenderStart_case_1
                  by solve( !KU( ~x.12 ) @ #vk.4 )
                next
                  case SenderStart_case_2
                  by solve( !KU( ~x.13 ) @ #vk.6 )
                next
                  case c_exp
                  by solve( !KU( ~x.6 ) @ #vk.7 )
                qed
              next
                case split_case_7
                solve( !KU( x.7^(x.8*inv((~x.6*x.9))) ) @ #vk.1 )
                  case KeyGen_case_1
                  by solve( !KU( ~x.16 ) @ #vk.5 )
                next
                  case KeyGen_case_2
                  by solve( !KU( ~x.17 ) @ #vk.7 )
                next
                  case KeyGen_case_3
                  by solve( !KU( ~x.16 ) @ #vk.5 )
                next
                  case KeyGen_case_4
                  by solve( !KU( ~x.17 ) @ #vk.7 )
                next
                  case OuterRatchetToSender_case_1
                  by solve( !KU( ~x.17 ) @ #vk.5 )
                next
                  case OuterRatchetToSender_case_2
                  by solve( !KU( ~x.18 ) @ #vk.7 )
                next
                  case SenderStart_case_1
                  by solve( !KU( ~x.17 ) @ #vk.5 )
                next
                  case SenderStart_case_2
                  by solve( !KU( ~x.18 ) @ #vk.7 )
                next
                  case c_exp
                  by solve( !KU( ~x.6 ) @ #vk.8 )
                qed
              qed
            next
              case Send
              by solve( Session( ~id.3, $A.2, 'S', ~x.5, $B.2, pc.2, rk.2,
                                 kdf(<'rk', 
                                      kdf(<'rk', 
                                           kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.4), 
                                                'g'^(~prek*~x.4)>)
                                          >), 
                                      z.2>)
                        ) ▶₁ #vr.4 )
            next
              case c_senc
              solve( !KU( kdf(<'mk', 
                               kdf(<'ck', 
                                    kdf(<'rk', 
                                         kdf(<'rk', 
                                              kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.4), 
                                                   'g'^(~prek*~x.4)>)
                                             >), 
                                         z.2>)
                                   >)
                              >)
                     ) @ #vk.4 )
                case c_kdf
                solve( !KU( kdf(<'ck', 
                                 kdf(<'rk', 
                                      kdf(<'rk', 
                                           kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.4), 
                                                'g'^(~prek*~x.4)>)
                                          >), 
                                      z.2>)
                                >)
                       ) @ #vk.7 )
                  case c_kdf
                  solve( !KU( kdf(<'rk', 
                                   kdf(<'rk', 
                                        kdf(<'g'^(~ltk*~prek), 'g'^(~ltk.1*~x.4), 'g'^(~prek*~x.4)>)
                                       >), 
                                   z.2>)
                         ) @ #vk.10 )
                    case c_kdf
                    by contradiction /* node #b after last node #x */
                  qed
                qed
              qed
            qed
          next
            case OuterRatchetToReceiver_case_2
            solve( !KU( senc(x.3,
                             kdf(<'mk', kdf(<'ck', kdf(<'rk', old_rk.1, z.2>)>)>))
                   ) @ #vk.2 )
              case OuterRatchetToSender
              solve( splitEqs(3) )
                case split_case_1
                solve( !KU( pc.4^~x.7 ) @ #x )
                  case OuterRatchetToSender
                  by contradiction /* from formulas */
                next
                  case c_exp
                  by solve( !KU( ~x.7 ) @ #vk.4 )
                qed
              next
                case split_case_2
                by contradiction /* from formulas */
              next
                case split_case_3
                solve( !KU( z.5^inv(~x.6) ) @ #vk.1 )
                  case c_exp
                  by contradiction /* node #b after last node #x */
                qed
              next
                case split_case_4
                solve( splitEqs(0) )
                  case split_case_1
                  solve( !KU( z.4^inv(~x.11) ) @ #vk.1 )
                    case c_exp
                    by contradiction /* node #b after last node #vk.3 */
                  qed
                next
                  case split_case_2
                  solve( !KU( x.12^(~x.11*x.13) ) @ #x )
                    case KeyGen_case_1
                    by solve( !KU( ~x.14 ) @ #vk.3 )
                  next
                    case KeyGen_case_2
                    by solve( !KU( ~x.14 ) @ #vk.4 )
                  next
                    case KeyGen_case_3
                    by solve( !KU( ~x.14 ) @ #vk.3 )
                  next
                    case KeyGen_case_4
                    by solve( !KU( ~x.14 ) @ #vk.4 )
                  next
                    case OuterRatchetToSender_case_1
                    by solve( !KU( ~x.15 ) @ #vk.3 )
                  next
                    case OuterRatchetToSender_case_2
                    by solve( !KU( ~x.15 ) @ #vk.4 )
                  next
                    case OuterRatchetToSender_case_3
                    solve( splitEqs(4) )
                      case split_case_1
                      by solve( !KU( ~x.16 ) @ #vk.3 )
                    next
                      case split_case_2
                      solve( NewDHSecrets( ~id.4, 'g'^~x.16, old_pc, z.3, old_rk.1
                             ) @ #b.1 )
                        case OuterRatchetToReceiver
                        by solve( Send( m.4 ) @ #b.1 )
                      next
                        case ReceiverStart
                        by solve( Send( m.4 ) @ #b.1 )
                      qed
                    next
                      case split_case_3
                      by solve( !KU( ~x.16 ) @ #vk.4 )
                    next
                      case split_case_4
                      solve( splitEqs(2) )
                        case split_case_1
                        solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                        'g'^(~x.19*inv((~x.16*x.18))), old_rk.1, old_ck.1
                               ) ▶₂ #vr.2 )
                          case OuterRatchetToReceiver_case_1
                          solve( !KU( 'g'^(~x.19*inv((~x.16*x.18))) ) @ #vk.6 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.23 ) @ #vk.10 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.23 ) @ #vk.10 )
                          next
                            case OuterRatchetToSender
                            by solve( !KU( ~x.24 ) @ #vk.10 )
                          next
                            case SenderStart
                            by solve( !KU( ~x.24 ) @ #vk.10 )
                          next
                            case c_exp
                            solve( !KU( ~x.19 ) @ #vk.10 )
                              case OuterRatchetToSender
                              by solve( !KU( ~x.16 ) @ #vk.13 )
                            next
                              case Send
                              by solve( !KU( ~x.16 ) @ #vk.13 )
                            next
                              case SenderStart
                              by contradiction /* cyclic */
                            next
                              case fresh
                              by solve( !KU( ~x.16 ) @ #vk.13 )
                            qed
                          qed
                        next
                          case OuterRatchetToReceiver_case_2
                          solve( !KU( 'g'^(~x.19*inv((~x.16*x.18))) ) @ #vk.6 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.23 ) @ #vk.10 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.23 ) @ #vk.10 )
                          next
                            case OuterRatchetToSender
                            by solve( !KU( ~x.24 ) @ #vk.10 )
                          next
                            case SenderStart
                            by solve( !KU( ~x.24 ) @ #vk.10 )
                          next
                            case c_exp
                            solve( !KU( ~x.19 ) @ #vk.10 )
                              case OuterRatchetToSender
                              by solve( !KU( ~x.16 ) @ #vk.13 )
                            next
                              case Send
                              by solve( !KU( ~x.16 ) @ #vk.13 )
                            next
                              case SenderStart
                              by contradiction /* cyclic */
                            next
                              case fresh
                              by solve( !KU( ~x.16 ) @ #vk.13 )
                            qed
                          qed
                        next
                          case OuterRatchetToReceiver_case_3
                          solve( !KU( 'g'^(~x.19*inv((~x.16*x.18))) ) @ #vk.6 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.23 ) @ #vk.10 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.23 ) @ #vk.10 )
                          next
                            case OuterRatchetToSender
                            by solve( !KU( ~x.24 ) @ #vk.10 )
                          next
                            case SenderStart
                            by solve( !KU( ~x.24 ) @ #vk.10 )
                          next
                            case c_exp
                            solve( !KU( ~x.19 ) @ #vk.10 )
                              case OuterRatchetToSender
                              by solve( !KU( ~x.16 ) @ #vk.13 )
                            next
                              case Send
                              by solve( !KU( ~x.16 ) @ #vk.13 )
                            next
                              case SenderStart
                              by contradiction /* cyclic */
                            next
                              case fresh
                              by solve( !KU( ~x.16 ) @ #vk.13 )
                            qed
                          qed
                        next
                          case Receive
                          solve( Session( ~id.4, $A.3, 'S', ~x.14, $B.3, 'g'^inv(x.18),
                                          kdf(<'rk', kdf(<'rk', old_rk.1, 'g'^(~x.19*inv(x.18))>), 
                                               'g'^(~x.14*inv(x.18))>),
                                          ck
                                 ) ▶₁ #t )
                            case OuterRatchetToSender
                            solve( NewDHSecrets( ~id.3, 'g'^~x.20,
                                                 'g'^(~x.19*inv((~x.16*x.18))), 'g'^(~x.19*x.21),
                                                 old_rk.1
                                   ) @ #b.2 )
                              case OuterRatchetToReceiver
                              solve( Receive( m.7 ) @ #b.2 )
                                case OuterRatchetToReceiver
                                solve( !KU( 'g'^(~x.19*inv((~x.16*x.18))) ) @ #vk.7 )
                                  case KeyGen_case_1
                                  by solve( !KU( ~x.41 ) @ #vk.11 )
                                next
                                  case KeyGen_case_2
                                  by solve( !KU( ~x.41 ) @ #vk.11 )
                                next
                                  case OuterRatchetToSender
                                  by solve( !KU( ~x.42 ) @ #vk.11 )
                                next
                                  case SenderStart
                                  by solve( !KU( ~x.42 ) @ #vk.11 )
                                next
                                  case c_exp
                                  solve( !KU( ~x.19 ) @ #vk.11 )
                                    case OuterRatchetToSender
                                    by solve( !KU( ~x.16 ) @ #vk.14 )
                                  next
                                    case Send
                                    by solve( !KU( ~x.16 ) @ #vk.14 )
                                  next
                                    case SenderStart
                                    by contradiction /* cyclic */
                                  next
                                    case fresh
                                    by solve( !KU( ~x.16 ) @ #vk.14 )
                                  qed
                                qed
                              qed
                            next
                              case OuterRatchetToSender
                              by solve( NewDHSecrets( ~id.4, 'g'^~x.19, old_pc.1, old_pc.1^~x.19,
                                                      kdf(<'rk', old_rk.3, 'g'^(~x.19*x.21)>)
                                        ) @ #b.1 )
                            next
                              case ReceiverStart
                              solve( !KU( 'g'^(~x.19*inv((~x.16*x.18))) ) @ #vk.7 )
                                case KeyGen_case_1
                                by solve( !KU( ~x.53 ) @ #vk.11 )
                              next
                                case KeyGen_case_2
                                by solve( !KU( ~x.53 ) @ #vk.11 )
                              next
                                case OuterRatchetToSender
                                by solve( !KU( ~x.54 ) @ #vk.11 )
                              next
                                case SenderStart
                                by solve( !KU( ~x.54 ) @ #vk.11 )
                              next
                                case c_exp
                                solve( !KU( ~x.19 ) @ #vk.11 )
                                  case OuterRatchetToSender
                                  by solve( !KU( ~x.16 ) @ #vk.14 )
                                next
                                  case Send
                                  by solve( !KU( ~x.16 ) @ #vk.14 )
                                next
                                  case SenderStart
                                  by contradiction /* cyclic */
                                next
                                  case fresh
                                  by solve( !KU( ~x.16 ) @ #vk.14 )
                                qed
                              qed
                            next
                              case SenderStart
                              by solve( NewDHSecrets( ~id.4, 'g'^~x.19, old_pc.1, old_pc.1^~x.19,
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(x.26*~x.27), z.7, 
                                                                'g'^(~x.19*x.21)>)
                                                          >)
                                        ) @ #b.1 )
                            qed
                          next
                            case Send
                            solve( NewDHSecrets( ~id.3, 'g'^~x.20,
                                                 'g'^(~x.19*inv((~x.16*x.23))), 'g'^(~x.19*x.21),
                                                 old_rk.1
                                   ) @ #b.2 )
                              case OuterRatchetToReceiver
                              solve( !KU( 'g'^(~x.19*inv((~x.16*x.23))) ) @ #vk.7 )
                                case KeyGen_case_1
                                by solve( !KU( ~x.43 ) @ #vk.11 )
                              next
                                case KeyGen_case_2
                                by solve( !KU( ~x.43 ) @ #vk.11 )
                              next
                                case OuterRatchetToSender
                                by solve( !KU( ~x.44 ) @ #vk.11 )
                              next
                                case SenderStart
                                by solve( !KU( ~x.44 ) @ #vk.11 )
                              next
                                case c_exp
                                solve( !KU( ~x.19 ) @ #vk.11 )
                                  case OuterRatchetToSender
                                  by solve( !KU( ~x.16 ) @ #vk.14 )
                                next
                                  case Send
                                  by solve( !KU( ~x.16 ) @ #vk.14 )
                                next
                                  case SenderStart
                                  by contradiction /* cyclic */
                                next
                                  case fresh
                                  by solve( !KU( ~x.16 ) @ #vk.14 )
                                qed
                              qed
                            next
                              case OuterRatchetToSender
                              by solve( Receive( m.7 ) @ #b.2 )
                            next
                              case ReceiverStart
                              solve( !KU( 'g'^(~x.19*inv((~x.16*x.23))) ) @ #vk.7 )
                                case KeyGen_case_1
                                by solve( !KU( ~x.55 ) @ #vk.11 )
                              next
                                case KeyGen_case_2
                                by solve( !KU( ~x.55 ) @ #vk.11 )
                              next
                                case OuterRatchetToSender
                                by solve( !KU( ~x.56 ) @ #vk.11 )
                              next
                                case SenderStart
                                by solve( !KU( ~x.56 ) @ #vk.11 )
                              next
                                case c_exp
                                solve( !KU( ~x.19 ) @ #vk.11 )
                                  case OuterRatchetToSender
                                  by solve( !KU( ~x.16 ) @ #vk.14 )
                                next
                                  case Send
                                  by solve( !KU( ~x.16 ) @ #vk.14 )
                                next
                                  case SenderStart
                                  by contradiction /* cyclic */
                                next
                                  case fresh
                                  by solve( !KU( ~x.16 ) @ #vk.14 )
                                qed
                              qed
                            next
                              case SenderStart
                              by solve( NewDHSecrets( ~id.4, 'g'^~x.19, old_pc.1, old_pc.1^~x.19,
                                                      kdf(<'rk', 
                                                           kdf(<'g'^(x.28*~x.29), z.7, 
                                                                'g'^(~x.19*x.21)>)
                                                          >)
                                        ) @ #b.1 )
                            qed
                          qed
                        next
                          case ReceiverStart
                          solve( !KU( 'g'^(~x.19*inv((~x.16*x.18))) ) @ #vk.6 )
                            case KeyGen_case_1
                            by solve( !KU( ~x.23 ) @ #vk.10 )
                          next
                            case KeyGen_case_2
                            by solve( !KU( ~x.23 ) @ #vk.10 )
                          next
                            case OuterRatchetToSender
                            by solve( !KU( ~x.24 ) @ #vk.10 )
                          next
                            case SenderStart
                            by solve( !KU( ~x.24 ) @ #vk.10 )
                          next
                            case c_exp
                            solve( !KU( ~x.19 ) @ #vk.10 )
                              case OuterRatchetToSender
                              by solve( !KU( ~x.16 ) @ #vk.13 )
                            next
                              case Send
                              by solve( !KU( ~x.16 ) @ #vk.13 )
                            next
                              case SenderStart
                              by contradiction /* cyclic */
                            next
                              case fresh
                              by solve( !KU( ~x.16 ) @ #vk.13 )
                            qed
                          qed
                        qed
                      next
                        case split_case_2
                        by contradiction /* from formulas */
                      next
                        case split_case_3
                        solve( Session( ~id.4, $A.3, 'S', ~x.14, $B.3, 'g'^inv(x.18),
                                        kdf(<'rk', kdf(<'rk', old_rk.1, 'g'^(~x.19*inv(x.18))>), 
                                             'g'^(~x.14*inv(x.18))>),
                                        ck
                               ) ▶₁ #t )
                          case OuterRatchetToSender
                          solve( Session( ~id.3, $A.2, 'R', drop.1, $B.2,
                                          'g'^(~x.19*inv((~x.16*x.18))), old_rk.1, old_ck.1
                                 ) ▶₂ #vr.2 )
                            case OuterRatchetToReceiver_case_1
                            solve( !KU( 'g'^(~x.19*inv((~x.16*x.18))) ) @ #vk.6 )
                              case KeyGen_case_1
                              by solve( !KU( ~x.25 ) @ #vk.10 )
                            next
                              case KeyGen_case_2
                              by solve( !KU( ~x.25 ) @ #vk.10 )
                            next
                              case OuterRatchetToSender
                              by solve( !KU( ~x.26 ) @ #vk.10 )
                            next
                              case SenderStart
                              by solve( !KU( ~x.26 ) @ #vk.10 )
                            next
                              case c_exp
                              solve( !KU( ~x.19 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.16 ) @ #vk.13 )
                              next
                                case Send
                                by solve( !KU( ~x.16 ) @ #vk.13 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.16 ) @ #vk.13 )
                              qed
                            qed
                          next
                            case OuterRatchetToReceiver_case_2
                            solve( !KU( 'g'^(~x.19*inv((~x.16*x.18))) ) @ #vk.6 )
                              case KeyGen_case_1
                              by solve( !KU( ~x.25 ) @ #vk.10 )
                            next
                              case KeyGen_case_2
                              by solve( !KU( ~x.25 ) @ #vk.10 )
                            next
                              case OuterRatchetToSender
                              by solve( !KU( ~x.26 ) @ #vk.10 )
                            next
                              case SenderStart
                              by solve( !KU( ~x.26 ) @ #vk.10 )
                            next
                              case c_exp
                              solve( !KU( ~x.19 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.16 ) @ #vk.13 )
                              next
                                case Send
                                by solve( !KU( ~x.16 ) @ #vk.13 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.16 ) @ #vk.13 )
                              qed
                            qed
                          next
                            case OuterRatchetToReceiver_case_3
                            solve( !KU( 'g'^(~x.19*inv((~x.16*x.18))) ) @ #vk.6 )
                              case KeyGen_case_1
                              by solve( !KU( ~x.25 ) @ #vk.10 )
                            next
                              case KeyGen_case_2
                              by solve( !KU( ~x.25 ) @ #vk.10 )
                            next
                              case OuterRatchetToSender
                              by solve( !KU( ~x.26 ) @ #vk.10 )
                            next
                              case SenderStart
                              by solve( !KU( ~x.26 ) @ #vk.10 )
                            next
                              case c_exp
                              solve( !KU( ~x.19 ) @ #vk.10 )
                                case OuterRatchetToSender
                                by solve( !KU( ~x.16 ) @ #vk.13 )
                              next
                                case Send
                                by solve( !KU( ~x.16 ) @ #vk.13 )
                              next
                                case SenderStart
                                by contradiction /* cyclic */
                              next
                                case fresh
                                by solve( !KU( ~x.16 ) @ #vk.13 )
                              qed
                            qed
                          next
                            case Receive
                            solve( NewDHSecrets( ~id.3, 'g'^~x.22,
                                                 'g'^(~x.19*inv((~x.16*x.18))), 'g'^(~x.19*x.23),
                                                 old_rk.1
                                   ) @ #b.2 )
                              case OuterRatchetToReceiver
                              solve( !KU( 'g'^(~x.19*inv((~x.16*x.18))) ) @ #vk.7 )
                                case KeyGen_case_1
                                by solve( !KU( ~x.43 ) @ #vk.11 )
                              next
                                case KeyGen_case_2
                                by solve( !KU( ~x.43 ) @ #vk.11 )
                              next
                                case OuterRatchetToSender
                                by solve( !KU( ~x.44 ) @ #vk.11 )
                              next
                                case SenderStart
                                by solve( !KU( ~x.44 ) @ #vk.11 )
                              next
                                case c_exp
                                solve( !KU( ~x.19 ) @ #vk.11 )
                                  case OuterRatchetToSender
                                  by solve( !KU( ~x.16 ) @ #vk.14 )
                                next
                                  case Send
                                  by solve( !KU( ~x.16 ) @ #vk.14 )
                                next
                                  case SenderStart
                                  by contradiction /* cyclic */
                                next
                                  case fresh
                                  by solve( !KU( ~x.16 ) @ #vk.14 )
                                qed
                              qed
                            next
                              case OuterRatchetToSender
                              by sorry
                            next
                              case ReceiverStart
                              by sorry
                            next
                              case SenderStart
                              by sorry
                            qed
                          next
                            case ReceiverStart
                            by sorry
                          qed
                        next
                          case Send
                          by sorry
                        qed
                      next
                        case split_case_4
                        by sorry
                      next
                        case split_case_5
                        by sorry
                      next
                        case split_case_6
                        by sorry
                      next
                        case split_case_7
                        by sorry
                      qed
                    next
                      case split_case_5
                      by sorry
                    next
                      case split_case_6
                      by sorry
                    qed
                  next
                    case SenderStart_case_1
                    by sorry
                  next
                    case SenderStart_case_2
                    by sorry
                  next
                    case c_exp
                    by sorry
                  qed
                next
                  case split_case_3
                  by sorry
                next
                  case split_case_4
                  by sorry
                next
                  case split_case_5
                  by sorry
                qed
              next
                case split_case_5
                by sorry
              next
                case split_case_6
                by sorry
              next
                case split_case_7
                by sorry
              qed
            next
              case Send
              by sorry
            next
              case c_senc
              by sorry
            qed
          next
            case OuterRatchetToReceiver_case_3
            by sorry
          next
            case Receive
            by sorry
          next
            case ReceiverStart
            by sorry
          qed
        qed
      next
        case ReceiverStart
        by solve( Send( m.1 ) @ #b )
      next
        case SenderStart
        solve( !SecretKeys( $A.1, ~ltk, prek ) ▶₃ #b )
          case KeyGen
          solve( !PublicKeys( $B.1, ltpk, prepk ) ▶₄ #b )
            case KeyGen
            solve( !KU( 'g'^(~prek.3*~x.3) ) @ #x )
              case KeyGen
              by solve( !KU( ~x.4 ) @ #vk )
            next
              case SenderStart
              solve( Send( m.1 ) @ #vr.2 )
                case SenderStart
                by solve( !KU( ~prek.4 ) @ #vk )
              qed
            next
              case c_exp
              by solve( !KU( ~x.3 ) @ #vk.3 )
            qed
          qed
        qed
      qed
    next
      case SenderStart
      solve( !SecretKeys( $A, ~ltk, prek ) ▶₃ #t )
        case KeyGen
        solve( !PublicKeys( $B, ltpk, prepk ) ▶₄ #t )
          case KeyGen
          solve( !KU( 'g'^(~x.2*~prek.3) ) @ #x )
            case KeyGen
            by solve( !KU( ~x.3 ) @ #vk )
          next
            case SenderStart
            by solve( !KU( ~prek.4 ) @ #vk )
          next
            case c_exp
            by solve( !KU( ~x.2 ) @ #vk.2 )
          qed
        qed
      qed
    qed
  qed
qed

lemma CkSecrecy [reuse, use_induction,
                 hide_lemma=OuterLoopStepSender, hide_lemma=NoDHNeutral,
                 hide_lemma=NoGenerator, hide_lemma=SSSecrecy]:
  all-traces
  "∀ id pc1 pc2 ss rk ck #a.
    ((ChainKey( id, ck ) @ #a) ∧
     (DHSecrets( id, pc1, pc2, ss, rk ) @ #a)) ⇒
    ((¬(∃ #x. !KU( ck ) @ #x)) ∨ (∃ #x. !KU( ss ) @ #x))"
/*
guarded formula characterizing all counter-examples:
"∃ id pc1 pc2 ss rk ck #a.
  (ChainKey( id, ck ) @ #a) ∧
  (DHSecrets( id, pc1, pc2, ss, rk ) @ #a)
 ∧
  (∃ #x. (!KU( ck ) @ #x)) ∧ (∀ #x. (!KU( ss ) @ #x) ⇒ ⊥)"
*/
by sorry

lemma Secrecy [no_cyclic, hide_lemma=OuterLoopStepSender,
               hide_lemma=NoDHNeutral]:
  all-traces "∀ m #t. (Send( m ) @ #t) ⇒ (¬(∃ #x. K( m ) @ #x))"
/*
guarded formula characterizing all counter-examples:
"∃ m #t. (Send( m ) @ #t) ∧ ∃ #x. (K( m ) @ #x)"
*/
by sorry

















/* All wellformedness checks were successful. */

/*
Generated from:
Tamarin version 1.11.0
Maude version 3.2.1
Git revision: 4d53012802d3c526e3d794810cb15551163f4462, branch: rewrite-prover-regression
Compiled at: 2024-12-05 16:41:44.504428 UTC
*/

end